import{ay as Hf,R as pr,aY as QM,ax as eO,bd as dD,r as Fg,bc as hr,bg as gD,bh as mD}from"./index-DolUtUq3.js";import{i as At,h as Hg,f as pD,H as vD,E as sc,B as Jc,s as Mo,S as gw,j as wD}from"./_commonjs-dynamic-modules-D0ipRT8o.js";var kh=function(t){return t&&t.Math===Math&&t},gn=kh(typeof globalThis=="object"&&globalThis)||kh(typeof window=="object"&&window)||kh(typeof self=="object"&&self)||kh(typeof Hf=="object"&&Hf)||kh(typeof Hf=="object"&&Hf)||function(){return this}()||Function("return this")(),Cx={},ui=function(t){try{return!!t()}catch{return!0}},CD=ui,Os=!CD(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),yD=ui,gv=!yD(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),xD=gv,Dg=Function.prototype.call,Ps=xD?Dg.bind(Dg):function(){return Dg.apply(Dg,arguments)},tO={},rO={}.propertyIsEnumerable,nO=Object.getOwnPropertyDescriptor,SD=nO&&!rO.call({1:2},1);tO.f=SD?function(e){var r=nO(this,e);return!!r&&r.enumerable}:rO;var mv=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},iO=gv,sO=Function.prototype,ty=sO.call,bD=iO&&sO.bind.bind(ty,ty),jr=iO?bD:function(t){return function(){return ty.apply(t,arguments)}},oO=jr,ED=oO({}.toString),RD=oO("".slice),Hc=function(t){return RD(ED(t),8,-1)},TD=jr,_D=ui,AD=Hc,mw=Object,ID=TD("".split),MD=_D(function(){return!mw("z").propertyIsEnumerable(0)})?function(t){return AD(t)==="String"?ID(t,""):mw(t)}:mw,pv=function(t){return t==null},OD=pv,PD=TypeError,eg=function(t){if(OD(t))throw new PD("Can't call method on "+t);return t},kD=MD,ND=eg,vv=function(t){return kD(ND(t))},pw=typeof document=="object"&&document.all,mn=typeof pw>"u"&&pw!==void 0?function(t){return typeof t=="function"||t===pw}:function(t){return typeof t=="function"},FD=mn,yo=function(t){return typeof t=="object"?t!==null:FD(t)},vw=gn,HD=mn,DD=function(t){return HD(t)?t:void 0},wh=function(t,e){return arguments.length<2?DD(vw[t]):vw[t]&&vw[t][e]},LD=jr,wv=LD({}.isPrototypeOf),$D=gn,uR=$D.navigator,hR=uR&&uR.userAgent,Cv=hR?String(hR):"",aO=gn,ww=Cv,fR=aO.process,dR=aO.Deno,gR=fR&&fR.versions||dR&&dR.version,mR=gR&&gR.v8,xs,ip;mR&&(xs=mR.split("."),ip=xs[0]>0&&xs[0]<4?1:+(xs[0]+xs[1]));!ip&&ww&&(xs=ww.match(/Edge\/(\d+)/),(!xs||xs[1]>=74)&&(xs=ww.match(/Chrome\/(\d+)/),xs&&(ip=+xs[1])));var BD=ip,pR=BD,VD=ui,WD=gn,UD=WD.String,yx=!!Object.getOwnPropertySymbols&&!VD(function(){var t=Symbol("symbol detection");return!UD(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&pR&&pR<41}),jD=yx,lO=jD&&!Symbol.sham&&typeof Symbol.iterator=="symbol",zD=wh,GD=mn,YD=wv,KD=lO,XD=Object,xx=KD?function(t){return typeof t=="symbol"}:function(t){var e=zD("Symbol");return GD(e)&&YD(e.prototype,XD(t))},qD=String,yv=function(t){try{return qD(t)}catch{return"Object"}},JD=mn,ZD=yv,QD=TypeError,tg=function(t){if(JD(t))return t;throw new QD(ZD(t)+" is not a function")},eL=tg,tL=pv,xv=function(t,e){var r=t[e];return tL(r)?void 0:eL(r)},Cw=Ps,yw=mn,xw=yo,rL=TypeError,nL=function(t,e){var r,n;if(e==="string"&&yw(r=t.toString)&&!xw(n=Cw(r,t))||yw(r=t.valueOf)&&!xw(n=Cw(r,t))||e!=="string"&&yw(r=t.toString)&&!xw(n=Cw(r,t)))return n;throw new rL("Can't convert object to primitive value")},cO={exports:{}},vR=gn,iL=Object.defineProperty,Sx=function(t,e){try{iL(vR,t,{value:e,configurable:!0,writable:!0})}catch{vR[t]=e}return e},sL=gn,oL=Sx,wR="__core-js_shared__",CR=cO.exports=sL[wR]||oL(wR,{});(CR.versions||(CR.versions=[])).push({version:"3.39.0",mode:"global",copyright:"Â© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"});var bx=cO.exports,yR=bx,uO=function(t,e){return yR[t]||(yR[t]=e||{})},aL=eg,lL=Object,rg=function(t){return lL(aL(t))},cL=jr,uL=rg,hL=cL({}.hasOwnProperty),xo=Object.hasOwn||function(e,r){return hL(uL(e),r)},fL=jr,dL=0,gL=Math.random(),mL=fL(1 .toString),hO=function(t){return"Symbol("+(t===void 0?"":t)+")_"+mL(++dL+gL,36)},pL=gn,vL=uO,xR=xo,wL=hO,CL=yx,yL=lO,ju=pL.Symbol,Sw=vL("wks"),xL=yL?ju.for||ju:ju&&ju.withoutSetter||wL,cl=function(t){return xR(Sw,t)||(Sw[t]=CL&&xR(ju,t)?ju[t]:xL("Symbol."+t)),Sw[t]},SL=Ps,SR=yo,bR=xx,bL=xv,EL=nL,RL=cl,TL=TypeError,_L=RL("toPrimitive"),AL=function(t,e){if(!SR(t)||bR(t))return t;var r=bL(t,_L),n;if(r){if(e===void 0&&(e="default"),n=SL(r,t,e),!SR(n)||bR(n))return n;throw new TL("Can't convert object to primitive value")}return e===void 0&&(e="number"),EL(t,e)},IL=AL,ML=xx,fO=function(t){var e=IL(t,"string");return ML(e)?e:e+""},OL=gn,ER=yo,ry=OL.document,PL=ER(ry)&&ER(ry.createElement),Ex=function(t){return PL?ry.createElement(t):{}},kL=Os,NL=ui,FL=Ex,dO=!kL&&!NL(function(){return Object.defineProperty(FL("div"),"a",{get:function(){return 7}}).a!==7}),HL=Os,DL=Ps,LL=tO,$L=mv,BL=vv,VL=fO,WL=xo,UL=dO,RR=Object.getOwnPropertyDescriptor;Cx.f=HL?RR:function(e,r){if(e=BL(e),r=VL(r),UL)try{return RR(e,r)}catch{}if(WL(e,r))return $L(!DL(LL.f,e,r),e[r])};var ul={},jL=Os,zL=ui,gO=jL&&zL(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),GL=yo,YL=String,KL=TypeError,ca=function(t){if(GL(t))return t;throw new KL(YL(t)+" is not an object")},XL=Os,qL=dO,JL=gO,Lg=ca,TR=fO,ZL=TypeError,bw=Object.defineProperty,QL=Object.getOwnPropertyDescriptor,Ew="enumerable",Rw="configurable",Tw="writable";ul.f=XL?JL?function(e,r,n){if(Lg(e),r=TR(r),Lg(n),typeof e=="function"&&r==="prototype"&&"value"in n&&Tw in n&&!n[Tw]){var i=QL(e,r);i&&i[Tw]&&(e[r]=n.value,n={configurable:Rw in n?n[Rw]:i[Rw],enumerable:Ew in n?n[Ew]:i[Ew],writable:!1})}return bw(e,r,n)}:bw:function(e,r,n){if(Lg(e),r=TR(r),Lg(n),qL)try{return bw(e,r,n)}catch{}if("get"in n||"set"in n)throw new ZL("Accessors not supported");return"value"in n&&(e[r]=n.value),e};var e4=Os,t4=ul,r4=mv,ng=e4?function(t,e,r){return t4.f(t,e,r4(1,r))}:function(t,e,r){return t[e]=r,t},mO={exports:{}},ny=Os,n4=xo,pO=Function.prototype,i4=ny&&Object.getOwnPropertyDescriptor,Rx=n4(pO,"name"),s4=Rx&&(function(){}).name==="something",o4=Rx&&(!ny||ny&&i4(pO,"name").configurable),a4={EXISTS:Rx,PROPER:s4,CONFIGURABLE:o4},l4=jr,c4=mn,iy=bx,u4=l4(Function.toString);c4(iy.inspectSource)||(iy.inspectSource=function(t){return u4(t)});var h4=iy.inspectSource,f4=gn,d4=mn,_R=f4.WeakMap,g4=d4(_R)&&/native code/.test(String(_R)),m4=uO,p4=hO,AR=m4("keys"),vO=function(t){return AR[t]||(AR[t]=p4(t))},Tx={},v4=g4,wO=gn,w4=yo,C4=ng,_w=xo,Aw=bx,y4=vO,x4=Tx,IR="Object already initialized",sy=wO.TypeError,S4=wO.WeakMap,sp,Sd,op,b4=function(t){return op(t)?Sd(t):sp(t,{})},E4=function(t){return function(e){var r;if(!w4(e)||(r=Sd(e)).type!==t)throw new sy("Incompatible receiver, "+t+" required");return r}};if(v4||Aw.state){var Fs=Aw.state||(Aw.state=new S4);Fs.get=Fs.get,Fs.has=Fs.has,Fs.set=Fs.set,sp=function(t,e){if(Fs.has(t))throw new sy(IR);return e.facade=t,Fs.set(t,e),e},Sd=function(t){return Fs.get(t)||{}},op=function(t){return Fs.has(t)}}else{var Zc=y4("state");x4[Zc]=!0,sp=function(t,e){if(_w(t,Zc))throw new sy(IR);return e.facade=t,C4(t,Zc,e),e},Sd=function(t){return _w(t,Zc)?t[Zc]:{}},op=function(t){return _w(t,Zc)}}var R4={set:sp,get:Sd,has:op,enforce:b4,getterFor:E4},_x=jr,T4=ui,_4=mn,$g=xo,oy=Os,A4=a4.CONFIGURABLE,I4=h4,CO=R4,M4=CO.enforce,O4=CO.get,MR=String,Fm=Object.defineProperty,P4=_x("".slice),k4=_x("".replace),N4=_x([].join),F4=oy&&!T4(function(){return Fm(function(){},"length",{value:8}).length!==8}),H4=String(String).split("String"),D4=mO.exports=function(t,e,r){P4(MR(e),0,7)==="Symbol("&&(e="["+k4(MR(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!$g(t,"name")||A4&&t.name!==e)&&(oy?Fm(t,"name",{value:e,configurable:!0}):t.name=e),F4&&r&&$g(r,"arity")&&t.length!==r.arity&&Fm(t,"length",{value:r.arity});try{r&&$g(r,"constructor")&&r.constructor?oy&&Fm(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var n=M4(t);return $g(n,"source")||(n.source=N4(H4,typeof e=="string"?e:"")),t};Function.prototype.toString=D4(function(){return _4(this)&&O4(this).source||I4(this)},"toString");var L4=mO.exports,$4=mn,B4=ul,V4=L4,W4=Sx,U4=function(t,e,r,n){n||(n={});var i=n.enumerable,s=n.name!==void 0?n.name:e;if($4(r)&&V4(r,s,n),n.global)i?t[e]=r:W4(e,r);else{try{n.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=r:B4.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},yO={},j4=Math.ceil,z4=Math.floor,G4=Math.trunc||function(e){var r=+e;return(r>0?z4:j4)(r)},Y4=G4,ig=function(t){var e=+t;return e!==e||e===0?0:Y4(e)},K4=ig,X4=Math.max,q4=Math.min,J4=function(t,e){var r=K4(t);return r<0?X4(r+e,0):q4(r,e)},Z4=ig,Q4=Math.min,e$=function(t){var e=Z4(t);return e>0?Q4(e,9007199254740991):0},t$=e$,sg=function(t){return t$(t.length)},r$=vv,n$=J4,i$=sg,OR=function(t){return function(e,r,n){var i=r$(e),s=i$(i);if(s===0)return!t&&-1;var o=n$(n,s),a;if(t&&r!==r){for(;s>o;)if(a=i[o++],a!==a)return!0}else for(;s>o;o++)if((t||o in i)&&i[o]===r)return t||o||0;return!t&&-1}},s$={includes:OR(!0),indexOf:OR(!1)},o$=jr,Iw=xo,a$=vv,l$=s$.indexOf,c$=Tx,PR=o$([].push),xO=function(t,e){var r=a$(t),n=0,i=[],s;for(s in r)!Iw(c$,s)&&Iw(r,s)&&PR(i,s);for(;e.length>n;)Iw(r,s=e[n++])&&(~l$(i,s)||PR(i,s));return i},Ax=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],u$=xO,h$=Ax,f$=h$.concat("length","prototype");yO.f=Object.getOwnPropertyNames||function(e){return u$(e,f$)};var SO={};SO.f=Object.getOwnPropertySymbols;var d$=wh,g$=jr,m$=yO,p$=SO,v$=ca,w$=g$([].concat),C$=d$("Reflect","ownKeys")||function(e){var r=m$.f(v$(e)),n=p$.f;return n?w$(r,n(e)):r},kR=xo,y$=C$,x$=Cx,S$=ul,bO=function(t,e,r){for(var n=y$(e),i=S$.f,s=x$.f,o=0;o<n.length;o++){var a=n[o];!kR(t,a)&&!(r&&kR(r,a))&&i(t,a,s(e,a))}},b$=ui,E$=mn,R$=/#|\.prototype\./,og=function(t,e){var r=_$[T$(t)];return r===I$?!0:r===A$?!1:E$(e)?b$(e):!!e},T$=og.normalize=function(t){return String(t).replace(R$,".").toLowerCase()},_$=og.data={},A$=og.NATIVE="N",I$=og.POLYFILL="P",M$=og,Bg=gn,O$=Cx.f,P$=ng,k$=U4,N$=Sx,F$=bO,H$=M$,pn=function(t,e){var r=t.target,n=t.global,i=t.stat,s,o,a,l,c,u;if(n?o=Bg:i?o=Bg[r]||N$(r,{}):o=Bg[r]&&Bg[r].prototype,o)for(a in e){if(c=e[a],t.dontCallGetSet?(u=O$(o,a),l=u&&u.value):l=o[a],s=H$(n?a:r+(i?".":"#")+a,t.forced),!s&&l!==void 0){if(typeof c==typeof l)continue;F$(c,l)}(t.sham||l&&l.sham)&&P$(c,"sham",!0),k$(o,a,c,t)}},D$=gv,EO=Function.prototype,NR=EO.apply,FR=EO.call,Sv=typeof Reflect=="object"&&Reflect.apply||(D$?FR.bind(NR):function(){return FR.apply(NR,arguments)}),L$=jr,$$=tg,RO=function(t,e,r){try{return L$($$(Object.getOwnPropertyDescriptor(t,e)[r]))}catch{}},B$=yo,V$=function(t){return B$(t)||t===null},W$=V$,U$=String,j$=TypeError,z$=function(t){if(W$(t))return t;throw new j$("Can't set "+U$(t)+" as a prototype")},G$=RO,Y$=yo,K$=eg,X$=z$,TO=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},r;try{r=G$(Object.prototype,"__proto__","set"),r(e,[]),t=e instanceof Array}catch{}return function(i,s){return K$(i),X$(s),Y$(i)&&(t?r(i,s):i.__proto__=s),i}}():void 0),q$=ul.f,J$=function(t,e,r){r in t||q$(t,r,{configurable:!0,get:function(){return e[r]},set:function(n){e[r]=n}})},Z$=mn,Q$=yo,HR=TO,eB=function(t,e,r){var n,i;return HR&&Z$(n=e.constructor)&&n!==r&&Q$(i=n.prototype)&&i!==r.prototype&&HR(t,i),t},tB=cl,rB=tB("toStringTag"),_O={};_O[rB]="z";var nB=String(_O)==="[object z]",iB=nB,sB=mn,Hm=Hc,oB=cl,aB=oB("toStringTag"),lB=Object,cB=Hm(function(){return arguments}())==="Arguments",uB=function(t,e){try{return t[e]}catch{}},AO=iB?Hm:function(t){var e,r,n;return t===void 0?"Undefined":t===null?"Null":typeof(r=uB(e=lB(t),aB))=="string"?r:cB?Hm(e):(n=Hm(e))==="Object"&&sB(e.callee)?"Arguments":n},hB=AO,fB=String,bv=function(t){if(hB(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return fB(t)},dB=bv,gB=function(t,e){return t===void 0?arguments.length<2?"":e:dB(t)},mB=yo,pB=ng,vB=function(t,e){mB(e)&&"cause"in e&&pB(t,"cause",e.cause)},wB=jr,IO=Error,CB=wB("".replace),yB=function(t){return String(new IO(t).stack)}("zxcasd"),MO=/\n\s*at [^:]*:[^\n]*/,xB=MO.test(yB),SB=function(t,e){if(xB&&typeof t=="string"&&!IO.prepareStackTrace)for(;e--;)t=CB(t,MO,"");return t},bB=ui,EB=mv,RB=!bB(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",EB(1,7)),t.stack!==7):!0}),TB=ng,_B=SB,AB=RB,DR=Error.captureStackTrace,IB=function(t,e,r,n){AB&&(DR?DR(t,e):TB(t,"stack",_B(r,n)))},LR=wh,MB=xo,$R=ng,OB=wv,BR=TO,VR=bO,WR=J$,PB=eB,kB=gB,NB=vB,FB=IB,HB=Os,DB=function(t,e,r,n){var i="stackTraceLimit",s=n?2:1,o=t.split("."),a=o[o.length-1],l=LR.apply(null,o);if(l){var c=l.prototype;if(MB(c,"cause")&&delete c.cause,!r)return l;var u=LR("Error"),h=e(function(f,d){var g=kB(n?d:f,void 0),m=n?new l(f):new l;return g!==void 0&&$R(m,"message",g),FB(m,h,m.stack,2),this&&OB(c,this)&&PB(m,this,h),arguments.length>s&&NB(m,arguments[s]),m});h.prototype=c,a!=="Error"?BR?BR(h,u):VR(h,u,{name:!0}):HB&&i in l&&(WR(h,l,i),WR(h,l,"prepareStackTrace")),VR(h,l);try{c.name!==a&&$R(c,"name",a),c.constructor=h}catch{}return h}},OO=pn,LB=gn,So=Sv,PO=DB,ay="WebAssembly",UR=LB[ay],ap=new Error("e",{cause:7}).cause!==7,Dc=function(t,e){var r={};r[t]=PO(t,e,ap),OO({global:!0,constructor:!0,arity:1,forced:ap},r)},Ix=function(t,e){if(UR&&UR[t]){var r={};r[t]=PO(ay+"."+t,e,ap),OO({target:ay,stat:!0,constructor:!0,arity:1,forced:ap},r)}};Dc("Error",function(t){return function(r){return So(t,this,arguments)}});Dc("EvalError",function(t){return function(r){return So(t,this,arguments)}});Dc("RangeError",function(t){return function(r){return So(t,this,arguments)}});Dc("ReferenceError",function(t){return function(r){return So(t,this,arguments)}});Dc("SyntaxError",function(t){return function(r){return So(t,this,arguments)}});Dc("TypeError",function(t){return function(r){return So(t,this,arguments)}});Dc("URIError",function(t){return function(r){return So(t,this,arguments)}});Ix("CompileError",function(t){return function(r){return So(t,this,arguments)}});Ix("LinkError",function(t){return function(r){return So(t,this,arguments)}});Ix("RuntimeError",function(t){return function(r){return So(t,this,arguments)}});var $B=Hc,kO=Array.isArray||function(e){return $B(e)==="Array"},BB=Os,VB=kO,WB=TypeError,UB=Object.getOwnPropertyDescriptor,jB=BB&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),NO=jB?function(t,e){if(VB(t)&&!UB(t,"length").writable)throw new WB("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},zB=TypeError,GB=9007199254740991,FO=function(t){if(t>GB)throw zB("Maximum allowed index exceeded");return t},YB=pn,KB=rg,XB=sg,qB=NO,JB=FO,ZB=ui,QB=ZB(function(){return[].push.call({length:4294967296},1)!==4294967297}),e3=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},t3=QB||!e3();YB({target:"Array",proto:!0,arity:1,forced:t3},{push:function(e){var r=KB(this),n=XB(r),i=arguments.length;JB(n+i);for(var s=0;s<i;s++)r[n]=arguments[s],n++;return qB(r,n),n}});var Mw=jr,Vg=Set.prototype,bo={Set,add:Mw(Vg.add),has:Mw(Vg.has),remove:Mw(Vg.delete),proto:Vg},r3=bo.has,Lc=function(t){return r3(t),t},n3=Ps,$c=function(t,e,r){for(var n=r?t:t.iterator,i=t.next,s,o;!(s=n3(i,n)).done;)if(o=e(s.value),o!==void 0)return o},HO=jr,i3=$c,DO=bo,s3=DO.Set,LO=DO.proto,o3=HO(LO.forEach),$O=HO(LO.keys),a3=$O(new s3).next,ag=function(t,e,r){return r?i3({iterator:$O(t),next:a3},e):o3(t,e)},BO=bo,l3=ag,c3=BO.Set,u3=BO.add,Mx=function(t){var e=new c3;return l3(t,function(r){u3(e,r)}),e},h3=RO,f3=bo,lg=h3(f3.proto,"size","get")||function(t){return t.size},d3=function(t){return{iterator:t,next:t.next,done:!1}},jR=tg,VO=ca,zR=Ps,g3=ig,m3=d3,GR="Invalid size",p3=RangeError,v3=TypeError,w3=Math.max,WO=function(t,e){this.set=t,this.size=w3(e,0),this.has=jR(t.has),this.keys=jR(t.keys)};WO.prototype={getIterator:function(){return m3(VO(zR(this.keys,this.set)))},includes:function(t){return zR(this.has,this.set,t)}};var Bc=function(t){VO(t);var e=+t.size;if(e!==e)throw new v3(GR);var r=g3(e);if(r<0)throw new p3(GR);return new WO(t,r)},C3=Lc,UO=bo,y3=Mx,x3=lg,S3=Bc,b3=ag,E3=$c,R3=UO.has,YR=UO.remove,T3=function(e){var r=C3(this),n=S3(e),i=y3(r);return x3(r)<=n.size?b3(r,function(s){n.includes(s)&&YR(i,s)}):E3(n.getIterator(),function(s){R3(r,s)&&YR(i,s)}),i},_3=wh,KR=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},Vc=function(t){var e=_3("Set");try{new e()[t](KR(0));try{return new e()[t](KR(-1)),!1}catch{return!0}}catch{return!1}},A3=pn,I3=T3,M3=Vc;A3({target:"Set",proto:!0,real:!0,forced:!M3("difference")},{difference:I3});var O3=Lc,Ox=bo,P3=lg,k3=Bc,N3=ag,F3=$c,H3=Ox.Set,XR=Ox.add,D3=Ox.has,L3=function(e){var r=O3(this),n=k3(e),i=new H3;return P3(r)>n.size?F3(n.getIterator(),function(s){D3(r,s)&&XR(i,s)}):N3(r,function(s){n.includes(s)&&XR(i,s)}),i},$3=pn,B3=ui,V3=L3,W3=Vc,U3=!W3("intersection")||B3(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});$3({target:"Set",proto:!0,real:!0,forced:U3},{intersection:V3});var j3=Ps,qR=ca,z3=xv,Px=function(t,e,r){var n,i;qR(t);try{if(n=z3(t,"return"),!n){if(e==="throw")throw r;return r}n=j3(n,t)}catch(s){i=!0,n=s}if(e==="throw")throw r;if(i)throw n;return qR(n),r},G3=Lc,Y3=bo.has,K3=lg,X3=Bc,q3=ag,J3=$c,Z3=Px,Q3=function(e){var r=G3(this),n=X3(e);if(K3(r)<=n.size)return q3(r,function(s){if(n.includes(s))return!1},!0)!==!1;var i=n.getIterator();return J3(i,function(s){if(Y3(r,s))return Z3(i,"normal",!1)})!==!1},eV=pn,tV=Q3,rV=Vc;eV({target:"Set",proto:!0,real:!0,forced:!rV("isDisjointFrom")},{isDisjointFrom:tV});var nV=Lc,iV=lg,sV=ag,oV=Bc,aV=function(e){var r=nV(this),n=oV(e);return iV(r)>n.size?!1:sV(r,function(i){if(!n.includes(i))return!1},!0)!==!1},lV=pn,cV=aV,uV=Vc;lV({target:"Set",proto:!0,real:!0,forced:!uV("isSubsetOf")},{isSubsetOf:cV});var hV=Lc,fV=bo.has,dV=lg,gV=Bc,mV=$c,pV=Px,vV=function(e){var r=hV(this),n=gV(e);if(dV(r)<n.size)return!1;var i=n.getIterator();return mV(i,function(s){if(!fV(r,s))return pV(i,"normal",!1)})!==!1},wV=pn,CV=vV,yV=Vc;wV({target:"Set",proto:!0,real:!0,forced:!yV("isSupersetOf")},{isSupersetOf:CV});var xV=Lc,kx=bo,SV=Mx,bV=Bc,EV=$c,RV=kx.add,TV=kx.has,_V=kx.remove,AV=function(e){var r=xV(this),n=bV(e).getIterator(),i=SV(r);return EV(n,function(s){TV(r,s)?_V(i,s):RV(i,s)}),i},IV=pn,MV=AV,OV=Vc;IV({target:"Set",proto:!0,real:!0,forced:!OV("symmetricDifference")},{symmetricDifference:MV});var PV=Lc,kV=bo.add,NV=Mx,FV=Bc,HV=$c,DV=function(e){var r=PV(this),n=FV(e).getIterator(),i=NV(r);return HV(n,function(s){kV(i,s)}),i},LV=pn,$V=DV,BV=Vc;LV({target:"Set",proto:!0,real:!0,forced:!BV("union")},{union:$V});var VV=Hc,WV=jr,UV=function(t){if(VV(t)==="Function")return WV(t)},JR=UV,jV=tg,zV=gv,GV=JR(JR.bind),jO=function(t,e){return jV(t),e===void 0?t:zV?GV(t,e):function(){return t.apply(e,arguments)}},YV=wh,zO=YV("document","documentElement"),KV=jr,Nx=KV([].slice),XV=TypeError,GO=function(t,e){if(t<e)throw new XV("Not enough arguments");return t},qV=Cv,JV=/(?:ipad|iphone|ipod).*applewebkit/i.test(qV),Nh=gn,ZV=Cv,QV=Hc,Wg=function(t){return ZV.slice(0,t.length)===t},YO=function(){return Wg("Bun/")?"BUN":Wg("Cloudflare-Workers")?"CLOUDFLARE":Wg("Deno/")?"DENO":Wg("Node.js/")?"NODE":Nh.Bun&&typeof Bun.version=="string"?"BUN":Nh.Deno&&typeof Deno.version=="object"?"DENO":QV(Nh.process)==="process"?"NODE":Nh.window&&Nh.document?"BROWSER":"REST"}(),eW=YO,tW=eW==="NODE",_i=gn,rW=Sv,nW=jO,ZR=mn,iW=xo,KO=ui,QR=zO,sW=Nx,eT=Ex,oW=GO,aW=JV,lW=tW,ly=_i.setImmediate,cy=_i.clearImmediate,cW=_i.process,Ow=_i.Dispatch,uW=_i.Function,tT=_i.MessageChannel,hW=_i.String,Pw=0,zf={},rT="onreadystatechange",bd,wl,kw,Nw;KO(function(){bd=_i.location});var Fx=function(t){if(iW(zf,t)){var e=zf[t];delete zf[t],e()}},Fw=function(t){return function(){Fx(t)}},nT=function(t){Fx(t.data)},iT=function(t){_i.postMessage(hW(t),bd.protocol+"//"+bd.host)};(!ly||!cy)&&(ly=function(e){oW(arguments.length,1);var r=ZR(e)?e:uW(e),n=sW(arguments,1);return zf[++Pw]=function(){rW(r,void 0,n)},wl(Pw),Pw},cy=function(e){delete zf[e]},lW?wl=function(t){cW.nextTick(Fw(t))}:Ow&&Ow.now?wl=function(t){Ow.now(Fw(t))}:tT&&!aW?(kw=new tT,Nw=kw.port2,kw.port1.onmessage=nT,wl=nW(Nw.postMessage,Nw)):_i.addEventListener&&ZR(_i.postMessage)&&!_i.importScripts&&bd&&bd.protocol!=="file:"&&!KO(iT)?(wl=iT,_i.addEventListener("message",nT,!1)):rT in eT("script")?wl=function(t){QR.appendChild(eT("script"))[rT]=function(){QR.removeChild(this),Fx(t)}}:wl=function(t){setTimeout(Fw(t),0)});var XO={set:ly,clear:cy},fW=pn,dW=gn,sT=XO.clear;fW({global:!0,bind:!0,enumerable:!0,forced:dW.clearImmediate!==sT},{clearImmediate:sT});var qO=gn,gW=Sv,mW=mn,pW=YO,vW=Cv,wW=Nx,CW=GO,yW=qO.Function,xW=/MSIE .\./.test(vW)||pW==="BUN"&&function(){var t=qO.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),SW=function(t,e){var r=e?2:1;return xW?function(n,i){var s=CW(arguments.length,1)>r,o=mW(n)?n:yW(n),a=s?wW(arguments,r):[],l=s?function(){gW(o,this,a)}:o;return e?t(l,i):t(l)}:t},bW=pn,JO=gn,oT=XO.set,EW=SW,aT=JO.setImmediate?EW(oT,!1):oT;bW({global:!0,bind:!0,enumerable:!0,forced:JO.setImmediate!==aT},{setImmediate:aT});/*! @license DOMPurify 2.5.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.7/LICENSE */function Ba(t){"@babel/helpers - typeof";return Ba=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ba(t)}function uy(t,e){return uy=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},uy(t,e)}function RW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Dm(t,e,r){return RW()?Dm=Reflect.construct:Dm=function(i,s,o){var a=[null];a.push.apply(a,s);var l=Function.bind.apply(i,a),c=new l;return o&&uy(c,o.prototype),c},Dm.apply(null,arguments)}function ds(t){return TW(t)||_W(t)||AW(t)||IW()}function TW(t){if(Array.isArray(t))return hy(t)}function _W(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function AW(t,e){if(t){if(typeof t=="string")return hy(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hy(t,e)}}function hy(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function IW(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var MW=Object.hasOwnProperty,lT=Object.setPrototypeOf,OW=Object.isFrozen,PW=Object.getPrototypeOf,kW=Object.getOwnPropertyDescriptor,jn=Object.freeze,Zi=Object.seal,NW=Object.create,ZO=typeof Reflect<"u"&&Reflect,lp=ZO.apply,fy=ZO.construct;lp||(lp=function(e,r,n){return e.apply(r,n)});jn||(jn=function(e){return e});Zi||(Zi=function(e){return e});fy||(fy=function(e,r){return Dm(e,ds(r))});var FW=Qi(Array.prototype.forEach),cT=Qi(Array.prototype.pop),Fh=Qi(Array.prototype.push),Lm=Qi(String.prototype.toLowerCase),Hw=Qi(String.prototype.toString),uT=Qi(String.prototype.match),rs=Qi(String.prototype.replace),HW=Qi(String.prototype.indexOf),DW=Qi(String.prototype.trim),un=Qi(RegExp.prototype.test),Dw=LW(TypeError);function Qi(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return lp(t,e,n)}}function LW(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return fy(t,r)}}function pt(t,e,r){var n;r=(n=r)!==null&&n!==void 0?n:Lm,lT&&lT(t,null);for(var i=e.length;i--;){var s=e[i];if(typeof s=="string"){var o=r(s);o!==s&&(OW(e)||(e[i]=o),s=o)}t[s]=!0}return t}function Cl(t){var e=NW(null),r;for(r in t)lp(MW,t,[r])===!0&&(e[r]=t[r]);return e}function Ug(t,e){for(;t!==null;){var r=kW(t,e);if(r){if(r.get)return Qi(r.get);if(typeof r.value=="function")return Qi(r.value)}t=PW(t)}function n(i){return console.warn("fallback value for",i),null}return n}var hT=jn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Lw=jn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),$w=jn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),$W=jn(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Bw=jn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),BW=jn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),fT=jn(["#text"]),dT=jn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Vw=jn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),gT=jn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),jg=jn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),VW=Zi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),WW=Zi(/<%[\w\W]*|[\w\W]*%>/gm),UW=Zi(/\${[\w\W]*}/gm),jW=Zi(/^data-[\-\w.\u00B7-\uFFFF]/),zW=Zi(/^aria-[\-\w]+$/),GW=Zi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),YW=Zi(/^(?:\w+script|data):/i),KW=Zi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),XW=Zi(/^html$/i),qW=Zi(/^[a-z][.\w]*(-[.\w]+)+$/i),JW=function(){return typeof window>"u"?null:window},ZW=function(e,r){if(Ba(e)!=="object"||typeof e.createPolicy!="function")return null;var n=null,i="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(i)&&(n=r.currentScript.getAttribute(i));var s="dompurify"+(n?"#"+n:"");try{return e.createPolicy(s,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}};function QO(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:JW(),e=function(W){return QO(W)};if(e.version="2.5.7",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var r=t.document,n=t.document,i=t.DocumentFragment,s=t.HTMLTemplateElement,o=t.Node,a=t.Element,l=t.NodeFilter,c=t.NamedNodeMap,u=c===void 0?t.NamedNodeMap||t.MozNamedAttrMap:c,h=t.HTMLFormElement,f=t.DOMParser,d=t.trustedTypes,g=a.prototype,m=Ug(g,"cloneNode"),p=Ug(g,"nextSibling"),y=Ug(g,"childNodes"),S=Ug(g,"parentNode");if(typeof s=="function"){var C=n.createElement("template");C.content&&C.content.ownerDocument&&(n=C.content.ownerDocument)}var A=ZW(d,r),I=A?A.createHTML(""):"",O=n,_=O.implementation,E=O.createNodeIterator,b=O.createDocumentFragment,k=O.getElementsByTagName,B=r.importNode,N={};try{N=Cl(n).documentMode?n.documentMode:{}}catch{}var q={};e.isSupported=typeof S=="function"&&_&&_.createHTMLDocument!==void 0&&N!==9;var ue=VW,we=WW,Se=UW,ce=jW,Re=zW,Y=YW,Pe=KW,w=qW,v=GW,x=null,R=pt({},[].concat(ds(hT),ds(Lw),ds($w),ds(Bw),ds(fT))),T=null,L=pt({},[].concat(ds(dT),ds(Vw),ds(gT),ds(jg))),K=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Q=null,Z=null,ie=!0,fe=!0,H=!1,Me=!0,ae=!1,ke=!0,Ae=!1,be=!1,$e=!1,Le=!1,P=!1,F=!1,G=!0,ne=!1,X="user-content-",re=!0,te=!1,ee={},oe=null,le=pt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),se=null,Ee=pt({},["audio","video","img","source","image","track"]),Oe=null,De=pt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ze="http://www.w3.org/1998/Math/MathML",lt="http://www.w3.org/2000/svg",nt="http://www.w3.org/1999/xhtml",Je=nt,yt=!1,Jt=null,_o=pt({},[ze,lt,nt],Hw),hi,vl=["application/xhtml+xml","text/html"],cn="text/html",Zt,Mr=null,zr=n.createElement("form"),Xt=function(W){return W instanceof RegExp||W instanceof Function},Oh=function(W){Mr&&Mr===W||((!W||Ba(W)!=="object")&&(W={}),W=Cl(W),hi=vl.indexOf(W.PARSER_MEDIA_TYPE)===-1?hi=cn:hi=W.PARSER_MEDIA_TYPE,Zt=hi==="application/xhtml+xml"?Hw:Lm,x="ALLOWED_TAGS"in W?pt({},W.ALLOWED_TAGS,Zt):R,T="ALLOWED_ATTR"in W?pt({},W.ALLOWED_ATTR,Zt):L,Jt="ALLOWED_NAMESPACES"in W?pt({},W.ALLOWED_NAMESPACES,Hw):_o,Oe="ADD_URI_SAFE_ATTR"in W?pt(Cl(De),W.ADD_URI_SAFE_ATTR,Zt):De,se="ADD_DATA_URI_TAGS"in W?pt(Cl(Ee),W.ADD_DATA_URI_TAGS,Zt):Ee,oe="FORBID_CONTENTS"in W?pt({},W.FORBID_CONTENTS,Zt):le,Q="FORBID_TAGS"in W?pt({},W.FORBID_TAGS,Zt):{},Z="FORBID_ATTR"in W?pt({},W.FORBID_ATTR,Zt):{},ee="USE_PROFILES"in W?W.USE_PROFILES:!1,ie=W.ALLOW_ARIA_ATTR!==!1,fe=W.ALLOW_DATA_ATTR!==!1,H=W.ALLOW_UNKNOWN_PROTOCOLS||!1,Me=W.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ae=W.SAFE_FOR_TEMPLATES||!1,ke=W.SAFE_FOR_XML!==!1,Ae=W.WHOLE_DOCUMENT||!1,Le=W.RETURN_DOM||!1,P=W.RETURN_DOM_FRAGMENT||!1,F=W.RETURN_TRUSTED_TYPE||!1,$e=W.FORCE_BODY||!1,G=W.SANITIZE_DOM!==!1,ne=W.SANITIZE_NAMED_PROPS||!1,re=W.KEEP_CONTENT!==!1,te=W.IN_PLACE||!1,v=W.ALLOWED_URI_REGEXP||v,Je=W.NAMESPACE||nt,K=W.CUSTOM_ELEMENT_HANDLING||{},W.CUSTOM_ELEMENT_HANDLING&&Xt(W.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(K.tagNameCheck=W.CUSTOM_ELEMENT_HANDLING.tagNameCheck),W.CUSTOM_ELEMENT_HANDLING&&Xt(W.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(K.attributeNameCheck=W.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),W.CUSTOM_ELEMENT_HANDLING&&typeof W.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(K.allowCustomizedBuiltInElements=W.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ae&&(fe=!1),P&&(Le=!0),ee&&(x=pt({},ds(fT)),T=[],ee.html===!0&&(pt(x,hT),pt(T,dT)),ee.svg===!0&&(pt(x,Lw),pt(T,Vw),pt(T,jg)),ee.svgFilters===!0&&(pt(x,$w),pt(T,Vw),pt(T,jg)),ee.mathMl===!0&&(pt(x,Bw),pt(T,gT),pt(T,jg))),W.ADD_TAGS&&(x===R&&(x=Cl(x)),pt(x,W.ADD_TAGS,Zt)),W.ADD_ATTR&&(T===L&&(T=Cl(T)),pt(T,W.ADD_ATTR,Zt)),W.ADD_URI_SAFE_ATTR&&pt(Oe,W.ADD_URI_SAFE_ATTR,Zt),W.FORBID_CONTENTS&&(oe===le&&(oe=Cl(oe)),pt(oe,W.FORBID_CONTENTS,Zt)),re&&(x["#text"]=!0),Ae&&pt(x,["html","head","body"]),x.table&&(pt(x,["tbody"]),delete Q.tbody),jn&&jn(W),Mr=W)},kg=pt({},["mi","mo","mn","ms","mtext"]),Ng=pt({},["annotation-xml"]),hw=pt({},["title","style","font","a","script"]),pa=pt({},Lw);pt(pa,$w),pt(pa,$W);var Ph=pt({},Bw);pt(Ph,BW);var fw=function(W){var de=S(W);(!de||!de.tagName)&&(de={namespaceURI:Je,tagName:"template"});var he=Lm(W.tagName),Ie=Lm(de.tagName);return Jt[W.namespaceURI]?W.namespaceURI===lt?de.namespaceURI===nt?he==="svg":de.namespaceURI===ze?he==="svg"&&(Ie==="annotation-xml"||kg[Ie]):!!pa[he]:W.namespaceURI===ze?de.namespaceURI===nt?he==="math":de.namespaceURI===lt?he==="math"&&Ng[Ie]:!!Ph[he]:W.namespaceURI===nt?de.namespaceURI===lt&&!Ng[Ie]||de.namespaceURI===ze&&!kg[Ie]?!1:!Ph[he]&&(hw[he]||!pa[he]):!!(hi==="application/xhtml+xml"&&Jt[W.namespaceURI]):!1},Kn=function(W){Fh(e.removed,{element:W});try{W.parentNode.removeChild(W)}catch{try{W.outerHTML=I}catch{W.remove()}}},M=function(W,de){try{Fh(e.removed,{attribute:de.getAttributeNode(W),from:de})}catch{Fh(e.removed,{attribute:null,from:de})}if(de.removeAttribute(W),W==="is"&&!T[W])if(Le||P)try{Kn(de)}catch{}else try{de.setAttribute(W,"")}catch{}},U=function(W){var de,he;if($e)W="<remove></remove>"+W;else{var Ie=uT(W,/^[\r\n\t ]+/);he=Ie&&Ie[0]}hi==="application/xhtml+xml"&&Je===nt&&(W='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+W+"</body></html>");var Ke=A?A.createHTML(W):W;if(Je===nt)try{de=new f().parseFromString(Ke,hi)}catch{}if(!de||!de.documentElement){de=_.createDocument(Je,"template",null);try{de.documentElement.innerHTML=yt?I:Ke}catch{}}var mt=de.body||de.documentElement;return W&&he&&mt.insertBefore(n.createTextNode(he),mt.childNodes[0]||null),Je===nt?k.call(de,Ae?"html":"body")[0]:Ae?de.documentElement:mt},D=function(W){return E.call(W.ownerDocument||W,W,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT|l.SHOW_PROCESSING_INSTRUCTION|l.SHOW_CDATA_SECTION,null,!1)},V=function(W){return W instanceof h&&(typeof W.nodeName!="string"||typeof W.textContent!="string"||typeof W.removeChild!="function"||!(W.attributes instanceof u)||typeof W.removeAttribute!="function"||typeof W.setAttribute!="function"||typeof W.namespaceURI!="string"||typeof W.insertBefore!="function"||typeof W.hasChildNodes!="function")},j=function(W){return Ba(o)==="object"?W instanceof o:W&&Ba(W)==="object"&&typeof W.nodeType=="number"&&typeof W.nodeName=="string"},z=function(W,de,he){q[W]&&FW(q[W],function(Ie){Ie.call(e,de,he,Mr)})},me=function(W){var de;if(z("beforeSanitizeElements",W,null),V(W)||un(/[\u0080-\uFFFF]/,W.nodeName))return Kn(W),!0;var he=Zt(W.nodeName);if(z("uponSanitizeElement",W,{tagName:he,allowedTags:x}),W.hasChildNodes()&&!j(W.firstElementChild)&&(!j(W.content)||!j(W.content.firstElementChild))&&un(/<[/\w]/g,W.innerHTML)&&un(/<[/\w]/g,W.textContent)||he==="select"&&un(/<template/i,W.innerHTML)||W.nodeType===7||ke&&W.nodeType===8&&un(/<[/\w]/g,W.data))return Kn(W),!0;if(!x[he]||Q[he]){if(!Q[he]&&ge(he)&&(K.tagNameCheck instanceof RegExp&&un(K.tagNameCheck,he)||K.tagNameCheck instanceof Function&&K.tagNameCheck(he)))return!1;if(re&&!oe[he]){var Ie=S(W)||W.parentNode,Ke=y(W)||W.childNodes;if(Ke&&Ie)for(var mt=Ke.length,ut=mt-1;ut>=0;--ut){var cr=m(Ke[ut],!0);cr.__removalCount=(W.__removalCount||0)+1,Ie.insertBefore(cr,p(W))}}return Kn(W),!0}return W instanceof a&&!fw(W)||(he==="noscript"||he==="noembed"||he==="noframes")&&un(/<\/no(script|embed|frames)/i,W.innerHTML)?(Kn(W),!0):(ae&&W.nodeType===3&&(de=W.textContent,de=rs(de,ue," "),de=rs(de,we," "),de=rs(de,Se," "),W.textContent!==de&&(Fh(e.removed,{element:W.cloneNode()}),W.textContent=de)),z("afterSanitizeElements",W,null),!1)},xe=function(W,de,he){if(G&&(de==="id"||de==="name")&&(he in n||he in zr))return!1;if(!(fe&&!Z[de]&&un(ce,de))){if(!(ie&&un(Re,de))){if(!T[de]||Z[de]){if(!(ge(W)&&(K.tagNameCheck instanceof RegExp&&un(K.tagNameCheck,W)||K.tagNameCheck instanceof Function&&K.tagNameCheck(W))&&(K.attributeNameCheck instanceof RegExp&&un(K.attributeNameCheck,de)||K.attributeNameCheck instanceof Function&&K.attributeNameCheck(de))||de==="is"&&K.allowCustomizedBuiltInElements&&(K.tagNameCheck instanceof RegExp&&un(K.tagNameCheck,he)||K.tagNameCheck instanceof Function&&K.tagNameCheck(he))))return!1}else if(!Oe[de]){if(!un(v,rs(he,Pe,""))){if(!((de==="src"||de==="xlink:href"||de==="href")&&W!=="script"&&HW(he,"data:")===0&&se[W])){if(!(H&&!un(Y,rs(he,Pe,"")))){if(he)return!1}}}}}}return!0},ge=function(W){return W!=="annotation-xml"&&uT(W,w)},pe=function(W){var de,he,Ie,Ke;z("beforeSanitizeAttributes",W,null);var mt=W.attributes;if(mt){var ut={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:T};for(Ke=mt.length;Ke--;){de=mt[Ke];var cr=de,nr=cr.name,Ao=cr.namespaceURI;if(he=nr==="value"?de.value:DW(de.value),Ie=Zt(nr),ut.attrName=Ie,ut.attrValue=he,ut.keepAttr=!0,ut.forceKeepAttr=void 0,z("uponSanitizeAttribute",W,ut),he=ut.attrValue,!ut.forceKeepAttr&&(M(nr,W),!!ut.keepAttr)){if(!Me&&un(/\/>/i,he)){M(nr,W);continue}ae&&(he=rs(he,ue," "),he=rs(he,we," "),he=rs(he,Se," "));var va=Zt(W.nodeName);if(xe(va,Ie,he)){if(ne&&(Ie==="id"||Ie==="name")&&(M(nr,W),he=X+he),ke&&un(/((--!?|])>)|<\/(style|title)/i,he)){M(nr,W);continue}if(A&&Ba(d)==="object"&&typeof d.getAttributeType=="function"&&!Ao)switch(d.getAttributeType(va,Ie)){case"TrustedHTML":{he=A.createHTML(he);break}case"TrustedScriptURL":{he=A.createScriptURL(he);break}}try{Ao?W.setAttributeNS(Ao,nr,he):W.setAttribute(nr,he),V(W)?Kn(W):cT(e.removed)}catch{}}}}z("afterSanitizeAttributes",W,null)}},Ce=function ve(W){var de,he=D(W);for(z("beforeSanitizeShadowDOM",W,null);de=he.nextNode();)z("uponSanitizeShadowNode",de,null),!me(de)&&(de.content instanceof i&&ve(de.content),pe(de));z("afterSanitizeShadowDOM",W,null)};return e.sanitize=function(ve){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},de,he,Ie,Ke,mt;if(yt=!ve,yt&&(ve="<!-->"),typeof ve!="string"&&!j(ve))if(typeof ve.toString=="function"){if(ve=ve.toString(),typeof ve!="string")throw Dw("dirty is not a string, aborting")}else throw Dw("toString is not a function");if(!e.isSupported){if(Ba(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof ve=="string")return t.toStaticHTML(ve);if(j(ve))return t.toStaticHTML(ve.outerHTML)}return ve}if(be||Oh(W),e.removed=[],typeof ve=="string"&&(te=!1),te){if(ve.nodeName){var ut=Zt(ve.nodeName);if(!x[ut]||Q[ut])throw Dw("root node is forbidden and cannot be sanitized in-place")}}else if(ve instanceof o)de=U("<!---->"),he=de.ownerDocument.importNode(ve,!0),he.nodeType===1&&he.nodeName==="BODY"||he.nodeName==="HTML"?de=he:de.appendChild(he);else{if(!Le&&!ae&&!Ae&&ve.indexOf("<")===-1)return A&&F?A.createHTML(ve):ve;if(de=U(ve),!de)return Le?null:F?I:""}de&&$e&&Kn(de.firstChild);for(var cr=D(te?ve:de);Ie=cr.nextNode();)Ie.nodeType===3&&Ie===Ke||me(Ie)||(Ie.content instanceof i&&Ce(Ie.content),pe(Ie),Ke=Ie);if(Ke=null,te)return ve;if(Le){if(P)for(mt=b.call(de.ownerDocument);de.firstChild;)mt.appendChild(de.firstChild);else mt=de;return(T.shadowroot||T.shadowrootmod)&&(mt=B.call(r,mt,!0)),mt}var nr=Ae?de.outerHTML:de.innerHTML;return Ae&&x["!doctype"]&&de.ownerDocument&&de.ownerDocument.doctype&&de.ownerDocument.doctype.name&&un(XW,de.ownerDocument.doctype.name)&&(nr="<!DOCTYPE "+de.ownerDocument.doctype.name+`>
`+nr),ae&&(nr=rs(nr,ue," "),nr=rs(nr,we," "),nr=rs(nr,Se," ")),A&&F?A.createHTML(nr):nr},e.setConfig=function(ve){Oh(ve),be=!0},e.clearConfig=function(){Mr=null,be=!1},e.isValidAttribute=function(ve,W,de){Mr||Oh({});var he=Zt(ve),Ie=Zt(W);return xe(he,Ie,de)},e.addHook=function(ve,W){typeof W=="function"&&(q[ve]=q[ve]||[],Fh(q[ve],W))},e.removeHook=function(ve){if(q[ve])return cT(q[ve])},e.removeHooks=function(ve){q[ve]&&(q[ve]=[])},e.removeAllHooks=function(){q={}},e}var QW=QO();function e8(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function mT(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function $m(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let s=0;s<n;s++)e[s]||(e[s]=[]),e[s][i]=t[i][s];return e}function Gn(t,e,r,n){let i=-1,s=t,o=r;Array.isArray(t)||(s=Array.from(t));const a=s.length;for(i+=1;i<a;)o=e(o,s[i],i,s),i+=1;return o}function rl(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let o=-1;for(;r<i;){const a=n[r];e(a,r,n)&&(o+=1,s[o]=a),r+=1}return s}function bt(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let o=-1;for(;r<i;){const a=n[r];o+=1,s[o]=e(a,r,n),r+=1}return s}function J(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function eP(t){const e=[];return J(t,r=>{e.indexOf(r)===-1&&e.push(r)}),e}function pT(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let s=n;return J(i,o=>{s=s.filter(a=>!o.includes(a))}),s}function vT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function Ht(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Gn(t,(s,o,a)=>{const l=o.replace(/\r?\n\s*/g,""),c=r[a]?r[a]:"";return s+l+c},"").trim()}function Nr(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function Ue(t){return typeof t<"u"}function tr(t){return typeof t>"u"}function _r(t){return t===null||t===""||tr(t)}function t8(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Df="length",Gf=t=>parseInt(t,16),wT=t=>parseInt(t,10),cp=(t,e,r)=>t.substr(e,r),Yf=t=>t.codePointAt(0)-65,dy=t=>`${t}`.replace(/\-/g,""),r8=t=>Gf(cp(dy(t),Gf("12"),Yf("F")))/(Gf(cp(dy(t),Yf("B"),~~![][Df]))||9),n8=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let CT=!1;const yT={invalid:()=>Ht`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Ht`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Ht`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},xT={invalid:()=>Ht`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Ht`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Ht`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function i8(t,e){const r=!_r(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="14.6.1";let s,o="invalid",a="invalid";t=dy(t||"");const l=s8(t);if(r||n||l)if(l){const c=At("17/10/2024","DD/MM/YYYY"),u=Math.floor(c.toDate().getTime()/864e5),h=r8(t);s=At((h+1)*864e5,"x").format("MMMM DD, YYYY"),u>h?(o="expired",a="expired"):(o="valid",a="valid")}else n?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(n8()&&(o="valid",a="valid"),!CT&&o!=="valid"&&(yT[o]({keyValidityDate:s,hotVersion:i})&&console[o==="non_commercial"?"info":"warn"](yT[o]({keyValidityDate:s,hotVersion:i})),CT=!0),a!=="valid"&&e.parentNode&&xT[a]({keyValidityDate:s,hotVersion:i})){const u=document.createElement("div");u.className="hot-display-license-info",u.innerHTML=xT[a]({keyValidityDate:s,hotVersion:i}),e.parentNode.insertBefore(u,e.nextSibling)}}function s8(t){let e=[][Df],r=e;if(t[Df]!==Yf("Z"))return!1;for(let n="",i="B<H4P+".split(""),s=Yf(i.shift());s;s=Yf(i.shift()||"A"))--s<""[Df]?r=r|(wT(`${wT(Gf(n)+(Gf(cp(t,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=cp(t,s,s?i[Df]===1?9:8:6);return r===e}function Is(t){return t[0].toUpperCase()+t.substr(1)}function tP(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function rP(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function nP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function ST(t){return Hx(`${t}`,{ALLOWED_TAGS:[]})}function Hx(t,e){return QW.sanitize(t,e)}const Ch=t=>["tabindex",t],o8=()=>["role","treegrid"],go=()=>["role","presentation"],a8=()=>["role","gridcell"],l8=()=>["role","rowheader"],iP=()=>["role","rowgroup"],c8=()=>["role","columnheader"],gy=()=>["role","row"],u8=()=>["role","menu"],h8=()=>["role","menuitem"],f8=()=>["role","menuitemcheckbox"],d8=()=>["role","combobox"],sP=()=>["role","listbox"],g8=()=>["role","option"],m8=()=>["role","checkbox"],p8=()=>["scope","col"],v8=()=>["scope","row"],w8=()=>["type","text"],up=t=>["aria-label",t],Wc=()=>["aria-hidden","true"],C8=()=>["aria-disabled","true"],y8=()=>["aria-multiselectable","true"],oP=t=>["aria-haspopup",t],aP=t=>["aria-rowcount",t],Ev=t=>["aria-colcount",t],lP=t=>["aria-rowindex",t],Dx=t=>["aria-colindex",t],qi=t=>["aria-expanded",t],x8=t=>["aria-sort",t],bT=()=>["aria-readonly","true"],ET=()=>["aria-invalid","true"],cP=t=>["aria-checked",t],Lx=()=>["aria-selected","true"],S8=()=>["aria-autocomplete","list"],b8=t=>["aria-controls",t],E8=t=>["aria-activedescendant",t],R8=t=>["aria-live",t],T8=t=>["aria-relevant",t],_8=t=>["aria-setsize",t],A8=t=>["aria-posinset",t];function I8(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function M8(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function O8(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function oh(t){return O8(t)&&t.parent}function xc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let s=t;for(;s!=null&&s!==r;){const{nodeType:o,nodeName:a}=s;if(o===n&&(e.includes(a)||e.includes(s)))return s;const{host:l}=s;l&&o===i?s=l:s=s.parentNode}return null}function zg(t,e,r){const n=[];let i=t;for(;i&&(i=xc(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const s=n.length;return s?n[s-1]:null}function pc(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function P8(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function yl(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function uP(t){return!t||!t.length?[]:t.filter(e=>!!e)}function hP(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const s=i instanceof RegExp;return s&&e&&r.push(i),!s})),{regexFree:n,regexes:r}}function Qe(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function _e(t,e){typeof e=="string"&&(e=e.split(" ")),e=uP(e),e.length>0&&t.classList.add(...e)}function it(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=hP(e,!0);r=uP(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(s=>{i.test(s)&&t.classList.remove(s)})})}function Ze(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function yh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=hP(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(s=>{i.test(s)&&t.removeAttribute(s)})})}function fP(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)fP(e[r])}}function wo(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const k8=/(<(.*)>|&(.*);)/;function xh(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;k8.test(e)?t.innerHTML=r?Hx(e):e:Sc(t,e)}function Sc(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(wo(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function ah(t){const e=t.ownerDocument.documentElement;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return ah(r.host.impl);if(r.host)return ah(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(sa(r).display==="none")return!1;r=r.parentNode}return!0}function sn(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,s,o,a;for(s=i.offsetLeft,o=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)s+=i.offsetLeft,o+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(s+=r.pageXOffset||n.scrollLeft,o+=r.pageYOffset||n.scrollTop),{left:s,top:o}}function dP(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function $x(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Bx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?dP(e):t.scrollTop}function gP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?$x(e):t.scrollLeft}function hp(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:s,overflowX:o,overflowY:a}=i.style;if([s,o,a].includes("scroll"))return i;if({overflow:s,overflowX:o,overflowY:a}=r.getComputedStyle(i),n.includes(s)||n.includes(o)||n.includes(a)||i.clientHeight<=i.scrollHeight+1&&(n.includes(a)||n.includes(s))||i.clientWidth<=i.scrollWidth+1&&(n.includes(o)||n.includes(s)))return i;i=i.parentNode}return r}function N8(t){return t.scrollHeight-t.clientHeight}function F8(t){return t.scrollWidth-t.clientWidth}function lh(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=sa(n,r),s=["scroll","hidden","auto"],o=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(s.includes(o)||s.includes(a)||s.includes(l))return n;n=n.parentNode}return r}function Ed(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=sa(t,r);if(i[e]!==""&&i[e]!==void 0)return i[e]}function sa(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function rr(t){return t.offsetWidth}function Fr(t){return t.offsetHeight}function zu(t){return t.clientHeight||t.innerHeight}function mP(t){return t.clientWidth||t.innerWidth}function pP(t){return t.selectionStart?t.selectionStart:0}function H8(t){return t.selectionEnd?t.selectionEnd:0}function RT(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Rv(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,s=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=s}}}let Ww;function D8(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.offsetWidth;r.style.overflow="scroll";let i=e.offsetWidth;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),n-i}function ln(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Ww===void 0&&(Ww=D8(t)),Ww}function L8(t){return t.offsetWidth!==t.clientWidth}function $8(t){return t.offsetHeight!==t.clientHeight}function Vx(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function Tv(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Bm(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function vP(t){return Bm(t)&&t.hasAttribute("data-hot-input")===!1}function wP(t){return!t.parentNode}function B8(t,e){new IntersectionObserver((n,i)=>{n.forEach(s=>{s.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function CP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=t.ownerDocument,i=n.createRange(),s=n.defaultView.getSelection();Ze(t,"contenteditable",!0),r&&Ze(t,...Wc()),e&&_e(t,"invisibleSelection"),i.selectNodeContents(t),s.removeAllRanges(),s.addRange(i)}function yP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&it(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function V8(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;CP(t,r),e(),yP(t,r)}function er(t){return typeof t=="function"}function Wx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,o)},e),n}return i}function xP(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t.apply(this,r.concat(o))}}function W8(t){const e=t.length;function r(n){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=n.concat(o);let c;return l.length>=e?c=t.apply(this,l):c=r(l),c}}return r([])}function my(t,e,r,n,i,s,o,a){return Ue(a)?t.call(e,r,n,i,s,o,a):Ue(o)?t.call(e,r,n,i,s,o):Ue(s)?t.call(e,r,n,i,s):Ue(i)?t.call(e,r,n,i):Ue(n)?t.call(e,r,n):Ue(r)?t.call(e,r):t.call(e)}var U8=jr,TT=kO,j8=mn,_T=Hc,z8=bv,AT=U8([].push),G8=function(t){if(j8(t))return t;if(TT(t)){for(var e=t.length,r=[],n=0;n<e;n++){var i=t[n];typeof i=="string"?AT(r,i):(typeof i=="number"||_T(i)==="Number"||_T(i)==="String")&&AT(r,z8(i))}var s=r.length,o=!0;return function(a,l){if(o)return o=!1,l;if(TT(this))return l;for(var c=0;c<s;c++)if(r[c]===a)return l}}},Y8=pn,SP=wh,bP=Sv,K8=Ps,cg=jr,EP=ui,IT=mn,MT=xx,RP=Nx,X8=G8,q8=yx,J8=String,Za=SP("JSON","stringify"),Gg=cg(/./.exec),OT=cg("".charAt),Z8=cg("".charCodeAt),Q8=cg("".replace),e6=cg(1 .toString),t6=/[\uD800-\uDFFF]/g,PT=/^[\uD800-\uDBFF]$/,kT=/^[\uDC00-\uDFFF]$/,NT=!q8||EP(function(){var t=SP("Symbol")("stringify detection");return Za([t])!=="[null]"||Za({a:t})!=="{}"||Za(Object(t))!=="{}"}),FT=EP(function(){return Za("\uDF06\uD834")!=='"\\udf06\\ud834"'||Za("\uDEAD")!=='"\\udead"'}),r6=function(t,e){var r=RP(arguments),n=X8(e);if(!(!IT(n)&&(t===void 0||MT(t))))return r[1]=function(i,s){if(IT(n)&&(s=K8(n,this,J8(i),s)),!MT(s))return s},bP(Za,null,r)},n6=function(t,e,r){var n=OT(r,e-1),i=OT(r,e+1);return Gg(PT,t)&&!Gg(kT,i)||Gg(kT,t)&&!Gg(PT,n)?"\\u"+e6(Z8(t,0),16):t};Za&&Y8({target:"JSON",stat:!0,arity:3,forced:NT||FT},{stringify:function(e,r,n){var i=RP(arguments),s=bP(NT?r6:Za,null,i);return FT&&typeof s=="string"?Q8(s,t6,n6):s}});function Rd(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},gt(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=Rd(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[Rd(r[0])]:e[n]=[]:e[n]=null)})),e}function Eo(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Ur(t,e,r){const n=Array.isArray(r);return gt(e,(i,s)=>{(n===!1||r.includes(s))&&(t[s]=i)}),t}function _v(t,e){gt(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),_v(t[n],e[n])):t[n]=e[n]})}function zn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Co(t){const e={};return gt(t,(r,n)=>{e[n]=r}),e}function jt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return J(r,i=>{t.MIXINS.push(i.MIXIN_NAME),gt(i,(s,o)=>{if(t.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof s=="function")t.prototype[o]=s;else{const a=function(u,h){const f=`_${u}`,d=g=>{let m=g;return(Array.isArray(m)||dt(m))&&(m=zn(m)),m};return function(){return this[f]===void 0&&(this[f]=d(h)),this[f]}},l=function(u){const h=`_${u}`;return function(f){this[h]=f}};Object.defineProperty(t.prototype,o,{get:a(o,s),set:l(o),configurable:!0})}})}),t}function Ux(t,e){return JSON.stringify(t)===JSON.stringify(e)}function dt(t){return Object.prototype.toString.call(t)==="[object Object]"}function ua(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function gt(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function i6(t,e){const r=e.split(".");let n=t;return gt(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function Uw(t,e,r){const n=e.split(".");let i=t;n.forEach((s,o)=>{o!==n.length-1?(Cr(i,s)||(i[s]={}),i=i[s]):i[s]=r})}function jx(t){if(!dt(t))return 0;const e=function(r){let n=0;return dt(r)?gt(r,(i,s)=>{s!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function Ss(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function Cr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function zx(t){return window.requestAnimationFrame(t)}function fp(t){window.cancelAnimationFrame(t)}function TP(){return"ontouchstart"in window}function s6(){return typeof window<"u"}let Qc;function o6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Qc||(typeof Intl=="object"?Qc=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Qc=(r,n)=>`${r}`.localeCompare(n):Qc=(r,n)=>r===n?0:r>n?-1:1,Qc)}const Wi=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},hl={chrome:Wi((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Wi(t=>/CriOS/.test(t)),edge:Wi(t=>/Edge/.test(t)),edgeWebKit:Wi(t=>/EdgiOS/.test(t)),firefox:Wi(t=>/Firefox/.test(t)),firefoxWebKit:Wi(t=>/FxiOS/.test(t)),mobile:Wi(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Wi((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},ug={mac:Wi(t=>/^Mac/.test(t)),win:Wi(t=>/^Win/.test(t)),linux:Wi(t=>/^Linux/.test(t)),ios:Wi(t=>/iPhone|iPad|iPod/i.test(t))};function a6(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};gt(hl,r=>{let{test:n}=r;return void n(t,e)})}function l6(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};gt(ug,e=>{let{test:r}=e;return void r(t)})}s6()&&(a6(),l6());function _P(){return hl.chrome.value}function c6(){return hl.chromeWebKit.value}function jw(){return hl.firefox.value}function u6(){return hl.firefoxWebKit.value}function AP(){return hl.safari.value}function h6(){return hl.edge.value}function za(){return hl.mobile.value}function IP(){return ug.ios.value}function MP(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&ug.mac.value}function HT(){return ug.win.value}function py(){return ug.mac.value}const Xe={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:jw()?182:174,AUDIO_MUTE:jw()?181:173,AUDIO_UP:jw()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},f6=[Xe.ALT,Xe.ARROW_DOWN,Xe.ARROW_LEFT,Xe.ARROW_RIGHT,Xe.ARROW_UP,Xe.AUDIO_DOWN,Xe.AUDIO_MUTE,Xe.AUDIO_UP,Xe.BACKSPACE,Xe.CAPS_LOCK,Xe.DELETE,Xe.END,Xe.ENTER,Xe.ESCAPE,Xe.F1,Xe.F2,Xe.F3,Xe.F4,Xe.F5,Xe.F6,Xe.F7,Xe.F8,Xe.F9,Xe.F10,Xe.F11,Xe.F12,Xe.F13,Xe.F14,Xe.F15,Xe.F16,Xe.F17,Xe.F18,Xe.F19,Xe.HOME,Xe.INSERT,Xe.MEDIA_NEXT,Xe.MEDIA_PLAY_PAUSE,Xe.MEDIA_PREV,Xe.MEDIA_STOP,Xe.NULL,Xe.NUM_LOCK,Xe.PAGE_DOWN,Xe.PAGE_UP,Xe.PAUSE,Xe.SCROLL_LOCK,Xe.SHIFT,Xe.TAB];function d6(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function OP(t){return f6.includes(t)}function g6(t){return[Xe.CONTROL,Xe.COMMAND_LEFT,Xe.COMMAND_RIGHT,Xe.COMMAND_FIREFOX].includes(t)}function hg(t,e){const r=e.split("|");let n=!1;return J(r,i=>{if(t===Xe[i])return n=!0,!1}),n}function ks(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function oc(t){return t.isImmediatePropagationEnabled===!1}function bc(t){return t.button===2}function Gx(t){return t.button===0}function m6(t){return t instanceof TouchEvent}function p6(t,e){const r={x:t.offsetX,y:t.offsetY};let n=t.target;if(!(e instanceof HTMLElement)||n!==e&&n.contains(e))return r;for(;n!==e;)r.x+=n.offsetLeft,r.y+=n.offsetTop,n=n.offsetParent;return r}var PP={},v6=xO,w6=Ax,C6=Object.keys||function(e){return v6(e,w6)},y6=Os,x6=gO,S6=ul,b6=ca,E6=vv,R6=C6;PP.f=y6&&!x6?Object.defineProperties:function(e,r){b6(e);for(var n=E6(r),i=R6(r),s=i.length,o=0,a;s>o;)S6.f(e,a=i[o++],n[a]);return e};var T6=ca,_6=PP,DT=Ax,A6=Tx,I6=zO,M6=Ex,O6=vO,LT=">",$T="<",vy="prototype",wy="script",kP=O6("IE_PROTO"),zw=function(){},NP=function(t){return $T+wy+LT+t+$T+"/"+wy+LT},BT=function(t){t.write(NP("")),t.close();var e=t.parentWindow.Object;return t=null,e},P6=function(){var t=M6("iframe"),e="java"+wy+":",r;return t.style.display="none",I6.appendChild(t),t.src=String(e),r=t.contentWindow.document,r.open(),r.write(NP("document.F=Object")),r.close(),r.F},Yg,Vm=function(){try{Yg=new ActiveXObject("htmlfile")}catch{}Vm=typeof document<"u"?document.domain&&Yg?BT(Yg):P6():BT(Yg);for(var t=DT.length;t--;)delete Vm[vy][DT[t]];return Vm()};A6[kP]=!0;var k6=Object.create||function(e,r){var n;return e!==null?(zw[vy]=T6(e),n=new zw,zw[vy]=null,n[kP]=e):n=Vm(),r===void 0?n:_6.f(n,r)},N6=cl,F6=k6,H6=ul.f,Cy=N6("unscopables"),yy=Array.prototype;yy[Cy]===void 0&&H6(yy,Cy,{configurable:!0,value:F6(null)});var Yx=function(t){yy[Cy][t]=!0},D6=Yx;D6("flatMap");function Ft(){Ue(console)&&console.warn(...arguments)}function Kx(){Ue(console)&&console.error(...arguments)}function L6(t,e,r){return(e=$6(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $6(t){var e=B6(t,"string");return typeof e=="symbol"?e:e+""}function B6(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const eu=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],V6=Ht`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,Gw=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Yw=new Map([[]]),Kg=new WeakMap;class We{static getSingleton(){return U6()}constructor(){L6(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return J(eu,r=>{e[r]=[],this.initOrderMap(e,r)}),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;if(Array.isArray(r))J(r,s=>this.add(e,s,n));else{Gw.has(e)&&Ft(nP(V6,{hookName:e,removedInVersion:Gw.get(e)})),Yw.has(e)&&Ft(Yw.get(e));const s=this.getBucket(n);if(typeof s[e]>"u"&&(this.register(e),s[e]=[],this.initOrderMap(s,e)),r.skip=!1,s[e].indexOf(r)===-1){let o=!1;r.initialHook&&J(s[e],(a,l)=>{if(a.initialHook)return s[e][l]=r,o=!0,!1}),o||s[e].push(r)}this.setCallbackOrderIndex(s,e,r,i),this.orderBucketByOrderIndex(s,e)}return this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;Array.isArray(r)?J(r,s=>this.once(e,s,n)):(r.runOnce=!0,this.add(e,r,n,i))}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(n);return typeof i[e]<"u"&&i[e].indexOf(r)>=0?(r.skip=!0,!0):!1}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const n=this.getBucket(r);return!!(n[e]!==void 0&&n[e].length)}run(e,r,n,i,s,o,a,l){{const c=this.globalBucket[r],u=c?c.length:0;let h=0;if(u)for(;h<u;){if(!c[h]||c[h].skip){h+=1;continue}const f=my(c[h],e,n,i,s,o,a,l);f!==void 0&&(n=f),c[h]&&c[h].runOnce&&this.remove(r,c[h]),h+=1}}{const c=this.getBucket(e)[r],u=c?c.length:0;let h=0;if(u)for(;h<u;){if(!c[h]||c[h].skip){h+=1;continue}const f=my(c[h],e,n,i,s,o,a,l);f!==void 0&&(n=f),c[h]&&c[h].runOnce&&this.remove(r,c[h],e),h+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;gt(this.getBucket(e),(r,n,i)=>i[n].length=0)}register(e){this.isRegistered(e)||eu.push(e)}deregister(e){this.isRegistered(e)&&eu.splice(eu.indexOf(e),1)}isDeprecated(e){return Yw.has(e)||Gw.has(e)}isRegistered(e){return eu.indexOf(e)>=0}getRegistered(){return eu}setCallbackOrderIndex(e,r,n,i){const s=Number.isInteger(i)?i:0,o=this.getCallbackOrderMap(e,r);o.set(s,[...o.get(s)||[],n])}orderBucketByOrderIndex(e,r){const n=this.getCallbackOrderMap(e,r);n===void 0||n.size===0||n.size===1&&n.has(0)||(e[r]=[...n].sort((i,s)=>i[0]-s[0]).flatMap(i=>{let[,s]=i;return s}))}initOrderMap(e,r){Kg.has(e)||Kg.set(e,[]),Kg.get(e)[r]=new Map}getCallbackOrderMap(e,r){return Kg.get(e)[r]}}const W6=new We;function U6(){return W6}const Kw=new Map;function Ns(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Kw.has(t)||Kw.set(t,new Map);const e=Kw.get(t);function r(a,l){e.set(a,l)}function n(a){return e.get(a)}function i(a){return e.has(a)}function s(){return[...e.keys()]}function o(){return[...e.values()]}return{register:r,getItem:n,hasItem:i,getNames:s,getValues:o}}const xy=new WeakMap,{register:j6,getItem:FP,hasItem:HP,getNames:y1e,getValues:x1e}=Ns("editors");function z6(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},We.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function DP(t,e){let r;if(typeof t=="function")xy.get(t)||mi(null,t),r=xy.get(t);else if(typeof t=="string")r=FP(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function Sy(t){if(typeof t=="function")return t;if(!HP(t))throw Error(`No registered editor found under "${t}" name`);return FP(t).getConstructor()}function mi(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new z6(e);typeof t=="string"&&j6(t,r),xy.set(e,r)}function G6(t,e,r){return(e=Y6(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Y6(t){var e=K6(t,"string");return typeof e=="symbol"?e:e+""}function K6(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ms{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;G6(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(o){n.call(this,X6(o))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:s,options:i,eventManager:this}),e.addEventListener(r,s,i),()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,o;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===r&&o.element===e){if(n&&n!==o.callback||i&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const s={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let o;n.createEvent?(o=n.createEvent("MouseEvents"),o.initMouseEvent(r,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,n.body.parentNode)):o=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${r}`,o)}}function X6(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),ks(this)},t}function q6(t,e){J6(t,e),e.add(t)}function J6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xl(t,e,r){return(e=Z6(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Z6(t){var e=Q6(t,"string");return typeof e=="symbol"?e:e+""}function Q6(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VT(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Xw=new WeakSet;class by{constructor(e,r,n){q6(this,Xw),xl(this,"hot",void 0),xl(this,"tableMeta",void 0),xl(this,"selection",void 0),xl(this,"eventManager",void 0),xl(this,"destroyed",!1),xl(this,"activeEditor",void 0),xl(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new Ms(e),this.hot.addHook("afterDocumentKeyDown",i=>VT(Xw,this,eU).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,s,o)=>VT(Xw,this,tU).call(this,i,s,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,c=>{c&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,s=this.hot.runHooks("modifyGetCellCoords",n,i);let o=n,a=i;if(Array.isArray(s)&&([o,a]=s),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(n,i,!0);if(l){const c=this.hot.getCellEditor(this.cellProperties),u=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=DP(c,this.hot),this.activeEditor.prepare(n,i,u,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let s=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&i.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:s,columnIndexMapper:o}=this.hot,a=s.isHidden(this.hot.toPhysicalRow(n))||o.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||a)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function eU(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||oc(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!OP(r)&&!g6(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function tU(t,e){e.isCell()&&this.openEditor(null,t,!0)}const WT=new WeakMap;by.getInstance=function(t,e,r){let n=WT.get(t);return n||(n=new by(t,e,r),WT.set(t,n)),n};function rU(t,e){LP(t,e),e.add(t)}function Hh(t,e,r){LP(t,e),e.set(t,r)}function LP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ur(t,e){return t.get(qo(t,e))}function Dh(t,e,r){return t.set(qo(t,e),r),r}function qo(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Ju=Object.freeze({CELL:"cell",MIXED:"mixed"});var tn=new WeakMap,Xg=new WeakMap,qg=new WeakMap,Jg=new WeakMap,Zg=new WeakMap,Fa=new WeakSet;class nU{constructor(e){var r=this;rU(this,Fa),Hh(this,tn,void 0),Hh(this,Xg,void 0),Hh(this,qg,1),Hh(this,Jg,null),Hh(this,Zg,new Map);const n=e.getSettings();Dh(tn,this,e),Dh(Xg,this,n.imeFastEdit?Ju.MIXED:Ju.CELL),ur(tn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return qo(Fa,r,sU).call(r,...s)}),ur(tn,this).addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return qo(Fa,r,UT).call(r,...s)}),ur(tn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return qo(Fa,r,UT).call(r,...s)}),ur(tn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return qo(Fa,r,iU).call(r,...s)})}getFocusMode(){return ur(Xg,this)}setFocusMode(e){Object.values(Ju).includes(e)?Dh(Xg,this,e):Ft(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return ur(qg,this)}setRefocusDelay(e){Dh(qg,this,e)}setRefocusElementGetter(e){Dh(Jg,this,e)}getRefocusElement(){if(typeof ur(Jg,this)=="function")return ur(Jg,this).call(this);var e;return(e=ur(tn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,s;const o=(i=ur(tn,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!o)return;let a=ur(tn,this).runHooks("modifyFocusedElement",o.row,o.col,n);a instanceof HTMLElement||(a=n),a&&!((s=ur(tn,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&a.focus({preventScroll:!0})};e?r(e):qo(Fa,this,Xx).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ur(qg,this);const n=this.getRefocusElement();ur(tn,this).getSettings().imeFastEdit&&!((e=ur(tn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&n&&(ur(Zg,this).has(r)||ur(Zg,this).set(r,Wx(()=>{n.select()},r)),ur(Zg,this).get(r)())}}function Xx(t){var e;const r=(e=ur(tn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||!ur(tn,this).selection.isCellVisible(r)){t(null);return}const n=ur(tn,this).getCell(r.row,r.col,!0);n===null?ur(tn,this).addHookOnce("afterScroll",()=>{t(ur(tn,this).getCell(r.row,r.col,!0))}):t(n)}function UT(){qo(Fa,this,Xx).call(this,t=>{const{activeElement:e}=ur(tn,this).rootDocument;e&&vP(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function iU(){qo(Fa,this,Xx).call(this,t=>{this.getFocusMode()===Ju.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function sU(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Ju.MIXED:Ju.CELL)}var oU=yo,aU=Hc,lU=cl,cU=lU("match"),uU=function(t){var e;return oU(t)&&((e=t[cU])!==void 0?!!e:aU(t)==="RegExp")},hU=ca,fU=function(){var t=hU(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},dU=Ps,gU=xo,mU=wv,pU=fU,jT=RegExp.prototype,vU=function(t){var e=t.flags;return e===void 0&&!("flags"in jT)&&!gU(t,"flags")&&mU(jT,t)?dU(pU,t):e},qx=jr,wU=rg,CU=Math.floor,qw=qx("".charAt),yU=qx("".replace),Jw=qx("".slice),xU=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,SU=/\$([$&'`]|\d{1,2})/g,bU=function(t,e,r,n,i,s){var o=r+t.length,a=n.length,l=SU;return i!==void 0&&(i=wU(i),l=xU),yU(s,l,function(c,u){var h;switch(qw(u,0)){case"$":return"$";case"&":return t;case"`":return Jw(e,0,r);case"'":return Jw(e,o);case"<":h=i[Jw(u,1,-1)];break;default:var f=+u;if(f===0)return c;if(f>a){var d=CU(f/10);return d===0?c:d<=a?n[d-1]===void 0?qw(u,1):n[d-1]+qw(u,1):c}h=n[f-1]}return h===void 0?"":h})},EU=pn,RU=Ps,Jx=jr,zT=eg,TU=mn,_U=pv,AU=uU,Lh=bv,IU=xv,MU=vU,OU=bU,PU=cl,kU=PU("replace"),NU=TypeError,Zw=Jx("".indexOf);Jx("".replace);var GT=Jx("".slice),FU=Math.max;EU({target:"String",proto:!0},{replaceAll:function(e,r){var n=zT(this),i,s,o,a,l,c,u,h,f,d,g=0,m="";if(!_U(e)){if(i=AU(e),i&&(s=Lh(zT(MU(e))),!~Zw(s,"g")))throw new NU("`.replaceAll` does not allow non-global regexes");if(o=IU(e,kU),o)return RU(o,e,n,r)}for(a=Lh(n),l=Lh(e),c=TU(r),c||(r=Lh(r)),u=l.length,h=FU(1,u),f=Zw(a,l);f!==-1;)d=c?Lh(r(l,f,a)):OU(l,a,f,[],void 0,r),m+=GT(a,g,f)+d,g=f+u,f=f+h>a.length?-1:Zw(a,l,f+h);return g<a.length&&(m+=GT(a,g)),m}});const $P={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},HU=new RegExp(Object.keys($P).map(t=>`(${t})`).join("|"),"gi");function DU(t){return(t&&t.nodeName||"")==="TABLE"}function YT(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),s=i.length,o=s>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],u=r?1:0,h=e?1:0;for(let f=0;f<s;f+=1){const d=e&&f===0,g=[];for(let p=0;p<o;p+=1){const y=!d&&r&&p===0;let S="";if(d)S=`<th>${t.getColHeader(p-u)}</th>`;else if(y)S=`<th>${t.getRowHeader(f-h)}</th>`;else{const C=i[f][p],{hidden:A,rowspan:I,colspan:O}=t.getCellMeta(f-h,p-u);if(!A){const _=[];if(I&&_.push(`rowspan="${I}"`),O&&_.push(`colspan="${O}"`),_r(C))S=`<td ${_.join(" ")}></td>`;else{const E=C.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");S=`<td ${_.join(" ")}>${E}</td>`}}}g.push(S)}const m=["<tr>",...g,"</tr>"].join("");d?l.splice(1,0,m):c.splice(-1,0,m)}return a.splice(1,0,l.join(""),c.join("")),a.join("")}function KT(t){const e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],s=i.length,o=[];n===0&&r.push("<tbody>");for(let a=0;a<s;a+=1){const l=i[a],c=_r(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,u=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(u.length-1)} </span>`).replace(/\t/gi,"&#9;");o.push(`<td>${c}</td>`)}r.push("<tr>",...o,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function LU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let s=t;if(typeof s=="string"){const C=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,A=>{const I=A.match(/<td\b[^>]*?>/g)[0],O=/<p.*?>/g,_=A.substring(I.length,A.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(O,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${I}${_}</td>`});i.insertAdjacentHTML("afterbegin",`${C}`),s=i.querySelector("table")}if(!s||!DU(s))return;const o=i.querySelector('meta[name$="enerator"]'),a=s.querySelector("tbody th")!==null,l=s.querySelector("tr"),c=l?Array.from(l.cells).reduce((C,A)=>C+A.colSpan,0)-(a?1:0):0,u=s.tFoot&&Array.from(s.tFoot.rows)||[],h=[];let f=!1,d=0,g=0;if(s.tHead){const C=Array.from(s.tHead.rows).filter(A=>{const I=A.querySelector("td")!==null;return I&&h.push(A),!I});d=C.length,f=d>0,d>1?r.nestedHeaders=Array.from(C).reduce((A,I)=>{const O=Array.from(I.cells).reduce((_,E,b)=>{if(a&&b===0)return _;const{colSpan:k,innerHTML:B}=E,N=k>1?{label:B,colspan:k}:B;return _.push(N),_},[]);return A.push(O),A},[]):f&&(r.colHeaders=Array.from(C[0].children).reduce((A,I,O)=>(a&&O===0||A.push(I.innerHTML),A),[]))}h.length&&(r.fixedRowsTop=h.length),u.length&&(r.fixedRowsBottom=u.length);const m=[...h,...Array.from(s.tBodies).reduce((C,A)=>(C.push(...Array.from(A.rows)),C),[]),...u];g=m.length;const p=new Array(g);for(let C=0;C<g;C++)p[C]=new Array(c);const y=[],S=[];for(let C=0;C<g;C++){const A=m[C],I=Array.from(A.cells),O=I.length;for(let _=0;_<O;_++){const E=I[_],{nodeName:b,innerHTML:k,rowSpan:B,colSpan:N}=E,q=p[C].findIndex(ue=>ue===void 0);if(b==="TD"){if(B>1||N>1){for(let ce=C;ce<C+B;ce++)if(ce<g)for(let Re=q;Re<q+N;Re++)p[ce][Re]=null;const we=E.getAttribute("style");we&&we.includes("mso-ignore:colspan")||y.push({col:q,row:C,rowspan:B,colspan:N})}let ue="";o&&/excel/gi.test(o.content)?ue=k.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ue=k.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),p[C][q]=ue.replace(HU,we=>$P[we])}else S.push(k)}}return y.length&&(r.mergeCells=y),S.length&&(r.rowHeaders=S),p.length&&(r.data=p),r}function Wn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function $U(t){return Wn(t,[","])}function Ge(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function XT(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function BP(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function $t(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}const Ey="asc",BU="desc",qT=new Map([[Ey,[-1,1]],[BU,[1,-1]]]),VU=t=>`The priority '${t}' is already declared in a map.`,WU=t=>`The priority '${t}' is not a number.`;function UU(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=er(t)?t:VU,e=er(e)?e:WU;function n(s,o){if(!Wn(s))throw new Error(e(s));if(r.has(s))throw new Error(t(s));r.set(s,o)}function i(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ey;const[o,a]=qT.get(s)||qT.get(Ey);return[...r].sort((l,c)=>l[0]<c[0]?o:a).map(l=>l[1])}return{addItem:n,getItems:i}}const jU=t=>`The id '${t}' is already declared in a map.`;function Av(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=er(t)?t:jU;function r(c,u){if(l(c))throw new Error(t(c));e.set(c,u)}function n(c){return e.delete(c)}function i(){e.clear()}function s(c){const[u]=a().find(h=>{let[f,d]=h;return c===d?f:!1})||[null];return u}function o(c){return e.get(c)}function a(){return[...e]}function l(c){return e.has(c)}return{addItem:r,clear:i,getId:s,getItem:o,getItems:a,hasItem:l,removeItem:n}}const zU=t=>`'${t}' value is already declared in a unique set.`;function GU(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=er(t)?t:zU;function r(s){if(e.has(s))throw new Error(t(s));e.add(s)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const Zx=t=>`There is already registered "${t}" plugin.`,YU=t=>`There is already registered plugin on priority "${t}".`,KU=t=>`The priority "${t}" is not a number.`,VP=UU({errorPriorityExists:YU,errorPriorityNaN:KU}),WP=GU({errorItemExists:Zx}),Ry=Av({errorIdExists:Zx});function UP(){return[...VP.getItems(),...WP.getItems()]}function Qx(t){const e=Is(t);return Ry.getItem(e)}function XU(t){return!!Qx(t)}function _t(t,e,r){[t,e,r]=JU(t,e,r),Qx(t)===void 0&&qU(t,e,r)}function qU(t,e,r){const n=Is(t);if(Ry.hasItem(n))throw new Error(Zx(n));r===void 0?WP.addItem(n):VP.addItem(r,n),Ry.addItem(n,e)}function JU(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:ZU,getItem:QU,hasItem:jP,getNames:S1e,getValues:b1e}=Ns("renderers");function Ty(t){if(typeof t=="function")return t;if(!jP(t))throw Error(`No registered renderer found under "${t}" name`);return QU(t)}function Hi(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),ZU(t,e)}const{register:e5,getItem:t5,hasItem:zP,getNames:E1e,getValues:R1e}=Ns("validators");function r5(t){if(typeof t=="function")return t;if(!zP(t))throw Error(`No registered validator found under "${t}" name`);return t5(t)}function Lu(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),e5(t,e)}var n5=pn,i5=rg,s5=sg,o5=ig,a5=Yx;n5({target:"Array",proto:!0},{at:function(e){var r=i5(this),n=s5(r),i=o5(e),s=i>=0?i:n+i;return s<0||s>=n?void 0:r[s]}});a5("at");var l5=pn,c5=jr,u5=eg,h5=ig,f5=bv,d5=ui,g5=c5("".charAt),m5=d5(function(){return"ð ®·".at(-2)!=="\uD842"});l5({target:"String",proto:!0,forced:m5},{at:function(e){var r=f5(u5(this)),n=r.length,i=h5(e),s=i>=0?i:n+i;return s<0||s>=n?void 0:g5(r,s)}});function $h(t,e,r){return(e=p5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p5(t){var e=v5(t,"string");return typeof e=="symbol"?e:e+""}function v5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class w5{constructor(){$h(this,"count",0),$h(this,"startColumn",null),$h(this,"endColumn",null),$h(this,"startPosition",null),$h(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:s,columnWidth:o}=r,a=i>0?s+1:s;n>=i&&n+o<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:c,columnWidth:u}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=c[this.endColumn]+u-c[this.startColumn-1];if(g<=i&&(this.startColumn-=1),g>=i)break}this.startPosition=(r=c[this.startColumn])!==null&&r!==void 0?r:null;const h=o>0?i+1:i,f=n+i-h,d=this.startColumn===null?0:e.getColumnWidth(this.startColumn);f<-1*s||n>c.at(-1)||-1*n-i>-1*d?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Bh(t,e,r){return(e=C5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function C5(t){var e=y5(t,"string");return typeof e=="symbol"?e:e+""}function y5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x5{constructor(){Bh(this,"count",0),Bh(this,"startRow",null),Bh(this,"endRow",null),Bh(this,"startPosition",null),Bh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:s,rowHeight:o}=r;n>=i&&n+o<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:c}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const f=l[this.endRow]+c-l[this.startRow-1];if(f<=i-s&&(this.startRow-=1),f>=i-s)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null;const u=n+i-s,h=this.startRow===null?0:e.getRowHeight(this.startRow);u<h||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Vh(t,e,r){return(e=S5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function S5(t){var e=b5(t,"string");return typeof e=="symbol"?e:e+""}function b5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GP{constructor(){Vh(this,"count",0),Vh(this,"startColumn",null),Vh(this,"endColumn",null),Vh(this,"startPosition",null),Vh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:s}=r;n<=i&&(this.startColumn=e);const o=i>0?s+1:s;n>=i&&n<=i+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:c,columnWidth:u}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const d=c[this.endColumn]+u-c[this.startColumn-1];if(this.startColumn-=1,d>i)break}this.startPosition=(r=c[this.startColumn])!==null&&r!==void 0?r:null;const h=o>0?i+1:i;n+i-h<-1*s||n>c.at(-1)+u||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Wh(t,e,r){return(e=E5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function E5(t){var e=R5(t,"string");return typeof e=="symbol"?e:e+""}function R5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YP{constructor(){Wh(this,"count",0),Wh(this,"startRow",null),Wh(this,"endRow",null),Wh(this,"startPosition",null),Wh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:s}=r;n<=i&&(this.startRow=e),n>=i&&n<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:c}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+c-l[this.startRow-1];if(this.startRow-=1,h>=i-s)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null,n+i-s<0||n>l.at(-1)+c?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Uh(t,e,r){return(e=T5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T5(t){var e=_5(t,"string");return typeof e=="symbol"?e:e+""}function _5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class A5{constructor(){Uh(this,"count",0),Uh(this,"startColumn",0),Uh(this,"endColumn",0),Uh(this,"startPosition",0),Uh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function jh(t,e,r){return(e=I5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I5(t){var e=M5(t,"string");return typeof e=="symbol"?e:e+""}function M5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O5{constructor(){jh(this,"count",0),jh(this,"startRow",0),jh(this,"endRow",0),jh(this,"startPosition",0),jh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}class P5 extends GP{finalize(e){var r;super.finalize(e);const{overrideFn:n,totalColumns:i,startPositions:s}=e;this.startColumn!==null&&typeof n=="function"&&n(this),this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=s[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}class k5 extends YP{finalize(e){var r;super.finalize(e);const{overrideFn:n,totalRows:i,startPositions:s}=e;this.startRow!==null&&typeof n=="function"&&n(this),this.startRow<0&&(this.startRow=0),this.startPosition=(r=s[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function JT(t,e,r){return(e=N5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function N5(t){var e=F5(t,"string");return typeof e=="symbol"?e:e+""}function F5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KP{constructor(e){JT(this,"calculationTypes",[]),JT(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function ns(t,e,r){return(e=H5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function H5(t){var e=D5(t,"string");return typeof e=="symbol"?e:e+""}function D5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Iv=50;class L5 extends KP{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:s,columnWidthFn:o,overrideFn:a,inlineStartOffset:l}=e;super(r),ns(this,"viewportWidth",0),ns(this,"scrollOffset",0),ns(this,"zeroBasedScrollOffset",0),ns(this,"totalColumns",0),ns(this,"columnWidthFn",null),ns(this,"columnWidth",0),ns(this,"overrideFn",null),ns(this,"inlineStartOffset",0),ns(this,"totalCalculatedWidth",0),ns(this,"startPositions",[]),ns(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=s,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?Iv:r}}function Ii(t,e,r){return(e=$5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $5(t){var e=B5(t,"string");return typeof e=="symbol"?e:e+""}function B5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const XP=23;class V5 extends KP{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:s,rowHeightFn:o,overrideFn:a,horizontalScrollbarHeight:l}=e;super(r),Ii(this,"viewportHeight",0),Ii(this,"scrollOffset",0),Ii(this,"zeroBasedScrollOffset",0),Ii(this,"totalRows",0),Ii(this,"rowHeightFn",null),Ii(this,"rowHeight",0),Ii(this,"overrideFn",null),Ii(this,"horizontalScrollbarHeight",0),Ii(this,"innerViewportHeight",0),Ii(this,"totalCalculatedHeight",0),Ii(this,"startPositions",[]),Ii(this,"needReverse",!0),this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=s,this.rowHeightFn=o,this.overrideFn=a,this.horizontalScrollbarHeight=l??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?XP:r}}function W5(t,e,r){U5(t,e),e.set(t,r)}function U5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZT(t,e,r){return(e=j5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function j5(t){var e=z5(t,"string");return typeof e=="symbol"?e:e+""}function z5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tu(t,e){return t.get(qP(t,e))}function QT(t,e,r){return t.set(qP(t,e),r),r}function qP(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Oo=new WeakMap;class Ec{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;ZT(this,"row",null),ZT(this,"col",null),W5(this,Oo,!1),QT(Oo,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return tu(Oo,this)}isSouthEastOf(e){return this.row>=e.row&&(tu(Oo,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(tu(Oo,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(tu(Oo,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(tu(Oo,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Ec&&QT(Oo,this,e.isRtl()),this}clone(){return new Ec(this.row,this.col,tu(Oo,this))}toObject(){return{row:this.row,col:this.col}}}function G5(t,e,r){Y5(t,e),e.set(t,r)}function Y5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qw(t,e,r){return(e=K5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function K5(t){var e=X5(t,"string");return typeof e=="symbol"?e:e+""}function X5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mi(t,e){return t.get(JP(t,e))}function q5(t,e,r){return t.set(JP(t,e),r),r}function JP(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Xn=new WeakMap;class fg{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Qw(this,"highlight",null),Qw(this,"from",null),Qw(this,"to",null),G5(this,Xn,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),q5(Xn,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return i.row<=r&&s.row>=r&&i.col<=n&&s.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),s=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(n.row,o.row),c=Math.min(n.col,o.col),u=Math.max(i.row,a.row),h=Math.max(i.col,a.col),f=this._createCellCoords(l,c),d=this._createCellCoords(u,h);return this.from=f,this.to=d,this.setDirection(s),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Mi(Xn,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Mi(Xn,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Mi(Xn,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Mi(Xn,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Mi(Xn,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Mi(Xn,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Mi(Xn,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Mi(Xn,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Ec))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(Mi(Xn,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(Mi(Xn,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)!(this.from.row===i&&this.from.col===s)&&!(this.to.row===i&&this.to.col===s)&&n.push(this._createCellCoords(i,s));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)e.row===i&&e.col===s?n.push(e):r.row===i&&r.col===s?n.push(r):n.push(this._createCellCoords(i,s));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let s=r.col;s<=n.col;s++)if(e(i,s)===!1)return}clone(){return new fg(this.highlight,this.from,this.to,Mi(Xn,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new Ec(e,r,Mi(Xn,this))}}function Hs(t,e,r){J5(t,e),e.set(t,r)}function J5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ye(t,e){return t.get(ZP(t,e))}function Ca(t,e,r){return t.set(ZP(t,e),r),r}function ZP(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Oi=new WeakMap,eC=new WeakMap,Zr=new WeakMap,ru=new WeakMap,Qg=new WeakMap,is=new WeakMap,tC=new WeakMap,zh=new WeakMap,Sl=new WeakMap,Ds=new WeakMap;let QP=class{constructor(e,r,n,i,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Hs(this,Oi,void 0),Hs(this,eC,void 0),Hs(this,Zr,void 0),Hs(this,ru,void 0),Hs(this,Qg,void 0),Hs(this,is,void 0),Hs(this,tC,void 0),Hs(this,zh,void 0),Hs(this,Sl,[null,null]),Hs(this,Ds,[null,null]),Ca(Oi,this,n),Ca(eC,this,r),Ca(Zr,this,s),Ca(ru,this,o),Ca(Qg,this,a),Ca(is,this,i),Ca(tC,this,e),this.registerEvents()}registerEvents(){Ye(is,this).addEventListener(Ye(Zr,this).holder,"contextmenu",n=>this.onContextMenu(n)),Ye(is,this).addEventListener(Ye(Zr,this).TABLE,"mouseover",n=>this.onMouseOver(n)),Ye(is,this).addEventListener(Ye(Zr,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{Ye(is,this).addEventListener(Ye(Zr,this).holder,"touchstart",n=>this.onTouchStart(n)),Ye(is,this).addEventListener(Ye(Zr,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),Ye(is,this).addEventListener(Ye(Zr,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Ye(Oi,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Ye(Oi,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{Ye(is,this).addEventListener(Ye(Zr,this).holder,"mouseup",n=>this.onMouseUp(n)),Ye(is,this).addEventListener(Ye(Zr,this).holder,"mousedown",n=>this.onMouseDown(n))};za()?e():(TP()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(Ye(zh,this)&&n){const[i,s]=[n.row,Ye(zh,this).from.row],[o,a]=[n.col,Ye(zh,this).from.col];return i===s&&o===a}return!1}parentCell(e){const r={},n=Ye(Zr,this).TABLE,i=zg(e,["TD","TH"],n);return i?(r.coords=Ye(Zr,this).getCoords(i),r.TD=i):Qe(e,"wtBorder")&&Qe(e,"current")?(r.coords=Ye(ru,this).getFocusSelection().cellRange.highlight,r.TD=Ye(Zr,this).getCell(r.coords)):Qe(e,"wtBorder")&&Qe(e,"area")&&Ye(ru,this).getAreaSelection().cellRange&&(r.coords=Ye(ru,this).getAreaSelection().cellRange.to,r.TD=Ye(Zr,this).getCell(r.coords)),r}onMouseDown(e){const r=Ye(eC,this).rootDocument.activeElement,n=xP(I8,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const s=this.parentCell(i);Qe(i,"corner")?Ye(Oi,this).getSetting("onCellCornerMouseDown",e,i):s.TD&&Ye(Oi,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(Ye(Ds,this)[0]=s.TD,clearTimeout(Ye(Sl,this)[0]),Ye(Sl,this)[0]=setTimeout(()=>{Ye(Ds,this)[0]=null},1e3))}onContextMenu(e){if(Ye(Oi,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!Ye(Oi,this).has("onCellMouseOver"))return;const r=Ye(Zr,this).TABLE,n=zg(e.target,["TD","TH"],r),i=Ye(Qg,this)||this;n&&n!==i.lastMouseOver&&pc(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,Ye(Zr,this).getCoords(n),n))}onMouseOut(e){if(!Ye(Oi,this).has("onCellMouseOut"))return;const r=Ye(Zr,this).TABLE,n=zg(e.target,["TD","TH"],r),i=zg(e.relatedTarget,["TD","TH"],r),s=Ye(Qg,this)||this;n&&n!==i&&pc(n,r)&&(this.callListener("onCellMouseOut",e,Ye(Zr,this).getCoords(n),n),i===null&&(s.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&Ye(Oi,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===Ye(Ds,this)[0]&&r.TD===Ye(Ds,this)[1]?(Qe(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),Ye(Ds,this)[0]=null,Ye(Ds,this)[1]=null):r.TD===Ye(Ds,this)[0]&&(Ye(Ds,this)[1]=r.TD,clearTimeout(Ye(Sl,this)[1]),Ye(Sl,this)[1]=setTimeout(()=>{Ye(Ds,this)[1]=null},500)))}onTouchStart(e){Ca(zh,this,Ye(ru,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,s=Ue(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&s&&Ye(Oi,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];IP()&&(c6()||u6())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const s=Ye(Oi,this).getSettingPure(e);s&&s(r,n,i,Ye(tC,this).call(this))}destroy(){clearTimeout(Ye(Sl,this)[0]),clearTimeout(Ye(Sl,this)[1]),Ye(is,this).destroy()}};function rC(t,e,r){return(e=Z5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Z5(t){var e=Q5(t,"string");return typeof e=="symbol"?e:e+""}function Q5(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ej{constructor(e,r,n){rC(this,"offset",void 0),rC(this,"total",void 0),rC(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function nC(t,e,r){return(e=tj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tj(t){var e=rj(t,"string");return typeof e=="symbol"?e:e+""}function rj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nj{constructor(e,r,n){nC(this,"offset",void 0),nC(this,"total",void 0),nC(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const ij=0,dp=1,gp=2;function e0(t,e,r){return(e=sj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sj(t){var e=oj(t,"string");return typeof e=="symbol"?e:e+""}function oj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class e_{constructor(){e0(this,"currentSize",0),e0(this,"nextSize",0),e0(this,"currentOffset",0),e0(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function iC(t,e,r){return(e=aj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aj(t){var e=lj(t,"string");return typeof e=="symbol"?e:e+""}function lj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cj{constructor(){iC(this,"size",new e_),iC(this,"workingSpace",ij),iC(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof e_}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=dp,e.workingSpace=gp,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=gp,e.workingSpace=dp,this.sharedSize=e.getViewSize()}}function nu(t,e,r){return(e=uj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uj(t){var e=hj(t,"string");return typeof e=="symbol"?e:e+""}function hj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ek{constructor(e,r,n){nu(this,"rootNode",void 0),nu(this,"nodesPool",void 0),nu(this,"sizeSet",new cj),nu(this,"childNodeType",void 0),nu(this,"visualIndex",0),nu(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=r,this.childNodeType=n.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:r}=this;let n=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)n+=1;else if(r.isPlaceOn(dp))break;i=i.nextElementSibling}}else n=e.childElementCount;return n}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:r}=this,n=this.isSharedViewSet(),{nextSize:i}=r.getViewSize();let s=this.getRenderedChildCount();for(;s<i;){const a=this.nodesPool();!n||n&&r.isPlaceOn(gp)?e.appendChild(a):e.insertBefore(a,e.firstChild),s+=1}const o=n&&r.isPlaceOn(dp);for(;s>i;)e.removeChild(o?e.firstChild:e.lastChild),s-=1}render(){const{rootNode:e,sizeSet:r}=this;let n=this.visualIndex;this.isSharedViewSet()&&r.isPlaceOn(gp)&&(n+=r.sharedSize.nextSize);let i=e.childNodes[n];if(i.tagName!==this.childNodeType){const s=this.nodesPool();e.replaceChild(s,i),i=s}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class tk extends ek{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function fj(t,e,r){return(e=dj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dj(t){var e=gj(t,"string");return typeof e=="symbol"?e:e+""}function gj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mj{constructor(e){fj(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function Gh(t,e,r){return(e=pj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pj(t){var e=vj(t,"string");return typeof e=="symbol"?e:e+""}function vj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dg{constructor(e,r){Gh(this,"nodesPool",null),Gh(this,"nodeType",void 0),Gh(this,"rootNode",void 0),Gh(this,"table",null),Gh(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new mj(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function t_(t,e,r){return(e=wj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wj(t){var e=Cj(t,"string");return typeof e=="symbol"?e:e+""}function Cj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yj extends dg{constructor(){super("TH"),t_(this,"orderViews",new WeakMap),t_(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new tk(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:s}=this.table;for(let o=0;o<e;o++){const a=this.table.renderedRowToSource(o),l=i.getRenderedNode(o);this.sourceRowIndex=a;const c=this.obtainOrderView(l),u=s.obtainOrderView(l);c.appendView(u).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<n;h++){c.render();const f=c.getCurrentNode();f.className="",f.removeAttribute("style"),yh(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ze(f,[l8(),v8(),Dx(h+1),Ch(-1)]),r[h](a,f,h)}c.end()}}}class xj extends dg{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,s=i+r;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<s;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)n.removeChild(n.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&wo(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Ze(this.rootNode,[iP()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:s}=this.table,o=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&Ze(o,[gy(),lP(r+1)]);for(let a=-1*s;a<i;a+=1){const l=this.table.renderedColumnToSource(a),c=o.childNodes[a+s];c.className="",c.removeAttribute("style"),yh(c,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ze(c,[Dx(a+1+this.table.rowHeadersCount),Ch(-1),c8(),...a>=0?[p8()]:[gy()]]),n[r](l,c,r)}}}}let r_=!1;class Sj extends dg{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!r_&&e>1e3&&(r_=!0,Ft(Ht`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[i].style.width=`${o}px`}for(let i=0;i<e;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getStretchedColumnWidth(s);this.rootNode.childNodes[i+r].style.width=`${o}px`}const n=this.rootNode.firstChild;n&&_e(n,"rowHeader")}}function bj(t,e,r){return(e=Ej(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ej(t){var e=Rj(t,"string");return typeof e=="symbol"?e:e+""}function Rj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const t0={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let n_=!1;class Tj extends dg{constructor(e){super("TR",e),bj(this,"orderView",void 0),this.orderView=new ek(e,r=>this.nodesPool.obtain(r),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!n_&&e>1e3&&(n_=!0,Ft(Ht`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Ze(this.rootNode,[iP()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const s=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;Ze(s,[gy(),lP(o+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}it(s,[t0.rowEven,t0.rowOdd]),(o+1)%2===0?_e(s,t0.rowEven):_e(s,t0.rowOdd)}this.orderView.end()}}function i_(t,e,r){return(e=_j(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _j(t){var e=Aj(t,"string");return typeof e=="symbol"?e:e+""}function Aj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ij extends dg{constructor(){super("TD"),i_(this,"orderViews",new WeakMap),i_(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new tk(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),c=n.getRenderedNode(a);this.sourceRowIndex=l;const u=this.obtainOrderView(c),h=i.obtainOrderView(c);u.prependView(h).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let f=0;f<r;f++){u.render();const d=u.getCurrentNode(),g=this.table.renderedColumnToSource(f);if(Qe(d,"hide")||(d.className=""),d.removeAttribute("style"),d.removeAttribute("dir"),yh(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,g,d),this.table.isAriaEnabled()){var s,o;Ze(d,[...d.hasAttribute("role")?[]:[a8()],Ch(-1),Dx(g+((s=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}u.end()}}}function Gr(t,e,r){return(e=Mj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mj(t){var e=Oj(t,"string");return typeof e=="symbol"?e:e+""}function Oj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pj{constructor(e){let{cellRenderer:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Gr(this,"rootNode",void 0),Gr(this,"rootDocument",void 0),Gr(this,"rowHeaders",null),Gr(this,"columnHeaders",null),Gr(this,"colGroup",null),Gr(this,"rows",null),Gr(this,"cells",null),Gr(this,"rowFilter",null),Gr(this,"columnFilter",null),Gr(this,"rowUtils",null),Gr(this,"columnUtils",null),Gr(this,"rowsToRender",0),Gr(this,"columnsToRender",0),Gr(this,"rowHeaderFunctions",[]),Gr(this,"rowHeadersCount",0),Gr(this,"columnHeaderFunctions",[]),Gr(this,"columnHeadersCount",0),Gr(this,"cellRenderer",void 0),Gr(this,"activeOverlayName",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n);if(i.firstChild){const s=this.renderedRowToSource(n),o=this.rowUtils.getHeightByOverlayName(s,this.activeOverlayName);o?i.firstChild.style.height=`${o-1}px`:i.firstChild.style.height=""}}}}class kj{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:s,columnUtils:o,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new Pj(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new yj,columnHeaders:new xj(r),colGroup:new Sj(n),rows:new Tj(i),cells:new Ij}),this.renderer.setAxisUtils(s,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Yh(t,e,r){Nj(t,e),e.set(t,r)}function Nj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function r0(t,e,r){return(e=Fj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fj(t){var e=Hj(t,"string");return typeof e=="symbol"?e:e+""}function Hj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wn(t,e){return t.get(rk(t,e))}function Kh(t,e,r){return t.set(rk(t,e),r),r}function rk(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var n0=new WeakMap,iu=new WeakMap,Xh=new WeakMap,i0=new WeakMap,bl=new WeakMap;class Dj{constructor(e){let{totalColumns:r,stretchMode:n,stretchingColumnWidthFn:i,columnWidthFn:s}=e;r0(this,"stretchAllRatio",0),r0(this,"stretchLastWidth",0),r0(this,"stretchAllColumnsWidth",[]),Yh(this,n0,0),r0(this,"needVerifyLastColumnWidth",!0),Yh(this,iu,()=>0),Yh(this,Xh,o=>o),Yh(this,i0,o=>o),Yh(this,bl,()=>"none"),Kh(iu,this,r),Kh(bl,this,n),Kh(Xh,this,i??wn(Xh,this)),Kh(i0,this,s??wn(i0,this))}refreshStretching(e){if(wn(bl,this).call(this)==="none")return;this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,Kh(n0,this,e);let r=0;for(let i=0;i<wn(iu,this).call(this);i++){const s=this._getColumnWidth(i),o=wn(Xh,this).call(this,void 0,i);typeof o=="number"?e-=o:r+=s}const n=e-r;if(wn(bl,this).call(this)==="all"&&n>0)this.stretchAllRatio=e/r,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(wn(bl,this).call(this)==="last"&&e!==1/0){const i=this._getColumnWidth(wn(iu,this).call(this)-1),s=n+i;this.stretchLastWidth=s>=0?s:i}}getStretchedColumnWidth(e,r){let n=null;return wn(bl,this).call(this)==="all"&&this.stretchAllRatio!==0?n=this._getStretchedAllColumnWidth(e,r):wn(bl,this).call(this)==="last"&&this.stretchLastWidth!==0&&(n=this._getStretchedLastColumnWidth(e)),n}_getStretchedAllColumnWidth(e,r){let n=0;if(!this.stretchAllColumnsWidth[e]){const i=Math.round(r*this.stretchAllRatio),s=wn(Xh,this).call(this,i,e);s===void 0?this.stretchAllColumnsWidth[e]=i:this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===wn(iu,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let i=0;i<this.stretchAllColumnsWidth.length;i++)n+=this.stretchAllColumnsWidth[i];n!==wn(n0,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=wn(n0,this)-n)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===wn(iu,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let r=wn(i0,this).call(this,e);return isNaN(r)&&(r=Iv),r}}function s0(t,e,r){return(e=Lj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lj(t){var e=$j(t,"string");return typeof e=="symbol"?e:e+""}function $j(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bj{constructor(e,r){s0(this,"dataAccessObject",void 0),s0(this,"wtSettings",void 0),s0(this,"headerWidths",new Map),s0(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=r,this.stretching=new Dj({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(n,i)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",n,i),columnWidthFn:n=>this.dataAccessObject.wtTable.getColumnWidth(n)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let r=this.getWidth(e);const n=this.stretching.getStretchedColumnWidth(e,r);return n&&(r=n),r}getHeaderHeight(e){let r=this.wtSettings.getSetting("defaultRowHeight");const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:r,cloneSource:n}=this.dataAccessObject,i=n?n.wtTable.holder:e.holder,s=i.offsetHeight<i.scrollHeight?ln():0;this.stretching.refreshStretching(r.getViewportWidth()-s)}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let s=0;s<n;s++){let o=Array.isArray(r)?r[s]:r;o=o??i,this.headerWidths.set(s,o)}}}}function s_(t,e,r){return(e=Vj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vj(t){var e=Wj(t,"string");return typeof e=="symbol"?e:e+""}function Wj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uj{constructor(e,r){s_(this,"dataAccessObject",void 0),s_(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}function Ls(t,e,r){return(e=jj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jj(t){var e=zj(t,"string");return typeof e=="symbol"?e:e+""}function zj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sh{constructor(e,r,n,i,s){Ls(this,"wtSettings",null),Ls(this,"domBindings",void 0),Ls(this,"TBODY",null),Ls(this,"THEAD",null),Ls(this,"COLGROUP",null),Ls(this,"hasTableHeight",!0),Ls(this,"hasTableWidth",!0),Ls(this,"isTableVisible",!1),Ls(this,"tableOffset",0),Ls(this,"holderOffset",0),this.domBindings=n,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,fP(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new Uj(this.dataAccessObject,this.wtSettings),this.columnUtils=new Bj(this.dataAccessObject,this.wtSettings),this.tableRenderer=new kj({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Qe(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Ze(n,[go()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Qe(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ze(n,[go()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Qe(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Ze(n.parentNode,[go()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ze(n,[go()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,s=r.getSetting("totalRows"),o=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,c=r.getSetting("columnHeaders"),u=c.length;let h=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=sn(this.holder),h=i.createCalculators(h),l&&!r.getSetting("fixedColumnsStart"))){const d=n.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=d!==0,g!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=sn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const d=s>0?this.getFirstRenderedRow():0,g=o>0?this.getFirstRenderedColumn():0;this.rowFilter=new nj(d,s,u),this.columnFilter=new ej(g,o,l);let m=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const p={};this.wtSettings.getSetting("beforeDraw",!0,p),m=p.skipRender!==!0}if(m){this.tableRenderer.setHeaderContentRenderers(a,c),(this.is(uo)||this.is(Qa))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let p;if(this.isMaster&&(p=this.dataAccessObject.workspaceWidth,i.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(uo))&&this.markOversizedRows(),this.isMaster){this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM();const y=rr(this.hider),S=rr(this.TABLE);y!==0&&S!==y&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),p!==i.getWorkspaceWidth()&&(i.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(uo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let f=!1;return this.isMaster&&(f=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(f=n.bottomOverlay.resetFixedPosition()||f),f=n.inlineStartOverlay.resetFixedPosition()||f,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),f?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let s,o,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,s=this.getColumnHeaderHeight(n),o=this.getColumnHeader(r,n),o&&(a=zu(o),(!s&&i<a||s<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let s=0,o=i.length;s<o;s++)if(n[s]){if(!r[s]||r[s].childNodes.length===0)return;r[s].childNodes[0].style.height=`${n[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(uo))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const s=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[s]&&(r.oversizedRows[s]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n);if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const s=this.getRow(r);if(!s&&r>=0)throw new Error("TR was expected to be rendered but is not");const o=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!o&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var s;r=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const s=i.childNodes[n];s&&r.push(s)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),s=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[s];return a==null?void 0:a.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=s==null?void 0:s.childNodes[i];o&&r.push(o)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=xc(r,["TD","TH"])),r===null)return null;const n=r.parentNode,i=n.parentNode;let s=P8(n),o=r.cellIndex;return yl(_c,r,this.wtRootElement)||yl(Rc,r,this.wtRootElement)?i.nodeName==="THEAD"&&(s-=i.childNodes.length):yl(Qa,r,this.wtRootElement)||yl(uo,r,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-i.childNodes.length+s:i===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):s=this.rowFilter.renderedToSource(s),yl(_c,r,this.wtRootElement)||yl(Tc,r,this.wtRootElement)||yl(Qa,r,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o),this.wot.createCellCoords(s,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=e*this.wtSettings.getSetting("defaultRowHeight"),n=zu(this.TBODY)-1;let i,s,o,a,l;if(!(r===n&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,o=this.rowFilter.renderedToSource(e),i=this.getRowHeight(o),a=this.getTrForRow(o),l=a.querySelector("th"),l?s=zu(l):s=zu(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<s||i<s)&&(s+=1,this.dataAccessObject.wtViewport.oversizedRows[o]=s)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return rr(this.TABLE)}getHeight(){return Fr(this.TABLE)}getTotalWidth(){const e=rr(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Fr(this.hider);return e!==0?e:this.getHeight()}isVisible(){return ah(this.TABLE)}_modifyRowHeaderWidth(e){let r=er(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const Gj="stickyRowsBottom",eS={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),r=t-e;return t===0||e===0?-1:r<0?0:r},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};ua(eS,"MIXIN_NAME",Gj,{writable:!1,enumerable:!1});const Yj="stickyColumnsStart",Mv={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ua(Mv,"MIXIN_NAME",Yj,{writable:!1,enumerable:!1});class tS extends Sh{constructor(e,r,n,i){super(e,r,n,i,Qa)}}jt(tS,eS);jt(tS,Mv);const Rc="top",uo="bottom",Tc="inline_start",_c="top_inline_start_corner",Qa="bottom_inline_start_corner",nk=[Rc,uo,Tc,_c,Qa],Kj=new Map([[Rc,`ht_clone_${Rc}`],[uo,`ht_clone_${uo}`],[Tc,`ht_clone_${Tc} ht_clone_left`],[_c,`ht_clone_${_c} ht_clone_top_left_corner`],[Qa,`ht_clone_${Qa} ht_clone_bottom_left_corner`]]);function Xj(t,e){qj(t,e),e.add(t)}function qj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jj(t,e,r){return(e=Zj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zj(t){var e=Qj(t,"string");return typeof e=="symbol"?e:e+""}function Qj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function o0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var qh=new WeakSet;class e9{constructor(e){Xj(this,qh),Jj(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n,i,s){const o=this.scrollViewportHorizontally(e.col,n,s),a=this.scrollViewportVertically(e.row,r,i);return o||a}scrollViewportHorizontally(e,r,n){const{drawn:i,totalColumns:s}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>s)return!1;const o=r===void 0&&n===void 0,{fixedColumnsStart:a,inlineStartOverlay:l}=this.dataAccessObject;if(o&&e<a||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),!Number.isInteger(e)||e<0||e>s))return!1;const c=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn();let h=!1;return(o&&(e<c||e>u)||!o)&&(h=l.scrollTo(e,o?e>=this.getLastPartiallyVisibleColumn():r)),h}scrollViewportVertically(e,r,n){const{drawn:i,totalRows:s}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>s)return!1;const o=r===void 0&&n===void 0,{fixedRowsBottom:a,fixedRowsTop:l,topOverlay:c}=this.dataAccessObject;if(o&&(e<l||e>s-a-1)||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),!Number.isInteger(e)||e<0||e>s))return!1;const u=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let f=!1;return(o&&(e<u||e>h)||!o)&&(f=c.scrollTo(e,o?e>=this.getLastPartiallyVisibleRow():n)),f}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return o0(qh,this,a_).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return o0(qh,this,a_).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return o0(qh,this,o_).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return o0(qh,this,o_).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function o_(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:s,rootWindow:o}=this.dataAccessObject;if(r.mainTableScrollableElement===o){const a=e.getSetting("rtlMode");let l=null;if(a){const u=n.TABLE.getBoundingClientRect(),f=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(u.right-f)}else l=sn(n.wtRootElement).left;const c=Math.abs(gP(o,o));if(l>c){const u=mP(o);let h=i.getRowHeaderWidth();for(let f=1;f<=s;f++)if(h+=r.sumCellSizes(f-1,f),l+h-c>=u){t=f-2;break}}}return t}function a_(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const o=sn(r.wtRootElement),a=Bx(s,s);if(o.top>a){const l=zu(s);let c=n.getColumnHeaderHeight();for(let u=1;u<=i;u++)if(c+=e.sumCellSizes(u-1,u),o.top+c-a>=l){t=u-2;break}}}return t}function ss(t,e,r){return(e=t9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function t9(t){var e=r9(t,"string");return typeof e=="symbol"?e:e+""}function r9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rS{get eventManager(){return new Ms(this)}constructor(e,r){ss(this,"wtTable",void 0),ss(this,"wtScroll",void 0),ss(this,"wtViewport",void 0),ss(this,"wtOverlays",void 0),ss(this,"selectionManager",void 0),ss(this,"wtEvent",void 0),ss(this,"guid",`wt_${tP()}`),ss(this,"drawInterrupted",!1),ss(this,"drawn",!1),ss(this,"domBindings",void 0),ss(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new e9(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){Sc(n,e[r])}])}}createCellCoords(e,r){return new Ec(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new fg(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=n-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n,i,s){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,r,n,i,s)}scrollViewportHorizontally(e,r,n){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,r,n)}scrollViewportVertically(e,r,n){return e<0?!1:this.wtScroll.scrollViewportVertically(e,r,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function l_(t,e,r){return(e=n9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n9(t){var e=i9(t,"string");return typeof e=="symbol"?e:e+""}function i9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class s9 extends rS{constructor(e,r,n){super(e,r),l_(this,"cloneSource",void 0),l_(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new QP(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function o9(t,e,r){return(e=a9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a9(t){var e=l9(t,"string");return typeof e=="symbol"?e:e+""}function l9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gg{constructor(e,r,n,i,s){o9(this,"wtSettings",null),ua(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=r,this.wtSettings=i;const{TABLE:o,hider:a,spreader:l,holder:c,wtRootElement:u}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=l,this.holder=c,this.wtRootElement=u,this.trimmingContainer=lh(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=lh(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=hp(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){Ft(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,s=n<this.wtSettings.getSetting("fixedColumnsStart"),o=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,c={start:this.getRelativeStartPosition(l),top:l.offsetTop},u={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(o,s,u,c):h=this.getRelativeCellPositionWithinHolder(o,a,s,u,c),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(!r)o=i.start;else{let l=s.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(s.left+s.width+ln())),o=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:a=i.top,{start:n.start+o,top:n.top+a}}getRelativeCellPositionWithinHolder(e,r,n,i,s){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(n||(a=o.horizontal-s.start),r){const c=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+c.top}else e||(l=o.vertical-s.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(nk.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=n.createElement("div"),o=n.createElement("table"),a=e.wtRootElement.parentNode;s.className=`${Kj.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,r.getSetting("ariaTags")&&Ze(s,[go()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(o),a.appendChild(s);const c=this.wtSettings.getSetting("preventOverflow");return c===!0||c==="horizontal"&&this.type===Rc||c==="vertical"&&this.type===Tc?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=hp(e.TABLE),new s9(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.needFullRender&&this.clone.draw(e)}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,s=e.parentNode.style;[n,i,s].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class c9 extends gg{constructor(e,r,n,i,s,o){super(e,r,Qa,n,i),this.bottomOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new tS(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${s}px`,r.style.bottom=`${o}px`}else Tv(r),this.repositionOverlay();let n=Fr(this.clone.wtTable.TABLE);const i=rr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=ln(n)),i.style.bottom=`${s}px`}}const u9="calculatedColumns",Ov={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ua(Ov,"MIXIN_NAME",u9,{writable:!1,enumerable:!1});class nS extends Sh{constructor(e,r,n,i){super(e,r,n,i,uo)}}jt(nS,eS);jt(nS,Ov);function h9(t,e,r){return(e=f9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f9(t){var e=d9(t,"string");return typeof e=="symbol"?e:e+""}function d9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g9 extends gg{constructor(e,r,n,i){super(e,r,uo,n,i),h9(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new nS(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=ln(n)),i.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;return this.mainTableScrollableElement===r?(r.scrollTo($x(r),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,wtSettings:i}=this.wot,s=i.getSetting("defaultRowHeight");let o=e,a=0;for(;o<r;){const l=n.getRowHeight(o);a+=l===void 0?s:l,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=ln(n),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let u=r.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=s),u=Math.min(u,e.wtRootElement.scrollWidth),a.width=`${u}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let c=Fr(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(c=0),a.height=`${c}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;r&&s.offsetHeight!==s.clientHeight&&(o=ln(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=o,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Bx(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let s=!1;if((n||r===0)&&i.length>0){const o=this.wot.wtTable.holder.parentNode,a=Qe(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(_e(o,"innerBorderBottom"),s=!a):(it(o,"innerBorderBottom"),s=a)}return s}}const m9="calculatedRows",iS={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ua(iS,"MIXIN_NAME",m9,{writable:!1,enumerable:!1});class sS extends Sh{constructor(e,r,n,i){super(e,r,n,i,Tc)}}jt(sS,iS);jt(sS,Mv);const p9="localHooks",vn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,r,n,i,s,o){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)my(this._localHooks[t][l],this,e,r,n,i,s,o)}},clearLocalHooks(){return this._localHooks={},this}};ua(vn,"MIXIN_NAME",p9,{writable:!1,enumerable:!1});let ik=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};jt(ik,vn);const sk="active-header",oS="header",aS="area",lS="focus",v9="fill",w9="row",C9="column",y9="custom-selection",cS=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var x9=Yx;x9("flat");function S9(t,e){ok(t,e),e.add(t)}function c_(t,e,r){ok(t,e),e.set(t,r)}function ok(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Or(t,e){return t.get(Kf(t,e))}function u_(t,e,r){return t.set(Kf(t,e),r),r}function Kf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var os=new WeakMap,ei=new WeakMap,a0=new WeakSet;class b9{constructor(){S9(this,a0),c_(this,os,void 0),c_(this,ei,void 0)}setActiveOverlay(e){return u_(ei,this,e),this}setActiveSelection(e){return u_(os,this,e),this}scan(){const e=Or(os,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,s]=Or(os,this).getCorners(),{wtTable:o}=Or(ei,this),a=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount();let c=0;for(let u=-o.getRowHeadersCount();u<a;u++){const h=o.columnFilter.renderedToSource(u);if(!(h<n||h>s)){for(let f=-l;f<0;f++){if(f<r||f>i)continue;const d=f+l;let g=o.getColumnHeader(h,d);const m=Or(ei,this).getSetting("onBeforeHighlightingColumnHeader",h,d,{selectionType:Or(os,this).settings.selectionType,columnCursor:c,selectionWidth:s-n+1});m!==null&&(m!==h&&(g=o.getColumnHeader(m,d)),e(g))}c+=1}}}scanRowsInHeadersRange(e){const[r,n,i,s]=Or(os,this).getCorners(),{wtTable:o}=Or(ei,this),a=o.getRenderedRowsCount(),l=o.getRowHeadersCount();let c=0;for(let u=-o.getColumnHeadersCount();u<a;u++){const h=o.rowFilter.renderedToSource(u);if(!(h<r||h>i)){for(let f=-l;f<0;f++){if(f<n||f>s)continue;const d=f+l;let g=o.getRowHeader(h,d);const m=Or(ei,this).getSetting("onBeforeHighlightingRowHeader",h,d,{selectionType:Or(os,this).settings.selectionType,rowCursor:c,selectionHeight:i-r+1});m!==null&&(m!==h&&(g=o.getRowHeader(m,d)),e(g))}c+=1}}}scanCellsRange(e){const[r,n,i,s]=Or(os,this).getCorners(),{wtTable:o}=Or(ei,this);Kf(a0,this,sC).call(this,(a,l)=>{if(a>=r&&a<=i&&l>=n&&l<=s){const c=o.getCell(Or(ei,this).createCellCoords(a,l)),u=Or(ei,this).getSetting("onAfterDrawSelection",a,l,Or(os,this).settings.layerLevel);typeof u=="string"&&_e(c,u),e(c)}})}scanRowsInCellsRange(e){const[r,,n]=Or(os,this).getCorners(),{wtTable:i}=Or(ei,this);Kf(a0,this,sC).call(this,(s,o)=>{if(s>=r&&s<=n){const a=i.getCell(Or(ei,this).createCellCoords(s,o));e(a)}})}scanColumnsInCellsRange(e){const[,r,,n]=Or(os,this).getCorners(),{wtTable:i}=Or(ei,this);Kf(a0,this,sC).call(this,(s,o)=>{if(o>=r&&o<=n){const a=i.getCell(Or(ei,this).createCellCoords(s,o));e(a)}})}}function sC(t){const{wtTable:e}=Or(ei,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const s=e.rowFilter.renderedToSource(i);for(let o=0;o<n;o+=1)t(s,e.columnFilter.renderedToSource(o))}}class h_{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=cS,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),ks(e);const n=this,i=this.wot.rootDocument.body,s=r.getBoundingClientRect();r.style.display="none";function o(l){if(l.clientY<Math.floor(s.top)||l.clientY>Math.ceil(s.top+s.height)||l.clientX<Math.floor(s.left)||l.clientX>Math.ceil(s.left+s.width))return!0}function a(l){o(l)&&(n.eventManager.removeEventListener(i,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=n[a],c=r.createElement("div");c.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(c.className+=" hidden"),i=c.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(c)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),za()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let o=s.bordersHolder;o||(o=r.createElement("div"),o.className="htBorders",s.bordersHolder=o,s.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const r=10,n=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`};gt(i,(o,a)=>{this.selectionHandles.styles.bottomHitArea[a]=o,this.selectionHandles.styles.topHitArea[a]=o});const s={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};gt(s,(o,a)=>{this.selectionHandles.styles.bottom[a]=o,this.selectionHandles.styles.top[a]=o}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,s,o){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:c,topHitArea:u,bottom:h,bottomHitArea:f}=this.selectionHandles.styles,d=parseInt(c.borderWidth,10),g=parseInt(c.width,10),m=parseInt(u.width,10),p=this.wot.wtTable.getWidth(),y=this.wot.wtTable.getHeight();c.top=`${parseInt(n-g-1,10)}px`,c[l]=`${parseInt(i-g-1,10)}px`,u.top=`${parseInt(n-m/4*3,10)}px`,u[l]=`${parseInt(i-m/4*3,10)}px`;const S=Math.min(parseInt(i+s,10),p-g-d*2),C=Math.min(parseInt(i+s-m/4,10),p-m-d*2);h[l]=`${S}px`,f[l]=`${C}px`;const A=Math.min(parseInt(n+o,10),y-g-d*2),I=Math.min(parseInt(n+o-m/4,10),y-m-d*2);h.top=`${A}px`,f.top=`${I}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",u.display="block",this.isPartRange(e,r)?(h.display="none",f.display="none"):(h.display="block",f.display="block")):(c.display="none",h.display="none",u.display="none",f.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",u.zIndex="9999"):(c.zIndex="",u.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:r,rootDocument:n,rootWindow:i}=this.wot;let s,o,a,l,c,u;const h=r.getRenderedRowsCount();for(let Re=0;Re<h;Re+=1){const Y=r.rowFilter.renderedToSource(Re);if(Y>=e[0]&&Y<=e[2]){s=Y,c=e[0];break}}for(let Re=h-1;Re>=0;Re-=1){const Y=r.rowFilter.renderedToSource(Re);if(Y>=e[0]&&Y<=e[2]){o=Y;break}}const f=r.getRenderedColumnsCount();for(let Re=0;Re<f;Re+=1){const Y=r.columnFilter.renderedToSource(Re);if(Y>=e[1]&&Y<=e[3]){a=Y,u=e[1];break}}for(let Re=f-1;Re>=0;Re-=1){const Y=r.columnFilter.renderedToSource(Re);if(Y>=e[1]&&Y<=e[3]){l=Y;break}}if(s===void 0||a===void 0){this.disappear();return}let d=r.getCell(this.wot.createCellCoords(s,a));const g=s!==o||a!==l,m=g?r.getCell(this.wot.createCellCoords(o,l)):d,p=sn(d),y=g?sn(m):p,S=sn(r.TABLE),C=rr(r.TABLE),A=p.top,I=p.left,O=this.wot.wtSettings.getSetting("rtlMode");let _=0,E=0;if(O){const Re=rr(d),Y=i.innerWidth-S.left-C;E=I+Re-y.left,_=i.innerWidth-I-Re-Y-1}else E=y.left+rr(m)-I,_=I-S.left-1;if(this.isEntireColumnSelected(s,o)){const Re=this.getDimensionsFromHeader("columns",a,l,c,S);let Y=null;Re&&([Y,_,E]=Re),Y&&(d=Y)}let b=A-S.top-1,k=y.top+Fr(m)-A;if(this.isEntireRowSelected(a,l)){const Re=this.getDimensionsFromHeader("rows",s,o,u,S);let Y=null;Re&&([Y,b,k]=Re),Y&&(d=Y)}const B=sa(d,i);parseInt(B.borderTopWidth,10)>0&&(b+=1,k=k>0?k-1:0),parseInt(B[O?"borderRightWidth":"borderLeftWidth"],10)>0&&(_+=1,E=E>0?E-1:0);const N=O?"right":"left";this.topStyle.top=`${b}px`,this.topStyle[N]=`${_}px`,this.topStyle.width=`${E}px`,this.topStyle.display="block",this.startStyle.top=`${b}px`,this.startStyle[N]=`${_}px`,this.startStyle.height=`${k}px`,this.startStyle.display="block";const q=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${b+k-q}px`,this.bottomStyle[N]=`${_}px`,this.bottomStyle.width=`${E}px`,this.bottomStyle.display="block",this.endStyle.top=`${b}px`,this.endStyle[N]=`${_+E-q}px`,this.endStyle.height=`${k+1}px`,this.endStyle.display="block";let ue=this.settings.border.cornerVisible;ue=typeof ue=="function"?ue(this.settings.layerLevel):ue;const we=this.wot.getSetting("onModifyGetCellCoords",o,l);let[Se,ce]=[o,l];if(we&&Array.isArray(we)&&([,,Se,ce]=we),za()||!ue||this.isPartRange(Se,ce))this.cornerStyle.display="none";else{this.cornerStyle.top=`${b+k+this.cornerCenterPointOffset-1}px`,this.cornerStyle[N]=`${_+E+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Re=lh(r.TABLE);const Y=Re===i;Y&&(Re=n.documentElement);const Pe=parseInt(this.cornerDefaultStyle.width,10)/2,w=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const v=Y?m.getBoundingClientRect().left:m.offsetLeft;let x=!1,R=0;O?(R=v-parseInt(this.cornerDefaultStyle.width,10)/2,x=R<0):(R=v+rr(m)+parseInt(this.cornerDefaultStyle.width,10)/2,x=R>=mP(Re)),x&&(this.cornerStyle[N]=`${Math.floor(_+E+this.cornerCenterPointOffset-Pe)}px`,this.cornerStyle[O?"borderLeftWidth":"borderRightWidth"]=0)}o===this.wot.getSetting("totalRows")-1&&(Y?m.getBoundingClientRect().top:m.offsetTop)+Fr(m)+parseInt(this.cornerDefaultStyle.height,10)/2>=zu(Re)&&(this.cornerStyle.top=`${Math.floor(b+k+this.cornerCenterPointOffset-w)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}za()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(o,l,b,_,E,k)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,s){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let l=null,c=null,u=null,h=null,f=null,d=null,g=null,m=null;switch(e){case"rows":l=function(){return o.getRowHeader(...arguments)},c=function(){return Fr(...arguments)},u="ht__selection--rows",d="top";break;case"columns":l=function(){return o.getColumnHeader(...arguments)},c=function(){return rr(...arguments)},u="ht__selection--columns",d="left";break}if(a.classList.contains(u)){const p=this.wot.getSetting("columnHeaders").length;if(g=l(r,p-i),m=l(n,p-i),!g||!m)return!1;const y=sn(g),S=sn(m);return g&&m&&(h=y[d]-s[d]-1,f=S[d]+c(m)-y[d]),[g,h,f]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?_e(this[e],"hidden"):(Qe(this[e],"hidden")&&it(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?_e(this[e],"hidden"):it(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",za()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function E9(t,e){ak(t,e),e.add(t)}function su(t,e,r){ak(t,e),e.set(t,r)}function ak(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vt(t,e){return t.get(uS(t,e))}function f_(t,e,r){return t.set(uS(t,e),r),r}function uS(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var bn=new WeakMap,ri=new WeakMap,oC=new WeakMap,Lf=new WeakMap,aC=new WeakMap,El=new WeakMap,d_=new WeakSet;class R9{constructor(e){E9(this,d_),su(this,bn,void 0),su(this,ri,void 0),su(this,oC,new b9),su(this,Lf,new WeakMap),su(this,aC,new WeakSet),su(this,El,new Map),f_(ri,this,e)}setActiveOverlay(e){return f_(bn,this,e),vt(oC,this).setActiveOverlay(vt(bn,this)),vt(Lf,this).has(vt(bn,this))||vt(Lf,this).set(vt(bn,this),new Set),this}getFocusSelection(){return vt(ri,this)!==null?vt(ri,this).getFocus():null}getAreaSelection(){return vt(ri,this)!==null?vt(ri,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(vt(El,this).has(e)){const n=vt(El,this).get(e);if(n.has(vt(bn,this)))return n.get(vt(bn,this));const i=new h_(vt(bn,this),e.settings);return n.set(vt(bn,this),i),i}const r=new h_(vt(bn,this),e.settings);return vt(El,this).set(e,new Map([[vt(bn,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=vt(El,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){vt(El,this).get(e).forEach(r=>r.destroy()),vt(El,this).delete(e)}render(e){if(vt(ri,this)===null)return;e&&uS(d_,this,T9).call(this);const r=Array.from(vt(ri,this)),n=new Map,i=new Map;for(let s=0;s<r.length;s++){const o=r[s],{className:a,headerAttributes:l,createLayers:c,selectionType:u}=o.settings;vt(aC,this).has(o)||(vt(aC,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const h=this.getBorderInstance(o);if(o.isEmpty()){h==null||h.disappear();continue}a&&vt(oC,this).setActiveSelection(o).scan().forEach(g=>{if(n.has(g)){const m=n.get(g);m.has(a)&&c===!0?m.set(a,m.get(a)+1):m.set(a,1)}else n.set(g,new Map([[a,1]]));l&&(i.has(g)||i.set(g,[]),g.nodeName==="TH"&&i.get(g).push(...l))});const f=o.getCorners();vt(bn,this).getSetting("onBeforeDrawBorders",f,u),h==null||h.appear(f)}n.forEach((s,o)=>{var a;const l=Array.from(s).map(c=>{let[u,h]=c;return h===1?u:[u,...Array.from({length:h-1},(f,d)=>`${u}-${d+1}`)]}).flat();l.forEach(c=>vt(Lf,this).get(vt(bn,this)).add(c)),_e(o,l),o.nodeName==="TD"&&Array.isArray((a=vt(ri,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Ze(o,vt(ri,this).options.cellAttributes)}),Array.from(i.keys()).forEach(s=>{Ze(s,[...i.get(s)])})}}function T9(){const t=vt(Lf,this).get(vt(bn,this)),e=vt(bn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const s=vt(bn,this).wtTable.TABLE.querySelectorAll(`.${r}`);let o=[];Array.isArray((n=vt(ri,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(o=vt(ri,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=vt(ri,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(o=[...o,...vt(ri,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=s.length;a<l;a++)it(s[a],r),yh(s[a],o)}),t.clear()}class _9 extends gg{constructor(e,r,n,i){super(e,r,Tc,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new sS(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),Vx(n,`${s}px`,"0px")):(s=this.getScrollPosition(),Tv(n));const o=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===r&&r.scrollX!==e?(r.scrollTo(e,dP(r)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,s=0;for(;i<r;)s+=this.wot.wtTable.getStretchedColumnWidth(i)||n,i+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,i=ln(r),o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||a==="vertical"){let c=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(c-=i),c=Math.min(c,e.wtRootElement.scrollHeight),o.height=`${c}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const l=rr(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=this.wot.selectionManager.getFocusSelection()?parseInt(cS.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),s=n.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=s===0&&i.length>0&&!Qe(a.parentNode,"innerBorderInlineStart")?1:0;let c=this.getTableParentOffset(),u=0;if(r){const h=this.wot.wtTable.getColumnWidth(e),f=this.wot.wtViewport.getViewportWidth();h>f&&(r=!1)}return r&&a.offsetWidth!==a.clientWidth&&(u=ln(this.domBindings.rootDocument)),r?(c+=this.sumCellSizes(0,e+1),c-=this.wot.wtViewport.getViewportWidth(),c+=l):c+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),c+=u,F8(this.mainTableScrollableElement)===c-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(c)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(gP(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),o=i-s;n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),s=r.getSetting("fixedColumnsStart"),o=r.getSetting("totalRows"),a=r.getSetting("preventOverflow")==="vertical";o?it(n,"emptyRows"):_e(n,"emptyRows");let l=!1;if(!a){if(s&&!i.length)_e(n,"innerBorderLeft innerBorderInlineStart");else if(!s&&i.length){const c=Qe(n,"innerBorderInlineStart");e?(_e(n,"innerBorderLeft innerBorderInlineStart"),l=!c):(it(n,"innerBorderLeft innerBorderInlineStart"),l=c)}}return l}}const A9="stickyRowsTop",hS={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ua(hS,"MIXIN_NAME",A9,{writable:!1,enumerable:!1});class fS extends Sh{constructor(e,r,n,i){super(e,r,n,i,_c)}}jt(fS,hS);jt(fS,Mv);function g_(t,e,r){return(e=I9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I9(t){var e=M9(t,"string");return typeof e=="symbol"?e:e+""}function M9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O9 extends gg{constructor(e,r,n,i,s,o){super(e,r,_c,n,i),g_(this,"topOverlay",void 0),g_(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new fS(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();Vx(e,`${i}px`,`${s}px`)}else Tv(e);let r=Fr(this.clone.wtTable.TABLE);const n=rr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class dS extends Sh{constructor(e,r,n,i){super(e,r,n,i,Rc)}}jt(dS,hS);jt(dS,Ov);function P9(t,e,r){return(e=k9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function k9(t){var e=N9(t,"string");return typeof e=="symbol"?e:e+""}function N9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class F9 extends gg{constructor(e,r,n,i){super(e,r,Rc,n,i),P9(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new dS(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,s=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),c=Math.ceil(l.bottom),u=e.offsetHeight;s=c===u,i=this.getOverlayOffset(),Vx(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Tv(e);const o=this.adjustHeaderBordersPosition(i,s);return this.adjustElementsSize(),o}setScrollPosition(e){const r=this.domBindings.rootWindow;let n=!1;return this.mainTableScrollableElement===r&&r.scrollY!==e?(r.scrollTo($x(r),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultRowHeight");let i=e,s=0;for(;i<r;){const o=this.wot.wtTable.getRowHeight(i);s+=o===void 0?n:o,i+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,i=ln(r),o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||a==="horizontal"){let c=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=i),c=Math.min(c,e.wtRootElement.scrollWidth),o.width=`${c}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=Fr(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=this.wot.selectionManager.getFocusSelection()?parseInt(cS.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,o=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=i.getSetting("columnHeaders"),c=i.getSetting("fixedRowsTop")===0&&a.length>0&&!Qe(o.parentNode,"innerBorderTop")?1:0;let u=this.getTableParentOffset(),h=0;if(r){const f=this.wot.wtTable.getRowHeight(e),d=this.wot.wtViewport.getViewportHeight();f>d&&(r=!1)}if(r&&o.offsetHeight!==o.clientHeight&&(h=ln(this.domBindings.rootDocument)),r){const f=i.getSetting("fixedRowsBottom"),d=i.getSetting("totalRows");u+=this.sumCellSizes(0,e+1),u-=n.wtViewport.getViewportHeight()-this.sumCellSizes(d-f,d),u+=1,u+=c}else u+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return u+=h,N8(this.mainTableScrollableElement)===u-c&&c>0&&this.wot.wtOverlays.expandHiderVerticallyBy(c),this.setScrollPosition(u)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Bx(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,s=n.getSetting("totalColumns"),o=n.getSetting("preventOverflow")==="horizontal";s?it(i,"emptyColumns"):_e(i,"emptyColumns");let a=!1;if(!r&&!o){const l=n.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==l,u=n.getSetting("columnHeaders");if((c||l===0)&&u.length>0){const h=Qe(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(_e(i,"innerBorderTop"),a=!h):(it(i,"innerBorderTop"),a=h)}}return a}}function l0(t,e,r){H9(t,e),e.set(t,r)}function H9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Po(t,e,r){return(e=D9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function D9(t){var e=L9(t,"string");return typeof e=="symbol"?e:e+""}function L9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rl(t,e,r){return t.set(lk(t,e),r),r}function ko(t,e){return t.get(lk(t,e))}function lk(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ou=new WeakMap,c0=new WeakMap,au=new WeakMap,u0=new WeakMap;class $9{constructor(e,r,n,i,s,o){Po(this,"wot",null),l0(this,ou,[]),Po(this,"topOverlay",null),Po(this,"bottomOverlay",null),Po(this,"inlineStartOverlay",null),Po(this,"topInlineStartCornerOverlay",null),Po(this,"bottomInlineStartCornerOverlay",null),Po(this,"browserLineHeight",void 0),Po(this,"wtSettings",null),l0(this,c0,!1),l0(this,au,0),l0(this,u0,null),Po(this,"resizeObserver",new ResizeObserver(u=>{zx(()=>{!Array.isArray(u)||!u.length||(Rl(au,this,ko(au,this)+1),ko(au,this)===100&&(Ft("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),ko(u0,this)!==null&&clearTimeout(ko(u0,this)),Rl(u0,this,setTimeout(()=>{Rl(au,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=o;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=ln(a);const c=l.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?o.holder:hp(o.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...ko(ou,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),s=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new F9(...e),this.bottomOverlay=new g9(...e),this.inlineStartOverlay=new _9(...e),this.topInlineStartCornerOverlay=new O9(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new c9(...e,this.bottomOverlay,this.inlineStartOverlay),Rl(ou,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Rl(c0,this,ko(ou,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),ko(ou,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),ko(ou,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",h=>this.onTableScroll(h),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const s=r.devicePixelRatio&&r.devicePixelRatio>1,o=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),l={passive:o};(a||s||!_P())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:f}=h.clone.wtTable;this.eventManager.addEventListener(f,"wheel",d=>this.onCloneWheel(d,a),l)}});let u;this.eventManager.addEventListener(r,"resize",()=>{clearTimeout(u),u=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize"),Rl(au,this,0)},200)}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(i!==r&&s!==r&&!e.target.contains(i)||n!==r&&s!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target,a=s!==n&&o!==n&&!o.contains(s),l=i!==n&&o!==n&&!o.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===n)return;const c=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&c)&&e.preventDefault()}onKeyDown(e){this.keyPressed=hg(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),s=this.scrollHorizontally(n);return i||s}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,r=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,[i,s]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=r.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==s||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){r.scrollLeft=i;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=i)}this.verticalScrolling&&(n.scrollTop=s),this.refreshAll()}syncScrollWithMaster(){if(!ko(c0,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),Rl(c0,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=hp(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,s=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),c=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,u=a+this.inlineStartOverlay.sumCellSizes(0,s),f=r.hider.style,d=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,c-r.holder.clientHeight),g=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,u-r.holder.clientWidth),m=d()?1:0,p=g()?1:0;if(f.width=`${u+p}px`,f.height=`${c+m}px`,this.scrollbarSize>0){const{scrollHeight:y,scrollWidth:S}=r.wtRootElement,{scrollHeight:C,scrollWidth:A}=r.holder;this.hasScrollbarRight=y<C,this.hasScrollbarBottom=S<A,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>S?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>y&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return J(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];J(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function m_(t,e,r){return(e=B9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function B9(t){var e=V9(t,"string");return typeof e=="symbol"?e:e+""}function V9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class W9{constructor(e){m_(this,"settings",{}),m_(this,"defaults",Object.freeze(this.getDefaults())),gt(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);Sc(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,r){return r===void 0?gt(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,s){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,s):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class gS extends Sh{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=lh(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=Ed(e,"height",r),s=Ed(e,"overflow",r),o=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let c=e.offsetWidth,u=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(s)){const f=e.cloneNode(!1);f.style.overflow="auto",f.style.position="absolute",e.nextElementSibling?n.insertBefore(f,e.nextElementSibling):n.appendChild(f);const d=parseInt(sa(f,r).height,10);n.removeChild(f),d===0&&(u=0)}u=Math.min(u,l),o.height=i==="auto"?"auto":`${u}px`,c=Math.min(c,a),o.width=`${c}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:u>0,this.hasTableWidth=c>0}this.isTableVisible=ah(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",s=e.getSetting("columnHeaders").length;if(s&&!r.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let c=0;c<s;c++)for(let u=-1*a;u<l;u++)this.markIfOversizedColumnHeader(u);r.hasOversizedColumnHeadersMarked[n]=!0}}}jt(gS,iS);jt(gS,Ov);class U9{constructor(e,r,n,i,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new O5:new k5],["fullyVisible",()=>new x5],["partiallyVisible",()=>new YP]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new A5:new P5],["fullyVisible",()=>new w5],["partiallyVisible",()=>new GP]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=Fr(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:r,rootWindow:n}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=r.documentElement.offsetWidth,o=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),u=l?c.right-s:c.left,h=s-u;let f,d;if(a)return rr(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?f=Math.min(h,s):f=Math.min(this.getContainerFillWidth(),h,s),i===n&&o>0&&this.sumColumnWidths(0,o-1)>f)return r.documentElement.clientWidth;if(i!==n&&(d=Ed(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",n),d==="scroll"||d==="hidden"||d==="auto"))return Math.max(f,i.clientWidth);const g=e.getSetting("stretchH");return g==="none"||!g?Math.max(f,rr(this.wtTable.TABLE)):f}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,r=this.domBindings.rootDocument.createElement("div");r.style.width="100%",r.style.height="1px",e.appendChild(r);const n=r.offsetWidth;return this.containerWidth=n,e.removeChild(r),n}getWorkspaceOffset(){return sn(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Fr(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,s=r.length;i<s;i++)n?(this.rowHeaderWidth+=rr(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportHeight(),s,o;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=r.getSetting("fixedRowsTop"),c=r.getSetting("fixedRowsBottom"),u=r.getSetting("totalRows");return l&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=o,i-=o),c&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(u-c,u),i-=o),n.holder.clientHeight===n.holder.offsetHeight?s=0:s=ln(this.domBindings.rootDocument),new V5({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:r.getSetting("totalRows"),rowHeightFn:h=>n.getRowHeight(h),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=r.getSetting("fixedColumnsStart");if(o&&s>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);s+=a,i-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=ln(this.domBindings.rootDocument)),new L5({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:s,totalColumns:r.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const s=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s)}if(e&&!r.getSetting("renderAllColumns")){const s=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:r,endRow:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:s}=this.rowsRenderCalculator;return r<i||r===i&&r>0?!1:!(n>s||n===s&&n<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:r,endColumn:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:s}=this.columnsRenderCalculator;return r<i||r===i&&r>0?!1:!(n>s||n===s&&n<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){gt(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}class j9 extends rS{constructor(e,r){super(e,new W9(r));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new gS(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new U9(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new R9(this.wtSettings.getSetting("selections")),this.wtEvent=new QP(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new $9(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];gt(e,(i,s)=>{this.wtSettings.getSetting(s).length&&n.push(i),r.push(i)}),it(this.wtTable.wtRootElement.parentNode,r),_e(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!nk.includes(e))return null;const n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class mS{constructor(e){e instanceof rS?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new mS(r);return()=>n},this._wot=new j9(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n,i,s){return this._wot.scrollViewport(e,r,n,i,s)}scrollViewportHorizontally(e,r,n){return this._wot.scrollViewportHorizontally(e,r,n)}scrollViewportVertically(e,r,n){return this._wot.scrollViewportVertically(e,r,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,s){return this._wot.wtSettings.getSetting(e,r,n,i,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function p_(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:s,controller:o,cellCoordsFactory:a}=t;const l=s.isSelected()?s.getSelectedRange().current():null,c=s.isSelectedByCorner(),u=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(i):(c||u)&&i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(a(i.row,i.col)):c&&i.row<0&&!o.column?s.setRangeEnd(a(l.to.row,i.col)):u&&i.col<0&&!o.row?s.setRangeEnd(a(i.row,l.to.col)):(!c&&!u&&i.col<0||c&&i.col<0)&&!o.row?s.selectRows(Math.max(l.from.row,0),i.row,i.col):(!c&&!u&&i.row<0||u&&i.row<0)&&!o.column&&s.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!s.inInSelection(i),f=r||n&&h;i.row<0&&i.col>=0&&!o.column?f&&s.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!o.row?f&&s.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!o.cell?f&&s.setRangeStart(i):i.col<0&&i.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function z9(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:s}=t;if(!e)return;const o=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),c=n.tableProps.countRows();n.markSource("mouse"),a&&!i.column?n.setRangeEnd(s(c-1,r.col)):o&&!i.row?n.setRangeEnd(s(r.row,l-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}const G9=new Map([["mousedown",p_],["mouseover",z9],["touchstart",p_]]);function v_(t,e){let{coords:r,selection:n,controller:i,cellCoordsFactory:s}=e;G9.get(t.type)({coords:r,selection:n,controller:i,cellCoordsFactory:s,isShiftKey:t.shiftKey,isLeftClick:Gx(t)||t.type==="touchstart",isRightClick:bc(t)})}const ck=new WeakMap,pS=Symbol("rootInstance");function Y9(t){ck.set(t,!0)}function K9(t){return t===pS}function Wm(t){return ck.has(t)}function X9(t,e){uk(t,e),e.add(t)}function Tl(t,e,r){uk(t,e),e.set(t,r)}function uk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ya(t,e,r){return(e=q9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function q9(t){var e=J9(t,"string");return typeof e=="symbol"?e:e+""}function J9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qr(t,e){return t.get(Td(t,e))}function Pi(t,e,r){return t.set(Td(t,e),r),r}function Td(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var lC=new WeakMap,h0=new WeakMap,f0=new WeakMap,No=new WeakMap,as=new WeakMap,cC=new WeakMap,uC=new WeakMap,Um=new WeakSet;class Z9{constructor(e){X9(this,Um),ya(this,"hot",void 0),ya(this,"eventManager",void 0),ya(this,"settings",void 0),ya(this,"THEAD",void 0),ya(this,"TBODY",void 0),ya(this,"_wt",void 0),ya(this,"activeWt",void 0),Tl(this,lC,0),Tl(this,h0,0),ya(this,"postponedAdjustElementsSize",!1),Tl(this,f0,!1),Tl(this,No,void 0),Tl(this,as,void 0),Tl(this,cC,0),Tl(this,uC,0),this.hot=e,this.eventManager=new Ms(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n,i,s){return this._wt.scrollViewport(e,r,n,i,s)}scrollViewportHorizontally(e,r,n){return this._wt.scrollViewportHorizontally(e,r,n)}scrollViewportVertically(e,r,n){return this._wt.scrollViewportVertically(e,r,n)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),_e(e,"handsontable"),Pi(as,this,r.createElement("TABLE")),_e(Qr(as,this),"htCore"),this.hot.getSettings().tableClassName&&_e(Qr(as,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Ze(Qr(as,this),[go()]),Ze(e,[o8(),aP(-1),Ev(this.hot.countCols()),y8()])),this.THEAD=r.createElement("THEAD"),Qr(as,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),Qr(as,this).appendChild(this.TBODY),this.hot.table=Qr(as,this),this.hot.container.insertBefore(Qr(as,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:r,selection:n,rootWindow:i}=this.hot,s=r.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{Pi(f0,this,!0),this.isTextSelectionAllowed(a.target)||(RT(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{Pi(f0,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{Qr(f0,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&RT(i),a.preventDefault())}),this.eventManager.addEventListener(s,"keyup",a=>{n.isInProgress()&&!a.shiftKey&&n.finish()}),this.eventManager.addEventListener(s,"mouseup",a=>{n.isInProgress()&&Gx(a)&&n.finish(),Pi(No,this,!1);const l=vP(r.activeElement);Bm(r.activeElement)&&!l||(l||!n.isSelected()&&!n.isSelectedByAnyHeader()&&!e.contains(a.target)&&!bc(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",a=>{n.isInProgress()&&bc(a)&&(n.finish(),Pi(No,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{n.isInProgress()&&n.finish(),Pi(No,this,!1)}),this.eventManager.addEventListener(s,"mousedown",a=>{const l=a.target,c=a.x||a.clientX,u=a.y||a.clientY;let h=a.target;if(Qr(No,this)||!e||!this.hot.view)return;const{holder:f}=this._wt.wtTable;if(h===f){const g=ln(r);if(r.elementFromPoint(c+g,u)!==f||r.elementFromPoint(c,u+g)!==f)return}else for(;h!==s;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let o=oh(i);for(;o!==null;)this.eventManager.addEventListener(o.document.documentElement,"click",()=>{this.hot.unlisten()}),o=oh(o);this.eventManager.addEventListener(Qr(as,this),"selectstart",a=>{this.settings.fragmentSelection||Bm(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const s=n.getNearestNotHiddenIndex(e,r),o=n.getRenderableFromVisualIndex(s);if(!Number.isInteger(o))return 0;let a=0;return r<0?a=o+1:r>0&&(a=i-o),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Qr(as,this),isDataViewInstance:()=>Wm(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(s,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),Pi(h0,this,s.length),this.hot.getSettings().ariaTags&&Td(Um,this,hk).call(this)===this.hot.countCols()&&Td(Um,this,Q9).call(this,Qr(h0,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),Pi(lC,this,s.length),s},columnWidth:s=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(o===null?s:o)},rowHeight:s=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(o===null?s:o)},rowHeightByOverlayName:(s,o)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),l=a===null?s:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,o)},cellRenderer:(s,o,a)=>{const[l,c]=this.translateFromRenderableToVisualIndex(s,o),u=this.hot.runHooks("modifyGetCellCoords",l,c);let h=l,f=c;Array.isArray(u)&&([h,f]=u);const d=this.hot.getCellMeta(h,f),g=this.hot.colToProp(f);let m=this.hot.getDataAtRowProp(h,g);this.hot.hasHook("beforeValueRender")&&(m=this.hot.runHooks("beforeValueRender",m,d)),this.hot.runHooks("beforeRenderer",a,l,c,g,m,d),this.hot.getCellRenderer(d)(this.hot,a,l,c,g,m,d),this.hot.runHooks("afterRenderer",a,l,c,g,m,d)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&ah(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o),u={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Pi(No,this,!0),this.hot.runHooks("beforeOnCellMouseDown",s,c,a,u),!oc(s)&&(v_(s,{coords:c,selection:this.hot.selection,controller:u,cellCoordsFactory:(h,f)=>this.hot._createCellCoords(h,f)}),this.hot.runHooks("afterOnCellMouseDown",s,c,a),this.activeWt=this._wt)},onCellContextMenu:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,Pi(No,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,c,a),!oc(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,c,a),this.activeWt=this._wt)},onCellMouseOut:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",s,c,a),!oc(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,c,a),this.activeWt=this._wt)},onCellMouseOver:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o),u={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",s,c,a,u),!oc(s)&&(Qr(No,this)&&v_(s,{coords:c,selection:this.hot.selection,controller:u,cellCoordsFactory:(h,f)=>this.hot._createCellCoords(h,f)}),this.hot.runHooks("afterOnCellMouseOver",s,c,a),this.activeWt=this._wt)},onCellMouseUp:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",s,c,a),!(oc(s)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",s,c,a),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,o)=>this.beforeRender(s,o),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:s=>{const o=this.hot.rowIndexMapper,a=s<0;let l=s;return!a&&(l=o.getVisualFromRenderableIndex(s),l===null)?s:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:o.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:s=>{const o=this.hot.columnIndexMapper,a=s<0;let l=s;return!a&&(l=o.getVisualFromRenderableIndex(s),l===null)?s:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:o.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,o,a)=>{const l=this.hot.rowIndexMapper,c=s<0;let u=s;c||(u=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingRowHeader",u,o,a);return c?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(s,o,a)=>{const l=this.hot.columnIndexMapper,c=s<0;let u=s;c||(u=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingColumnHeader",u,o,a);return c?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(s,o,a)=>{let l;const[c,u]=this.translateFromRenderableToVisualIndex(s,o),h=this.hot.selection.getSelectedRange();if(h.size()>0){const d=h.peekByIndex(a??0);l=[d.from.row,d.from.col,d.to.row,d.to.col]}return this.hot.runHooks("afterDrawSelection",c,u,l,a)},onBeforeDrawBorders:(s,o)=>{const[a,l,c,u]=s,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(c),this.hot.columnIndexMapper.getVisualFromRenderableIndex(u)];return this.hot.runHooks("beforeDrawBorders",h,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(s,o)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.runHooks("beforeStretchingColumnWidth",s,a)},onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,o,a)=>{const l=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,u=o>=0?c.getVisualFromRenderableIndex(o):o,h=s>=0?l.getVisualFromRenderableIndex(s):s,f=this.hot.runHooks("modifyGetCellCoords",h,u,a);if(Array.isArray(f)){const[d,g,m,p]=f;return[d>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1)):d,g>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(g,1)):g,m>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(m,-1)):m,p>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(p,-1)):p]}},viewportRowCalculatorOverride:s=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){const a=this.countRenderableRows(),l=s.startRow,c=s.endRow;if(typeof o=="number")s.startRow=Math.max(l-o,0),s.endRow=Math.min(c+o,a-1);else if(o==="auto"){const u=Math.ceil(c/a*12);s.startRow=Math.max(l-u,0),s.endRow=Math.min(c+u,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){const a=this.countRenderableColumns(),l=s.startColumn,c=s.endColumn;if(typeof o=="number"&&(s.startColumn=Math.max(l-o,0),s.endColumn=Math.min(c+o,a-1)),o==="auto"){const u=Math.ceil(c/a*6);s.startColumn=Math.max(l-u,0),s.endColumn=Math.min(c+u,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new mS(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(Bm(e))return!0;const r=pc(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Qr(No,this)}isSelectedOnlyCell(){var e,r;return(e=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!Qe(n,"relative")){wo(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,s=n.createElement("div"),o=n.createElement("span");s.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,i),s.appendChild(o),r.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(r.firstChild){const o=r.firstChild;Qe(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,n,i),o.className="",_e(o,["relative",...s()])):(wo(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:o}=this.hot,a=o.createElement("div"),l=o.createElement("span"),c=s();a.classList.add("relative",...c),l.className="colHeader",this.settings.ariaTags&&(Ze(a,...go()),Ze(l,...go())),this.updateCellHeader(l,e,n,i),a.appendChild(l),r.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=r;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Qe(e,"colHeader")?s=o.wtTable.columnFilter.sourceToRendered(r):Qe(e,"rowHeader")&&(s=o.wtTable.rowFilter.sourceToRendered(r))),s>-1?xh(e,n(r,i)):(Sc(e,"Â "),_e(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){Pi(cC,this,e),Pi(uC,this,r)}getLastSize(){return{width:Qr(cC,this),height:Qr(uC,this)}}getFirstRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedRow(),1):null}getLastRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedRow(),-1):null}getFirstRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedColumn(),1):null}getLastRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedColumn(),-1):null}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Qr(lC,this)}getRowHeadersCount(){return Qr(h0,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}isVisible(){return this._wt.wtTable.isVisible()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function hk(){return parseInt(this.hot.rootElement.getAttribute(Ev()[0]),10)}function Q9(t){const e=Td(Um,this,hk).call(this)+t;Ze(this.hot.rootElement,...Ev(e))}const e7="ABCDEFGHIJKLMNOPQRSTUVWXYZ",w_=e7.length;function t7(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%w_,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/w_,10);return r}function fk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t;const n=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(r=[t]),r.forEach((i,s)=>{Array.isArray(i)?i.forEach((o,a)=>{n.push([s+e,a,o])}):Object.keys(i).forEach(o=>{n.push([s+e,o,i[o]])})}),n}function dk(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&dt(t[0])&&(e=jx(t[0]))),e}function r7(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function n7(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function Jh(t,e,r){return(e=i7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i7(t){var e=s7(t,"string");return typeof e=="symbol"?e:e+""}function s7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class o7{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Jh(this,"hot",void 0),Jh(this,"data",void 0),Jh(this,"dataType","array"),Jh(this,"colToProp",()=>{}),Jh(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return J(this.data,(n,i)=>{const s=this.getAtCell(i,e);r.push(s)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=r===void 0&&n===void 0,{dataDotNotation:o}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],s?a.forEach((c,u)=>{l[u]=this.getAtPhysicalCell(e,u,a)}):Ge(r,n,c=>{l[c-r]=this.getAtPhysicalCell(e,c,a)});else if(dt(a)||er(a))if(i?l=[]:l={},!s||i){const u=this.countFirstRowKeys()-1;Ge(0,u,h=>{const f=this.colToProp(h);if(h>=(r||0)&&h<=(n||u)&&!Number.isInteger(f)){const d=this.getAtPhysicalCell(e,f,a);i?l.push(d):o?Uw(l,f,d):l[f]=d}})}else gt(a,(c,u)=>{const h=this.getAtPhysicalCell(e,u,a);o?Uw(l,u,h):l[u]=h});return l}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Ss(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}Number.isInteger(r)?this.data[e][r]=n:Uw(this.data[e],r,n)}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){const{dataDotNotation:s}=this.hot.getSettings();i=s?i6(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){const s=Ss(i);this.hot.runHooks("modifySourceData",e,r,s,"get"),s.isTouched()&&(i=s.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=null,o=null,a=null,l=null;e===null||r===null?(i=!0,s=0,a=this.countRows()-1):(s=Math.min(e.row,r.row),o=Math.min(e.col,r.col),a=Math.max(e.row,r.row),l=Math.max(e.col,r.col));const c=[];return Ge(s,a,u=>{c.push(i?this.getAtRow(u,void 0,void 0,n):this.getAtRow(u,o,l,n))}),c}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return dk(this.data)}destroy(){this.data=null,this.hot=null}}function C_(t,e,r){return(e=a7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a7(t){var e=l7(t,"string");return typeof e=="symbol"?e:e+""}function l7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;C_(this,"indexedValues",[]),C_(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,er(this.initValueOrFn)?Ge(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):Ge(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}jt(Uc,vn);function vS(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((s,o)=>er(n)?n(s,o):n),...i===void 0?[]:t.slice(i)]}function wS(t,e){return rl(t,(r,n)=>e.includes(n)===!1)}class fl extends Uc{insert(e,r){this.indexedValues=vS(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=wS(this.indexedValues,e),super.remove(e)}}class Pv extends fl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Gn(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function CS(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function _d(t,e){return rl(t,r=>e.includes(r)===!1)}function yS(t,e){return bt(t,r=>r-e.filter(n=>n<r).length)}function xS(t,e){const r=e[0],n=e.length;return bt(t,i=>i>=r?i+n:i)}function c7(t,e,r){return(e=u7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function u7(t){var e=h7(t,"string");return typeof e=="symbol"?e:e+""}function h7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kv extends Uc{constructor(){super(...arguments),c7(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=_d(this.orderOfIndexes,[e]),er(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=vS(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=xS(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=wS(this.indexedValues,e),this.orderOfIndexes=_d(this.orderOfIndexes,e),this.orderOfIndexes=yS(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class mg extends fl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Gn(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}const y_=new Map([["indexesSequence",{getListWithInsertedItems:CS,getListWithRemovedItems:_d}],["physicallyIndexed",{getListWithInsertedItems:vS,getListWithRemovedItems:wS}]]),gk=t=>{if(y_.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return y_.get(t)};class mk extends Uc{constructor(){super(e=>e)}insert(e,r){const n=xS(this.indexedValues,r);this.indexedValues=CS(n,e,r),super.insert(e,r)}remove(e){const r=_d(this.indexedValues,e);this.indexedValues=yS(r,e),super.remove(e)}}const x_=new Map([["hiding",Pv],["index",Uc],["linkedPhysicalIndexToValue",kv],["physicalIndexToValue",fl],["trimming",mg]]);function f7(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!x_.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(x_.get(t))(e)}function d7(t,e,r){return(e=g7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g7(t){var e=m7(t,"string");return typeof e=="symbol"?e:e+""}function m7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SS{constructor(){d7(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)))}unregister(e){const r=this.collection.get(e);Ue(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return tr(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}jt(SS,vn);function hC(t,e,r){return(e=p7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p7(t){var e=v7(t,"string");return typeof e=="symbol"?e:e+""}function v7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S_ extends SS{constructor(e,r){super(),hC(this,"mergedValuesCache",[]),hC(this,"aggregationFunction",void 0),hC(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=bt(this.get(),s=>s.getValues()),n=[],i=Ue(r[0])&&r[0].length||0;for(let s=0;s<i;s+=1){const o=[];for(let a=0;a<this.getLength();a+=1)o.push(r[a][s]);n.push(o)}return bt(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return Ue(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function w7(t,e,r){C7(t,e),e.set(t,r)}function C7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function y7(t,e,r){return t.set(pk(t,e),r),r}function x7(t,e){return t.get(pk(t,e))}function pk(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var fC=new WeakMap;class vk{constructor(){w7(this,fC,[])}subscribe(e){return this.addLocalHook("change",e),this._write(x7(fC,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){y7(fC,this,e)}}jt(vk,vn);function b_(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function Zh(t,e,r){S7(t,e),e.set(t,r)}function S7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ki(t,e){return t.get(wk(t,e))}function d0(t,e,r){return t.set(wk(t,e),r),r}function wk(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var g0=new WeakMap,Qh=new WeakMap,m0=new WeakMap,p0=new WeakMap,v0=new WeakMap;class b7{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Zh(this,g0,new Set),Zh(this,Qh,[]),Zh(this,m0,[]),Zh(this,p0,!1),Zh(this,v0,!1),d0(v0,this,e??!1)}createObserver(){const e=new vk;return ki(g0,this).add(e),e.addLocalHook("unsubscribe",()=>{ki(g0,this).delete(e)}),e._writeInitialChanges(b_(ki(Qh,this),ki(m0,this))),e}emit(e){let r=ki(m0,this);(!ki(p0,this)||ki(Qh,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(ki(v0,this)):d0(Qh,this,new Array(e.length).fill(ki(v0,this))),ki(p0,this)||(d0(p0,this,!0),r=ki(Qh,this)));const n=b_(r,e);ki(g0,this).forEach(i=>i._write(n)),d0(m0,this,e)}}function Pn(t,e,r){return(e=E7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function E7(t){var e=R7(t,"string");return typeof e=="symbol"?e:e+""}function R7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _y{constructor(){Pn(this,"indexesSequence",new mk),Pn(this,"trimmingMapsCollection",new S_(e=>e.some(r=>r===!0),!1)),Pn(this,"hidingMapsCollection",new S_(e=>e.some(r=>r===!0),!1)),Pn(this,"variousMapsCollection",new SS),Pn(this,"hidingChangesObservable",new b7({initialIndexValue:!1})),Pn(this,"notTrimmedIndexesCache",[]),Pn(this,"notHiddenIndexesCache",[]),Pn(this,"isBatched",!1),Pn(this,"indexesSequenceChanged",!1),Pn(this,"indexesChangeSource",void 0),Pn(this,"trimmedIndexesChanged",!1),Pn(this,"hiddenIndexesChanged",!1),Pn(this,"renderablePhysicalIndexesCache",[]),Pn(this,"fromPhysicalToVisualIndexesCache",new Map),Pn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,f7(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof mg?this.trimmingMapsCollection.register(e,r):r instanceof Pv?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return Ue(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return Ue(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return Ue(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return Ue(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return r>0?o=s.findIndex(a=>a>e):o=s.reverse().findIndex(a=>a<e),o===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:s[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=bt(e,c=>this.getPhysicalFromVisualIndex(c)),i=this.getNotTrimmedIndexesLength(),s=e.length,o=_d(this.getIndexesSequence(),n),a=o.filter(c=>this.isTrimmed(c)===!1);let l=o.indexOf(a[a.length-1])+1;if(r+s<i){const c=a[r];l=o.indexOf(c)}this.indexesChangeSource="move",this.setIndexesSequence(CS(o,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){const n=this.getNotTrimmedIndexes()[e],i=Ue(n)?n:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),o=bt(new Array(r).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,o),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(s,o),this.hidingMapsCollection.insertToEvery(s,o),this.variousMapsCollection.insertToEvery(s,o),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}jt(_y,vn);function T7(t,e){return gt(e,(r,n)=>{tr(t[n])&&(t[n]=r)}),t}function Ck(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function yk(t){Ue(t)&&Kx(Ht`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function _7(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:A7,getValues:I7}=Ns("phraseFormatters");function M7(t,e){A7(t,e)}function O7(){return I7()}M7("pluralize",_7);const xk="ContextMenu:items",ot=xk,bS=`${ot}.noItems`,ES=`${ot}.insertRowAbove`,RS=`${ot}.insertRowBelow`,TS=`${ot}.insertColumnOnTheLeft`,_S=`${ot}.insertColumnOnTheRight`,AS=`${ot}.removeRow`,IS=`${ot}.removeColumn`,MS=`${ot}.undo`,OS=`${ot}.redo`,mp=`${ot}.readOnly`,PS=`${ot}.clearColumn`,kS=`${ot}.copy`,NS=`${ot}.copyWithHeaders`,FS=`${ot}.copyWithGroupHeaders`,HS=`${ot}.copyHeadersOnly`,DS=`${ot}.cut`,LS=`${ot}.freezeColumn`,$S=`${ot}.unfreezeColumn`,BS=`${ot}.mergeCells`,VS=`${ot}.unmergeCells`,WS=`${ot}.addComment`,US=`${ot}.editComment`,jS=`${ot}.removeComment`,zS=`${ot}.readOnlyComment`,GS=`${ot}.align`,pp=`${ot}.align.left`,vp=`${ot}.align.center`,wp=`${ot}.align.right`,Cp=`${ot}.align.justify`,yp=`${ot}.align.top`,xp=`${ot}.align.middle`,Sp=`${ot}.align.bottom`,YS=`${ot}.borders`,KS=`${ot}.borders.top`,XS=`${ot}.borders.right`,qS=`${ot}.borders.bottom`,JS=`${ot}.borders.left`,ZS=`${ot}.borders.remove`,QS=`${ot}.nestedHeaders.insertChildRow`,eb=`${ot}.nestedHeaders.detachFromParent`,tb=`${ot}.hideColumn`,rb=`${ot}.showColumn`,nb=`${ot}.hideRow`,ib=`${ot}.showRow`,Yn="Filters:",Sr=`${Yn}conditions`,Nv=`${Sr}.none`,sb=`${Sr}.isEmpty`,ob=`${Sr}.isNotEmpty`,ab=`${Sr}.isEqualTo`,lb=`${Sr}.isNotEqualTo`,cb=`${Sr}.beginsWith`,ub=`${Sr}.endsWith`,hb=`${Sr}.contains`,fb=`${Sr}.doesNotContain`,P7=`${Sr}.byValue`,db=`${Sr}.greaterThan`,gb=`${Sr}.greaterThanOrEqualTo`,mb=`${Sr}.lessThan`,pb=`${Sr}.lessThanOrEqualTo`,vb=`${Sr}.isBetween`,wb=`${Sr}.isNotBetween`,Cb=`${Sr}.after`,yb=`${Sr}.before`,xb=`${Sr}.today`,Sb=`${Sr}.tomorrow`,bb=`${Sr}.yesterday`,Eb=`${Yn}labels.filterByCondition`,Rb=`${Yn}labels.filterByValue`,Tb=`${Yn}labels.conjunction`,Fv=`${Yn}labels.disjunction`,bp=`${Yn}values.blankCells`,_b=`${Yn}buttons.selectAll`,Ab=`${Yn}buttons.clear`,Ib=`${Yn}buttons.ok`,Mb=`${Yn}buttons.cancel`,Ob=`${Yn}buttons.placeholder.search`,Pb=`${Yn}buttons.placeholder.value`,kb=`${Yn}buttons.placeholder.secondValue`,Nb="CheckboxRenderer:",Fb=`${Nb}checked`,Hb=`${Nb}unchecked`,k7=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:Fb,CHECKBOX_RENDERER_NAMESPACE:Nb,CHECKBOX_UNCHECKED:Hb,CONTEXTMENU_ITEMS_ADD_COMMENT:WS,CONTEXTMENU_ITEMS_ALIGNMENT:GS,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Sp,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:vp,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:Cp,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:pp,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:xp,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:wp,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:yp,CONTEXTMENU_ITEMS_BORDERS:YS,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:qS,CONTEXTMENU_ITEMS_BORDERS_LEFT:JS,CONTEXTMENU_ITEMS_BORDERS_RIGHT:XS,CONTEXTMENU_ITEMS_BORDERS_TOP:KS,CONTEXTMENU_ITEMS_CLEAR_COLUMN:PS,CONTEXTMENU_ITEMS_COPY:kS,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:HS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:FS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:NS,CONTEXTMENU_ITEMS_CUT:DS,CONTEXTMENU_ITEMS_EDIT_COMMENT:US,CONTEXTMENU_ITEMS_FREEZE_COLUMN:LS,CONTEXTMENU_ITEMS_HIDE_COLUMN:tb,CONTEXTMENU_ITEMS_HIDE_ROW:nb,CONTEXTMENU_ITEMS_INSERT_LEFT:TS,CONTEXTMENU_ITEMS_INSERT_RIGHT:_S,CONTEXTMENU_ITEMS_MERGE_CELLS:BS,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:eb,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:QS,CONTEXTMENU_ITEMS_NO_ITEMS:bS,CONTEXTMENU_ITEMS_READ_ONLY:mp,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:zS,CONTEXTMENU_ITEMS_REDO:OS,CONTEXTMENU_ITEMS_REMOVE_BORDERS:ZS,CONTEXTMENU_ITEMS_REMOVE_COLUMN:IS,CONTEXTMENU_ITEMS_REMOVE_COMMENT:jS,CONTEXTMENU_ITEMS_REMOVE_ROW:AS,CONTEXTMENU_ITEMS_ROW_ABOVE:ES,CONTEXTMENU_ITEMS_ROW_BELOW:RS,CONTEXTMENU_ITEMS_SHOW_COLUMN:rb,CONTEXTMENU_ITEMS_SHOW_ROW:ib,CONTEXTMENU_ITEMS_UNDO:MS,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:$S,CONTEXTMENU_ITEMS_UNMERGE_CELLS:VS,CONTEXT_MENU_ITEMS_NAMESPACE:xk,FILTERS_BUTTONS_CANCEL:Mb,FILTERS_BUTTONS_CLEAR:Ab,FILTERS_BUTTONS_OK:Ib,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:Ob,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:kb,FILTERS_BUTTONS_PLACEHOLDER_VALUE:Pb,FILTERS_BUTTONS_SELECT_ALL:_b,FILTERS_CONDITIONS_AFTER:Cb,FILTERS_CONDITIONS_BEFORE:yb,FILTERS_CONDITIONS_BEGINS_WITH:cb,FILTERS_CONDITIONS_BETWEEN:vb,FILTERS_CONDITIONS_BY_VALUE:P7,FILTERS_CONDITIONS_CONTAINS:hb,FILTERS_CONDITIONS_EMPTY:sb,FILTERS_CONDITIONS_ENDS_WITH:ub,FILTERS_CONDITIONS_EQUAL:ab,FILTERS_CONDITIONS_GREATER_THAN:db,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:gb,FILTERS_CONDITIONS_LESS_THAN:mb,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:pb,FILTERS_CONDITIONS_NAMESPACE:Sr,FILTERS_CONDITIONS_NONE:Nv,FILTERS_CONDITIONS_NOT_BETWEEN:wb,FILTERS_CONDITIONS_NOT_CONTAIN:fb,FILTERS_CONDITIONS_NOT_EMPTY:ob,FILTERS_CONDITIONS_NOT_EQUAL:lb,FILTERS_CONDITIONS_TODAY:xb,FILTERS_CONDITIONS_TOMORROW:Sb,FILTERS_CONDITIONS_YESTERDAY:bb,FILTERS_DIVS_FILTER_BY_CONDITION:Eb,FILTERS_DIVS_FILTER_BY_VALUE:Rb,FILTERS_LABELS_CONJUNCTION:Tb,FILTERS_LABELS_DISJUNCTION:Fv,FILTERS_NAMESPACE:Yn,FILTERS_VALUES_BLANK_CELLS:bp},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const Sk={languageCode:"en-US",[bS]:"No available options",[ES]:"Insert row above",[RS]:"Insert row below",[TS]:"Insert column left",[_S]:"Insert column right",[AS]:["Remove row","Remove rows"],[IS]:["Remove column","Remove columns"],[MS]:"Undo",[OS]:"Redo",[mp]:"Read only",[PS]:"Clear column",[GS]:"Alignment",[pp]:"Left",[vp]:"Center",[wp]:"Right",[Cp]:"Justify",[yp]:"Top",[xp]:"Middle",[Sp]:"Bottom",[LS]:"Freeze column",[$S]:"Unfreeze column",[YS]:"Borders",[KS]:"Top",[XS]:"Right",[qS]:"Bottom",[JS]:"Left",[ZS]:"Remove border(s)",[WS]:"Add comment",[US]:"Edit comment",[jS]:"Delete comment",[zS]:"Read-only comment",[BS]:"Merge cells",[VS]:"Unmerge cells",[kS]:"Copy",[NS]:["Copy with header","Copy with headers"],[FS]:["Copy with group header","Copy with group headers"],[HS]:["Copy header only","Copy headers only"],[DS]:"Cut",[QS]:"Insert child row",[eb]:"Detach from parent",[tb]:["Hide column","Hide columns"],[rb]:["Show column","Show columns"],[nb]:["Hide row","Hide rows"],[ib]:["Show row","Show rows"],[Nv]:"None",[sb]:"Is empty",[ob]:"Is not empty",[ab]:"Is equal to",[lb]:"Is not equal to",[cb]:"Begins with",[ub]:"Ends with",[hb]:"Contains",[fb]:"Does not contain",[db]:"Greater than",[gb]:"Greater than or equal to",[mb]:"Less than",[pb]:"Less than or equal to",[vb]:"Is between",[wb]:"Is not between",[Cb]:"After",[yb]:"Before",[xb]:"Today",[Sb]:"Tomorrow",[bb]:"Yesterday",[bp]:"Blank cells",[Eb]:"Filter by condition",[Rb]:"Filter by value",[Tb]:"And",[Fv]:"Or",[_b]:"Select all",[Ab]:"Clear",[Ib]:"OK",[Mb]:"Cancel",[Ob]:"Search",[Pb]:"Value",[kb]:"Second value",[Fb]:"Checked",[Hb]:"Unchecked"},N7=k7,Ay=Sk.languageCode,{register:F7,getItem:bk,hasItem:H7,getValues:D7}=Ns("languagesDictionaries");Ek(Sk);function Ek(t,e){let r=t,n=e;return dt(t)&&(n=t,r=n.languageCode),L7(r,n),F7(r,zn(n)),zn(n)}function L7(t,e){t!==Ay&&T7(e,bk(Ay))}function Rk(t){return Db(t)?zn(bk(t)):null}function Db(t){return H7(t)}function $7(){return D7()}function Tk(t,e,r){const n=Rk(t);if(n===null)return null;const i=n[e];if(tr(i))return null;const s=B7(i,r);return Array.isArray(s)?s[0]:s}function B7(t,e){let r=t;return J(O7(),n=>{r=n(t,e)}),r}function V7(t){let e=Ck(t);return Db(e)||(e=Ay,yk(t)),e}function W7(t,e,r){return(e=U7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function U7(t){var e=j7(t,"string");return typeof e=="symbol"?e:e+""}function j7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ha extends ik{constructor(e,r){super(e,null),W7(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),s=this.getNearestNotHiddenCoords(n,-1);return i===null||s===null?null:((i.row>s.row||i.col>s.col)&&(i=r,s=n),this.settings.createCellRange(i,i,s))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return s===null?null:this.settings.createCellCoords(i,s)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if((s===null||s.col===null||s.row===null)&&(o=this.getNearestNotHiddenCoords(r,n,i)),o!==null&&e.overlaps(o)){const a=e.highlight.clone();if(a.row>=0&&(a.row=o.row),a.col>=0&&(a.col=o.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&s!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function dC(t){let{activeHeaderClassName:e,...r}=t;return new ha({className:e,...r,selectionType:sk})}function z7(t){let{areaCornerVisible:e,...r}=t;return new ha({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:aS})}function G7(t){let{...e}=t;return new ha({className:"highlight",...e,selectionType:aS})}function Y7(t){let{columnClassName:e,...r}=t;return new ha({className:e,...r,selectionType:C9})}function K7(t){let{cellCornerVisible:e,...r}=t;return new ha({className:"current",headerAttributes:[Lx()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:lS})}function X7(t){let{border:e,visualCellRange:r,...n}=t;return new ha({...e,...n,selectionType:y9},r)}function q7(t){let{...e}=t;return new ha({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:v9})}function E_(t){let{headerClassName:e,...r}=t;return new ha({className:e,...r,selectionType:oS})}function J7(t){let{rowClassName:e,...r}=t;return new ha({className:e,...r,selectionType:w9})}function Z7(t,e){Q7(t,e),e.add(t)}function Q7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qn(t,e,r){return(e=ez(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ez(t){var e=tz(t,"string");return typeof e=="symbol"?e:e+""}function tz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fo(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var $s=new WeakSet;class rz{constructor(e){Z7(this,$s),qn(this,"options",void 0),qn(this,"layerLevel",0),qn(this,"focus",void 0),qn(this,"fill",void 0),qn(this,"layeredAreas",new Map),qn(this,"areas",new Map),qn(this,"rowHeaders",new Map),qn(this,"columnHeaders",new Map),qn(this,"activeRowHeaders",new Map),qn(this,"activeColumnHeaders",new Map),qn(this,"activeCornerHeaders",new Map),qn(this,"rowHighlights",new Map),qn(this,"columnHighlights",new Map),qn(this,"customSelections",[]),this.options=e,this.focus=K7(e),this.fill=q7(e)}isEnabledFor(e,r){let n=e;e===lS&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Fo($s,this,Ho).call(this,this.layeredAreas,z7)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Fo($s,this,Ho).call(this,this.areas,G7)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Fo($s,this,Ho).call(this,this.rowHeaders,E_)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Fo($s,this,Ho).call(this,this.columnHeaders,E_)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Fo($s,this,Ho).call(this,this.activeRowHeaders,dC)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Fo($s,this,Ho).call(this,this.activeColumnHeaders,dC)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Fo($s,this,Ho).call(this,this.activeCornerHeaders,dC)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Fo($s,this,Ho).call(this,this.rowHighlights,J7)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Fo($s,this,Ho).call(this,this.columnHighlights,Y7)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(X7({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),J(this.areas.values(),e=>void e.clear()),J(this.layeredAreas.values(),e=>void e.clear()),J(this.rowHeaders.values(),e=>void e.clear()),J(this.columnHeaders.values(),e=>void e.clear()),J(this.activeRowHeaders.values(),e=>void e.clear()),J(this.activeColumnHeaders.values(),e=>void e.clear()),J(this.activeCornerHeaders.values(),e=>void e.clear()),J(this.rowHighlights.values(),e=>void e.clear()),J(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Ho(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function R_(t,e,r){return(e=nz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nz(t){var e=iz(t,"string");return typeof e=="symbol"?e:e+""}function iz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sz{constructor(e){R_(this,"ranges",[]),R_(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(r=>r.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function oz(t,e){_k(t,e),e.add(t)}function gC(t,e,r){_k(t,e),e.set(t,r)}function _k(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tt(t,e){return t.get(Br(t,e))}function w0(t,e,r){return t.set(Br(t,e),r),r}function Br(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var C0=new WeakMap,Qt=new WeakMap,Rs=new WeakMap,Kr=new WeakSet;class Iy{constructor(e,r){oz(this,Kr),gC(this,C0,void 0),gC(this,Qt,void 0),gC(this,Rs,{x:0,y:0}),w0(C0,this,e),w0(Qt,this,r)}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Tt(Qt,this).createCellCoords(e,r);let s=Tt(C0,this).current().highlight;const o=Tt(Qt,this).visualToRenderableCoords(s);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),o.row!==null&&o.col!==null){const{width:c,height:u}=Br(Kr,this,Ak).call(this),{row:h,col:f}=Br(Kr,this,__).call(this,s),d=Tt(Qt,this).fixedRowsBottom(),g=Tt(Qt,this).minSpareRows(),m=Tt(Qt,this).minSpareCols(),p=Tt(Qt,this).autoWrapRow(),y=Tt(Qt,this).autoWrapCol(),S=Tt(Qt,this).createCellCoords(h+i.row,f+i.col);if(S.row>=u){const I=Ss(n&&g>0&&d===0),O=S.col+1,_=Tt(Qt,this).createCellCoords(S.row-u,O>=c?O-c:O);this.runLocalHooks("beforeColumnWrap",I,Br(Kr,this,lu).call(this,_),O>=c),I.value?this.runLocalHooks("insertRowRequire",Tt(Qt,this).countRenderableRows()):y&&S.assign(_)}else if(S.row<0){const I=Ss(y),O=S.col-1,_=Tt(Qt,this).createCellCoords(u+S.row,O<0?c+O:O);this.runLocalHooks("beforeColumnWrap",I,Br(Kr,this,lu).call(this,_),O<0),y&&S.assign(_)}if(S.col>=c){const I=Ss(n&&m>0),O=S.row+1,_=Tt(Qt,this).createCellCoords(O>=u?O-u:O,S.col-c);this.runLocalHooks("beforeRowWrap",I,Br(Kr,this,lu).call(this,_),O>=u),I.value?this.runLocalHooks("insertColRequire",Tt(Qt,this).countRenderableColumns()):p&&S.assign(_)}else if(S.col<0){const I=Ss(p),O=S.row-1,_=Tt(Qt,this).createCellCoords(O<0?u+O:O,c+S.col);this.runLocalHooks("beforeRowWrap",I,Br(Kr,this,lu).call(this,_),O<0),p&&S.assign(_)}const{rowDir:C,colDir:A}=Br(Kr,this,T_).call(this,S);a=C,l=A,s=Br(Kr,this,lu).call(this,S)}return this.runLocalHooks("afterTransformStart",s,a,l),s}transformEnd(e,r){const n=Tt(Qt,this).createCellCoords(e,r),i=Tt(C0,this).current(),s=Tt(Qt,this).visualToRenderableCoords(i.highlight),o=Br(Kr,this,mC).call(this,i.to.row,i.from.row),a=Br(Kr,this,pC).call(this,i.to.col,i.from.col),l=i.to.clone();let c=0,u=0;if(this.runLocalHooks("beforeTransformEnd",n),s.row!==null&&s.col!==null&&o!==null&&a!==null){const{row:h,col:f}=Br(Kr,this,__).call(this,i.highlight),d=Tt(Qt,this).createCellCoords(o+n.row,a+n.col),g=i.getTopStartCorner(),m=i.getTopEndCorner(),p=i.getBottomEndCorner();if(n.col<0&&a>=f&&d.col<f){const A=d.col-f;d.col=Br(Kr,this,pC).call(this,g.col,m.col)+A}else if(n.col>0&&a<=f&&d.col>f){const A=Br(Kr,this,pC).call(this,m.col,g.col),I=Math.max(d.col-A,1);d.col=A+I}if(n.row<0&&o>=h&&d.row<h){const A=d.row-h;d.row=Br(Kr,this,mC).call(this,g.row,p.row)+A}else if(n.row>0&&o<=h&&d.row>h){const A=Br(Kr,this,mC).call(this,p.row,g.row),I=Math.max(d.row-A,1);d.row=A+I}const{rowDir:y,colDir:S}=Br(Kr,this,T_).call(this,d);c=y,u=S;const C=Br(Kr,this,lu).call(this,d);n.row===0&&n.col!==0?l.col=C.col:n.row!==0&&n.col===0?l.row=C.row:(l.row=C.row,l.col=C.col)}return this.runLocalHooks("afterTransformEnd",l,c,u),l}setOffsetSize(e){let{x:r,y:n}=e;w0(Rs,this,{x:r,y:n})}resetOffsetSize(){w0(Rs,this,{x:0,y:0})}}function T_(t){const{width:e,height:r}=Br(Kr,this,Ak).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function Ak(){return{width:Tt(Rs,this).x+Tt(Qt,this).countRenderableColumns(),height:Tt(Rs,this).y+Tt(Qt,this).countRenderableRows()}}function mC(t,e){const r=Tt(Qt,this).findFirstNonHiddenRenderableRow(t,e);return r===null?null:Tt(Rs,this).y+r}function pC(t,e){const r=Tt(Qt,this).findFirstNonHiddenRenderableColumn(t,e);return r===null?null:Tt(Rs,this).x+r}function __(t){const{row:e,col:r}=Tt(Qt,this).visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return Tt(Qt,this).createCellCoords(Tt(Rs,this).y+e,Tt(Rs,this).x+r)}function lu(t){const e=t.clone();return e.col=t.col-Tt(Rs,this).x,e.row=t.row-Tt(Rs,this).y,Tt(Qt,this).renderableToVisualCoords(e)}jt(Iy,vn);const Hv=0,Dv=1,Ik=2,Lb=3,az=[Lb,Ik],lz=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],vC=Symbol("root"),A_=Symbol("child");function ch(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vC;if(e!==vC&&e!==A_)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===vC;let i=Hv;if(r){const s=t[0];t.length===0?i=Dv:n&&s instanceof fg?i=Lb:n&&Array.isArray(s)?i=ch(s,A_):t.length>=2&&t.length<=4&&!t.some((a,l)=>!lz[l].includes(typeof a))&&(i=Ik)}return i}function Ad(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!az.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const o=t===Lb;let a=o?s.from.row:s[0],l=o?s.from.col:s[1],c=o?s.to.row:s[2],u=o?s.to.col:s[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof u=="string"&&(u=i(u))),tr(c)&&(c=a),tr(u)&&(u=l),!n){const d=a,g=l,m=c,p=u;a=Math.min(d,m),l=Math.min(g,p),c=Math.max(d,m),u=Math.max(g,p)}const h=e(a,l),f=e(c,u);return r(h,h,f)}}function cz(t){const e=ch(t.getSelected());if(e===Hv||e===Dv)return[];const r=Ad(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;J(t.getSelected(),o=>{const{from:a,to:l}=r(o),c=Math.max(a.col,0),u=l.col-c+1;J(Array.from(new Array(u),(h,f)=>c+f),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((o,a)=>o-a);return Gn(i,(o,a,l,c)=>(l!==0&&a===c[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function uz(t){const e=ch(t.getSelected());if(e===Hv||e===Dv)return[];const r=Ad(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;J(t.getSelected(),o=>{const{from:a,to:l}=r(o),c=Math.max(a.row,0),u=l.row-c+1;J(Array.from(new Array(u),(h,f)=>c+f),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((o,a)=>o-a);return Gn(i,(o,a,l,c)=>(l!==0&&a===c[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function cu(t,e,r){hz(t,e),e.set(t,r)}function hz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _l(t,e,r){return(e=fz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fz(t){var e=dz(t,"string");return typeof e=="symbol"?e:e+""}function dz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ir(t,e){return t.get(Mk(t,e))}function Bs(t,e,r){return t.set(Mk(t,e),r),r}function Mk(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Cn=new WeakMap,Al=new WeakMap,y0=new WeakMap,ef=new WeakMap,x0=new WeakMap,tf=new WeakMap;class Ok{constructor(e,r){var n=this;_l(this,"settings",void 0),_l(this,"tableProps",void 0),_l(this,"inProgress",!1),_l(this,"selectedRange",new sz((i,s,o)=>this.tableProps.createCellRange(i,s,o))),_l(this,"highlight",void 0),cu(this,Cn,void 0),cu(this,Al,void 0),_l(this,"selectedByRowHeader",new Set),_l(this,"selectedByColumnHeader",new Set),cu(this,y0,!1),cu(this,ef,!1),cu(this,x0,"unknown"),cu(this,tf,-1),this.settings=e,this.tableProps=r,this.highlight=new rz({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[Lx()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,s)=>this.tableProps.isDisabledCellSelection(i,s),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),createCellRange:(i,s,o)=>this.tableProps.createCellRange(i,s,o)}),Bs(Cn,this,new Iy(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Bs(Al,this,new Iy(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),ir(Cn,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformStart",...s)}),ir(Cn,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformStart",...s)}),ir(Cn,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformEnd",...s)}),ir(Cn,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformEnd",...s)}),ir(Cn,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("insertRowRequire",...s)}),ir(Cn,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("insertColRequire",...s)}),ir(Cn,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeRowWrap",...s)}),ir(Cn,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeColumnWrap",...s)}),ir(Al,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformFocus",...s)}),ir(Al,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}markSource(e){Bs(x0,this,e)}markEndSource(){Bs(x0,this,"unknown")}getSelectionSource(){return ir(x0,this)}setExpectedLayers(e){Bs(tf,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Bs(tf,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",o=tr(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.clone();Bs(y0,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!s||s&&!o&&tr(r))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const r=e.clone(),n=this.tableProps.countRows(),i=this.tableProps.countCols(),s=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||i>0)&&(n===0&&r.col<0&&!s||i===0&&r.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),this.settings.selectionMode==="single")o.setFrom(o.highlight),o.setTo(o.highlight);else{const l=o.getHorizontalDirection(),c=o.getVerticalDirection(),u=this.isMultiple();o.setTo(r),u&&(l!==o.getHorizontalDirection()||o.getWidth()===1&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),u&&(c!==o.getVerticalDirection()||o.getHeight()===1&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}n>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=ir(tf,this)===-1||this.selectedRange.size()===ir(tf,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();r<this.highlight.layerLevel&&(J(this.highlight.getAreas(),g=>void g.clear()),J(this.highlight.getLayeredAreas(),g=>void g.clear()),J(this.highlight.getRowHeaders(),g=>void g.clear()),J(this.highlight.getColumnHeaders(),g=>void g.clear()),J(this.highlight.getActiveRowHeaders(),g=>void g.clear()),J(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),J(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),J(this.highlight.getRowHighlights(),g=>void g.clear()),J(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(r);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),d=this.highlight.createColumnHighlight();if(s.clear(),o.clear(),a.clear(),l.clear(),c.clear(),u.clear(),h.clear(),f.clear(),d.clear(),this.highlight.isEnabledFor(aS,e.highlight)&&(this.isMultiple()||r>=1)&&(s.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),r===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(oS,e.highlight)){if(!e.isSingleHeader()){const p=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),y=this.tableProps.createCellCoords(e.to.row,-1),S=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),C=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(p).commit(),l.add(S).commit(),f.add(p).commit(),d.add(S).commit()):(a.add(p).add(y).commit(),l.add(S).add(C).commit(),f.add(p).add(y).commit(),d.add(S).add(C).commit())}const g=!ir(ef,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),m=!ir(ef,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());g&&c.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),m&&u.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&m&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const r=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const n=this.highlight.getFocus();n.clear(),r.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(lS,r.highlight)&&n.add(r.highlight).commit().syncWith(r),this.inProgress||(Bs(y0,this,!0),this.runLocalHooks("afterSetFocus",r.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?ir(Cn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):ir(Cn,this).resetOffsetSize(),this.setRangeStart(ir(Cn,this).transformStart(e,r,n))}transformEnd(e,r){this.settings.navigableHeaders?ir(Cn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):ir(Cn,this).resetOffsetSize(),this.setRangeEnd(ir(Cn,this).transformEnd(e,r))}transformFocus(e,r){const n=this.selectedRange.current(),{row:i,col:s}=n.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,s-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);n.highlight.isHeader()?ir(Al,this).setOffsetSize({x:s<0?Math.abs(s):-o,y:i<0?Math.abs(i):-a}):ir(Al,this).setOffsetSize({x:s<0?0:-o,y:i<0?0:-a});const l=ir(Al,this).transformStart(e,r);this.setRangeFocus(l.normalize())}shiftRows(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:i,to:s,highlight:o}=n,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),c=this.isSelectedByColumnHeader(),u=c?-1:0,h=c?0:r;this.getSelectedRange().pop();const f=this.tableProps.createCellCoords($t(i.row+h,u,a-1),i.col),d=this.tableProps.createCellCoords($t(s.row+r,u,a-1),s.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(f,!0,this.tableProps.createCellCoords($t(o.row+r,0,a-1),o.col)):this.setRangeStartOnly(f,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),c&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:i,to:s,highlight:o}=n,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),c=this.isSelectedByColumnHeader(),u=l?-1:0,h=l?0:r;this.getSelectedRange().pop();const f=this.tableProps.createCellCoords(i.row,$t(i.col+h,u,a-1)),d=this.tableProps.createCellCoords(s.row,$t(s.col+r,u,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(f,!0,this.tableProps.createCellCoords(o.row,$t(o.col+r,0,a-1))):this.setRangeStartOnly(f,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),c&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Ss(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&ir(y0,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:s}=i.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(o>0&&s<0||o===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:s}=i.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(o>0&&s<0||o===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),c=n?-l:0,u=r?-a:0;if(c===0&&u===0&&(s===0||o===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:f,disableHeadersHighlight:d}=i;Bs(ef,this,d),f&&Number.isInteger(f==null?void 0:f.row)&&Number.isInteger(f==null?void 0:f.col)&&(h=this.tableProps.createCellCoords($t(f.row,c,s-1),$t(f.col,u,o-1)));const g=this.tableProps.createCellCoords(c,u),m=this.tableProps.createCellCoords(s-1,o-1);this.clear(),this.setRangeStartOnly(g,void 0,h),u<0&&this.selectedByRowHeader.add(this.getLayerLevel()),c<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(m),this.finish(),Bs(ef,this,!1)}selectCells(e){var r=this;const n=ch(e);if(n===Dv)return!1;if(n===Hv)throw new Error(Ht`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Ad(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),s=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},a=!e.some(l=>{const c=i(l),u=c.isValid(o);return!(u&&!c.containsHeaders()||u&&c.containsHeaders()&&c.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),J(e,l=>{const{from:c,to:u}=i(l);this.setRangeStartOnly(c.clone(),!1),this.setRangeEnd(u.clone())}),this.finish()),a}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof r=="string"?this.tableProps.propToCol(r):r,o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),c=l===0?0:-l,u=this.tableProps.createCellCoords(c,i),h=this.tableProps.createCellCoords(o-1,s),f=this.tableProps.createCellRange(u,u,h).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:l});if(f){let d=0,g=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(d=$t(n.row,c,o-1),g=$t(n.col,Math.min(i,s),Math.max(i,s))):(d=$t(n,c,o-1),g=i);const m=this.tableProps.createCellCoords(d,g),p=l===0?0:$t(m.row,c,-1),y=o-1,S=this.tableProps.createCellCoords(p,i),C=this.tableProps.createCellCoords(y,s);this.runLocalHooks("beforeSelectColumns",S,C,m),S.row=p,C.row=y,this.setRangeStartOnly(S,void 0,m),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(C),this.runLocalHooks("afterSelectColumns",S,C,m),this.finish()}return f}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=o===0?0:-o,l=this.tableProps.createCellCoords(e,a),c=this.tableProps.createCellCoords(r,s-1),u=this.tableProps.createCellRange(l,l,c).isValid({countRows:i,countCols:s,countRowHeaders:o,countColHeaders:0});if(u){let h=0,f=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(h=$t(n.row,Math.min(e,r),Math.max(e,r)),f=$t(n.col,a,s-1)):(h=e,f=$t(n,a,s-1));const d=this.tableProps.createCellCoords(h,f),g=o===0?0:$t(d.col,a,-1),m=s-1,p=this.tableProps.createCellCoords(e,g),y=this.tableProps.createCellCoords(r,m);this.runLocalHooks("beforeSelectRows",p,y,d),p.col=g,y.col=m,this.setRangeStartOnly(p,void 0,d),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.runLocalHooks("afterSelectRows",p,y,d),this.finish()}return u}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const n=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:s,highlight:o}=n;this.clear(),o.assign({row:$t(o.row,-1/0,e-1),col:$t(o.col,-1/0,r-1)}),i.assign({row:$t(i.row,-1/0,e-1),col:$t(i.col,-1/0,r-1)}),s.assign({row:$t(s.row,0,e-1),col:$t(s.col,0,r-1)}),this.selectedRange.ranges.push(n),this.highlight.getFocus().add(o).commit().syncWith(n),this.applyAndCommit(n)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.highlight.getFocus(),n=this.getLayerLevel();r.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),d=this.highlight.createColumnHighlight();s.commit(),o.commit(),a.commit(),l.commit(),c.commit(),u.commit(),h.commit(),f.commit(),d.commit()}this.highlight.useLayerLevel(n)}}jt(Ok,vn);const I_=/^(\r\n|\n\r|\r|\n)/,gz=/^[^\t\r\n]+/,M_=/^\t/;function mz(t){const e=[[""]];if(t.length===0)return e;let r=0,n=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(M_))t=t.replace(M_,""),r+=1,e[n][r]="";else if(t.match(I_))t=t.replace(I_,""),r=0,n+=1,e[n]=[""];else{let s="";if(t.startsWith('"')){let o=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(o+=1),s+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&o%2===0)&&(a=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const o=t.match(gz);s=o?o[0]:"",t=t.slice(s.length)}e[n][r]=s}return e}function Xf(t){let e,r,n,i,s="",o;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(s+="	"),o=t[e][n],typeof o=="string"?o.indexOf(`
`)>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:o==null?s+="":s+=o;e!==r-1&&(s+=`
`)}return s}function Il(t,e,r){return(e=pz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pz(t){var e=vz(t,"string");return typeof e=="symbol"?e:e+""}function vz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gu{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){Il(this,"hot",void 0),Il(this,"metaManager",void 0),Il(this,"tableMeta",void 0),Il(this,"dataSource",void 0),Il(this,"duckSchema",void 0),Il(this,"colToPropCache",void 0),Il(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,s=0,o=!1;if(typeof r=="function"){const a=jx(e);i=a>0?a:this.countFirstRowKeys(),o=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,r.length)}for(n=0;n<i;n++){const a=o?r(n):r[n];if(dt(a)){if(typeof a.data<"u"){const l=o?s:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return dk(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,s=n,o;return typeof i>"u"&&(i=0,s=""),typeof e=="object"&&!Array.isArray(e)&&gt(e,(a,l)=>{a===null?(o=s+l,this.colToPropCache.push(o),this.propToColCache.set(o,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&Ue(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(Ue(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Rd(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let o=s,a=0,l=e;if((typeof l!="number"||l>=s)&&(l=s),l<this.hot.countRows()&&(o=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,r,n)===!1||o===null)return{delta:0};const u=this.tableMeta.maxRows,h=this.getSchema().length,f=[];for(;a<r&&s+a<u;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=zn(this.getSchema()):(g=[],Ge(h-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},_v(g,this.getSchema())),f.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(o=Math.min(o+1,s)),this.spliceData(o,0,f);const d=this.hot.toVisualRow(o);return this.hot.countSourceRows()===f.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(o,r)),this.hot.runHooks("afterCreateRow",d,a,n),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:o}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,r,n)===!1)return{delta:0};let u=a;l<this.hot.countCols()&&(u=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let f=this.hot.countCols(),d=0,g=u;i==="end"&&(g=Math.min(g+1,a));const m=g;for(;d<r&&f<o;){if(typeof l!="number"||l>=f)if(h>0)for(let y=0;y<h;y+=1)typeof s[y]>"u"&&(s[y]=[]),s[y].push(null);else s.push([null]);else for(let y=0;y<h;y++)s[y].splice(g,0,null);d+=1,g+=1,f+=1}this.hot.columnIndexMapper.insertIndexes(l,d),d>0&&(e==null?this.metaManager.createColumn(null,d):n!=="auto"&&this.metaManager.createColumn(m,r));const p=this.hot.toVisualColumn(m);return this.hot.runHooks("afterCreateCol",p,d,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:d,startPhysicalIndex:m}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const s=this.visualRowsToPhysical(i,r),o=this.hot.countSourceRows();if(i=(o+i)%o,this.hot.runHooks("beforeRemoveRow",i,s.length,s,n)===!1)return!1;const l=s.length;if(this.filterData(i,l,s),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const u=Ue(this.tableMeta.columns)||Ue(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&u===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((u,h)=>h-u).forEach(u=>{this.metaManager.removeRow(u,1)}),this.hot.runHooks("afterRemoveRow",i,l,s,n),this.hot.forceFullRender=!0,!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const s=this.visualColumnsToPhysical(i,r),o=s.slice(0).sort((h,f)=>f-h);if(this.hot.runHooks("beforeRemoveCol",i,r,s,n)===!1)return!1;let l=!0;const c=o.length,u=this.dataSource;for(let h=0;h<c;h++)l&&s[0]!==s[h]-h&&(l=!1);if(l)for(let h=0,f=this.hot.countSourceRows();h<f;h++)u[h].splice(s[0],r),h===0&&this.metaManager.removeColumn(s[0],r);else for(let h=0,f=this.hot.countSourceRows();h<f;h++)for(let d=0;d<c;d++)u[h].splice(o[d],1),h===0&&this.metaManager.removeColumn(o[d],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,s,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),s=i.slice(r,r+n),o=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),c=3;c<a;c++)l[c-3]=arguments[c];mT(l,o);let u=0;for(;u<n;)l.push(null),u+=1;return e8(l),this.hot.populateFromArray(r,e,l,null,null,"spliceCol"),s}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),s=i.slice(r,r+n),o=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),c=3;c<a;c++)l[c-3]=arguments[c];mT(l,o);let u=0;for(;u<n;)l.push(null),u+=1;return this.hot.populateFromArray(e,r,[l],null,null,"spliceRow"),s}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const s=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(o=>this.dataSource.push(o))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((s,o)=>n.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const s=this.hot.runHooks("modifyRowData",n);i=isNaN(s)?s:i;const{dataDotNotation:o}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Cr(i,r))a=i[r];else if(o&&typeof r=="string"&&r.indexOf(".")>-1){let l=i;if(!l)return null;const c=r.split(".");for(let u=0,h=c.length;u<h;u++)if(l=l[c[u]],typeof l>"u")return null;a=l}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const l=Ss(a);this.hot.runHooks("modifyData",n,this.propToCol(r),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let s=n,o=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){const c=Ss(s);this.hot.runHooks("modifyData",i,this.propToCol(r),c,"set"),c.isTouched()&&(s=c.value)}const{dataDotNotation:l}=this.hot.getSettings();if(o&&o.hasOwnProperty&&Cr(o,r))o[r]=s;else if(l&&typeof r=="string"&&r.indexOf(".")>-1){let c=o,u=0,h;const f=r.split(".");for(u=0,h=f.length-1;u<h;u++)typeof c[f[u]]>"u"&&(c[f[u]]={}),c=c[f[u]];c[f[u]]=s}else typeof r=="function"?r(this.dataSource.slice(i,i+1)[0],s):o[r]=s}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let s=(n+e)%n,o=r,a;for(;s<n&&o;)a=this.hot.toPhysicalRow(s),i.push(a),o-=1,s+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let s=(n+e)%n,o=r;for(;s<n&&o;){const a=this.hot.toPhysicalColumn(s);i.push(a),o-=1,s+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,Gu.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let s,o,a;const l=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(l===0||c===0)return[];const u=n===Gu.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),f=Math.min(Math.max(c-1,0),Math.max(e.col,r.col));for(s=Math.min(e.row,r.row);s<=h;s++){a=[];const d=s>=0?this.hot.toPhysicalRow(s):s;for(o=Math.min(e.col,r.col);o<=f&&d!==null;o++)a.push(u.call(this,s,this.colToProp(o)));d!==null&&i.push(a)}return i}getText(e,r){return Xf(this.getRange(e,r,Gu.DESTINATION_RENDERER))}getCopyableText(e,r){return Xf(this.getRange(e,r,Gu.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:wz,getItem:Cz,hasItem:Pk,getNames:A1e,getValues:I1e}=Ns("cellTypes");function yz(t){if(!Pk(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Cz(t)}function gs(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&mi(t,r),n&&Hi(t,n),i&&Lu(t,i),wz(t,e)}function xz(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!Cr(e,t)}function Lv(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?yz(e.type):e.type;if(t._automaticallyAssignedMetaProps&&gt(e,(s,o)=>void t._automaticallyAssignedMetaProps.delete(o)),!dt(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};gt(n,(s,o)=>{if(xz(o,r)){var a;i[o]=s,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),Ur(t,i)}function Sz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Eo(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function jm(t){return Number.isInteger(t)&&t>=0}function zm(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function S0(t){return t==null}const kk=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),_r(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),_r(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),Ux(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function O_(t,e,r){return(e=bz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bz(t){var e=Ez(t,"string");return typeof e=="symbol"?e:e+""}function Ez(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rz(){return class{}}class Tz{constructor(e){O_(this,"metaCtor",Rz()),O_(this,"meta",void 0),this.meta=this.metaCtor.prototype,Ur(this.meta,kk()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;Ur(this.meta,e),Lv(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function _z(t,e,r){return(e=Az(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Az(t){var e=Iz(t,"string");return typeof e=="symbol"?e:e+""}function Iz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mz{constructor(e){_z(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){Ur(this.meta,e),Lv(this.meta,e,e)}}function b0(t,e,r){return(e=Oz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Oz(t){var e=Pz(t,"string");return typeof e=="symbol"?e:e+""}function Pz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ep{constructor(e){b0(this,"valueFactory",void 0),b0(this,"data",[]),b0(this,"index",[]),b0(this,"holes",new Set),this.valueFactory=e}obtain(e){zm(()=>jm(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;zm(()=>jm(e)||S0(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let o=0;o<r;o++)n.push(i+o),this.data.push(void 0);const s=S0(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...n,...this.index.slice(s)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;zm(()=>jm(e)||S0(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(S0(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const s=n[i];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return rl(this.data,(e,r)=>!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function P_(t,e,r){return(e=kz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kz(t){var e=Nz(t,"string");return typeof e=="symbol"?e:e+""}function Nz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Fz=["data","width"];class Hz{constructor(e){P_(this,"globalMeta",void 0),P_(this,"metas",new Ep(()=>this._createMeta())),this.globalMeta=e,this.metas=new Ep(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);Ur(n,r),Lv(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return Sz(this.globalMeta.getMetaConstructor(),Fz).prototype}}function k_(t,e,r){return(e=Dz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Dz(t){var e=Lz(t,"string");return typeof e=="symbol"?e:e+""}function Lz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $z{constructor(e){k_(this,"columnMeta",void 0),k_(this,"metas",new Ep(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);Ur(i,n),Lv(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var s;const o=this.metas.obtain(e).obtain(r);(s=o._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(n),o[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)Ue(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){zm(()=>jm(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Ep(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class Nk{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new Tz(e),this.tableMeta=new Mz(this.globalMeta),this.columnMeta=new Hz(this.globalMeta),this.cellMeta=new $z(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){let{visualRow:i,visualColumn:s}=n;const o=this.cellMeta.getMeta(e,r);return o.visualRow=i,o.visualCol=s,o.row=e,o.col=r,this.runLocalHooks("afterGetCellMeta",o),o}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}jt(Nk,vn);function N_(t,e,r,n){const{hotInstance:i,dataMap:s,dataSource:o,internalSource:a,source:l,metaManager:c,firstRun:u}=n,h=Is(a),f=i.getSettings();Array.isArray(f.dataSchema)?i.dataType="array":er(f.dataSchema)?i.dataType="function":i.dataType="object",s&&s.destroy(),t=i.runHooks(`before${h}`,t,u,l);const d=new Gu(i,t,c);if(e(d),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=d.getSchema();t=[];let m,p=0,y=0;for(p=0,y=f.startRows;p<y;p++)if((i.dataType==="object"||i.dataType==="function")&&f.dataSchema)m=zn(g),t.push(m);else if(i.dataType==="array")m=zn(g[0]),t.push(m);else{m=[];for(let S=0,C=f.startCols;S<C;S++)m.push(null);t.push(m)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),f.data=t,d.dataSource=t,o.data=t,o.dataType=i.dataType,o.colToProp=d.colToProp.bind(d),o.propToCol=d.propToCol.bind(d),o.countCachedColumns=d.countCachedColumns.bind(d),r(d),i.runHooks(`after${h}`,t,u,l),u||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Ze(i.rootElement,[aP(-1),Ev(i.countCols()+(i.view?i.countRowHeaders():0))])}function F_(t,e,r){return(e=Bz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bz(t){var e=Vz(t,"string");return typeof e=="symbol"?e:e+""}function Vz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wz{constructor(e){F_(this,"metaManager",void 0),F_(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",r=>this.extendCellMeta(r)),We.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:s,visualCol:o}=e,a=this.metaManager.hot,l=a.colToProp(o);e.prop=l,a.runHooks("beforeGetCellMeta",s,o,e);const c=Cr(e,"type")?e.type:null;let u=er(e.cells)?e.cells(n,i,l):null;if(c)if(u){var h;u.type=(h=u.type)!==null&&h!==void 0?h:c}else u={type:c};u&&this.metaManager.updateCellMeta(n,i,u),a.runHooks("afterGetCellMeta",s,o,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function Uz(t,e,r){jz(t,e),e.set(t,r)}function jz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wC(t,e,r){return(e=zz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zz(t){var e=Gz(t,"string");return typeof e=="symbol"?e:e+""}function Gz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yz(t,e){return t.get(Kz(t,e))}function Kz(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var H_=new WeakMap;class Xz{constructor(e){wC(this,"metaManager",void 0),wC(this,"usageTracker",new Set),wC(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),Uz(this,H_,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:n,target:i,onChange:s}=e,o=typeof i=="string",a=o?i:r,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],s?(this.installPropWatcher(r,l,s),o&&this.installPropWatcher(i,l,s)):n&&(this.installPropWatcher(r,l,Yz(H_,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(s){const o=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,s,o),this[r]=s},enumerable:!0,configurable:!0})}}const Fk="gridDefault",dl="editorManager.handlingEditor",qz={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},Jz="hooksRefRegisterer",Hk={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){J(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){gt(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};ua(Hk,"MIXIN_NAME",Jz,{writable:!1,enumerable:!1});function ls(t,e,r){return(e=Zz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zz(t){var e=Qz(t,"string");return typeof e=="symbol"?e:e+""}function Qz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const eG="base",Er=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class bh{static get EDITOR_TYPE(){return eG}constructor(e){ls(this,"hot",void 0),ls(this,"state",Er.VIRGIN),ls(this,"_opened",!1),ls(this,"_fullEditMode",!1),ls(this,"_closeCallback",null),ls(this,"TD",null),ls(this,"row",null),ls(this,"col",null),ls(this,"prop",null),ls(this,"originalValue",null),ls(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,s,o){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=s,this.cellProperties=o,this.state=this.isOpened()?this.state:Er.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,s,o;if(r){const l=this.hot.getSelectedLast();n=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),s=Math.max(l[0],l[2]),o=Math.max(l[1],l[3])}else[n,i,s,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,i);Array.isArray(a)&&([n,i]=a),this.hot.populateFromArray(n,i,e,s,o,"edit")}beginEditing(e,r){if(this.state!==Er.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(i,s)),this.state=Er.EDITING,this.isInFullEditMode()){const o=typeof e=="string"?e:Nr(this.originalValue);this.setValue(o)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,r,n){let i;if(n){const s=this._closeCallback;this._closeCallback=o=>{s&&s(o),n(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Er.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Er.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:i=[[s]],this.state=Er.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=Er.FINISHED,this.discardEditor(o)}):(this.state=Er.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Er.FINISHED,this.discardEditor()}discardEditor(e){this.state===Er.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Er.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Er.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Er.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,s=this.hot.rootWindow,o=sn(r),a=rr(r),l=sn(this.hot.rootElement),c=rr(this.hot.rootElement),u=n.topOverlay.holder,h=n.inlineStartOverlay.holder,f=u!==s?u.scrollTop:0,d=h!==s?h.scrollLeft:0,g=s.innerWidth-l.left-c,{wtTable:m}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,p=m.name,y=["master","inline_start"].includes(p)?f:0,S=["master","top","bottom"].includes(p)?d:0,C=o.top===l.top?0:1;let A=o.top-l.top-C-y,I=0;this.hot.isRtl()?I=s.innerWidth-o.left-a-g-1+S:I=o.left-l.left-1-S,["top","top_inline_start_corner"].includes(p)&&(A+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(p)&&(I+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const O=this.hot.hasColHeaders(),_=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),E=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),k=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(O&&_<=0||_===k)&&(A+=1),E<=0&&(I+=1);const B=i.rowsRenderCalculator.startPosition,N=i.columnsRenderCalculator.startPosition,q=Math.abs(n.inlineStartOverlay.getScrollPosition()),ue=n.topOverlay.getScrollPosition(),we=ln(this.hot.rootDocument);let Se=r.offsetTop;if(["inline_start","master"].includes(p)&&(Se+=B-ue),["bottom","bottom_inline_start_corner"].includes(p)){const{wtViewport:Q,wtTable:Z}=n.bottomOverlay.clone;Se+=Q.getWorkspaceHeight()-Z.getHeight()-we}let ce=r.offsetLeft;this.hot.isRtl()?(ce>=0?ce=m.getWidth()-r.offsetLeft:ce=Math.abs(ce),ce+=N-q-a):["top","master","bottom"].includes(p)&&(ce+=N-q);const Re=sa(this.TD,this.hot.rootWindow),Y=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Pe=parseInt(Re[Y],10)>0?0:1,w=parseInt(Re.borderTopWidth,10)>0?0:1,v=rr(r)+Pe,x=Fr(r)+w,R=L8(u)?we:0,T=$8(h)?we:0,L=this.hot.view.maximumVisibleElementWidth(ce)-R+Pe,K=Math.max(this.hot.view.maximumVisibleElementHeight(Se)-T+w,23);return{top:A,start:I,height:x,maxHeight:K,width:v,maxWidth:L}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}jt(bh,Hk);const tG={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===Er.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},rG={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},nG={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},iG={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeLast();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},sG={name:"editorOpen",callback(t,e,r){const n=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:s}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const o=t.getSettings(),a=typeof o.enterMoves=="function"?o.enterMoves(e):o.enterMoves;r.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}s.isHeader()||(t.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter(e):n.openEditor(null,e,!0):n.moveSelectionAfterEnter(e),ks(e))}};function oG(){return[qz,tG,rG,nG,iG,sG]}const aG={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},lG={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),r=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),n=t.rowIndexMapper.getNearestNotHiddenIndex(r,-1);if(n!==null){const i=t._createCellCoords(n,e.col),s=e.row-t.view.getFirstFullyVisibleRow(),o=Math.min(i.row-s,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},cG={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},uG={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},hG={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:r,to:n}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(r.col,n.col,e)}},fG={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&t.selection.isSelectedByRowHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=n.row,e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col))}}},dG={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&n.isCell()){const o=r.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=n.col,e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(s.row,o))}}},gG={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&n.isCell()){const o=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(o,1),l=i.clone();l.col=n.col,e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},mG={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&t.selection.isSelectedByColumnHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=n.col,e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},pG={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&t.selection.isSelectedByColumnHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=n.col,e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},vG={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&t.selection.isSelectedByRowHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=n.row,e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col))}}},wG={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:r,to:n}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(r.row,n.row,e)}},CG={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},yG={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),r=Math.max(e.row-t.countVisibleRows(),0),n=t.rowIndexMapper.getNearestNotHiddenIndex(r,1);if(n!==null){const i=t._createCellCoords(n,e.col),s=e.row-t.view.getFirstFullyVisibleRow(),o=Math.max(i.row-s,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}};function xG(){return[aG,lG,cG,uG,hG,fG,dG,gG,mG,pG,vG,wG,CG,yG]}const SG={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},bG={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),r=e?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+r;n===t.countRows()-1?i=1:n+i>t.countRows()&&(i=t.countRows()-n-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},EG={name:"moveCellSelectionInlineEnd",callback(t,e){const r=t.getSettings(),n=t.getSelectedRangeLast(),i=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;t.selection.isMultiple()&&!n.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-i.row,-i.col):t.selection.transformStart(-i.row,-i.col)}},RG={name:"moveCellSelectionInlineStart",callback(t,e){const r=t.getSettings(),n=t.getSelectedRangeLast(),i=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;t.selection.isMultiple()&&!n.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(i.row,i.col):t.selection.transformStart(i.row,i.col)}},TG={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},_G={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},AG={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),t.selection.setRangeStart(t._createCellCoords(r,e))}},IG={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),s=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),o=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(s,o))}},MG={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},OG={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,s=r.getNearestNotHiddenIndex(n,1);e.setRangeStart(t._createCellCoords(i,s))}},PG={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeLast().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(n,i))}},kG={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeLast().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(n,i))}},NG={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(r,e))}},FG={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),s=parseInt(t.getSettings().fixedColumnsStart,10),o=r.getNearestNotHiddenIndex(i,1),a=n.getNearestNotHiddenIndex(s,1);e.setRangeStart(t._createCellCoords(o,a))}},HG={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},DG={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),r=e?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+r);n===-r?i=-1:n+i<r&&(i=-(n+r)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function LG(){return[SG,bG,EG,RG,TG,_G,AG,IG,MG,OG,PG,kG,NG,FG,HG,DG]}const $G={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},BG={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),r=t.view.getFirstFullyVisibleRow()-1,n=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,s=t.view.getLastFullyVisibleColumn()+1,o=t._createCellCoords(r,n),a=t._createCellCoords(i,s);if(!t._createCellRange(o,o,a).includes(e)&&(e.row>=0||e.col>=0)){const c={};if(e.col>=0){const u=Math.floor(t.countVisibleCols()/2);c.col=Math.max(e.col-u,0)}if(e.row>=0){const u=Math.floor(t.countVisibleRows()/2);c.row=Math.max(e.row-u,0)}t.scrollViewportTo({...c,verticalSnap:"top",horizontalSnap:"start"})}}},VG={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},WG={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},UG={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),s=new Map;for(let o=0;o<e.length;o++)e[o].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==r||l!==n)){const{readOnly:c}=t.getCellMeta(a,l);c||s.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(s.values()))}},jG=[...oG(),...xG(),...LG(),$G,BG,VG,WG,UG];function Dk(t){const e={};return jG.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return i(t,...o)}}),e}function zG(t){const e=t.getShortcutManager().addContext("editor"),r=Dk(t),n={group:dl};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>r.editorCloseAndSaveByEnter(i,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,s)=>r.editorCloseAndSaveByEnter(i,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,s)=>r.editorCloseAndSave(i,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,s)=>r.editorCloseAndSaveByArrowKeys(i,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function GG(t){const e=t.getShortcutManager().addContext("grid"),r=Dk(t),n={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return Ue(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:Fk};e.addShortcuts([{keys:[["F2"]],callback:i=>r.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>r.editorOpen(i,s)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:dl,runOnlyIf:()=>Ue(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var i,s;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((s=t.getSelectedRangeLast())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}function YG(t){[GG,zG].forEach(e=>e(t))}function KG(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=t.rootElement,n=D_(t),i=D_(t);return n.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),r.firstChild.before(n),r.lastChild.after(i),{activate(){t._registerTimeout(()=>{n.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{n.tabIndex=-1,i.tabIndex=-1},10)}}}function D_(t){const r=t.rootDocument.createElement("input");return r.type="text",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Ze(r,[go(),Wc()]),r}function XG(t){const e=qG(t);let r;const{activate:n,deactivate:i}=KG(t,{onFocusFromTop(){var h;const f=(h=e(r))!==null&&h!==void 0?h:My(t);f&&(t.runHooks("modifyFocusOnTabNavigation","from_above",f),t.selectCell(f.row,f.col)),t.listen()},onFocusFromBottom(){var h;const f=(h=e(r))!==null&&h!==void 0?h:Oy(t);f&&(t.runHooks("modifyFocusOnTabNavigation","from_below",f),t.selectCell(f.row,f.col)),t.listen()}}),s={wrapped:!1,flipped:!1};let o=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(h,f,d,g,m)=>{if(a&&(s.wrapped&&s.flipped||l)&&(l=!1,m.value=!0),o){var p;r=(p=t.getSelectedRangeLast())===null||p===void 0?void 0:p.highlight}}),t.addHook("beforeRowWrap",(h,f,d)=>{s.wrapped=!0,s.flipped=d});function c(){s.wrapped=!1,s.flipped=!1,t.deselectCell(),t.unlisten()}const u={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Fk,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...u,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(o=!1),h||(l=!0)},position:"before"},{...u,callback:h=>{const{tabNavigation:f,autoWrapRow:d}=t.getSettings();if(a=!1,o=!0,!f||!t.selection.isSelected()||d&&s.wrapped&&s.flipped||!d&&s.wrapped)return d&&s.wrapped&&s.flipped&&(r=h.shiftKey?My(t):Oy(t)),c(),!1;h.preventDefault()},position:"after"}])}function My(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,s=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),s===0&&(s=r.getVisualFromRenderableIndex(s)),i===null||s===null?null:t._createCellCoords(i,s)}function Oy(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:s}=t.getSettings();let o=n.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(o<0){if(!s||t.countColHeaders()===0)return null;o=-1}if(a<0){if(!s||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(r=i.getVisualFromRenderableIndex(a))!==null&&r!==void 0?r:a)}function qG(t){return e=>{if(!e)return null;const r=My(t),n=Oy(t);return e.col<r.col&&(e.col=r.col),e.col>n.col&&(e.col=n.col),e.row<r.row&&(e.row=r.row),e.row>n.row&&(e.row=n.row),e}}function JG(t){return e=>{let{col:r}=e;t.scrollViewportTo({col:r})}}function ZG(){return()=>{}}function QG(t){return e=>{t.scrollViewportTo(e.toObject())}}function eY(t){return e=>{t.scrollViewportTo(e.toObject())}}function tY(t){return e=>{t.scrollViewportTo(e.toObject())}}function rY(t){return e=>{let{row:r}=e;t.scrollViewportTo({row:r})}}function nY(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e;if(n<0&&i>=0)t.scrollViewportTo({col:i});else if(i<0&&n>=0)t.scrollViewportTo({row:n});else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i})}}}function iY(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var s;if(r||n){r=!1;return}let o;e.isFocusSelectionChanged()?o=QG(t):e.isSelectedByCorner()?o=ZG():e.isSelectedByRowHeader()?o=rY(t):e.isSelectedByColumnHeader()?o=JG(t):e.getSelectedRange().size()===1&&e.isMultiple()?o=eY(t):e.getSelectedRange().size()===1&&!e.isMultiple()?o=nY(t):e.getSelectedRange().size()>1&&(o=tY(t)),(s=o)===null||s===void 0||s(i)}}}const L_=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),E0=t=>t.map(e=>{const r=e.toLowerCase();return L_.has(r)?L_.get(r):r}).sort().join("+"),sY=t=>t.split("+"),$_=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),CC=t=>{let{which:e,key:r}=t;if($_.has(e))return $_.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},Lk=Symbol("shortcut-context");function $k(t){return dt(t)&&t.__kindOf===Lk}const oY=t=>{const e=Av({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:l,callback:c,group:u,runOnlyIf:h=()=>!0,captureCtrl:f=!1,preventDefault:d=!0,stopPropagation:g=!1,relativeToGroup:m,position:p,forwardToContext:y}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(tr(u))throw new Error("You need to define the shortcut's group.");if(er(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(Ht`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const S={callback:c,group:u,runOnlyIf:h,captureCtrl:f,preventDefault:d,stopPropagation:g};Ue(m)&&(S.relativeToGroup=m,S.position=p),$k(y)&&(S.forwardToContext=y),l.forEach(C=>{const A=E0(C);if(e.hasItem(A)){const O=e.getItem(A);let _=O.findIndex(E=>E.group===m);_!==-1?p==="before"?_-=1:_+=1:_=O.length,O.splice(_,0,S)}else e.addItem(A,[S])})},n=function(l){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(u=>{gt(c,(h,f)=>{Object.prototype.hasOwnProperty.call(u,f)===!1&&(u[f]=c[f])}),r(u)})},i=l=>{const c=E0(l);e.removeItem(c)};return{__kindOf:Lk,addShortcut:r,addShortcuts:n,getShortcuts:l=>{const c=E0(l),u=e.getItem(c);return Ue(u)?u.slice():[]},hasShortcut:l=>{const c=E0(l);return e.hasItem(c)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(u=>{let[h,f]=u;const d=f.filter(g=>g.group!==l);d.length===0?i(sY(h)):(f.length=0,f.push(...d))})}}};function aY(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const lY=["meta","alt","shift","control"],rf=aY(),nf=[];let R0=0;function cY(t,e,r,n,i){const s=d=>lY.includes(d),o=function(d){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const m=[];return d.altKey&&m.push("alt"),g&&(d.ctrlKey||d.metaKey)?m.push("control/meta"):(d.ctrlKey&&m.push("control"),d.metaKey&&m.push("meta")),d.shiftKey&&m.push("shift"),m},a=d=>{if(e(d)===!1)return;const g=r(d);if(d.keyCode===229||g===!1||oc(d))return;const m=CC(d);let p=[];s(m)||(p=o(d));const y=[m].concat(p);!i(d,y)&&(py()&&p.includes("meta")||!py()&&p.includes("control"))&&i(d,[m].concat(o(d,!0))),n(d)},l=d=>{if(d.key){const g=CC(d);s(g)&&rf.press(g)}},c=d=>{if(d.key){const g=CC(d);s(g)&&rf.release(g)}},u=()=>{rf.releaseAll()};return{mount:()=>{let d=t;for(R0+=1;d;)R0===1&&(d.document.documentElement.addEventListener("keydown",l),nf.push({event:"keydown",listener:l}),d.document.documentElement.addEventListener("keyup",c),nf.push({event:"keyup",listener:c})),d.document.documentElement.addEventListener("keydown",a),d.document.documentElement.addEventListener("blur",u),d=oh(d)},unmount:()=>{let d=t;for(R0-=1;d;){if(R0===0){for(let g=0;g<nf.length;g++){const{event:m,listener:p}=nf[g];d.document.documentElement.removeEventListener(m,p)}nf.length=0}d.document.documentElement.removeEventListener("keydown",a),d.document.documentElement.removeEventListener("blur",u),d=oh(d)}},isPressed:d=>rf.isPressed(d),releasePressedKeys:()=>rf.releaseAll()}}const uY=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const s=Av({errorIdExists:g=>`The "${g}" context name is already registered.`});let o="grid";const a=g=>{const m=oY(g);return s.addItem(g,m),m},l=()=>o,c=g=>s.getItem(g),u=g=>{if(!s.hasItem(g))throw new Error(Ht`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=g};let h=!1;const f=function(g,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const y=$k(p)?p:c(p);let S=!1;if(!y.hasShortcut(m))return S;const C=y.getShortcuts(m);for(let A=0;A<C.length;A++){const{callback:I,runOnlyIf:O,preventDefault:_,stopPropagation:E,captureCtrl:b,forwardToContext:k}=C[A];if(O(g)===!0){if(h=b,S=I(g,m)===!1,h=!1,_&&g.preventDefault(),E&&(ks(g),g.stopPropagation()),S)break;k&&f(g,m,k)}}return S},d=cY(e,r,n,i,f);return d.mount(),{addContext:a,getActiveContextName:l,getContext:c,setActiveContextName:u,isCtrlPressed:()=>!h&&(d.isPressed("control")||d.isPressed("meta")),releasePressedKeys:()=>d.releasePressedKeys(),destroy:()=>d.unmount()}};let yC=null;const xC=new Map;function Bk(t,e){var r,n=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const o=new Ms(s);let a,l,c,u,h,f,d=!0;K9(i)&&Y9(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(r=e==null?void 0:e.layoutDirection)!==null&&r!==void 0?r:"inherit",m=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",m),this.isRtl=function(){return m==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=V7(e.language);const p=new Nk(s,e,[Wz,Xz]),y=p.getTableMeta(),S=p.getGlobalMeta(),C=Av();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Wm(this)&&i8(e.licenseKey,t),this.guid=`ht_${tP()}`,xC.set(this.guid,this),this.columnIndexMapper=new _y,this.rowIndexMapper=new _y,this.columnIndexMapper.addLocalHook("indexesSequenceChange",w=>{s.runHooks("afterColumnSequenceChange",w)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",w=>{s.runHooks("afterRowSequenceChange",w)}),l=new o7(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const A=w=>{const{row:v,col:x}=w;return s._createCellCoords(v>=0?s.rowIndexMapper.getRenderableFromVisualIndex(v):v,x>=0?s.columnIndexMapper.getRenderableFromVisualIndex(x):x)},I=w=>{const{row:v,col:x}=w;return s._createCellCoords(v>=0?s.rowIndexMapper.getVisualFromRenderableIndex(v):v,x>=0?s.columnIndexMapper.getVisualFromRenderableIndex(x):x)},O=(w,v)=>{const x=v>w?1:-1,R=Math.min(w,v),T=Math.max(w,v),L=s.rowIndexMapper.getNearestNotHiddenIndex(w,x);return L===null||x===1&&L>T||x===-1&&L<R?null:L>=0?s.rowIndexMapper.getRenderableFromVisualIndex(L):L},_=(w,v)=>{const x=v>w?1:-1,R=Math.min(w,v),T=Math.max(w,v),L=s.columnIndexMapper.getNearestNotHiddenIndex(w,x);return L===null||x===1&&L>T||x===-1&&L<R?null:L>=0?s.columnIndexMapper.getRenderableFromVisualIndex(L):L};let E=new Ok(y,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:w=>a.propToCol(w),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(w,v)=>s._createCellCoords(w,v),createCellRange:(w,v,x)=>s._createCellRange(w,v,x),visualToRenderableCoords:A,renderableToVisualCoords:I,findFirstNonHiddenRenderableRow:O,findFirstNonHiddenRenderableColumn:_,isDisabledCellSelection:(w,v)=>w<0||v<0?s.getSettings().disableVisualSelection:s.getCellMeta(w,v).disableVisualSelection});this.selection=E;const b=w=>{let{hiddenIndexesChanged:v}=w;v&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",b),this.rowIndexMapper.addLocalHook("cacheUpdated",b),this.selection.addLocalHook("afterSetRangeEnd",(w,v)=>{const x=Ss(!1),R=this.selection.getSelectedRange(),{from:T,to:L}=R.current(),K=R.size()-1;this.runHooks("afterSelection",T.row,T.col,L.row,L.col,x,K),this.runHooks("afterSelectionByProp",T.row,s.colToProp(T.col),L.row,s.colToProp(L.col),x,K),v&&(!x.isTouched()||x.isTouched()&&!x.value)&&f.scrollTo(w);const Q=E.isSelectedByRowHeader(),Z=E.isSelectedByColumnHeader();Q&&Z?_e(this.rootElement,["ht__selection--rows","ht__selection--columns"]):Q?(it(this.rootElement,"ht__selection--columns"),_e(this.rootElement,"ht__selection--rows")):Z?(it(this.rootElement,"ht__selection--rows"),_e(this.rootElement,"ht__selection--columns")):it(this.rootElement,["ht__selection--rows","ht__selection--columns"]),E.getSelectionSource()!=="shift"&&u.closeEditor(null),s.view.render(),u.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",w=>{this.runHooks("beforeSelectionFocusSet",w.row,w.col)}),this.selection.addLocalHook("afterSetFocus",w=>{const v=Ss(!1);this.runHooks("afterSelectionFocusSet",w.row,w.col,v),(!v.isTouched()||v.isTouched()&&!v.value)&&f.scrollTo(w),u.closeEditor(),s.view.render(),u.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",w=>{const v=w.length-1,{from:x,to:R}=w[v];this.runHooks("afterSelectionEnd",x.row,x.col,R.row,R.col,v),this.runHooks("afterSelectionEndByProp",x.row,s.colToProp(x.col),R.row,s.colToProp(R.col),v)}),this.selection.addLocalHook("afterIsMultipleSelection",w=>{const v=this.runHooks("afterIsMultipleSelection",w.value);w.value&&(w.value=v)}),this.selection.addLocalHook("afterDeselect",()=>{u.closeEditor(),s.view.render(),it(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var w=arguments.length,v=new Array(w),x=0;x<w;x++)v[x]=arguments[x];return n.runHooks("beforeSetRangeStart",...v)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var w=arguments.length,v=new Array(w),x=0;x<w;x++)v[x]=arguments[x];return n.runHooks("beforeSetRangeStartOnly",...v)}).addLocalHook("beforeSetRangeEnd",function(){for(var w=arguments.length,v=new Array(w),x=0;x<w;x++)v[x]=arguments[x];return n.runHooks("beforeSetRangeEnd",...v)}).addLocalHook("beforeSelectColumns",function(){for(var w=arguments.length,v=new Array(w),x=0;x<w;x++)v[x]=arguments[x];return n.runHooks("beforeSelectColumns",...v)}).addLocalHook("afterSelectColumns",function(){for(var w=arguments.length,v=new Array(w),x=0;x<w;x++)v[x]=arguments[x];return n.runHooks("afterSelectColumns",...v)}).addLocalHook("beforeSelectRows",function(){for(var w=arguments.length,v=new Array(w),x=0;x<w;x++)v[x]=arguments[x];return n.runHooks("beforeSelectRows",...v)}).addLocalHook("afterSelectRows",function(){for(var w=arguments.length,v=new Array(w),x=0;x<w;x++)v[x]=arguments[x];return n.runHooks("afterSelectRows",...v)}).addLocalHook("beforeModifyTransformStart",function(){for(var w=arguments.length,v=new Array(w),x=0;x<w;x++)v[x]=arguments[x];return n.runHooks("modifyTransformStart",...v)}).addLocalHook("afterModifyTransformStart",function(){for(var w=arguments.length,v=new Array(w),x=0;x<w;x++)v[x]=arguments[x];return n.runHooks("afterModifyTransformStart",...v)}).addLocalHook("beforeModifyTransformFocus",function(){for(var w=arguments.length,v=new Array(w),x=0;x<w;x++)v[x]=arguments[x];return n.runHooks("modifyTransformFocus",...v)}).addLocalHook("afterModifyTransformFocus",function(){for(var w=arguments.length,v=new Array(w),x=0;x<w;x++)v[x]=arguments[x];return n.runHooks("afterModifyTransformFocus",...v)}).addLocalHook("beforeModifyTransformEnd",function(){for(var w=arguments.length,v=new Array(w),x=0;x<w;x++)v[x]=arguments[x];return n.runHooks("modifyTransformEnd",...v)}).addLocalHook("afterModifyTransformEnd",function(){for(var w=arguments.length,v=new Array(w),x=0;x<w;x++)v[x]=arguments[x];return n.runHooks("afterModifyTransformEnd",...v)}).addLocalHook("beforeRowWrap",function(){for(var w=arguments.length,v=new Array(w),x=0;x<w;x++)v[x]=arguments[x];return n.runHooks("beforeRowWrap",...v)}).addLocalHook("beforeColumnWrap",function(){for(var w=arguments.length,v=new Array(w),x=0;x<w;x++)v[x]=arguments[x];return n.runHooks("beforeColumnWrap",...v)}).addLocalHook("insertRowRequire",w=>this.alter("insert_row_above",w,1,"auto")).addLocalHook("insertColRequire",w=>this.alter("insert_col_start",w,1,"auto")),c={alter(w,v){var x,R;let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,L=arguments.length>3?arguments[3]:void 0,K=arguments.length>4?arguments[4]:void 0;const Q=Z=>{if(Z.length===0)return[];const ie=[...Z];return ie.sort((H,Me)=>{let[ae]=H,[ke]=Me;return ae===ke?0:ae>ke?1:-1}),Gn(ie,(H,Me)=>{let[ae,ke]=Me;const Ae=H[H.length-1],[be,$e]=Ae,Le=be+$e;if(ae<=Le){const P=Math.max(ke-(Le-ae),0);Ae[1]+=P}else H.push([ae,ke]);return H},[ie[0]])};switch(w){case"insert_row_below":case"insert_row_above":const Z=s.countSourceRows();if(y.maxRows===Z)return;const ie=w==="insert_row_below"?"below":"above";v=(x=v)!==null&&x!==void 0?x:ie==="below"?Z:0;const{delta:fe,startPhysicalIndex:H}=a.createRow(v,T,{source:L,mode:ie});E.shiftRows(s.toVisualRow(H),fe);break;case"insert_col_start":case"insert_col_end":const Me=w==="insert_col_end"?"end":"start";v=(R=v)!==null&&R!==void 0?R:Me==="end"?s.countSourceCols():0;const{delta:ae,startPhysicalIndex:ke}=a.createCol(v,T,{source:L,mode:Me});if(ae){if(Array.isArray(y.colHeaders)){const $e=[s.toVisualColumn(ke),0];$e.length+=ae,Array.prototype.splice.apply(y.colHeaders,$e)}E.shiftColumns(s.toVisualColumn(ke),ae)}break;case"remove_row":const Ae=$e=>{let Le=0;J($e,P=>{let[F,G]=P;const ne=_r(F)?s.countRows()-1:Math.max(F-Le,0);if(Number.isInteger(F)&&(F=Math.max(F-Le,0)),!a.removeRow(F,G,L))return;if(E.isSelected()){const{row:oe}=s.getSelectedRangeLast().highlight;oe>=F&&oe<=F+G-1&&u.closeEditor(!0)}const re=s.countRows();re===0?E.deselect():L==="ContextMenu.removeRow"?E.refresh():E.shiftRows(F,-G);const te=y.fixedRowsTop;te>=ne+1&&(y.fixedRowsTop-=Math.min(G,te-ne));const ee=y.fixedRowsBottom;ee&&ne>=re-ee&&(y.fixedRowsBottom-=Math.min(G,ee)),Le+=G})};Array.isArray(v)?Ae(Q(v)):Ae([[v,T]]);break;case"remove_col":const be=$e=>{let Le=0;J($e,P=>{let[F,G]=P;const ne=_r(F)?s.countCols()-1:Math.max(F-Le,0);let X=s.toPhysicalColumn(ne);if(Number.isInteger(F)&&(F=Math.max(F-Le,0)),!a.removeCol(F,G,L))return;if(E.isSelected()){const{col:oe}=s.getSelectedRangeLast().highlight;oe>=F&&oe<=F+G-1&&u.closeEditor(!0)}s.countCols()===0?E.deselect():L==="ContextMenu.removeColumn"?E.refresh():E.shiftColumns(F,-G);const ee=y.fixedColumnsStart;ee>=ne+1&&(y.fixedColumnsStart-=Math.min(G,ee-ne)),Array.isArray(y.colHeaders)&&(typeof X>"u"&&(X=-1),y.colHeaders.splice(X,G)),Le+=G})};Array.isArray(v)?be(Q(v)):be([[v,T]]);break;default:throw new Error(`There is no such action "${w}"`)}s.view.render(),K||c.adjustRowsAndCols()},adjustRowsAndCols(){const w=y.minRows,v=y.minSpareRows,x=y.minCols,R=y.minSpareCols;if(w){const T=s.countRows();T<w&&a.createRow(T,w-T,{source:"auto"})}if(v){const T=s.countEmptyRows(!0);if(T<v){const L=v-T,K=Math.min(L,y.maxRows-s.countSourceRows());a.createRow(s.countRows(),K,{source:"auto"})}}{let T;(x||R)&&(T=s.countEmptyCols(!0));let L=s.countCols();if(x&&!y.columns&&L<x){const K=x-L;T+=K,a.createCol(L,K,{source:"auto"})}if(R&&!y.columns&&s.dataType==="array"&&T<R){L=s.countCols();const K=R-T,Q=Math.min(K,y.maxCols-L);a.createCol(L,Q,{source:"auto"})}}s.view&&s.view.adjustElementsSize()},populateFromArray(w,v,x,R,T){let L,K,Q,Z;const ie=[],fe={},H=[],Me=w.row,ae=w.col;if(K=v.length,K===0)return!1;let ke=0,Ae=0;switch(dt(x)&&(ke=x.col-ae+1,Ae=x.row-Me+1),T){case"shift_down":const be=$m(v),$e=be.length,Le=Math.max($e,ke),P=s.getData().slice(Me),F=$m(P).slice(ae,ae+Le);for(Q=0;Q<Le;Q+=1)if(Q<$e){for(L=0,K=be[Q].length;L<Ae-K;L+=1)be[Q].push(be[Q][L%K]);Q<F.length?H.push(be[Q].concat(F[Q])):H.push(be[Q].concat(new Array(P.length).fill(null)))}else H.push(be[Q%$e].concat(F[Q]));s.populateFromArray(Me,ae,$m(H));break;case"shift_right":const G=v.length,ne=Math.max(G,Ae),X=s.getData().slice(Me).map(Oe=>Oe.slice(ae));for(L=0;L<ne;L+=1)if(L<G){for(Q=0,Z=v[L].length;Q<ke-Z;Q+=1)v[L].push(v[L][Q%Z]);if(L<X.length)for(let Oe=0;Oe<X[L].length;Oe+=1)v[L].push(X[L][Oe]);else v[L].push(...new Array(X[0].length).fill(null))}else v.push(v[L%K].slice(0,ne).concat(X[L]));s.populateFromArray(Me,ae,v);break;case"overwrite":default:fe.row=w.row,fe.col=w.col;let re=0,te=0,ee=!0,oe;const le=function(De){let ze=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const lt=v[De%v.length];return ze!==null?lt[ze%lt.length]:lt},se=v.length,Ee=x?x.row-w.row+1:0;for(x?K=Ee:K=Math.max(se,Ee),L=0;L<K&&!(x&&fe.row>x.row&&Ee>se||!y.allowInsertRow&&fe.row>s.countRows()-1||fe.row>=y.maxRows);L++){const Oe=L-re,De=le(Oe).length,ze=x?x.col-w.col+1:0;if(x?Z=ze:Z=Math.max(De,ze),fe.col=w.col,oe=s.getCellMeta(fe.row,fe.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&oe.skipRowOnPaste){re+=1,fe.row+=1,K+=1;continue}for(te=0,Q=0;Q<Z&&!(x&&fe.col>x.col&&ze>De||!y.allowInsertColumn&&fe.col>s.countCols()-1||fe.col>=y.maxCols);Q++){if(oe=s.getCellMeta(fe.row,fe.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&oe.skipColumnOnPaste){te+=1,fe.col+=1,Z+=1;continue}if(oe.readOnly&&R!=="UndoRedo.undo"){fe.col+=1;continue}const lt=Q-te;let nt=le(Oe,lt),Je=s.getDataAtCell(fe.row,fe.col);if(nt!==null&&typeof nt=="object")if(Array.isArray(nt)&&Je===null&&(Je=[]),Je===null||typeof Je!="object")ee=!1;else{const yt=Rd(Array.isArray(Je)?Je:Je[0]||Je),Jt=Rd(Array.isArray(nt)?nt:nt[0]||nt);Ux(yt,Jt)||Array.isArray(yt)&&Array.isArray(Jt)?nt=zn(nt):ee=!1}else Je!==null&&typeof Je=="object"&&(ee=!1);ee&&ie.push([fe.row,fe.col,nt]),ee=!0,fe.col+=1}fe.row+=1}s.setDataAtCell(ie,null,null,R||"populateFromArray");break}}};function k(w){const v=Ck(w);Db(v)?(s.runHooks("beforeLanguageChange",v),S.language=v,s.runHooks("afterLanguageChange",v)):yk(w)}function B(w,v){const x=w==="className"?s.rootElement:s.table;if(d)_e(x,v);else{let R=[],T=[];S[w]&&(R=Array.isArray(S[w])?S[w]:vT(S[w])),v&&(T=Array.isArray(v)?v:vT(v));const L=pT(R,T),K=pT(T,R);L.length&&it(x,L),K.length&&_e(x,K)}S[w]=v}this.init=function(){l.setData(y.data),s.runHooks("beforeInit"),(za()||MP())&&_e(s.rootElement,"mobile"),this.updateSettings(y,!0),this.view=new Z9(this),u=by.getInstance(s,y,E),f=iY(s),h=new nU(s),Wm(this)&&XG(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),d&&s.rootElement.offsetParent===null&&B8(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof d=="object"&&(s.runHooks("afterChange",d[0],d[1]),d=!1),s.runHooks("afterInit")};function N(){let w=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,w=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&w===!1&&(w=!0,this.onQueueEmpty(this.valid))}}}function q(w){const v=w.replace(",",".");return isNaN(parseFloat(v))===!1?parseFloat(v):w}function ue(w,v,x){if(!w.length){x();return}const R=s.getActiveEditor(),T=new N;let L=!0;T.onQueueEmpty=()=>{R&&L&&R.cancelChanges(),x()};for(let K=w.length-1;K>=0;K--){const[Q,Z,,ie]=w[K],fe=a.propToCol(Z);let H;Number.isInteger(fe)?H=s.getCellMeta(Q,fe):H={...Object.getPrototypeOf(y),...y},H.type==="numeric"&&typeof ie=="string"&&$U(ie)&&(w[K][3]=q(ie)),s.getCellValidator(H)&&(T.addValidatorToQueue(),s.validateCell(w[K][3],H,function(Me,ae){return function(ke){if(typeof ke!="boolean")throw new Error("Validation error: result is not boolean");ke===!1&&ae.allowInvalid===!1&&(L=!1,w.splice(Me,1),ae.valid=!0),T.removeValidatorFormQueue()}}(K,H),v))}T.checkIfQueueIsEmpty()}function we(w,v){for(let R=w.length-1;R>=0;R--){let T=!1;if(w[R]===null){w.splice(R,1);continue}if(!((w[R][2]===null||w[R][2]===void 0)&&(w[R][3]===null||w[R][3]===void 0))){if(y.allowInsertRow)for(;w[R][0]>s.countRows()-1;){const{delta:L}=a.createRow(void 0,void 0,{source:v});if(L===0){T=!0;break}}if(s.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;a.propToCol(w[R][1])>s.countCols()-1;){const{delta:L}=a.createCol(void 0,void 0,{source:v});if(L===0){T=!0;break}}T||a.set(w[R][0],w[R][1],w[R][3])}}const x=w.length>0;if(s.forceFullRender=!0,x){c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",w,v),u.closeEditor(),s.view.render(),u.prepareEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",w,v||"edit");const R=s.getActiveEditor();R&&Ue(R.refreshValue)&&R.refreshValue()}else s.view.render()}this._createCellCoords=function(w,v){return s.view._wt.createCellCoords(w,v)},this._createCellRange=function(w,v,x){return s.view._wt.createCellRange(w,v,x)},this.validateCell=function(w,v,x,R){let T=s.getCellValidator(v);function L(K){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||v.hidden===!0){x(K);return}const Z=v.visualCol,ie=v.visualRow,fe=s.getCell(ie,Z,!0);if(fe&&fe.nodeName!=="TH"){const H=s.rowIndexMapper.getRenderableFromVisualIndex(ie),Me=s.columnIndexMapper.getRenderableFromVisualIndex(Z);s.view._wt.getSetting("cellRenderer",H,Me,fe)}x(K)}t8(T)&&(T=function(K){return function(Q,Z){Z(K.test(Q))}}(T)),er(T)?(w=s.runHooks("beforeValidate",w,v.visualRow,v.prop,R),s._registerImmediate(()=>{T.call(v,w,K=>{s&&(K=s.runHooks("afterValidate",K,w,v.visualRow,v.prop,R),v.valid=K,L(K),s.runHooks("postAfterValidate",K,w,v.visualRow,v.prop,R))})})):s._registerImmediate(()=>{v.valid=!0,L(v.valid,!1)})};function Se(w,v,x){return Array.isArray(w)?w:[[w,v,x]]}function ce(w,v){const x=s.getActiveEditor(),R=s.runHooks("beforeChange",w,v||"edit"),T=w.filter(L=>L!==null);return R===!1||T.length===0?(x&&x.cancelChanges(),[]):T}this.setDataAtCell=function(w,v,x,R){const T=Se(w,v,x),L=[];let K=R,Q,Z,ie;for(Q=0,Z=T.length;Q<Z;Q++){if(typeof T[Q]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof T[Q][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");T[Q][1]>=this.countCols()?ie=T[Q][1]:ie=a.colToProp(T[Q][1]),L.push([T[Q][0],ie,l.getAtCell(this.toPhysicalRow(T[Q][0]),T[Q][1]),T[Q][2]])}!K&&typeof w=="object"&&(K=v);const fe=ce(L,R);s.runHooks("afterSetDataAtCell",fe,K),ue(fe,K,()=>{we(fe,K)})},this.setDataAtRowProp=function(w,v,x,R){const T=Se(w,v,x),L=[];let K=R,Q,Z;for(Q=0,Z=T.length;Q<Z;Q++)L.push([T[Q][0],T[Q][1],l.getAtCell(this.toPhysicalRow(T[Q][0]),T[Q][1]),T[Q][2]]);!K&&typeof w=="object"&&(K=v);const ie=ce(L,R);s.runHooks("afterSetDataAtRowProp",ie,K),ue(ie,K,()=>{we(ie,K)})},this.listen=function(){s&&!s.isListening()&&(xC.forEach(w=>{s!==w&&w.unlisten()}),yC=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(yC=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return yC===s.guid},this.destroyEditor=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;u.closeEditor(w),s.view.render(),v&&E.isSelected()&&u.prepareEditor()},this.populateFromArray=function(w,v,x,R,T,L,K){if(!(typeof x=="object"&&typeof x[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const Q=typeof R=="number"?s._createCellCoords(R,T):null;return c.populateFromArray(s._createCellCoords(w,v),x,Q,L,K)},this.spliceCol=function(w,v,x){for(var R=arguments.length,T=new Array(R>3?R-3:0),L=3;L<R;L++)T[L-3]=arguments[L];return a.spliceCol(w,v,x,...T)},this.spliceRow=function(w,v,x){for(var R=arguments.length,T=new Array(R>3?R-3:0),L=3;L<R;L++)T[L-3]=arguments[L];return a.spliceRow(w,v,x,...T)},this.getSelected=function(){if(E.isSelected())return bt(E.getSelectedRange(),w=>{let{from:v,to:x}=w;return[v.row,v.col,x.row,x.col]})},this.getSelectedLast=function(){const w=this.getSelected();let v;return w&&w.length>0&&(v=w[w.length-1]),v},this.getSelectedRange=function(){if(E.isSelected())return Array.from(E.getSelectedRange())},this.getSelectedRangeLast=function(){const w=this.getSelectedRange();let v;return w&&w.length>0&&(v=w[w.length-1]),v},this.emptySelectedCells=function(w){if(!E.isSelected()||this.countRows()===0||this.countCols()===0)return;const v=[];J(E.getSelectedRange(),x=>{if(x.isSingleHeader())return;const R=x.getTopStartCorner(),T=x.getBottomEndCorner();Ge(R.row,T.row,L=>{Ge(R.col,T.col,K=>{this.getCellMeta(L,K).readOnly||v.push([L,K,null])})})}),v.length>0&&this.setDataAtCell(v,w)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const w=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(w,0),!this.isRenderSuspended()&&w===this.renderSuspendedCounter&&(this.renderCall?this.render():s.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(w){this.suspendRender();const v=w();return this.resumeRender(),v},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const v=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(v,0),(!this.isExecutionSuspended()&&v===this.executionSuspendedCounter||w)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(w){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const x=w();return this.resumeExecution(v),x},this.batch=function(w){this.suspendRender(),this.suspendExecution();const v=w();return this.resumeExecution(),this.resumeRender(),v},this.refreshDimensions=function(){if(!s.view)return;const{width:w,height:v}=s.view.getLastSize(),{width:x,height:R}=s.rootElement.getBoundingClientRect(),T=x!==w||R!==v;s.runHooks("beforeRefreshDimensions",{width:w,height:v},{width:x,height:R},T)!==!1&&((T||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(x,R),s.render()),s.runHooks("afterRefreshDimensions",{width:w,height:v},{width:x,height:R},T))},this.updateData=function(w,v){N_(w,x=>{a=x},x=>{a=x,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),E.refresh()},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"updateData",source:v,metaManager:p,firstRun:d})},this.loadData=function(w,v){N_(w,x=>{a=x},()=>{p.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),E.refresh(),d&&(d=[null,"loadData"])},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"loadData",source:v,metaManager:p,firstRun:d})},this.getInitialColumnCount=function(){const w=y.columns;let v=0;if(Array.isArray(w))v=w.length;else if(er(w))if(s.dataType==="array"){const x=this.countSourceCols();for(let R=0;R<x;R+=1)w(R)&&(v+=1)}else(s.dataType==="object"||s.dataType==="function")&&(v=a.colToPropCache.length);else if(Ue(y.dataSchema)){const x=a.getSchema();v=Array.isArray(x)?x.length:jx(x)}else v=this.countSourceCols();return v},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(w,v,x,R){return tr(w)?a.getAll():a.getRange(s._createCellCoords(w,v),s._createCellCoords(x,R),a.DESTINATION_RENDERER)},this.getCopyableText=function(w,v,x,R){return a.getCopyableText(s._createCellCoords(w,v),s._createCellCoords(x,R))},this.getCopyableData=function(w,v){return a.getCopyable(w,a.colToProp(v))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(w){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const x=(d?s.loadData:s.updateData).bind(this);let R=!1,T,L;if(Ue(w.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Ue(w.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Ue(w.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(T in w)T==="data"||(T==="language"?k(w.language):T==="className"?B("className",w.className):T==="tableClassName"&&s.table?(B("tableClassName",w.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):We.getSingleton().isRegistered(T)||We.getSingleton().isDeprecated(T)?(er(w[T])||Array.isArray(w[T]))&&(w[T].initialHook=!0,s.addHook(T,w[T])):!v&&Cr(w,T)&&(S[T]=w[T]));w.data===void 0&&y.data===void 0?x(null,"updateSettings"):w.data!==void 0?x(w.data,"updateSettings"):w.columns!==void 0&&(a.createMap(),s.initIndexMappers());const K=s.countCols(),Q=y.columns;if(Q&&er(Q)&&(R=!0),(w.cell!==void 0||w.cells!==void 0||w.columns!==void 0)&&p.clearCache(),K>0)for(T=0,L=0;T<K;T++){if(Q){const fe=R?Q(T):Q[L];fe&&p.updateColumnMeta(L,fe)}L+=1}Ue(w.cell)&&gt(w.cell,fe=>{s.setCellMetaObject(fe.row,fe.col,fe)}),s.runHooks("afterCellMetaReset");let Z=s.rootElement.style.height;Z!==""&&(Z=parseInt(s.rootElement.style.height,10));let ie=w.height;if(er(ie)&&(ie=ie()),v&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),ie===null){const fe=s.rootElement.getAttribute("data-initialstyle");fe&&(fe.indexOf("height")>-1||fe.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",fe):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else ie!==void 0&&(s.rootElement.style.height=isNaN(ie)?`${ie}`:`${ie}px`,s.rootElement.style.overflow="hidden");if(typeof w.width<"u"){let fe=w.width;er(fe)&&(fe=fe()),s.rootElement.style.width=isNaN(fe)?`${fe}`:`${fe}px`}v||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",w)),c.adjustRowsAndCols(),s.view&&!d&&(s.forceFullRender=!0,s.view.render(),s.view._wt.wtOverlays.adjustElementsSize()),!v&&s.view&&(Z===""||ie===""||ie===void 0)&&Z!==ie&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const w=s.getSelectedLast();if(y.getValue){if(er(y.getValue))return y.getValue.call(s);if(w)return s.getData()[w[0][0]][y.getValue]}else if(w)return s.getDataAtCell(w[0],w[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(w,v,x,R,T){c.alter(w,v,x,R,T)},this.getCell=function(w,v){let x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,R=v,T=w;if(v>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(v)))return null;R=this.columnIndexMapper.getRenderableFromVisualIndex(v)}if(w>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(w)))return null;T=this.rowIndexMapper.getRenderableFromVisualIndex(w)}return T===null||R===null||T===void 0||R===void 0?null:s.view.getCellAtCoords(s._createCellCoords(T,R),x)},this.getCoords=function(w){const v=this.view._wt.wtTable.getCoords(w);if(v===null)return null;const{row:x,col:R}=v;let T=x,L=R;return x>=0&&(T=this.rowIndexMapper.getVisualFromRenderableIndex(x)),R>=0&&(L=this.columnIndexMapper.getVisualFromRenderableIndex(R)),s._createCellCoords(T,L)},this.colToProp=function(w){return a.colToProp(w)},this.propToCol=function(w){return a.propToCol(w)},this.toVisualRow=w=>this.rowIndexMapper.getVisualFromPhysicalIndex(w),this.toVisualColumn=w=>this.columnIndexMapper.getVisualFromPhysicalIndex(w),this.toPhysicalRow=w=>this.rowIndexMapper.getPhysicalFromVisualIndex(w),this.toPhysicalColumn=w=>this.columnIndexMapper.getPhysicalFromVisualIndex(w),this.getDataAtCell=function(w,v){return a.get(w,a.colToProp(v))},this.getDataAtRowProp=function(w,v){return a.get(w,v)},this.getDataAtCol=function(w){const v=[],x=a.getRange(s._createCellCoords(0,w),s._createCellCoords(y.data.length-1,w),a.DESTINATION_RENDERER);for(let R=0;R<x.length;R+=1)for(let T=0;T<x[R].length;T+=1)v.push(x[R][T]);return v},this.getDataAtProp=function(w){const v=[],x=a.getRange(s._createCellCoords(0,a.propToCol(w)),s._createCellCoords(y.data.length-1,a.propToCol(w)),a.DESTINATION_RENDERER);for(let R=0;R<x.length;R+=1)for(let T=0;T<x[R].length;T+=1)v.push(x[R][T]);return v},this.getSourceData=function(w,v,x,R){let T;return w===void 0?T=l.getData():T=l.getByRange(s._createCellCoords(w,v),s._createCellCoords(x,R)),T},this.getSourceDataArray=function(w,v,x,R){let T;return w===void 0?T=l.getData(!0):T=l.getByRange(s._createCellCoords(w,v),s._createCellCoords(x,R),!0),T},this.getSourceDataAtCol=function(w){return l.getAtColumn(w)},this.setSourceDataAtCell=function(w,v,x,R){const T=Se(w,v,x),L=this.hasHook("afterSetSourceDataAtCell"),K=[];L&&J(T,Z=>{let[ie,fe,H]=Z;K.push([ie,fe,l.getAtCell(ie,fe),H])}),J(T,Z=>{let[ie,fe,H]=Z;l.setAtCell(ie,fe,H)}),L&&this.runHooks("afterSetSourceDataAtCell",K,R),this.render();const Q=s.getActiveEditor();Q&&Ue(Q.refreshValue)&&Q.refreshValue()},this.getSourceDataAtRow=function(w){return l.getAtRow(w)},this.getSourceDataAtCell=function(w,v){return l.getAtCell(w,v)},this.getDataAtRow=function(w){return a.getRange(s._createCellCoords(w,0),s._createCellCoords(w,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(w,v,x,R){const T=w===void 0?[0,0,this.countRows(),this.countCols()]:[w,v,x,R],[L,K]=T;let[,,Q,Z]=T,ie=null,fe=null;Q===void 0&&(Q=L),Z===void 0&&(Z=K);let H="mixed";return Ge(Math.max(Math.min(L,Q),0),Math.max(L,Q),Me=>{let ae=!0;return Ge(Math.max(Math.min(K,Z),0),Math.max(K,Z),ke=>(fe=this.getCellMeta(Me,ke).type,ie?ae=ie===fe:ie=fe,ae)),H=ae?fe:"mixed",ae}),H},this.removeCellMeta=function(w,v,x){const[R,T]=[this.toPhysicalRow(w),this.toPhysicalColumn(v)];let L=p.getCellMetaKeyValue(R,T,x);s.runHooks("beforeRemoveCellMeta",w,v,x,L)!==!1&&(p.removeCellMeta(R,T,x),s.runHooks("afterRemoveCellMeta",w,v,x,L)),L=null},this.spliceCellsMeta=function(w){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var x=arguments.length,R=new Array(x>2?x-2:0),T=2;T<x;T++)R[T-2]=arguments[T];if(R.length>0&&!Array.isArray(R[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");v>0&&p.removeRow(this.toPhysicalRow(w),v),R.length>0&&J(R.reverse(),L=>{p.createRow(this.toPhysicalRow(w)),J(L,(K,Q)=>this.setCellMetaObject(w,Q,K))}),s.render()},this.setCellMetaObject=function(w,v,x){typeof x=="object"&&gt(x,(R,T)=>{this.setCellMeta(w,v,T,R)})},this.setCellMeta=function(w,v,x,R){if(s.runHooks("beforeSetCellMeta",w,v,x,R)===!1)return;let L=w,K=v;w<this.countRows()&&(L=this.toPhysicalRow(w)),v<this.countCols()&&(K=this.toPhysicalColumn(v)),p.setCellMeta(L,K,x,R),s.runHooks("afterSetCellMeta",w,v,x,R)},this.getCellsMeta=function(){return p.getCellsMeta()},this.getCellMeta=function(w,v){let x=this.toPhysicalRow(w),R=this.toPhysicalColumn(v);return x===null&&(x=w),R===null&&(R=v),p.getCellMeta(x,R,{visualRow:w,visualColumn:v})},this.getColumnMeta=function(w){return p.getColumnMeta(this.toPhysicalColumn(w))},this.getCellMetaAtRow=function(w){return p.getCellsMetaAtRow(w)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||y.columns)},this.getCellRenderer=function(w,v){const x=typeof w=="number"?s.getCellMeta(w,v).renderer:w.renderer;return typeof x=="string"?Ty(x):tr(x)?Ty("text"):x},this.getCellEditor=function(w,v){const x=typeof w=="number"?s.getCellMeta(w,v).editor:w.editor;return typeof x=="string"?Sy(x):tr(x)?Sy("text"):x},this.getCellValidator=function(w,v){const x=typeof w=="number"?s.getCellMeta(w,v).validator:w.validator;return typeof x=="string"?r5(x):x},this.validateCells=function(w){this._validateCells(w)},this.validateRows=function(w,v){if(!Array.isArray(w))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(v,w)},this.validateColumns=function(w,v){if(!Array.isArray(w))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(v,void 0,w)},this._validateCells=function(w,v,x){const R=new N;w&&(R.onQueueEmpty=w);let T=s.countRows()-1;for(;T>=0;){if(v!==void 0&&v.indexOf(T)===-1){T-=1;continue}let L=s.countCols()-1;for(;L>=0;){if(x!==void 0&&x.indexOf(L)===-1){L-=1;continue}R.addValidatorToQueue(),s.validateCell(s.getDataAtCell(T,L),s.getCellMeta(T,L),K=>{if(typeof K!="boolean")throw new Error("Validation error: result is not boolean");K===!1&&(R.valid=!1),R.removeValidatorFormQueue()},"validateCells"),L-=1}T-=1}R.checkIfQueueIsEmpty()},this.getRowHeader=function(w){let v=y.rowHeaders,x=w;return x!==void 0&&(x=s.runHooks("modifyRowHeader",x)),x===void 0?(v=[],Ge(s.countRows()-1,R=>{v.push(s.getRowHeader(R))})):Array.isArray(v)&&v[x]!==void 0?v=v[x]:er(v)?v=v(x):v&&typeof v!="string"&&typeof v!="number"&&(v=x+1),v},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let w=0,v=s.countCols();w<v;w++)if(s.getColHeader(w))return!0;return!1},this.getColHeader=function(w){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const x=s.runHooks("modifyColHeader",w);if(x===void 0){const Q=[],Z=s.countCols();for(let ie=0;ie<Z;ie++)Q.push(s.getColHeader(ie));return Q}let R=y.colHeaders;const T=function(Q){const Z=[],ie=s.countCols();let fe=0;for(;fe<ie;fe++)er(y.columns)&&y.columns(fe)&&Z.push(fe);return Z[Q]},L=s.toPhysicalColumn(x),K=T(L);return y.colHeaders===!1?R=null:y.columns&&er(y.columns)&&y.columns(K)&&y.columns(K).title?R=y.columns(K).title:y.columns&&y.columns[L]&&y.columns[L].title?R=y.columns[L].title:Array.isArray(y.colHeaders)&&y.colHeaders[L]!==void 0?R=y.colHeaders[L]:er(y.colHeaders)?R=y.colHeaders(L):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(R=t7(x)),R=s.runHooks("modifyColumnHeaderValue",R,w,v),R},this._getColWidthFromSettings=function(w){let v;if(w>=0&&(v=s.getCellMeta(0,w).width),(v===void 0||v===y.width)&&(v=y.colWidths),v!=null){switch(typeof v){case"object":v=v[w];break;case"function":v=v(w);break}typeof v=="string"&&(v=parseInt(v,10))}return v},this.getColWidth=function(w){let v=s._getColWidthFromSettings(w);return v=s.runHooks("modifyColWidth",v,w),v===void 0&&(v=Iv),v},this._getRowHeightFromSettings=function(w){let v=y.rowHeights;if(v!=null){switch(typeof v){case"object":v=v[w];break;case"function":v=v(w);break}typeof v=="string"&&(v=parseInt(v,10))}return v},this.getRowHeight=function(w){let v=s._getRowHeightFromSettings(w);return v=s.runHooks("modifyRowHeight",v,w),v},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const w=y.maxCols,v=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(w,v)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=0;return XT(s.countRows()-1,x=>{if(s.isEmptyRow(x))v+=1;else if(w===!0)return!1}),v},this.countEmptyCols=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=0;return XT(s.countCols()-1,x=>{if(s.isEmptyCol(x))v+=1;else if(w===!0)return!1}),v},this.isEmptyRow=function(w){return y.isEmptyRow.call(s,w)},this.isEmptyCol=function(w){return y.isEmptyCol.call(s,w)},this.selectCell=function(w,v,x,R){let T=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,L=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return tr(w)||tr(v)?!1:this.selectCells([[w,v,x,R]],T,L)},this.selectCells=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;v===!1&&f.suspend();const R=E.selectCells(w);return R&&x&&s.listen(),f.resume(),R},this.selectColumns=function(w){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w,x=arguments.length>2?arguments[2]:void 0;return E.selectColumns(w,v,x)},this.selectRows=function(w){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w,x=arguments.length>2?arguments[2]:void 0;return E.selectRows(w,v,x)},this.deselectCell=function(){E.deselect()},this.selectAll=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w,x=arguments.length>2?arguments[2]:void 0;f.skipNextScrollCycle(),E.selectAll(w,v,x)};const Re=(w,v)=>w.getNearestNotHiddenIndex(v,1,!0);this.scrollViewportTo=function(w){var v;if(typeof w=="number"){var x;w={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(x=arguments[4])!==null&&x!==void 0?x:!0}}const{row:R,col:T,verticalSnap:L,horizontalSnap:K,considerHiddenIndexes:Q}=(v=w)!==null&&v!==void 0?v:{};let Z,ie,fe,H;L!==void 0&&(Z=L==="top",ie=!Z),K!==void 0&&(fe=K==="start",H=!fe);let Me=R,ae=T;if(Q===void 0||Q){const be=Number.isInteger(R)&&R>=0,$e=Number.isInteger(T)&&T>=0,Le=be?Re(this.rowIndexMapper,R):void 0,P=$e?Re(this.columnIndexMapper,T):void 0;if(Le===null||P===null)return!1;Me=be?s.rowIndexMapper.getRenderableFromVisualIndex(Le):R,ae=$e?s.columnIndexMapper.getRenderableFromVisualIndex(P):T}const ke=Number.isInteger(Me),Ae=Number.isInteger(ae);return ke&&Me>=0&&Ae&&ae>=0?s.view.scrollViewport(s._createCellCoords(Me,ae),Z,H,ie,fe):ke&&Me>=0&&(Ae&&ae<0||!Ae)?s.view.scrollViewportVertically(Me,Z,ie):Ae&&ae>=0&&(ke&&Me<0||!ke)?s.view.scrollViewportHorizontally(ae,H,fe):!1},this.scrollToFocusedCell=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",w);const{highlight:v}=this.getSelectedRangeLast();this.scrollViewportTo(v.toObject())?this.view.render():(this.removeHook("afterScroll",w),this._registerImmediate(()=>w()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),p.clearCache(),xC.delete(this.guid),Wm(s)){const w=this.rootDocument.querySelector(".hot-display-license-info");w&&w.parentNode.removeChild(w)}wo(s.rootElement),o.destroy(),u&&u.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),C.getItems().forEach(w=>{let[,v]=w;v.destroy()}),C.clear(),s.runHooks("afterDestroy")},!0),We.getSingleton().destroy(s),gt(s,(w,v,x)=>{er(w)?x[v]=Y(v):v!=="guid"&&(x[v]=null)}),s.isDestroyed=!0,a&&a.destroy(),a=null,c=null,E=null,u=null,s=null};function Y(w){return()=>{throw new Error(`The "${w}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return u.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(w){const v=Is(w);return v==="UndoRedo"?this.undoRedo:C.getItem(v)},this.getPluginName=function(w){return w===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:C.getId(w)},this.getInstance=function(){return s},this.addHook=function(w,v,x){We.getSingleton().add(w,v,s,x)},this.hasHook=function(w){return We.getSingleton().has(w,s)||We.getSingleton().has(w)},this.addHookOnce=function(w,v,x){We.getSingleton().once(w,v,s,x)},this.removeHook=function(w,v){We.getSingleton().remove(w,v,s)},this.runHooks=function(w,v,x,R,T,L,K){return We.getSingleton().run(s,w,v,x,R,T,L,K)},this.getTranslatedPhrase=function(w,v){return Tk(y.language,w,v)},this.toHTML=()=>YT(this),this.toTableElement=()=>{const w=this.rootDocument.createElement("div");return w.insertAdjacentHTML("afterbegin",YT(this)),w.firstElementChild},this.timeouts=[],this._registerTimeout=function(w){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,x=w;typeof x=="function"&&(x=setTimeout(x,v)),this.timeouts.push(x)},this._clearTimeouts=function(){J(this.timeouts,w=>{clearTimeout(w)})},this.immediates=[],this._registerImmediate=function(w){this.immediates.push(setImmediate(w))},this._clearImmediates=function(){J(this.immediates,w=>{clearImmediate(w)})},this._getEditorManager=function(){return u},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const Pe=uY({handleEvent(){return s.isListening()},beforeKeyDown:w=>this.runHooks("beforeKeyDown",w),afterKeyDown:w=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",w)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",w=>{w.ctrlKey===!1&&w.metaKey===!1&&Pe.releasePressedKeys()}),this.getShortcutManager=function(){return Pe},this.getFocusManager=function(){return h},UP().forEach(w=>{const v=Qx(w);C.addItem(w,new v(this))}),YG(s),Pe.setActiveContextName("grid"),We.getSingleton().run(s,"construct")}function B_(t,e,r){t.addEventListener(e,r,!1)}function V_(t,e,r){t.removeEventListener(e,r,!1)}function W_(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function hY(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},r=t.body,n=t.createTextNode(""),i=t.createElement("span");let s;function o(){n.textContent=s.value,i.style.position="absolute",i.style.fontSize=W_(s).fontSize,i.style.fontFamily=W_(s).fontFamily,i.style.whiteSpace="pre",r.appendChild(i);const u=i.clientWidth+2;r.removeChild(i);const h=s.style;h.height=`${e.minHeight}px`,e.minWidth>u?h.width=`${e.minWidth}px`:u>e.maxWidth?h.width=`${e.maxWidth}px`:h.width=`${u}px`;const f=s.scrollHeight?s.scrollHeight-1:0;e.minHeight>f?h.height=`${e.minHeight}px`:e.maxHeight<f?(h.height=`${e.maxHeight}px`,h.overflowY="visible"):h.height=`${f}px`}function a(){t.defaultView.setTimeout(o,0)}function l(u){if(u&&u.minHeight)if(u.minHeight==="inherit")e.minHeight=s.clientHeight;else{const h=parseInt(u.minHeight,10);isNaN(h)||(e.minHeight=h)}if(u&&u.maxHeight)if(u.maxHeight==="inherit")e.maxHeight=s.clientHeight;else{const h=parseInt(u.maxHeight,10);isNaN(h)||(e.maxHeight=h)}if(u&&u.minWidth)if(u.minWidth==="inherit")e.minWidth=s.clientWidth;else{const h=parseInt(u.minWidth,10);isNaN(h)||(e.minWidth=h)}if(u&&u.maxWidth)if(u.maxWidth==="inherit")e.maxWidth=s.clientWidth;else{const h=parseInt(u.maxWidth,10);isNaN(h)||(e.maxWidth=h)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))}function c(u,h){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=u,l(h),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${e.minHeight}px`,s.style.minWidth=`${e.minWidth}px`,s.style.maxWidth=`${e.maxWidth}px`,s.style.overflowY="hidden"),f&&(B_(s,"input",o),B_(s,"keydown",a)),o()}return{init:c,resize:o,unObserve(){V_(s,"input",o),V_(s,"keydown",a)}}}function U_(t,e){const r=pP(e),n=e.value.split(`
`);let i=r,s=0;for(let o=0;o<n.length;o++){const a=n[o];o!==0&&(s+=n[o-1].length+1);const l=s+a.length;if(t==="home"?i=s:t==="end"&&(i=l),r<=l)break}Rv(e,i)}function Ml(t,e,r){return(e=fY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fY(t){var e=dY(t,"string");return typeof e=="symbol"?e:e+""}function dY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const gY="ht_editor_visible",T0="ht_editor_hidden",j_="textEditor",mY="text";class jc extends bh{static get EDITOR_TYPE(){return mY}constructor(e){super(e),Ml(this,"eventManager",new Ms(this)),Ml(this,"autoResize",hY(this.hot.rootDocument)),Ml(this,"TEXTAREA",void 0),Ml(this,"textareaStyle",void 0),Ml(this,"TEXTAREA_PARENT",void 0),Ml(this,"textareaParentStyle",void 0),Ml(this,"layerClass",void 0),this.eventManager=new Ms(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),M8(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,s,o){const a=this.state;if(super.prepare(e,r,n,i,s,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=o;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Er.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===Er.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),Rv(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Ze(this.TEXTAREA,[["data-hot-input",""],Ch(-1)]),_e(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),_e(this.TEXTAREA_PARENT,"handsontableInputHolder"),Qe(this.TEXTAREA_PARENT,this.layerClass)&&it(this.TEXTAREA_PARENT,this.layerClass),_e(this.TEXTAREA_PARENT,T0),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){h6()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",it(this.TEXTAREA_PARENT,this.layerClass),_e(this.TEXTAREA_PARENT,T0)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;Ge(e.length-1,n=>{const i=e[n];if(Qe(i,"handsontableEditor"))return r=!0,!1}),Qe(this.TEXTAREA_PARENT,T0)&&it(this.TEXTAREA_PARENT,T0),r?(this.layerClass=gY,_e(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),_e(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Er.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:s,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=sa(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const c=sa(this.TEXTAREA),u=parseInt(c.paddingLeft,10)+parseInt(c.paddingRight,10),h=parseInt(c.paddingTop,10)+parseInt(c.paddingBottom,10),f=i-u,d=o-h,g=s-u,m=a-h;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(f,g),minHeight:Math.min(d,m),maxWidth:g,maxHeight:m},!0)}bindEvents(){IP()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Er.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Er.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>Ue(this.hot.getSelected()),group:j_},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(s,o)=>{let[a]=o;U_(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,o)=>{let[a]=o;U_(a,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(j_)}}const pY="base";function pg(t,e,r,n,i,s,o){const a=o.ariaTags,l=[],c=[],u=[],h=[];o.className&&_e(e,o.className),o.readOnly?(l.push(o.readOnlyCellClassName),a&&h.push(bT())):a&&u.push(bT()[0]),o.valid===!1&&o.invalidCellClassName?(l.push(o.invalidCellClassName),a&&h.push(ET())):(c.push(o.invalidCellClassName),a&&u.push(ET()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&l.push(o.noWordWrapClassName),!s&&o.placeholder&&l.push(o.placeholderCellClassName),it(e,c),_e(e,l),yh(e,u),Ze(e,h)}pg.RENDERER_TYPE=pY;const vY="text";function fa(t,e,r,n,i,s,o){pg.apply(this,[t,e,r,n,i,s,o]);let a=s;if(!a&&o.placeholder&&(a=o.placeholder),a=Nr(a),o.trimWhitespace&&(a=a.trim()),o.rendererTemplate){wo(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(r),e.appendChild(l)}else Sc(e,a)}fa.RENDERER_TYPE=vY;const wY="text",Vk={CELL_TYPE:wY,editor:jc,renderer:fa};gs(Vk);xt.editors={BaseEditor:bh};function xt(t,e){const r=new Bk(t,e||{},pS);return r.init(),r}xt.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Bk(t,e,pS)};xt.DefaultSettings=kk();xt.hooks=We.getSingleton();xt.CellCoords=Ec;xt.CellRange=fg;xt.packageName="handsontable";xt.buildDate="17/10/2024 09:16:16";xt.version="14.6.1";xt.languages={dictionaryKeys:N7,getLanguageDictionary:Rk,getLanguagesDictionaries:$7,registerLanguageDictionary:Ek,getTranslatedPhrase:Tk};function Py(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function CY(t){if(Array.isArray(t))return Py(t)}function yY(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Id(t,e,r){return e=Rp(e),_Y(t,Wk()?Reflect.construct(e,r||[],Rp(t).constructor):e.apply(t,r))}function uh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function z_(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Uk(n.key),n)}}function hh(t,e,r){return e&&z_(t.prototype,e),r&&z_(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function xY(t,e,r){return(e=Uk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rp(t){return Rp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Rp(t)}function Md(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ky(t,e)}function Wk(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Wk=function(){return!!t})()}function SY(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function bY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function G_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function EY(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?G_(Object(r),!0).forEach(function(n){xY(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):G_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function RY(t,e){if(t==null)return{};var r,n,i=TY(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function TY(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}function _Y(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yY(t)}function ky(t,e){return ky=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},ky(t,e)}function AY(t){return CY(t)||SY(t)||MY(t)||bY()}function IY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Uk(t){var e=IY(t,"string");return typeof e=="symbol"?e:e+""}function MY(t,e){if(t){if(typeof t=="string")return Py(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Py(t,e):void 0}}var SC=null,OY="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",PY="The Handsontable instance bound to this component was destroyed and cannot be used properly.",Tp="global",kY="hot-wrapper-editor-container";function NY(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function Ny(t,e){var r=pr.Children.toArray(t),n=pr.Children.count(t),i=null;return n!==0&&(n===1&&r[0].props[e]?i=r[0]:i=r.find(function(s){return s.props[e]!==void 0})),i||null}function jk(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function zk(t,e){if(typeof t>"u"||e===null)return null;var r=Yk(e.props,!1);return r.className="".concat(kY," ").concat(r.className),QM.createPortal(pr.createElement("div",Object.assign({},r),e),t.body)}function Gk(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Tp,n=Ny(t,"hot-editor"),i=jk(n);return n?pr.cloneElement(n,{emitEditorInstance:function(o,a){e.get(i)||e.set(i,new Map);var l=e.get(i);l.set(a??Tp,o)},editorColumnScope:r,isEditor:!0}):null}function FY(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;r||(r=document),SC||(SC=r.createDocumentFragment());var s=i??r.createElement("DIV");SC.appendChild(s);var o=pr.cloneElement(t,EY({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:QM.createPortal(o,s,n),portalContainer:s}}function Yk(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}function HY(){return typeof window<"u"}var Kk=function(){function t(){uh(this,t)}return hh(t,null,[{key:"getSettings",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.prevProps,s=i===void 0?{}:i,o=n.isInit,a=o===void 0?!1:o,l=n.initOnlySettingKeys,c=l===void 0?[]:l,u=function(p){return!a&&c.includes(p)?s[p]===r[p]:!1},h={};if(r.settings){var f=r.settings;for(var d in f)f.hasOwnProperty(d)&&!u(d)&&(h[d]=f[d])}for(var g in r)g!=="settings"&&g!=="children"&&!u(g)&&r.hasOwnProperty(g)&&(h[g]=r[g]);return h}}])}(),DY=function(t){function e(){return uh(this,e),Id(this,e,arguments)}return Md(e,t),hh(e,[{key:"getSettingsProps",value:function(){var n=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(i){return!n.internalProps.includes(i)}).reduce(function(i,s){return i[s]=n.props[s],i},{})}},{key:"getLocalEditorElement",value:function(){return Gk(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var n=this.props._getChildElementByType(this.props.children,"hot-renderer"),i=this.getLocalEditorElement();this.columnSettings=Kk.getSettings(this.getSettingsProps()),n!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(n),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),i!==null&&(this.columnSettings.editor=this.props._getEditorClass(i,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var n=this.props._getOwnerDocument(),i=zk(n,this.getLocalEditorElement());return pr.createElement(pr.Fragment,null,i)}}])}(pr.Component),LY=function(t){function e(){var r;return uh(this,e),r=Id(this,e,arguments),r.state={portals:[]},r}return Md(e,t),hh(e,[{key:"render",value:function(){return pr.createElement(pr.Fragment,null,this.state.portals)}}])}(pr.Component),$Y="14.6.1";function BY(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Xk={exports:{}},bC,Y_;function VY(){if(Y_)return bC;Y_=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return bC=t,bC}var EC,K_;function WY(){if(K_)return EC;K_=1;var t=VY();function e(){}function r(){}return r.resetWarningCache=e,EC=function(){function i(a,l,c,u,h,f){if(f!==t){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}i.isRequired=i;function s(){return i}var o={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:s,element:i,elementType:i,instanceOf:s,node:i,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:r,resetWarningCache:e};return o.PropTypes=o,o},EC}Xk.exports=WY()();var UY=Xk.exports,RC=BY(UY),$b=function(t){function e(){var r;return uh(this,e),r=Id(this,e,arguments),r.id=null,r.__hotInstance=null,r.hotElementRef=null,r.columnSettings=[],r.renderersPortalManager=null,r.portalCache=new Map,r.portalContainerCache=new Map,r.renderedCellCache=new Map,r.editorCache=new Map,r.componentRendererColumns=new Map,r}return Md(e,t),hh(e,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(PY),null)},set:function(n){this.__hotInstance=n}},{key:"_isHotInstanceDestroyed",value:function(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return HY()?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(n){this.hotElementRef=n}},{key:"getRendererWrapper",value:function(n){var i=this;return function(o,a,l,c,u,h,f){var d=i.getRenderedCellCache(),g=i.getPortalContainerCache(),m="".concat(l,"-").concat(c),p=o.guid,y="".concat(p,"-").concat(m),S="".concat(m,"-").concat(p);if(d.has(m)&&(a.innerHTML=d.get(m).innerHTML),a&&!a.getAttribute("ghost-table")){for(var C=i.portalCache.get(S),A=g.get(y);a.firstChild;)a.removeChild(a.firstChild);if(C&&A)a.appendChild(A);else{var I=FY(n,{TD:a,row:l,col:c,prop:u,value:h,cellProperties:f,isRenderer:!0},a.ownerDocument,S,A),O=I.portal,_=I.portalContainer;g.set(y,_),a.appendChild(_),i.portalCache.set(S,O)}}return d.set(m,a),a}}},{key:"getEditorClass",value:function(n){var i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Tp,o=jk(n),a=(i=this.getEditorCache().get(o))===null||i===void 0?void 0:i.get(s);return this.makeEditorClass(a)}},{key:"makeEditorClass",value:function(n){var i=function(s){function o(a){var l;return uh(this,o),l=Id(this,o,[a]),n.hotCustomEditorInstance=l,l.editorComponent=n,l}return Md(o,s),hh(o,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(xt.editors.BaseEditor);return Object.getOwnPropertyNames(xt.editors.BaseEditor.prototype).forEach(function(s){s!=="constructor"&&(i.prototype[s]=function(){for(var o,a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];return(o=n[s]).call.apply(o,[n].concat(l))})}),i}},{key:"getGlobalRendererElement",value:function(){return Ny(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return Gk(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this._isHotInstanceDestroyed()?[]:((n=this.hotInstance)===null||n===void 0||(n=n.getSettings())===null||n===void 0?void 0:n._initOnlySettings)||[],a=Kk.getSettings(this.props,{prevProps:s,isInit:i,initOnlySettingKeys:o}),l=this.getGlobalRendererElement(),c=this.getGlobalEditorElement();if(a.columns=this.columnSettings.length?this.columnSettings:a.columns,c)a.editor=this.getEditorClass(c,Tp);else{var u;this.props.editor||(u=this.props.settings)!==null&&u!==void 0&&u.editor?a.editor=this.props.editor||this.props.settings.editor:a.editor=Sy("text")}if(l)a.renderer=this.getRendererWrapper(l),this.componentRendererColumns.set("global",!0);else{var h;this.props.renderer||(h=this.props.settings)!==null&&h!==void 0&&h.renderer?a.renderer=this.props.renderer||this.props.settings.renderer:a.renderer=Ty("text")}return a}},{key:"displayAutoSizeWarning",value:function(n){var i,s;this.hotInstance&&((i=this.hotInstance.getPlugin("autoRowSize"))!==null&&i!==void 0&&i.enabled||(s=this.hotInstance.getPlugin("autoColumnSize"))!==null&&s!==void 0&&s.enabled)&&this.componentRendererColumns.size>0&&NY(OY)}},{key:"setHotColumnSettings",value:function(n,i){this.columnSettings[i]=n}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){this.renderersPortalManager.setState({portals:AY(this.portalCache.values())})}},{key:"updateHot",value:function(n){this.hotInstance&&this.hotInstance.updateSettings(n,!1)}},{key:"setRenderersPortalManagerRef",value:function(n){this.renderersPortalManager=n}},{key:"componentDidMount",value:function(){var n=this,i=this.createNewGlobalSettings(!0);this.hotInstance=new xt.Core(this.hotElementRef,i),this.hotInstance.addHook("beforeViewRender",function(){return n.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return n.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(i)}},{key:"componentDidUpdate",value:function(n){this.clearCache();var i=this.createNewGlobalSettings(!1,n);this.updateHot(i),this.displayAutoSizeWarning(i)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var n=this,i=function(u){return u.type===DY},s=pr.Children.toArray(this.props.children),o=s.filter(function(c){return i(c)}).map(function(c,u){return pr.cloneElement(c,{_componentRendererColumns:n.componentRendererColumns,_emitColumnSettings:n.setHotColumnSettings.bind(n),_columnIndex:u,_getChildElementByType:Ny.bind(n),_getRendererWrapper:n.getRendererWrapper.bind(n),_getEditorClass:n.getEditorClass.bind(n),_getOwnerDocument:n.getOwnerDocument.bind(n),_getEditorCache:n.getEditorCache.bind(n),children:c.props.children})}),a=Yk(this.props),l=zk(this.getOwnerDocument(),this.getGlobalEditorElement());return pr.createElement(pr.Fragment,null,pr.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},a),o),pr.createElement(LY,{ref:this.setRenderersPortalManagerRef.bind(this)}),l)}}],[{key:"version",get:function(){return $Y}}])}(pr.Component);$b.propTypes={style:RC.object,id:RC.string,className:RC.string};var jY=["children"],qk=pr.forwardRef(function(t,e){var r,n=t.children,i=RY(t,jY),s=typeof pr.useId=="function"?pr.useId():void 0,o=(r=i.id)!==null&&r!==void 0?r:s;return pr.createElement($b,Object.assign({id:o},i,{ref:e}),n)});qk.version=$b.version;pr.Component;const X_="handsontableEditor",zY="handsontable";class Bb extends jc{static get EDITOR_TYPE(){return zY}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Rv(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(c,u){const h=this.getSourceData(u.row,u.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Ur(l,o.handsontable),this.htOptions=l}beginEditing(e,r){const n=this.hot.getSettings().onBeginEditing;n&&n()===!1||super.beginEditing(e,r)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,r,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,r,n)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const n={group:X_,relativeToGroup:dl,position:"before"},i=(s,o)=>{const a=this.htEditor;if(s!==void 0&&(s<0||a.flipped&&s>a.countRows()-1?a.deselectCell():a.selectCell(s,0),a.getData().length))return o.preventDefault(),ks(o),this.hot.listen(),this.TEXTAREA.focus(),!1};r.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const o=this.htEditor;let a,l;return!o.getSelectedLast()&&o.flipped?a=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(l=o.getSelectedLast()[0],a=Math.max(0,l-1)):(l=o.getSelectedLast()[0],a=l-1)),i(a,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const o=this.htEditor;let a,l;if(!o.getSelectedLast()&&!o.flipped)a=0;else if(o.getSelectedLast()){if(o.flipped)a=o.getSelectedLast()[0]+1;else if(!o.flipped){const c=o.countRows()-1;l=o.getSelectedLast()[0],a=Math.min(c,l+1)}}return i(a,s)},preventDefault:!1}],n)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(X_)}}function GY(t,e,r){YY(t,e),e.set(t,r)}function YY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _0(t,e,r){return(e=KY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KY(t){var e=XY(t,"string");return typeof e=="symbol"?e:e+""}function XY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function q_(t,e){return t.get(qY(t,e))}function qY(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const JY="autocomplete";var TC=new WeakMap;class Vb extends Bb{constructor(){super(...arguments),_0(this,"query",null),_0(this,"strippedChoices",[]),_0(this,"rawChoices",[]),GY(this,TC,this.hot.guid.slice(0,9)),_0(this,"sortByRelevance",function(e,r,n){const i=[],s=[],o=e.length;let a=r.length,l,c,u,h;if(o===0){for(u=0;u<a;u++)s.push(u);return s}for(u=0;u<a;u++){if(c=ST(Nr(r[u])),n)h=c.indexOf(e);else{const f=this.cellProperties.locale;h=c.toLocaleLowerCase(f).indexOf(e.toLocaleLowerCase(f))}h!==-1&&(l=c.length-h-o,i.push({baseIndex:u,index:h,charsLeft:l,value:c}))}for(i.sort((f,d)=>{if(d.index===-1)return-1;if(f.index===-1)return 1;if(f.index<d.index)return-1;if(d.index<f.index)return 1;if(f.index===d.index){if(f.charsLeft<d.charsLeft)return-1;if(f.charsLeft>d.charsLeft)return 1}return 0}),u=0,a=i.length;u<a;u++)s.push(i[u].baseIndex);return s})}static get EDITOR_TYPE(){return JY}getValue(){const e=this.rawChoices.find(r=>this.stripValueIfNeeded(r)===this.TEXTAREA.value);return Ue(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),_e(this.htContainer,"autocompleteEditor"),_e(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Ze(this.TEXTAREA,[w8(),d8(),oP("listbox"),S8()])}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o),this.hot.getSettings().ariaTags&&Ze(this.TEXTAREA,[qi("false"),b8(`${q_(TC,this)}-listbox-${e}-${r}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,r=this.hot.getSettings().ariaTags,n=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=n==null?void 0:n.length,{row:s,col:o}=this;this.showEditableElement(),this.focus();let a=ln();a===0&&py()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[rr(this.TEXTAREA)-2]:void 0,width:e?rr(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,c,u,h,f,d,g)=>{fa(l,c,u,h,f,d,g);const{filteringCaseSensitive:m,allowHtml:p,locale:y}=this.cellProperties,S=this.query;let C=Nr(d),A,I;C&&!p&&(A=m===!0?C.indexOf(S):C.toLocaleLowerCase(y).indexOf(S.toLocaleLowerCase(y)),A!==-1&&(I=C.substr(A,S.length),C=C.replace(I,`<strong>${I}</strong>`))),r&&Ze(c,[g8(),...n?[_8(i)]:[],...n?[A8(n.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${h}`]]),c.innerHTML=C},afterSelectionEnd:(l,c)=>{if(r){const u=this.htEditor.getCell(l,c,!0);Ze(u,[Lx()]),Ze(this.TEXTAREA,...E8(u.id))}}}),r&&(Ze(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...go()),Ze(this.htEditor.rootElement,[sP(),R8("polite"),T8("text"),["id",`${q_(TC,this)}-listbox-${s}-${o}`]]),Ze(this.TEXTAREA,...qi("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Ze(this.TEXTAREA,[qi("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const r=this.cellProperties.source;this.query=e,typeof r=="function"?r.call(this.cellProperties,e,n=>{this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))}):Array.isArray(r)?(this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))):this.updateChoicesList([])}updateChoicesList(e){const r=pP(this.TEXTAREA),n=H8(this.TEXTAREA),i=this.cellProperties.sortByRelevance,s=this.cellProperties.filter;let o=null,a=null,l=e;i&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const c=Array.isArray(o)?o.length:0;if(s===!1)c&&(a=o[0]);else{const u=[];for(let h=0,f=l.length;h<f&&!(i&&c<=h);h++)c?u.push(l[o[h]]):u.push(l[h]);a=0,l=u}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData($m([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Rv(this.TEXTAREA,r,r===n?void 0:n)}flipDropdownIfNeeded(){const e=lh(this.hot.view._wt.wtTable.TABLE),r=e===this.hot.rootWindow,n=this.cellProperties.preventOverflow;if(r||!r&&(n||n==="horizontal"))return!1;const i=sn(this.TEXTAREA),s=Fr(this.TEXTAREA),o=this.getDropdownHeight(),a=e.scrollTop,l=Fr(this.hot.view._wt.wtTable.THEAD),c=sn(e),u=i.top-c.top-l+a,h=e.scrollHeight-u-l-s,f=o>h&&u>h;return f?this.flipDropdown(o):this.unflipDropdown(),this.limitDropdownIfNeeded(f?u:h,o),f}limitDropdownIfNeeded(e,r){if(r>e){let n=0,i=0,s=0,o=null;do s=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),n+=s,i+=1;while(n<e);o=n-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+r-o}px`),this.setDropdownHeight(n-s)}}flipDropdown(e){const r=this.htEditor.rootElement.style;r.position="absolute",r.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){const e=this.htEditor.getColWidth(0)+ln(this.hot.rootDocument)+2,r=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:r?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,r=this.cellProperties.visibleRows;return this.strippedChoices.length>=r?r*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:r}=this.cellProperties,n=bt(e,s=>Nr(s));return bt(n,s=>r?s:ST(s))}allowKeyEventPropagation(e){const r=this.htEditor.getSelectedRangeLast(),n={row:r?r.from.row:-1};let i=!1;return e===Xe.ARROW_DOWN&&n.row>0&&n.row<this.htEditor.countRows()-1&&(i=!0),e===Xe.ARROW_UP&&n.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(d6(e.keyCode)||e.keyCode===Xe.BACKSPACE||e.keyCode===Xe.DELETE||e.keyCode===Xe.INSERT){let r=10;if(e.keyCode===Xe.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},r)}}}const ZY="checkbox";class Jk extends bh{static get EDITOR_TYPE(){return ZY}beginEditing(e,r){if(r&&r.type==="mouseup"&&r.target.nodeName==="TD"){const n=this.TD.querySelector('input[type="checkbox"]');Qe(n,"htBadValue")||n.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Ga=()=>window,Gi=()=>window.document,Fy=(t,e)=>window.setTimeout(t,e),eo=function(t,e,r,n){t.addEventListener(e,r,!!n)},Do=function(t,e,r,n){t.removeEventListener(e,r,!!n)},QY=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},gi=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},_C=function(t,e){gi(t,e)||(t.className=t.className===""?e:t.className+" "+e)},AC=function(t,e){t.className=QY((" "+t.className+" ").replace(" "+e+" "," "))},Wb=function(t){return/Array/.test(Object.prototype.toString.call(t))},wi=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},eK=function(t){let e=t.getDay();return e===0||e===6},tK=function(t){return t%4===0&&t%100!==0||t%400===0},J_=function(t,e){return[31,tK(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},A0=function(t){wi(t)&&t.setHours(0,0,0,0)},I0=function(t,e){return t.getTime()===e.getTime()},_p=function(t,e,r){let n,i;for(n in e)i=t[n]!==void 0,i&&typeof e[n]=="object"&&e[n]!==null&&e[n].nodeName===void 0?wi(e[n])?r&&(t[n]=new Date(e[n].getTime())):Wb(e[n])?r&&(t[n]=e[n].slice(0)):t[n]=_p({},e[n],r):(r||!i)&&(t[n]=e[n]);return t},Z_=function(t,e,r){let n=Gi().createEvent("HTMLEvents");n.initEvent(e,!0,!1),n=_p(n,r),t.dispatchEvent(n)},Q_=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Vs={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},eA=function(t,e,r){for(e+=t.firstDay;e>=7;)e-=7;return r?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},rK=function(t){let e=[],r="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),r="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+r+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},nK=function(t,e){t.setHours(0,0,0,0);let r=t.getDate(),n=t.getDay(),i=e,s=i-1,o=7,a=function(f){return(f+o-1)%o};t.setDate(r+s-a(n));let l=new Date(t.getFullYear(),0,i),c=24*60*60*1e3,u=(t.getTime()-l.getTime())/c;return 1+Math.round((u-s+a(l.getDay()))/o)},iK=function(t,e,r,n,i){let s=new Date(n,r,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(s).isoWeek():nK(s,i))+"</td>"},sK=function(t,e,r,n){return'<tr class="pika-row'+(r?" pick-whole-week":"")+(n?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},oK=function(t){return"<tbody>"+t.join("")+"</tbody>"},aK=function(t){let e,r=[];for(t.showWeekNumber&&r.push("<th></th>"),e=0;e<7;e++)r.push('<th scope="col"><abbr title="'+eA(t,e)+'">'+eA(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?r.reverse():r).join("")+"</tr></thead>"},lK=function(t,e,r,n,i,s){let o,a,l,c=t._o,u=r===c.minYear,h=r===c.maxYear,f='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',d,g,m=!0,p=!0;for(l=[],o=0;o<12;o++)l.push('<option value="'+(r===i?o-e:12+o-e)+'"'+(o===n?' selected="selected"':"")+(u&&o<c.minMonth||h&&o>c.maxMonth?' disabled="disabled"':"")+">"+c.i18n.months[o]+"</option>");for(d='<div class="pika-label">'+c.i18n.months[n]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",Wb(c.yearRange)?(o=c.yearRange[0],a=c.yearRange[1]+1):(o=r-c.yearRange,a=1+r+c.yearRange),l=[];o<a&&o<=c.maxYear;o++)o>=c.minYear&&l.push('<option value="'+o+'"'+(o===r?' selected="selected"':"")+">"+o+"</option>");return g='<div class="pika-label">'+r+c.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",c.showMonthAfterYear?f+=g+d:f+=d+g,u&&(n===0||c.minMonth>=n)&&(m=!1),h&&(n===11||c.maxMonth<=n)&&(p=!1),e===0&&(f+='<button class="pika-prev'+(m?"":" is-disabled")+'" type="button">'+c.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(f+='<button class="pika-next'+(p?"":" is-disabled")+'" type="button">'+c.i18n.nextMonth+"</button>"),f+="</div>"},cK=function(t,e,r){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+r+'">'+aK(t)+oK(e)+"</table>"};function Hy(t){let e=this,r=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||Ga().event;let s=i.target||i.srcElement;if(s)if(gi(s,"is-disabled")||(gi(s,"pika-button")&&!gi(s,"is-empty")&&!gi(s.parentNode,"is-disabled")?(e.setDate(new Date(s.getAttribute("data-pika-year"),s.getAttribute("data-pika-month"),s.getAttribute("data-pika-day"))),r.bound&&Fy(function(){e.hide(),r.blurFieldOnSelect&&r.field&&r.field.blur()},100)):gi(s,"pika-prev")?e.prevMonth():gi(s,"pika-next")&&e.nextMonth()),gi(s,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||Ga().event;let s=i.target||i.srcElement;s&&(gi(s,"pika-select-month")?e.gotoMonth(s.value):gi(s,"pika-select-year")&&e.gotoYear(s.value))},e._onKeyChange=function(i){if(i=i||Ga().event,e.isVisible())switch(i.keyCode){case 13:case 27:r.field&&r.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(r.parse)return r.parse(r.field.value,r.format);if(this.hasMoment){let i=this.moment(r.field.value,r.format,r.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(r.field.value))},e._onInputChange=function(i){let s;i.firedBy!==e&&(s=e._parseFieldValue(),wi(s)&&e.setDate(s),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Gi().activeElement;do if(gi(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=Fy(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||Ga().event;let s=i.target||i.srcElement,o=s;if(s){!hasEventListeners&&gi(s,"pika-select")&&(s.onchange||(s.setAttribute("onchange","return;"),eo(s,"change",e._onChange)));do if(gi(o,"pika-single")||o===r.trigger)return;while(o=o.parentNode);e._v&&s!==r.trigger&&o!==r.trigger&&e.hide()}},e.el=Gi().createElement("div"),e.el.className="pika-single"+(r.isRTL?" is-rtl":"")+(r.theme?" "+r.theme:""),eo(e.el,"mousedown",e._onMouseDown,!0),eo(e.el,"touchend",e._onMouseDown,!0),eo(e.el,"change",e._onChange),r.keyboardInput&&eo(Gi(),"keydown",e._onKeyChange),r.field&&(r.container?r.container.appendChild(e.el):r.bound?Gi().body.appendChild(e.el):r.field.parentNode.insertBefore(e.el,r.field.nextSibling),eo(r.field,"change",e._onInputChange),r.defaultDate||(r.defaultDate=e._parseFieldValue(),r.setDefaultDate=!0));let n=r.defaultDate;wi(n)?r.setDefaultDate?e.setDate(n,!0):e.gotoDate(n):e.gotoDate(new Date),r.bound?(this.hide(),e.el.className+=" is-bound",eo(r.trigger,"click",e._onInputClick),eo(r.trigger,"focus",e._onInputFocus),eo(r.trigger,"blur",e._onInputBlur)):this.show()}Hy.prototype={config:function(t){this._o||(this._o=_p({},Vs,!0));let e=_p(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let r=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=r>4?4:r,wi(e.minDate)||(e.minDate=!1),wi(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),Wb(e.yearRange)){let n=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||n,e.yearRange[1]=parseInt(e.yearRange[1],10)||n}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Vs.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,wi(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return wi(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",Z_(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!wi(t))return;let r=this._o.minDate,n=this._o.maxDate;wi(r)&&t<r?t=r:wi(n)&&t>n&&(t=n),this._d=new Date(t.getTime()),A0(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),Z_(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(wi(t)){if(this.calendars){let r=new Date(this.calendars[0].year,this.calendars[0].month,1),n=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();n.setMonth(n.getMonth()+1),n.setDate(n.getDate()-1),e=i<r.getTime()||n.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let r=this.getDate()||new Date,n=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(r.valueOf()+n):t==="subtract"&&(i=new Date(r.valueOf()-n)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=Q_(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=Q_({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(A0(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Vs.minDate,this._o.minYear=Vs.minYear,this._o.minMonth=Vs.minMonth,this._o.startRange=Vs.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(A0(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Vs.maxDate,this._o.maxYear=Vs.maxYear,this._o.maxMonth=Vs.maxMonth,this._o.endRange=Vs.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,r=e.minYear,n=e.maxYear,i=e.minMonth,s=e.maxMonth,o="",a;this._y<=r&&(this._y=r,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=n&&(this._y=n,!isNaN(s)&&this._m>s&&(this._m=s));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),o+='<div class="pika-lendar">'+lK(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=o,e.bound&&e.field.type!=="hidden"&&Fy(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,r,n,i,s,o,a,l,c,u;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,r=this.el.offsetHeight,n=Ga().innerWidth||Gi().documentElement.clientWidth,i=Ga().innerHeight||Gi().documentElement.clientHeight,s=Gi().body.scrollTop||Gi().documentElement.scrollTop,c=!0,u=!0,l=t.getBoundingClientRect(),o=l.left+Ga().pageXOffset,a=l.bottom+Ga().pageYOffset,(this._o.reposition&&o+e>n||this._o.position.indexOf("right")>-1&&o-e+t.offsetWidth>0)&&(o=o-e+t.offsetWidth,c=!1),(this._o.reposition&&a+r>i+s||this._o.position.indexOf("top")>-1&&a-r-t.offsetHeight>0)&&(a=a-r-t.offsetHeight,u=!1),o<0&&(o=0),a<0&&(a=0),this.el.style.left=o+"px",this.el.style.top=a+"px",_C(this.el,c?"left-aligned":"right-aligned"),_C(this.el,u?"bottom-aligned":"top-aligned"),AC(this.el,c?"right-aligned":"left-aligned"),AC(this.el,u?"top-aligned":"bottom-aligned"))},render:function(t,e,r){let n=this._o,i=new Date,s=J_(t,e),o=new Date(t,e,1).getDay(),a=[],l=[];A0(i),n.firstDay>0&&(o-=n.firstDay,o<0&&(o+=7));let c=e===0?11:e-1,u=e===11?0:e+1,h=e===0?t-1:t,f=e===11?t+1:t,d=J_(h,c),g=s+o,m=g;for(;m>7;)m-=7;g+=7-m;let p=!1;for(let y=0,S=0;y<g;y++){let C=new Date(t,e,1+(y-o)),A=wi(this._d)?I0(C,this._d):!1,I=I0(C,i),O=n.events.indexOf(C.toDateString())!==-1,_=y<o||y>=s+o,E=1+(y-o),b=e,k=t,B=n.startRange&&I0(n.startRange,C),N=n.endRange&&I0(n.endRange,C),q=n.startRange&&n.endRange&&n.startRange<C&&C<n.endRange,ue=n.minDate&&C<n.minDate||n.maxDate&&C>n.maxDate||n.disableWeekends&&eK(C)||n.disableDayFn&&n.disableDayFn(C);_&&(y<o?(E=d+E,b=c,k=h):(E=E-s,b=u,k=f));let we={day:E,month:b,year:k,hasEvent:O,isSelected:A,isToday:I,isDisabled:ue,isEmpty:_,isStartRange:B,isEndRange:N,isInRange:q,showDaysInNextAndPreviousMonths:n.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:n.enableSelectionDaysInNextAndPreviousMonths};n.pickWholeWeek&&A&&(p=!0),l.push(rK(we)),++S===7&&(n.showWeekNumber&&l.unshift(iK(this,y-o,e,t,n.firstWeekOfYearMinDays)),a.push(sK(l,n.isRTL,n.pickWholeWeek,p)),l=[],S=0,p=!1)}return cK(n,a,r)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),AC(this.el,"is-hidden"),this._o.bound&&(eo(Gi(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Do(Gi(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),_C(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Do(this.el,"mousedown",this._onMouseDown,!0),Do(this.el,"touchend",this._onMouseDown,!0),Do(this.el,"change",this._onChange),t.keyboardInput&&Do(Gi(),"keydown",this._onKeyChange),t.field&&(Do(t.field,"change",this._onInputChange),t.bound&&(Do(t.trigger,"click",this._onInputClick),Do(t.trigger,"focus",this._onInputFocus),Do(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function IC(t,e,r){return(e=uK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uK(t){var e=hK(t,"string");return typeof e=="symbol"?e:e+""}function hK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Zk="date",tA="dateEditor";class Qk extends jc{constructor(){super(...arguments),IC(this,"defaultDateFormat","DD/MM/YYYY"),IC(this,"parentDestroyed",!1),IC(this,"$datePicker",null)}static get EDITOR_TYPE(){return Zk}init(){if(typeof At!="function")throw new Error("You need to include moment.js to your project.");if(typeof Hy!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),_e(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{Qe(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),n.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:tA})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(tA),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,r)}showDatepicker(e){const r=this.cellProperties.dateFormat||this.defaultDateFormat,n=this.hot.view.isMouseDown(),i=e?OP(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new Hy(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(At),this.$datePicker._onInputFocus=function(){},this.originalValue?(s=this.originalValue,At(s,r,!0).isValid()&&this.$datePicker.setMoment(At(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!n&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,At(s,r,!0).isValid()&&this.$datePicker.setMoment(At(s,r),!0),!i&&!n&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&_v(r,this.cellProperties.datePickerConfig);const n=r.onSelect,i=r.onClose;return r.field=e,r.trigger=e,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=r.format||this.defaultDateFormat,r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let o=s;isNaN(o.getTime())||(o=At(o).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(o),n&&n()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},r}refreshDimensions(e){var r;if(super.refreshDimensions(e),this.state!==Er.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{wtOverlays:s}=this.hot.view._wt,{wtTable:o}=(r=s.getParentOverlay(this.TD))!==null&&r!==void 0?r:this.hot.view._wt,a=n.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),l=n.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),c=i.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),u=i.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=c&&this.col<=u){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+Fr(this.TD)}px`;let f=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?f+=h.right-rr(this.datePicker):f+=h.left,this.datePickerStyle.left=`${f}px`}else this.hideDatepicker()}}const fK="dropdown";class Ub extends Vb{static get EDITOR_TYPE(){return fK}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}We.getSingleton().add("beforeValidate",function(t,e,r){const n=this.propToCol(r);if(Number.isInteger(n)){const i=this.getCellMeta(e,n);i.editor===Ub&&i.strict===void 0&&(i.filter=!1,i.strict=!0)}});const dK="numeric";class e2 extends jc{static get EDITOR_TYPE(){return dK}}const gK="password";class t2 extends jc{static get EDITOR_TYPE(){return gK}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,wo(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const MC="ht_editor_visible",rA="selectEditor",mK="select";class r2 extends bh{static get EDITOR_TYPE(){return mK}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",_e(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Qe(this.select,MC)&&it(this.select,MC),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),wo(this.select),gt(l,(c,u)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=u,xh(h,c),this.select.appendChild(h)})}prepareOptions(e){let r={};if(Array.isArray(e))for(let n=0,i=e.length;n<i;n++)r[e[n]]=e[n];else typeof e=="object"&&(r=e);return r}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Er.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:r,width:n,height:i}=this.getEditedCellRect(),s=this.select.style;s.height=`${i}px`,s.width=`${n}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${r}px`,s.margin="0px",_e(this.select,MC)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={group:rA};this.isInFullEditMode()&&r.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(rA)}}const pK="time";class n2 extends jc{static get EDITOR_TYPE(){return pK}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o),this.TEXTAREA.dir="ltr"}}function vK(){mi(bh),mi(Vb),mi(Jk),mi(Qk),mi(Ub),mi(Bb),mi(e2),mi(t2),mi(r2),mi(jc),mi(n2)}const wK="html";function jb(t,e,r,n,i,s,o){pg.apply(this,[t,e,r,n,i,s,o]),xh(e,s??"",!1)}jb.RENDERER_TYPE=wK;const CK="autocomplete";function Eh(t,e,r,n,i,s,o){const{rootDocument:a}=t,l=o.allowHtml?jb:fa,c=a.createElement("DIV"),u=t.getSettings().ariaTags;if(c.className="htAutocompleteArrow",u&&c.setAttribute(...Wc()),c.appendChild(a.createTextNode("â¼")),l.apply(this,[t,e,r,n,i,s,o]),e.firstChild||e.appendChild(a.createTextNode("Â ")),e.insertBefore(c,e.firstChild),_e(e,"htAutocomplete"),!t.acArrowListener){const h=new Ms(t);t.acArrowListener=function(f){Qe(f.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(r,n),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Eh.RENDERER_TYPE=CK;const yK="dropdown";function zb(t,e,r,n,i,s,o){Eh.apply(this,[t,e,r,n,i,s,o])}zb.RENDERER_TYPE=yK;const nA=new WeakMap,iA=new WeakMap,xK="htBadValue",fh="data-row",dh="data-col",SK="checkboxRenderer",i2="checkbox";We.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,r){const{label:n,type:i,row:s,column:o,prop:a}=e;if(i===i2){if(n){const{value:l,property:c}=n;let u=r;if(l)u=typeof l=="function"?l(s,o,a,r):l;else if(c){const h=this.getDataAtRowProp(s,c);u=h!==null?h:r}t=u}return t}});function Gb(t,e,r,n,i,s,o){const{rootDocument:a}=t,l=t.getSettings().ariaTags;pg.apply(this,[t,e,r,n,i,s,o]),bK(t);let c=EK(a);const u=o.label;let h=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),wo(e),s===o.checkedTemplate||Nr(s).toLocaleLowerCase(o.locale)===Nr(o.checkedTemplate).toLocaleLowerCase(o.locale)?c.checked=!0:s===o.uncheckedTemplate||Nr(s).toLocaleLowerCase(o.locale)===Nr(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?c.checked=!1:_r(s)?_e(c,"noValue"):(c.style.display="none",_e(c,xK),h=!0),Ze(c,[[fh,r],[dh,n]]),l&&Ze(c,[up(c.checked?t.getTranslatedPhrase(Fb):t.getTranslatedPhrase(Hb)),cP(c.checked),m8()]),!h&&u){let m="";if(u.value)m=typeof u.value=="function"?u.value.call(this,r,n,i,s):u.value;else if(u.property){const y=t.getDataAtRowProp(r,u.property);m=y!==null?y:""}const p=RK(a,m,u.separated!==!0);u.position==="before"?u.separated?(e.appendChild(p),e.appendChild(c)):(p.appendChild(c),c=p):(!u.position||u.position==="after")&&(u.separated?(e.appendChild(c),e.appendChild(p)):(p.insertBefore(c,p.firstChild),c=p))}(!u||u&&!u.separated)&&e.appendChild(c),h&&e.appendChild(a.createTextNode("#bad-value#")),nA.has(t)||(nA.set(t,!0),f());function f(){const p=t.getShortcutManager().getContext("grid"),y={group:SK,relativeToGroup:dl,position:"before"};p.addShortcuts([{keys:[["space"]],callback:()=>(d(),!g()),runOnlyIf:()=>{var S;return(S=t.getSelectedRangeLast())===null||S===void 0?void 0:S.highlight.isCell()}},{keys:[["enter"]],callback:()=>(d(),!g()),runOnlyIf:()=>{const S=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(S==null?void 0:S.isSingle())&&S.highlight.isCell()}},{keys:[["delete"],["backspace"]],callback:()=>(d(!0),!g()),runOnlyIf:()=>{var S;return(S=t.getSelectedRangeLast())===null||S===void 0?void 0:S.highlight.isCell()}}],y)}function d(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const p=t.getSelectedRange(),y=[],S=new Map;let C=[],A=0;if(p){for(let I=0;I<p.length;I++){const{row:O,col:_}=p[I].getTopStartCorner(),{row:E,col:b}=p[I].getBottomEndCorner();for(let k=O;k<=E;k+=1)for(let B=_;B<=b;B+=1){const N=t.getCellMeta(k,B),q={checkedTemplate:N.checkedTemplate,uncheckedTemplate:N.uncheckedTemplate};if(N.type!=="checkbox"){m===!0&&!N.readOnly&&(S.has(y.length)?S.set(y.length,[...S.get(y.length),[k,B,null]]):S.set(y.length,[[k,B,null]]));continue}if(N.readOnly===!0)continue;typeof N.checkedTemplate>"u"&&(N.checkedTemplate=!0),typeof N.uncheckedTemplate>"u"&&(N.uncheckedTemplate=!1);const ue=t.getDataAtCell(k,B);m===!1?[N.checkedTemplate,N.checkedTemplate.toString()].includes(ue)?C.push([k,B,N.uncheckedTemplate,q]):[N.uncheckedTemplate,N.uncheckedTemplate.toString(),null,void 0].includes(ue)&&C.push([k,B,N.checkedTemplate,q]):C.push([k,B,N.uncheckedTemplate,q]),A+=1}y.push(A),A=0}C.every(I=>{let[,,O]=I;return O===C[0][2]})?C=C.map(I=>{let[O,_,E]=I;return[O,_,E]}):C=C.map(I=>{let[O,_,,E]=I;return[O,_,E.checkedTemplate]}),C.length>0&&y.forEach((I,O)=>{let _=C.splice(0,I);S.size&&S.has(O)&&(_=[..._,...S.get(O)]),t.setDataAtCell(_)})}}function g(){const m=t.getSelectedRange();if(m){for(let p=0;p<m.length;p++){const y=m[p].getTopStartCorner(),S=m[p].getBottomEndCorner();for(let C=y.row;C<=S.row;C++)for(let A=y.col;A<=S.col;A++){const I=t.getCellMeta(C,A),O=t.getCell(C,A);if(O==null)return!0;if(O.querySelectorAll("input[type=checkbox]").length>0&&!I.readOnly)return!0}}return!1}}}Gb.RENDERER_TYPE=i2;function bK(t){let e=iA.get(t);if(!e){const{rootElement:r}=t;e=new Ms(t),e.addEventListener(r,"click",n=>_K(n,t)),e.addEventListener(r,"mouseup",n=>TK(n,t)),e.addEventListener(r,"change",n=>AK(n,t)),iA.set(t,e)}return e}function EK(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function RK(t,e,r){const n=t.createElement("label");return n.className=`htCheckboxRendererLabel ${r?"fullWidth":""}`,n.appendChild(t.createTextNode(e)),n.cloneNode(!0)}function TK(t,e){const{target:r}=t;Yb(r)&&(!r.hasAttribute(fh)||!r.hasAttribute(dh)||setTimeout(e.listen,10))}function _K(t,e){const{target:r}=t;if(!Yb(r)||!r.hasAttribute(fh)||!r.hasAttribute(dh))return;const n=parseInt(r.getAttribute(fh),10),i=parseInt(r.getAttribute(dh),10);e.getCellMeta(n,i).readOnly&&t.preventDefault()}function AK(t,e){const{target:r}=t;if(!Yb(r)||!r.hasAttribute(fh)||!r.hasAttribute(dh))return;const n=parseInt(r.getAttribute(fh),10),i=parseInt(r.getAttribute(dh),10),s=e.getCellMeta(n,i);if(!s.readOnly){let o=null;t.target.checked?o=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:o=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(n,i,o)}}function Yb(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const IK="handsontable";function Kb(t,e,r,n,i,s,o){Eh.apply(this,[t,e,r,n,i,s,o])}Kb.RENDERER_TYPE=IK;var s2={exports:{}};(function(t,e){(function(r){t.exports=r()})(function(){return function r(n,i,s){function o(c,u){if(!i[c]){if(!n[c]){var h=typeof Hg=="function"&&Hg;if(!u&&h)return h(c,!0);if(a)return a(c,!0);var f=new Error("Cannot find module '"+c+"'");throw f.code="MODULE_NOT_FOUND",f}var d=i[c]={exports:{}};n[c][0].call(d.exports,function(g){return o(n[c][1][g]||g)},d,d.exports,r,n,i,s)}return i[c].exports}for(var a=typeof Hg=="function"&&Hg,l=0;l<s.length;l++)o(s[l]);return o}({1:[function(r,n,i){(function(s){var o,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,c=Math.floor,u="[BigNumber Error] ",h=u+"Number primitive has more than 15 significant digits: ",f=1e14,d=14,g=9007199254740991,m=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],p=1e7,y=1e9;function S(b){var k=0|b;return 0<b||b===k?k:k-1}function C(b){for(var k,B,N=1,q=b.length,ue=b[0]+"";N<q;){for(k=b[N++]+"",B=d-k.length;B--;k="0"+k);ue+=k}for(q=ue.length;ue.charCodeAt(--q)===48;);return ue.slice(0,q+1||1)}function A(b,k){var B,N,q=b.c,ue=k.c,we=b.s,Se=k.s,ce=b.e,Re=k.e;if(!we||!Se)return null;if(B=q&&!q[0],N=ue&&!ue[0],B||N)return B?N?0:-Se:we;if(we!=Se)return we;if(B=we<0,N=ce==Re,!q||!ue)return N?0:!q^B?1:-1;if(!N)return Re<ce^B?1:-1;for(Se=(ce=q.length)<(Re=ue.length)?ce:Re,we=0;we<Se;we++)if(q[we]!=ue[we])return q[we]>ue[we]^B?1:-1;return ce==Re?0:Re<ce^B?1:-1}function I(b,k,B,N){if(b<k||B<b||b!==(b<0?l(b):c(b)))throw Error(u+(N||"Argument")+(typeof b=="number"?b<k||B<b?" out of range: ":" not an integer: ":" not a primitive number: ")+String(b))}function O(b){var k=b.c.length-1;return S(b.e/d)==k&&b.c[k]%2!=0}function _(b,k){return(1<b.length?b.charAt(0)+"."+b.slice(1):b)+(k<0?"e":"e+")+k}function E(b,k,B){var N,q;if(k<0){for(q=B+".";++k;q+=B);b=q+b}else if(++k>(N=b.length)){for(q=B,k-=N;--k;q+=B);b+=q}else k<N&&(b=b.slice(0,k)+"."+b.slice(k));return b}(o=function b(k){var B,N,q,ue,we,Se,ce,Re,Y,Pe,w=ae.prototype={constructor:ae,toString:null,valueOf:null},v=new ae(1),x=20,R=4,T=-7,L=21,K=-1e7,Q=1e7,Z=!1,ie=1,fe=0,H={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},Me="0123456789abcdefghijklmnopqrstuvwxyz";function ae(P,F){var G,ne,X,re,te,ee,oe,le,se=this;if(!(se instanceof ae))return new ae(P,F);if(F==null){if(P instanceof ae)return se.s=P.s,se.e=P.e,void(se.c=(P=P.c)?P.slice():P);if((ee=typeof P=="number")&&0*P==0){if(se.s=1/P<0?(P=-P,-1):1,P===~~P){for(re=0,te=P;10<=te;te/=10,re++);return se.e=re,void(se.c=[P])}le=String(P)}else{if(le=String(P),!a.test(le))return q(se,le,ee);se.s=le.charCodeAt(0)==45?(le=le.slice(1),-1):1}-1<(re=le.indexOf("."))&&(le=le.replace(".","")),0<(te=le.search(/e/i))?(re<0&&(re=te),re+=+le.slice(te+1),le=le.substring(0,te)):re<0&&(re=le.length)}else{if(I(F,2,Me.length,"Base"),le=String(P),F==10)return $e(se=new ae(P instanceof ae?P:le),x+se.e+1,R);if(ee=typeof P=="number"){if(0*P!=0)return q(se,le,ee,F);if(se.s=1/P<0?(le=le.slice(1),-1):1,ae.DEBUG&&15<le.replace(/^0\.0*|\./,"").length)throw Error(h+P);ee=!1}else se.s=le.charCodeAt(0)===45?(le=le.slice(1),-1):1;for(G=Me.slice(0,F),re=te=0,oe=le.length;te<oe;te++)if(G.indexOf(ne=le.charAt(te))<0){if(ne=="."){if(re<te){re=oe;continue}}else if(!X&&(le==le.toUpperCase()&&(le=le.toLowerCase())||le==le.toLowerCase()&&(le=le.toUpperCase()))){X=!0,te=-1,re=0;continue}return q(se,String(P),ee,F)}-1<(re=(le=N(le,F,10,se.s)).indexOf("."))?le=le.replace(".",""):re=le.length}for(te=0;le.charCodeAt(te)===48;te++);for(oe=le.length;le.charCodeAt(--oe)===48;);if(le=le.slice(te,++oe)){if(oe-=te,ee&&ae.DEBUG&&15<oe&&(g<P||P!==c(P)))throw Error(h+se.s*P);if(Q<(re=re-te-1))se.c=se.e=null;else if(re<K)se.c=[se.e=0];else{if(se.e=re,se.c=[],te=(re+1)%d,re<0&&(te+=d),te<oe){for(te&&se.c.push(+le.slice(0,te)),oe-=d;te<oe;)se.c.push(+le.slice(te,te+=d));le=le.slice(te),te=d-le.length}else te-=oe;for(;te--;le+="0");se.c.push(+le)}}else se.c=[se.e=0]}function ke(P,F,G,ne){var X,re,te,ee,oe;if(G==null?G=R:I(G,0,8),!P.c)return P.toString();if(X=P.c[0],te=P.e,F==null)oe=C(P.c),oe=ne==1||ne==2&&(te<=T||L<=te)?_(oe,te):E(oe,te,"0");else if(re=(P=$e(new ae(P),F,G)).e,ee=(oe=C(P.c)).length,ne==1||ne==2&&(F<=re||re<=T)){for(;ee<F;oe+="0",ee++);oe=_(oe,re)}else if(F-=te,oe=E(oe,re,"0"),ee<re+1){if(0<--F)for(oe+=".";F--;oe+="0");}else if(0<(F+=re-ee))for(re+1==ee&&(oe+=".");F--;oe+="0");return P.s<0&&X?"-"+oe:oe}function Ae(P,F){for(var G,ne=1,X=new ae(P[0]);ne<P.length;ne++){if(!(G=new ae(P[ne])).s){X=G;break}F.call(X,G)&&(X=G)}return X}function be(P,F,G){for(var ne=1,X=F.length;!F[--X];F.pop());for(X=F[0];10<=X;X/=10,ne++);return(G=ne+G*d-1)>Q?P.c=P.e=null:P.c=G<K?[P.e=0]:(P.e=G,F),P}function $e(P,F,G,ne){var X,re,te,ee,oe,le,se,Ee=P.c,Oe=m;if(Ee){e:{for(X=1,ee=Ee[0];10<=ee;ee/=10,X++);if((re=F-X)<0)re+=d,te=F,se=(oe=Ee[le=0])/Oe[X-te-1]%10|0;else if((le=l((re+1)/d))>=Ee.length){if(!ne)break e;for(;Ee.length<=le;Ee.push(0));oe=se=0,te=(re%=d)-d+(X=1)}else{for(oe=ee=Ee[le],X=1;10<=ee;ee/=10,X++);se=(te=(re%=d)-d+X)<0?0:oe/Oe[X-te-1]%10|0}if(ne=ne||F<0||Ee[le+1]!=null||(te<0?oe:oe%Oe[X-te-1]),ne=G<4?(se||ne)&&(G==0||G==(P.s<0?3:2)):5<se||se==5&&(G==4||ne||G==6&&(0<re?0<te?oe/Oe[X-te]:0:Ee[le-1])%10&1||G==(P.s<0?8:7)),F<1||!Ee[0])return Ee.length=0,ne?(F-=P.e+1,Ee[0]=Oe[(d-F%d)%d],P.e=-F||0):Ee[0]=P.e=0,P;if(re==0?(Ee.length=le,ee=1,le--):(Ee.length=le+1,ee=Oe[d-re],Ee[le]=0<te?c(oe/Oe[X-te]%Oe[te])*ee:0),ne)for(;;){if(le==0){for(re=1,te=Ee[0];10<=te;te/=10,re++);for(te=Ee[0]+=ee,ee=1;10<=te;te/=10,ee++);re!=ee&&(P.e++,Ee[0]==f&&(Ee[0]=1));break}if(Ee[le]+=ee,Ee[le]!=f)break;Ee[le--]=0,ee=1}for(re=Ee.length;Ee[--re]===0;Ee.pop());}P.e>Q?P.c=P.e=null:P.e<K&&(P.c=[P.e=0])}return P}function Le(P){var F,G=P.e;return G===null?P.toString():(F=C(P.c),F=G<=T||L<=G?_(F,G):E(F,G,"0"),P.s<0?"-"+F:F)}return ae.clone=b,ae.ROUND_UP=0,ae.ROUND_DOWN=1,ae.ROUND_CEIL=2,ae.ROUND_FLOOR=3,ae.ROUND_HALF_UP=4,ae.ROUND_HALF_DOWN=5,ae.ROUND_HALF_EVEN=6,ae.ROUND_HALF_CEIL=7,ae.ROUND_HALF_FLOOR=8,ae.EUCLID=9,ae.config=ae.set=function(P){var F,G;if(P!=null){if(typeof P!="object")throw Error(u+"Object expected: "+P);if(P.hasOwnProperty(F="DECIMAL_PLACES")&&(I(G=P[F],0,y,F),x=G),P.hasOwnProperty(F="ROUNDING_MODE")&&(I(G=P[F],0,8,F),R=G),P.hasOwnProperty(F="EXPONENTIAL_AT")&&((G=P[F])&&G.pop?(I(G[0],-y,0,F),I(G[1],0,y,F),T=G[0],L=G[1]):(I(G,-y,y,F),T=-(L=G<0?-G:G))),P.hasOwnProperty(F="RANGE"))if((G=P[F])&&G.pop)I(G[0],-y,-1,F),I(G[1],1,y,F),K=G[0],Q=G[1];else{if(I(G,-y,y,F),!G)throw Error(u+F+" cannot be zero: "+G);K=-(Q=G<0?-G:G)}if(P.hasOwnProperty(F="CRYPTO")){if((G=P[F])!==!!G)throw Error(u+F+" not true or false: "+G);if(G){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Z=!G,Error(u+"crypto unavailable");Z=G}else Z=G}if(P.hasOwnProperty(F="MODULO_MODE")&&(I(G=P[F],0,9,F),ie=G),P.hasOwnProperty(F="POW_PRECISION")&&(I(G=P[F],0,y,F),fe=G),P.hasOwnProperty(F="FORMAT")){if(typeof(G=P[F])!="object")throw Error(u+F+" not an object: "+G);H=G}if(P.hasOwnProperty(F="ALPHABET")){if(typeof(G=P[F])!="string"||/^.$|[+-.\s]|(.).*\1/.test(G))throw Error(u+F+" invalid: "+G);Me=G}}return{DECIMAL_PLACES:x,ROUNDING_MODE:R,EXPONENTIAL_AT:[T,L],RANGE:[K,Q],CRYPTO:Z,MODULO_MODE:ie,POW_PRECISION:fe,FORMAT:H,ALPHABET:Me}},ae.isBigNumber=function(P){return P instanceof ae||P&&P._isBigNumber===!0||!1},ae.maximum=ae.max=function(){return Ae(arguments,w.lt)},ae.minimum=ae.min=function(){return Ae(arguments,w.gt)},ae.random=(ue=9007199254740992,we=Math.random()*ue&2097151?function(){return c(Math.random()*ue)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(P){var F,G,ne,X,re,te=0,ee=[],oe=new ae(v);if(P==null?P=x:I(P,0,y),X=l(P/d),Z)if(crypto.getRandomValues){for(F=crypto.getRandomValues(new Uint32Array(X*=2));te<X;)9e15<=(re=131072*F[te]+(F[te+1]>>>11))?(G=crypto.getRandomValues(new Uint32Array(2)),F[te]=G[0],F[te+1]=G[1]):(ee.push(re%1e14),te+=2);te=X/2}else{if(!crypto.randomBytes)throw Z=!1,Error(u+"crypto unavailable");for(F=crypto.randomBytes(X*=7);te<X;)9e15<=(re=281474976710656*(31&F[te])+1099511627776*F[te+1]+4294967296*F[te+2]+16777216*F[te+3]+(F[te+4]<<16)+(F[te+5]<<8)+F[te+6])?crypto.randomBytes(7).copy(F,te):(ee.push(re%1e14),te+=7);te=X/7}if(!Z)for(;te<X;)(re=we())<9e15&&(ee[te++]=re%1e14);for(X=ee[--te],P%=d,X&&P&&(re=m[d-P],ee[te]=c(X/re)*re);ee[te]===0;ee.pop(),te--);if(te<0)ee=[ne=0];else{for(ne=-1;ee[0]===0;ee.splice(0,1),ne-=d);for(te=1,re=ee[0];10<=re;re/=10,te++);te<d&&(ne-=d-te)}return oe.e=ne,oe.c=ee,oe}),ae.sum=function(){for(var P=1,F=arguments,G=new ae(F[0]);P<F.length;)G=G.plus(F[P++]);return G},N=function(){var P="0123456789";function F(G,ne,X,re){for(var te,ee,oe=[0],le=0,se=G.length;le<se;){for(ee=oe.length;ee--;oe[ee]*=ne);for(oe[0]+=re.indexOf(G.charAt(le++)),te=0;te<oe.length;te++)oe[te]>X-1&&(oe[te+1]==null&&(oe[te+1]=0),oe[te+1]+=oe[te]/X|0,oe[te]%=X)}return oe.reverse()}return function(G,ne,X,re,te){var ee,oe,le,se,Ee,Oe,De,ze,lt=G.indexOf("."),nt=x,Je=R;for(0<=lt&&(se=fe,fe=0,G=G.replace(".",""),Oe=(ze=new ae(ne)).pow(G.length-lt),fe=se,ze.c=F(E(C(Oe.c),Oe.e,"0"),10,X,P),ze.e=ze.c.length),le=se=(De=F(G,ne,X,te?(ee=Me,P):(ee=P,Me))).length;De[--se]==0;De.pop());if(!De[0])return ee.charAt(0);if(lt<0?--le:(Oe.c=De,Oe.e=le,Oe.s=re,De=(Oe=B(Oe,ze,nt,Je,X)).c,Ee=Oe.r,le=Oe.e),lt=De[oe=le+nt+1],se=X/2,Ee=Ee||oe<0||De[oe+1]!=null,Ee=Je<4?(lt!=null||Ee)&&(Je==0||Je==(Oe.s<0?3:2)):se<lt||lt==se&&(Je==4||Ee||Je==6&&1&De[oe-1]||Je==(Oe.s<0?8:7)),oe<1||!De[0])G=Ee?E(ee.charAt(1),-nt,ee.charAt(0)):ee.charAt(0);else{if(De.length=oe,Ee)for(--X;++De[--oe]>X;)De[oe]=0,oe||(++le,De=[1].concat(De));for(se=De.length;!De[--se];);for(lt=0,G="";lt<=se;G+=ee.charAt(De[lt++]));G=E(G,le,ee.charAt(0))}return G}}(),B=function(){function P(ne,X,re){var te,ee,oe,le,se=0,Ee=ne.length,Oe=X%p,De=X/p|0;for(ne=ne.slice();Ee--;)se=((ee=Oe*(oe=ne[Ee]%p)+(te=De*oe+(le=ne[Ee]/p|0)*Oe)%p*p+se)/re|0)+(te/p|0)+De*le,ne[Ee]=ee%re;return se&&(ne=[se].concat(ne)),ne}function F(ne,X,re,te){var ee,oe;if(re!=te)oe=te<re?1:-1;else for(ee=oe=0;ee<re;ee++)if(ne[ee]!=X[ee]){oe=ne[ee]>X[ee]?1:-1;break}return oe}function G(ne,X,re,te){for(var ee=0;re--;)ne[re]-=ee,ee=ne[re]<X[re]?1:0,ne[re]=ee*te+ne[re]-X[re];for(;!ne[0]&&1<ne.length;ne.splice(0,1));}return function(ne,X,re,te,ee){var oe,le,se,Ee,Oe,De,ze,lt,nt,Je,yt,Jt,_o,hi,vl,cn,Zt,Mr=ne.s==X.s?1:-1,zr=ne.c,Xt=X.c;if(!(zr&&zr[0]&&Xt&&Xt[0]))return new ae(ne.s&&X.s&&(zr?!Xt||zr[0]!=Xt[0]:Xt)?zr&&zr[0]==0||!Xt?0*Mr:Mr/0:NaN);for(nt=(lt=new ae(Mr)).c=[],Mr=re+(le=ne.e-X.e)+1,ee||(ee=f,le=S(ne.e/d)-S(X.e/d),Mr=Mr/d|0),se=0;Xt[se]==(zr[se]||0);se++);if(Xt[se]>(zr[se]||0)&&le--,Mr<0)nt.push(1),Ee=!0;else{for(hi=zr.length,cn=Xt.length,Mr+=2,1<(Oe=c(ee/(Xt[se=0]+1)))&&(Xt=P(Xt,Oe,ee),zr=P(zr,Oe,ee),cn=Xt.length,hi=zr.length),_o=cn,yt=(Je=zr.slice(0,cn)).length;yt<cn;Je[yt++]=0);Zt=Xt.slice(),Zt=[0].concat(Zt),vl=Xt[0],Xt[1]>=ee/2&&vl++;do{if(Oe=0,(oe=F(Xt,Je,cn,yt))<0){if(Jt=Je[0],cn!=yt&&(Jt=Jt*ee+(Je[1]||0)),1<(Oe=c(Jt/vl)))for(ee<=Oe&&(Oe=ee-1),ze=(De=P(Xt,Oe,ee)).length,yt=Je.length;F(De,Je,ze,yt)==1;)Oe--,G(De,cn<ze?Zt:Xt,ze,ee),ze=De.length,oe=1;else Oe==0&&(oe=Oe=1),ze=(De=Xt.slice()).length;if(ze<yt&&(De=[0].concat(De)),G(Je,De,yt,ee),yt=Je.length,oe==-1)for(;F(Xt,Je,cn,yt)<1;)Oe++,G(Je,cn<yt?Zt:Xt,yt,ee),yt=Je.length}else oe===0&&(Oe++,Je=[0]);nt[se++]=Oe,Je[0]?Je[yt++]=zr[_o]||0:(Je=[zr[_o]],yt=1)}while((_o++<hi||Je[0]!=null)&&Mr--);Ee=Je[0]!=null,nt[0]||nt.splice(0,1)}if(ee==f){for(se=1,Mr=nt[0];10<=Mr;Mr/=10,se++);$e(lt,re+(lt.e=se+le*d-1)+1,te,Ee)}else lt.e=le,lt.r=+Ee;return lt}}(),Se=/^(-?)0([xbo])(?=\w[\w.]*$)/i,ce=/^([^.]+)\.$/,Re=/^\.([^.]+)$/,Y=/^-?(Infinity|NaN)$/,Pe=/^\s*\+(?=[\w.])|^\s+|\s+$/g,q=function(P,F,G,ne){var X,re=G?F:F.replace(Pe,"");if(Y.test(re))P.s=isNaN(re)?null:re<0?-1:1,P.c=P.e=null;else{if(!G&&(re=re.replace(Se,function(te,ee,oe){return X=(oe=oe.toLowerCase())=="x"?16:oe=="b"?2:8,ne&&ne!=X?te:ee}),ne&&(X=ne,re=re.replace(ce,"$1").replace(Re,"0.$1")),F!=re))return new ae(re,X);if(ae.DEBUG)throw Error(u+"Not a"+(ne?" base "+ne:"")+" number: "+F);P.c=P.e=P.s=null}},w.absoluteValue=w.abs=function(){var P=new ae(this);return P.s<0&&(P.s=1),P},w.comparedTo=function(P,F){return A(this,new ae(P,F))},w.decimalPlaces=w.dp=function(P,F){var G,ne,X;if(P!=null)return I(P,0,y),F==null?F=R:I(F,0,8),$e(new ae(this),P+this.e+1,F);if(!(G=this.c))return null;if(ne=((X=G.length-1)-S(this.e/d))*d,X=G[X])for(;X%10==0;X/=10,ne--);return ne<0&&(ne=0),ne},w.dividedBy=w.div=function(P,F){return B(this,new ae(P,F),x,R)},w.dividedToIntegerBy=w.idiv=function(P,F){return B(this,new ae(P,F),0,1)},w.exponentiatedBy=w.pow=function(P,F){var G,ne,X,re,te,ee,oe,le,se=this;if((P=new ae(P)).c&&!P.isInteger())throw Error(u+"Exponent not an integer: "+Le(P));if(F!=null&&(F=new ae(F)),te=14<P.e,!se.c||!se.c[0]||se.c[0]==1&&!se.e&&se.c.length==1||!P.c||!P.c[0])return le=new ae(Math.pow(+Le(se),te?2-O(P):+Le(P))),F?le.mod(F):le;if(ee=P.s<0,F){if(F.c?!F.c[0]:!F.s)return new ae(NaN);(ne=!ee&&se.isInteger()&&F.isInteger())&&(se=se.mod(F))}else{if(9<P.e&&(0<se.e||se.e<-1||(se.e==0?1<se.c[0]||te&&24e7<=se.c[1]:se.c[0]<8e13||te&&se.c[0]<=9999975e7)))return re=se.s<0&&O(P)?-0:0,-1<se.e&&(re=1/re),new ae(ee?1/re:re);fe&&(re=l(fe/d+2))}for(oe=te?(G=new ae(.5),ee&&(P.s=1),O(P)):(X=Math.abs(+Le(P)))%2,le=new ae(v);;){if(oe){if(!(le=le.times(se)).c)break;re?le.c.length>re&&(le.c.length=re):ne&&(le=le.mod(F))}if(X){if((X=c(X/2))===0)break;oe=X%2}else if($e(P=P.times(G),P.e+1,1),14<P.e)oe=O(P);else{if((X=+Le(P))==0)break;oe=X%2}se=se.times(se),re?se.c&&se.c.length>re&&(se.c.length=re):ne&&(se=se.mod(F))}return ne?le:(ee&&(le=v.div(le)),F?le.mod(F):re?$e(le,fe,R,void 0):le)},w.integerValue=function(P){var F=new ae(this);return P==null?P=R:I(P,0,8),$e(F,F.e+1,P)},w.isEqualTo=w.eq=function(P,F){return A(this,new ae(P,F))===0},w.isFinite=function(){return!!this.c},w.isGreaterThan=w.gt=function(P,F){return 0<A(this,new ae(P,F))},w.isGreaterThanOrEqualTo=w.gte=function(P,F){return(F=A(this,new ae(P,F)))===1||F===0},w.isInteger=function(){return!!this.c&&S(this.e/d)>this.c.length-2},w.isLessThan=w.lt=function(P,F){return A(this,new ae(P,F))<0},w.isLessThanOrEqualTo=w.lte=function(P,F){return(F=A(this,new ae(P,F)))===-1||F===0},w.isNaN=function(){return!this.s},w.isNegative=function(){return this.s<0},w.isPositive=function(){return 0<this.s},w.isZero=function(){return!!this.c&&this.c[0]==0},w.minus=function(P,F){var G,ne,X,re,te=this,ee=te.s;if(F=(P=new ae(P,F)).s,!ee||!F)return new ae(NaN);if(ee!=F)return P.s=-F,te.plus(P);var oe=te.e/d,le=P.e/d,se=te.c,Ee=P.c;if(!oe||!le){if(!se||!Ee)return se?(P.s=-F,P):new ae(Ee?te:NaN);if(!se[0]||!Ee[0])return Ee[0]?(P.s=-F,P):new ae(se[0]?te:R==3?-0:0)}if(oe=S(oe),le=S(le),se=se.slice(),ee=oe-le){for((X=(re=ee<0)?(ee=-ee,se):(le=oe,Ee)).reverse(),F=ee;F--;X.push(0));X.reverse()}else for(ne=(re=(ee=se.length)<(F=Ee.length))?ee:F,ee=F=0;F<ne;F++)if(se[F]!=Ee[F]){re=se[F]<Ee[F];break}if(re&&(X=se,se=Ee,Ee=X,P.s=-P.s),0<(F=(ne=Ee.length)-(G=se.length)))for(;F--;se[G++]=0);for(F=f-1;ee<ne;){if(se[--ne]<Ee[ne]){for(G=ne;G&&!se[--G];se[G]=F);--se[G],se[ne]+=f}se[ne]-=Ee[ne]}for(;se[0]==0;se.splice(0,1),--le);return se[0]?be(P,se,le):(P.s=R==3?-1:1,P.c=[P.e=0],P)},w.modulo=w.mod=function(P,F){var G,ne,X=this;return P=new ae(P,F),!X.c||!P.s||P.c&&!P.c[0]?new ae(NaN):!P.c||X.c&&!X.c[0]?new ae(X):(ie==9?(ne=P.s,P.s=1,G=B(X,P,0,3),P.s=ne,G.s*=ne):G=B(X,P,0,ie),(P=X.minus(G.times(P))).c[0]||ie!=1||(P.s=X.s),P)},w.multipliedBy=w.times=function(P,F){var G,ne,X,re,te,ee,oe,le,se,Ee,Oe,De,ze,lt,nt,Je=this,yt=Je.c,Jt=(P=new ae(P,F)).c;if(!(yt&&Jt&&yt[0]&&Jt[0]))return!Je.s||!P.s||yt&&!yt[0]&&!Jt||Jt&&!Jt[0]&&!yt?P.c=P.e=P.s=null:(P.s*=Je.s,yt&&Jt?(P.c=[0],P.e=0):P.c=P.e=null),P;for(ne=S(Je.e/d)+S(P.e/d),P.s*=Je.s,(oe=yt.length)<(Ee=Jt.length)&&(ze=yt,yt=Jt,Jt=ze,X=oe,oe=Ee,Ee=X),X=oe+Ee,ze=[];X--;ze.push(0));for(lt=f,nt=p,X=Ee;0<=--X;){for(G=0,Oe=Jt[X]%nt,De=Jt[X]/nt|0,re=X+(te=oe);X<re;)G=((le=Oe*(le=yt[--te]%nt)+(ee=De*le+(se=yt[te]/nt|0)*Oe)%nt*nt+ze[re]+G)/lt|0)+(ee/nt|0)+De*se,ze[re--]=le%lt;ze[re]=G}return G?++ne:ze.splice(0,1),be(P,ze,ne)},w.negated=function(){var P=new ae(this);return P.s=-P.s||null,P},w.plus=function(P,F){var G,ne=this,X=ne.s;if(F=(P=new ae(P,F)).s,!X||!F)return new ae(NaN);if(X!=F)return P.s=-F,ne.minus(P);var re=ne.e/d,te=P.e/d,ee=ne.c,oe=P.c;if(!re||!te){if(!ee||!oe)return new ae(X/0);if(!ee[0]||!oe[0])return oe[0]?P:new ae(ee[0]?ne:0*X)}if(re=S(re),te=S(te),ee=ee.slice(),X=re-te){for((G=0<X?(te=re,oe):(X=-X,ee)).reverse();X--;G.push(0));G.reverse()}for((X=ee.length)-(F=oe.length)<0&&(G=oe,oe=ee,ee=G,F=X),X=0;F;)X=(ee[--F]=ee[F]+oe[F]+X)/f|0,ee[F]=f===ee[F]?0:ee[F]%f;return X&&(ee=[X].concat(ee),++te),be(P,ee,te)},w.precision=w.sd=function(P,F){var G,ne,X;if(P!=null&&P!==!!P)return I(P,1,y),F==null?F=R:I(F,0,8),$e(new ae(this),P,F);if(!(G=this.c))return null;if(ne=(X=G.length-1)*d+1,X=G[X]){for(;X%10==0;X/=10,ne--);for(X=G[0];10<=X;X/=10,ne++);}return P&&this.e+1>ne&&(ne=this.e+1),ne},w.shiftedBy=function(P){return I(P,-g,g),this.times("1e"+P)},w.squareRoot=w.sqrt=function(){var P,F,G,ne,X,re=this,te=re.c,ee=re.s,oe=re.e,le=x+4,se=new ae("0.5");if(ee!==1||!te||!te[0])return new ae(!ee||ee<0&&(!te||te[0])?NaN:te?re:1/0);if((G=(ee=Math.sqrt(+Le(re)))==0||ee==1/0?(((F=C(te)).length+oe)%2==0&&(F+="0"),ee=Math.sqrt(+F),oe=S((oe+1)/2)-(oe<0||oe%2),new ae(F=ee==1/0?"1e"+oe:(F=ee.toExponential()).slice(0,F.indexOf("e")+1)+oe)):new ae(ee+"")).c[0]){for((ee=(oe=G.e)+le)<3&&(ee=0);;)if(X=G,G=se.times(X.plus(B(re,X,le,1))),C(X.c).slice(0,ee)===(F=C(G.c)).slice(0,ee)){if(G.e<oe&&--ee,(F=F.slice(ee-3,ee+1))!="9999"&&(ne||F!="4999")){+F&&(+F.slice(1)||F.charAt(0)!="5")||($e(G,G.e+x+2,1),P=!G.times(G).eq(re));break}if(!ne&&($e(X,X.e+x+2,0),X.times(X).eq(re))){G=X;break}le+=4,ee+=4,ne=1}}return $e(G,G.e+x+1,R,P)},w.toExponential=function(P,F){return P!=null&&(I(P,0,y),P++),ke(this,P,F,1)},w.toFixed=function(P,F){return P!=null&&(I(P,0,y),P=P+this.e+1),ke(this,P,F)},w.toFormat=function(P,F,G){var ne;if(G==null)P!=null&&F&&typeof F=="object"?(G=F,F=null):P&&typeof P=="object"?(G=P,P=F=null):G=H;else if(typeof G!="object")throw Error(u+"Argument not an object: "+G);if(ne=this.toFixed(P,F),this.c){var X,re=ne.split("."),te=+G.groupSize,ee=+G.secondaryGroupSize,oe=G.groupSeparator||"",le=re[0],se=re[1],Ee=this.s<0,Oe=Ee?le.slice(1):le,De=Oe.length;if(ee&&(X=te,te=ee,De-=ee=X),0<te&&0<De){for(X=De%te||te,le=Oe.substr(0,X);X<De;X+=te)le+=oe+Oe.substr(X,te);0<ee&&(le+=oe+Oe.slice(X)),Ee&&(le="-"+le)}ne=se?le+(G.decimalSeparator||"")+((ee=+G.fractionGroupSize)?se.replace(new RegExp("\\d{"+ee+"}\\B","g"),"$&"+(G.fractionGroupSeparator||"")):se):le}return(G.prefix||"")+ne+(G.suffix||"")},w.toFraction=function(P){var F,G,ne,X,re,te,ee,oe,le,se,Ee,Oe,De=this,ze=De.c;if(P!=null&&(!(ee=new ae(P)).isInteger()&&(ee.c||ee.s!==1)||ee.lt(v)))throw Error(u+"Argument "+(ee.isInteger()?"out of range: ":"not an integer: ")+Le(ee));if(!ze)return new ae(De);for(F=new ae(v),le=G=new ae(v),ne=oe=new ae(v),Oe=C(ze),re=F.e=Oe.length-De.e-1,F.c[0]=m[(te=re%d)<0?d+te:te],P=!P||0<ee.comparedTo(F)?0<re?F:le:ee,te=Q,Q=1/0,ee=new ae(Oe),oe.c[0]=0;se=B(ee,F,0,1),(X=G.plus(se.times(ne))).comparedTo(P)!=1;)G=ne,ne=X,le=oe.plus(se.times(X=le)),oe=X,F=ee.minus(se.times(X=F)),ee=X;return X=B(P.minus(G),ne,0,1),oe=oe.plus(X.times(le)),G=G.plus(X.times(ne)),oe.s=le.s=De.s,Ee=B(le,ne,re*=2,R).minus(De).abs().comparedTo(B(oe,G,re,R).minus(De).abs())<1?[le,ne]:[oe,G],Q=te,Ee},w.toNumber=function(){return+Le(this)},w.toPrecision=function(P,F){return P!=null&&I(P,1,y),ke(this,P,F,2)},w.toString=function(P){var F,G=this,ne=G.s,X=G.e;return X===null?ne?(F="Infinity",ne<0&&(F="-"+F)):F="NaN":(F=P==null?X<=T||L<=X?_(C(G.c),X):E(C(G.c),X,"0"):P===10?E(C((G=$e(new ae(G),x+X+1,R)).c),G.e,"0"):(I(P,2,Me.length,"Base"),N(E(C(G.c),X,"0"),10,P,ne,!0)),ne<0&&G.c[0]&&(F="-"+F)),F},w.valueOf=w.toJSON=function(){return Le(this)},w._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(w[Symbol.toStringTag]="BigNumber",w[Symbol.for("nodejs.util.inspect.custom")]=w.valueOf),k!=null&&ae.set(k),ae}()).default=o.BigNumber=o,n!==void 0&&n.exports?n.exports=o:(s||(s=typeof self<"u"&&self?self:window),s.BigNumber=o)})(this)},{}],2:[function(r,n,i){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(s){var o=s%10;return~~(s%100/10)==1?"th":o===1?"st":o===2?"nd":o===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,i){function s(S,C){return function(A){if(Array.isArray(A))return A}(S)||function(A,I){var O=[],_=!0,E=!1,b=void 0;try{for(var k,B=A[Symbol.iterator]();!(_=(k=B.next()).done)&&(O.push(k.value),!I||O.length!==I);_=!0);}catch(N){E=!0,b=N}finally{try{_||B.return==null||B.return()}finally{if(E)throw b}}return O}(S,C)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=r("./globalState"),a=r("./validating"),l=r("./parsing"),c=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],u={general:{scale:1024,suffixes:c,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:c,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function f(S){var C=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},A=2<arguments.length?arguments[2]:void 0;if(typeof C=="string"&&(C=l.parseFormat(C)),!a.validateFormat(C))return"ERROR: invalid format";var I=C.prefix||"",O=C.postfix||"",_=function(E,b,k){switch(b.output){case"currency":return b=y(b,o.currentCurrencyDefaultFormat()),function(Me,ae,ke){var Ae=ke.currentCurrency(),be=Object.assign({},h,ae),$e=void 0,Le="",P=!!be.totalLength||!!be.forceAverage||be.average,F=ae.currencyPosition||Ae.position,G=ae.currencySymbol||Ae.symbol;be.spaceSeparated&&(Le=" "),F==="infix"&&($e=Le+G+Le);var ne=p({instance:Me,providedFormat:ae,state:ke,decimalSeparator:$e});return F==="prefix"&&(ne=Me._value<0&&be.negative==="sign"?"-".concat(Le).concat(G).concat(ne.slice(1)):G+Le+ne),F&&F!=="postfix"||(ne=ne+(Le=P?"":Le)+G),ne}(E,b,o);case"percent":return b=y(b,o.currentPercentageDefaultFormat()),function(Me,ae,ke,Ae){var be=ae.prefixSymbol,$e=p({instance:Ae(100*Me._value),providedFormat:ae,state:ke}),Le=Object.assign({},h,ae);return be?"%".concat(Le.spaceSeparated?" ":"").concat($e):"".concat($e).concat(Le.spaceSeparated?" ":"","%")}(E,b,o,k);case"byte":return b=y(b,o.currentByteDefaultFormat()),v=E,R=o,T=k,L=(x=b).base||"binary",K=u[L],Q=d(v._value,K.suffixes,K.scale),Z=Q.value,ie=Q.suffix,fe=p({instance:T(Z),providedFormat:x,state:R,defaults:R.currentByteDefaultFormat()}),H=R.currentAbbreviations(),"".concat(fe).concat(H.spaced?" ":"").concat(ie);case"time":return b=y(b,o.currentTimeDefaultFormat()),Re=E,Y=Math.floor(Re._value/60/60),Pe=Math.floor((Re._value-60*Y*60)/60),w=Math.round(Re._value-60*Y*60-60*Pe),"".concat(Y,":").concat(Pe<10?"0":"").concat(Pe,":").concat(w<10?"0":"").concat(w);case"ordinal":return b=y(b,o.currentOrdinalDefaultFormat()),B=E,N=b,ue=(q=o).currentOrdinal(),we=Object.assign({},h,N),Se=p({instance:B,providedFormat:N,state:q}),ce=ue(B._value),"".concat(Se).concat(we.spaceSeparated?" ":"").concat(ce);case"number":default:return p({instance:E,providedFormat:b,numbro:k})}var B,N,q,ue,we,Se,ce,Re,Y,Pe,w,v,x,R,T,L,K,Q,Z,ie,fe,H}(S,C,A);return _=(_=I+_)+O}function d(S,C,A){var I=C[0],O=Math.abs(S);if(A<=O){for(var _=1;_<C.length;++_){var E=Math.pow(A,_),b=Math.pow(A,_+1);if(E<=O&&O<b){I=C[_],S/=E;break}}I===C[0]&&(S/=Math.pow(A,C.length-1),I=C[C.length-1])}return{value:S,suffix:I}}function g(S){for(var C="",A=0;A<S;A++)C+="0";return C}function m(S,C){return S.toString().indexOf("e")!==-1?function(A,I){var O=A.toString(),_=s(O.split("e"),2),E=_[0],b=_[1],k=s(E.split("."),2),B=k[0],N=k[1],q=N===void 0?"":N;if(0<+b)O=B+q+g(b-q.length);else{var ue=".";ue=+B<0?"-0".concat(ue):"0".concat(ue);var we=(g(-b-1)+Math.abs(B)+q).substr(0,I);we.length<I&&(we+=g(I-we.length)),O=ue+we}return 0<+b&&0<I&&(O+=".".concat(g(I))),O}(S,C):(Math.round(+"".concat(S,"e+").concat(C))/Math.pow(10,C)).toFixed(C)}function p(S){var C=S.instance,A=S.providedFormat,I=S.state,O=I===void 0?o:I,_=S.decimalSeparator,E=S.defaults,b=E===void 0?O.currentDefaults():E,k=C._value;if(k===0&&O.hasZeroFormat())return O.getZeroFormat();if(!isFinite(k))return k.toString();var B,N,q,ue,we,Se,ce,Re,Y=Object.assign({},h,b,A),Pe=Y.totalLength,w=Pe?0:Y.characteristic,v=Y.optionalCharacteristic,x=Y.forceAverage,R=!!Pe||!!x||Y.average,T=Pe?-1:R&&A.mantissa===void 0?0:Y.mantissa,L=!Pe&&(A.optionalMantissa===void 0?T===-1:Y.optionalMantissa),K=Y.trimMantissa,Q=Y.thousandSeparated,Z=Y.spaceSeparated,ie=Y.negative,fe=Y.forceSign,H=Y.exponential,Me="";if(R){var ae=function(P){var F=P.value,G=P.forceAverage,ne=P.abbreviations,X=P.spaceSeparated,re=X!==void 0&&X,te=P.totalLength,ee=te===void 0?0:te,oe="",le=Math.abs(F),se=-1;if(le>=Math.pow(10,12)&&!G||G==="trillion"?(oe=ne.trillion,F/=Math.pow(10,12)):le<Math.pow(10,12)&&le>=Math.pow(10,9)&&!G||G==="billion"?(oe=ne.billion,F/=Math.pow(10,9)):le<Math.pow(10,9)&&le>=Math.pow(10,6)&&!G||G==="million"?(oe=ne.million,F/=Math.pow(10,6)):(le<Math.pow(10,6)&&le>=Math.pow(10,3)&&!G||G==="thousand")&&(oe=ne.thousand,F/=Math.pow(10,3)),oe&&(oe=(re?" ":"")+oe),ee){var Ee=F.toString().split(".")[0];se=Math.max(ee-Ee.length,0)}return{value:F,abbreviation:oe,mantissaPrecision:se}}({value:k,forceAverage:x,abbreviations:O.currentAbbreviations(),spaceSeparated:Z,totalLength:Pe});k=ae.value,Me+=ae.abbreviation,Pe&&(T=ae.mantissaPrecision)}if(H){var ke=(N=(B={value:k,characteristicPrecision:w}).value,q=B.characteristicPrecision,ue=q===void 0?0:q,we=s(N.toExponential().split("e"),2),Se=we[0],ce=we[1],Re=+Se,ue&&1<ue&&(Re*=Math.pow(10,ue-1),ce=0<=(ce=+ce-(ue-1))?"+".concat(ce):ce),{value:Re,abbreviation:"e".concat(ce)});k=ke.value,Me=ke.abbreviation+Me}var Ae,be,$e,Le=function(P,F,G,ne,X){if(ne===-1)return P;var re=m(F,ne),te=s(re.toString().split("."),2),ee=te[0],oe=te[1],le=oe===void 0?"":oe;if(le.match(/^0+$/)&&(G||X))return ee;var se=le.match(/0+$/);return X&&se?"".concat(ee,".").concat(le.toString().slice(0,se.index)):re.toString()}(k.toString(),k,L,T,K);return Le=function(P,F,G,ne,X){var re=ne.currentDelimiters(),te=re.thousands;X=X||re.decimal;var ee=re.thousandsSize||3,oe=P.toString(),le=oe.split(".")[0],se=oe.split(".")[1];return G&&(F<0&&(le=le.slice(1)),function(Ee,Oe){for(var De=[],ze=0,lt=Ee;0<lt;lt--)ze===Oe&&(De.unshift(lt),ze=0),ze++;return De}(le.length,ee).forEach(function(Ee,Oe){le=le.slice(0,Ee+Oe)+te+le.slice(Ee+Oe)}),F<0&&(le="-".concat(le))),oe=se?le+X+se:le}(Le=function(P,F,G,ne){var X=P,re=s(X.toString().split("."),2),te=re[0],ee=re[1];if(te.match(/^-?0$/)&&G)return ee?"".concat(te.replace("0",""),".").concat(ee):te.replace("0","");if(te.length<ne)for(var oe=ne-te.length,le=0;le<oe;le++)X="0".concat(X);return X.toString()}(Le,0,v,w),k,Q,O,_),(R||H)&&(Le=Le+Me),(fe||k<0)&&(Ae=Le,$e=ie,Le=(be=k)===0?Ae:+Ae==0?Ae.replace("-",""):0<be?"+".concat(Ae):$e==="sign"?Ae:"(".concat(Ae.replace("-",""),")")),Le}function y(S,C){if(!S)return C;var A=Object.keys(S);return A.length===1&&A[0]==="output"?C:S}n.exports=function(S){return{format:function(){for(var C=arguments.length,A=new Array(C),I=0;I<C;I++)A[I]=arguments[I];return f.apply(void 0,A.concat([S]))},getByteUnit:function(){for(var C=arguments.length,A=new Array(C),I=0;I<C;I++)A[I]=arguments[I];return(function(O){var _=u.general;return d(O._value,_.suffixes,_.scale).suffix}).apply(void 0,A.concat([S]))},getBinaryByteUnit:function(){for(var C=arguments.length,A=new Array(C),I=0;I<C;I++)A[I]=arguments[I];return(function(O){var _=u.binary;return d(O._value,_.suffixes,_.scale).suffix}).apply(void 0,A.concat([S]))},getDecimalByteUnit:function(){for(var C=arguments.length,A=new Array(C),I=0;I<C;I++)A[I]=arguments[I];return(function(O){var _=u.decimal;return d(O._value,_.suffixes,_.scale).suffix}).apply(void 0,A.concat([S]))},formatOrDefault:y}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,i){var s=r("./en-US"),o=r("./validating"),a=r("./parsing"),l={},c=void 0,u={},h=null,f={};function d(m){c=m}function g(){return u[c]}l.languages=function(){return Object.assign({},u)},l.currentLanguage=function(){return c},l.currentCurrency=function(){return g().currency},l.currentAbbreviations=function(){return g().abbreviations},l.currentDelimiters=function(){return g().delimiters},l.currentOrdinal=function(){return g().ordinal},l.currentDefaults=function(){return Object.assign({},g().defaults,f)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),g().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),g().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),g().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),g().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),g().timeFormat)},l.setDefaults=function(m){m=a.parseFormat(m),o.validateFormat(m)&&(f=m)},l.getZeroFormat=function(){return h},l.setZeroFormat=function(m){return h=typeof m=="string"?m:null},l.hasZeroFormat=function(){return h!==null},l.languageData=function(m){if(m){if(u[m])return u[m];throw new Error('Unknown tag "'.concat(m,'"'))}return g()},l.registerLanguage=function(m){var p=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!o.validateLanguage(m))throw new Error("Invalid language data");u[m.languageTag]=m,p&&d(m.languageTag)},l.setLanguage=function(m){var p=1<arguments.length&&arguments[1]!==void 0?arguments[1]:s.languageTag;if(!u[m]){var y=m.split("-")[0],S=Object.keys(u).find(function(C){return C.split("-")[0]===y});return u[S]?void d(S):void d(p)}d(m)},l.registerLanguage(s),c=s.languageTag,n.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,i){n.exports=function(s){return{loadLanguagesInNode:function(o){return a=s,void o.forEach(function(l){var c=void 0;try{c=r("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}c&&a.registerLanguage(c)});var a}}}},{}],6:[function(r,n,i){var s=r("bignumber.js");function o(a,l,c){var u=new s(a._value),h=l;return c.isNumbro(l)&&(h=l._value),h=new s(h),a._value=u.minus(h).toNumber(),a}n.exports=function(a){return{add:function(l,c){return h=c,f=a,d=new s((u=l)._value),g=h,f.isNumbro(h)&&(g=h._value),g=new s(g),u._value=d.plus(g).toNumber(),u;var u,h,f,d,g},subtract:function(l,c){return o(l,c,a)},multiply:function(l,c){return h=c,f=a,d=new s((u=l)._value),g=h,f.isNumbro(h)&&(g=h._value),g=new s(g),u._value=d.times(g).toNumber(),u;var u,h,f,d,g},divide:function(l,c){return h=c,f=a,d=new s((u=l)._value),g=h,f.isNumbro(h)&&(g=h._value),g=new s(g),u._value=d.dividedBy(g).toNumber(),u;var u,h,f,d,g},set:function(l,c){return u=l,f=h=c,a.isNumbro(h)&&(f=h._value),u._value=f,u;var u,h,f},difference:function(l,c){return u=c,o(f=(h=a)(l._value),u,h),Math.abs(f._value);var u,h,f}}}},{"bignumber.js":1}],7:[function(r,n,i){function s(p,y){for(var S=0;S<y.length;S++){var C=y[S];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(p,C.key,C)}}var o=r("./globalState"),a=r("./validating"),l=r("./loading")(m),c=r("./unformatting"),u=r("./formatting")(m),h=r("./manipulating")(m),f=r("./parsing"),d=function(){function p(C){(function(A,I){if(!(A instanceof I))throw new TypeError("Cannot call a class as a function")})(this,p),this._value=C}var y,S;return y=p,(S=[{key:"clone",value:function(){return m(this._value)}},{key:"format",value:function(){var C=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return u.format(this,C)}},{key:"formatCurrency",value:function(C){return typeof C=="string"&&(C=f.parseFormat(C)),(C=u.formatOrDefault(C,o.currentCurrencyDefaultFormat())).output="currency",u.format(this,C)}},{key:"formatTime",value:function(){var C=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return C.output="time",u.format(this,C)}},{key:"binaryByteUnits",value:function(){return u.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return u.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return u.getByteUnit(this)}},{key:"difference",value:function(C){return h.difference(this,C)}},{key:"add",value:function(C){return h.add(this,C)}},{key:"subtract",value:function(C){return h.subtract(this,C)}},{key:"multiply",value:function(C){return h.multiply(this,C)}},{key:"divide",value:function(C){return h.divide(this,C)}},{key:"set",value:function(C){return h.set(this,g(C))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&s(y.prototype,S),p}();function g(p){var y=p;return m.isNumbro(p)?y=p._value:typeof p=="string"?y=m.unformat(p):isNaN(p)&&(y=NaN),y}function m(p){return new d(g(p))}m.version="2.1.2",m.isNumbro=function(p){return p instanceof d},m.language=o.currentLanguage,m.registerLanguage=o.registerLanguage,m.setLanguage=o.setLanguage,m.languages=o.languages,m.languageData=o.languageData,m.zeroFormat=o.setZeroFormat,m.defaultFormat=o.currentDefaults,m.setDefaults=o.setDefaults,m.defaultCurrencyFormat=o.currentCurrencyDefaultFormat,m.validate=a.validate,m.loadLanguagesInNode=l.loadLanguagesInNode,m.unformat=c.unformat,n.exports=m},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,i){n.exports={parseFormat:function(s){var o,a,l,c,u,h,f,d,g,m,p,y,S,C,A,I,O,_,E,b,k=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof s!="string"?s:(a=k,s=(l=(o=s).match(/^{([^}]*)}/))?(a.prefix=l[1],o.slice(l[0].length)):o,u=k,function(B,N){if(B.indexOf("$")===-1){if(B.indexOf("%")===-1)return B.indexOf("bd")!==-1?(N.output="byte",N.base="general"):B.indexOf("b")!==-1?(N.output="byte",N.base="binary"):B.indexOf("d")!==-1?(N.output="byte",N.base="decimal"):B.indexOf(":")===-1?B.indexOf("o")!==-1&&(N.output="ordinal"):N.output="time";N.output="percent"}else N.output="currency"}(s=(h=(c=s).match(/{([^}]*)}$/))?(u.postfix=h[1],c.slice(0,-h[0].length)):c,k),f=k,(d=s.match(/[1-9]+[0-9]*/))&&(f.totalLength=+d[0]),g=k,(m=s.split(".")[0].match(/0+/))&&(g.characteristic=m[0].length),function(B,N){if(B.indexOf(".")!==-1){var q=B.split(".")[0];N.optionalCharacteristic=q.indexOf("0")===-1}}(s,k),p=k,s.indexOf("a")!==-1&&(p.average=!0),S=k,(y=s).indexOf("K")!==-1?S.forceAverage="thousand":y.indexOf("M")!==-1?S.forceAverage="million":y.indexOf("B")!==-1?S.forceAverage="billion":y.indexOf("T")!==-1&&(S.forceAverage="trillion"),function(B,N){var q=B.split(".")[1];if(q){var ue=q.match(/0+/);ue&&(N.mantissa=ue[0].length)}}(s,k),A=k,(C=s).match(/\[\.]/)?A.optionalMantissa=!0:C.match(/\./)&&(A.optionalMantissa=!1),I=k,s.indexOf(",")!==-1&&(I.thousandSeparated=!0),O=k,s.indexOf(" ")!==-1&&(O.spaceSeparated=!0),E=k,(_=s).match(/^\+?\([^)]*\)$/)&&(E.negative="parenthesis"),_.match(/^\+?-/)&&(E.negative="sign"),b=k,s.match(/^\+/)&&(b.forceSign=!0),k)}}},{}],9:[function(r,n,i){var s=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function o(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,c){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",h=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,g=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===f?0:function m(p,y){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",C=3<arguments.length?arguments[3]:void 0,A=4<arguments.length?arguments[4]:void 0,I=5<arguments.length?arguments[5]:void 0,O=6<arguments.length?arguments[6]:void 0;if(!isNaN(+p))return+p;var _="",E=p.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(E!==p)return-1*m(E,y,S,C,A,I,O);for(var b=0;b<s.length;b++){var k=s[b];if((_=p.replace(k.key,""))!==p)return m(_,y,S,C,A,I,O)*k.factor}if((_=p.replace("%",""))!==p)return m(_,y,S,C,A,I,O)/100;var B=parseFloat(p);if(!isNaN(B)){var N=C(B);if(N&&N!=="."&&(_=p.replace(new RegExp("".concat(o(N),"$")),""))!==p)return m(_,y,S,C,A,I,O);var q={};Object.keys(I).forEach(function(Pe){q[I[Pe]]=Pe});for(var ue=Object.keys(q).sort().reverse(),we=ue.length,Se=0;Se<we;Se++){var ce=ue[Se],Re=q[ce];if((_=p.replace(ce,""))!==p){var Y=void 0;switch(Re){case"thousand":Y=Math.pow(10,3);break;case"million":Y=Math.pow(10,6);break;case"billion":Y=Math.pow(10,9);break;case"trillion":Y=Math.pow(10,12)}return m(_,y,S,C,A,I,O)*Y}}}}(function(m,p){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=m.replace(y,"");return S=(S=S.replace(new RegExp("([0-9])".concat(o(p.thousands),"([0-9])"),"g"),"$1$2")).replace(p.decimal,".")}(l,c,u),c,u,h,f,d,g)}n.exports={unformat:function(l,c){var u,h,f,d=r("./globalState"),g=d.currentDelimiters(),m=d.currentCurrency().symbol,p=d.currentOrdinal(),y=d.getZeroFormat(),S=d.currentAbbreviations(),C=void 0;if(typeof l=="string")C=function(A,I){if(!A.indexOf(":")||I.thousands===":")return!1;var O=A.split(":");if(O.length!==3)return!1;var _=+O[0],E=+O[1],b=+O[2];return!isNaN(_)&&!isNaN(E)&&!isNaN(b)}(l,g)?(u=l.split(":"),h=+u[0],f=+u[1],+u[2]+60*f+3600*h):a(l,g,m,p,y,S,c);else{if(typeof l!="number")return;C=l}if(C!==void 0)return C}}},{"./globalState":4}],10:[function(r,n,i){function s(g){return function(m){if(Array.isArray(m)){for(var p=0,y=new Array(m.length);p<m.length;p++)y[p]=m[p];return y}}(g)||function(m){if(Symbol.iterator in Object(m)||Object.prototype.toString.call(m)==="[object Arguments]")return Array.from(m)}(g)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(g){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(g)}var a=r("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,c={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(g,m){return m.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(g){return g.output==="byte"}},characteristic:{type:"number",restriction:function(g){return 0<=g},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(g){return 0<=g},message:"value must be positive"},{restriction:function(g,m){return!m.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(g){return 0<=g},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(g,m){return m.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},u={languageTag:{type:"string",mandatory:!0,restriction:function(g){return g.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(g){return!!a.unformat(g)}function f(g,m,p){var y=3<arguments.length&&arguments[3]!==void 0&&arguments[3],S=Object.keys(g).map(function(C){if(!m[C])return console.error("".concat(p," Invalid key: ").concat(C)),!1;var A=g[C],I=m[C];if(typeof I=="string"&&(I={type:I}),I.type==="format"){if(!f(A,c,"[Validate ".concat(C,"]"),!0))return!1}else if(o(A)!==I.type)return console.error("".concat(p," ").concat(C,' type mismatched: "').concat(I.type,'" expected, "').concat(o(A),'" provided')),!1;if(I.restrictions&&I.restrictions.length)for(var O=I.restrictions.length,_=0;_<O;_++){var E=I.restrictions[_],b=E.restriction,k=E.message;if(!b(A,g))return console.error("".concat(p," ").concat(C," invalid value: ").concat(k)),!1}return I.restriction&&!I.restriction(A,g)?(console.error("".concat(p," ").concat(C," invalid value: ").concat(I.message)),!1):I.validValues&&I.validValues.indexOf(A)===-1?(console.error("".concat(p," ").concat(C," invalid value: must be among ").concat(JSON.stringify(I.validValues),', "').concat(A,'" provided')),!1):!(I.children&&!f(A,I.children,"[Validate ".concat(C,"]")))});return y||S.push.apply(S,s(Object.keys(m).map(function(C){var A=m[C];if(typeof A=="string"&&(A={type:A}),A.mandatory){var I=A.mandatory;if(typeof I=="function"&&(I=I(g)),I&&g[C]===void 0)return console.error("".concat(p,' Missing mandatory key "').concat(C,'"')),!1}return!0}))),S.reduce(function(C,A){return C&&A},!0)}function d(g){return f(g,c,"[Validate format]")}n.exports={validate:function(g,m){var p=h(g),y=d(m);return p&&y},validateFormat:d,validateInput:h,validateLanguage:function(g){return f(g,u,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(s2);var MK=s2.exports;const Ol=eO(MK),OK="numeric";function o2(t,e){if(Wn(t)){const r=e.numericFormat,n=r&&r.culture||"-",i=r&&r.pattern;if(typeof n<"u"&&!Ol.languages()[n]){const s=n.replace("-",""),o=Ol.allLanguages?Ol.allLanguages[n]:Ol[s];o&&Ol.registerLanguage(o)}Ol.setLanguage(n),t=Ol(t).format(i||"0")}return t}function Xb(t,e,r,n,i,s,o){let a=s;if(Wn(a)){const l=o.className||"",c=l.length?l.split(" "):[];a=o2(a,o),c.indexOf("htLeft")<0&&c.indexOf("htCenter")<0&&c.indexOf("htRight")<0&&c.indexOf("htJustify")<0&&c.push("htRight"),c.indexOf("htNumeric")<0&&c.push("htNumeric"),o.className=c.join(" "),e.dir="ltr"}fa(t,e,r,n,i,a,o)}Xb.RENDERER_TYPE=OK;const PK="password";function qb(t,e,r,n,i,s,o){fa.apply(this,[t,e,r,n,i,s,o]);const a=o.hashLength||e.innerHTML.length,l=o.hashSymbol||"*";let c="";Ge(a-1,()=>{c+=l}),xh(e,c)}qb.RENDERER_TYPE=PK;const kK="select";function Jb(t,e,r,n,i,s,o){fa.apply(this,[t,e,r,n,i,s,o])}Jb.RENDERER_TYPE=kK;const NK="time";function Zb(t,e,r,n,i,s,o){fa.apply(this,[t,e,r,n,i,s,o]),e.dir="ltr"}Zb.RENDERER_TYPE=NK;function FK(){Hi(Eh),Hi(pg),Hi(Gb),Hi(zb),Hi(Kb),Hi(jb),Hi(Xb),Hi(qb),Hi(Jb),Hi(fa),Hi(Zb)}const HK="autocomplete";function $v(t,e){let r=t;if(r==null&&(r=""),this.allowEmpty&&r===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,sA(r,e)):sA(r,e)(this.source):e(!0)}$v.VALIDATOR_TYPE=HK;function sA(t,e){const r=t;return function(n){let i=!1;for(let s=0,o=n.length;s<o;s++)if(r===n[s]){i=!0;break}e(i)}}function DK(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const LK="date";function Qb(t,e){const r=DP(Zk,this.instance);let n=t,i=!0;n==null&&(n="");let s=At(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),o=At(new Date(n)).isValid()||s;if(this.allowEmpty&&n===""&&(o=!0,s=!0),o||(i=!1),!o&&s&&(i=!0),o&&!s)if(this.correctFormat===!0){const a=$K(n,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}Qb.VALIDATOR_TYPE=LK;function $K(t,e){const r=At(DK(t)),n=At(t,e),i=t.search(/[A-z]/g)>-1;let s;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||i?s=r:s=n,s.format(e)}const BK="dropdown";function eE(t,e){$v.apply(this,[t,e])}eE.VALIDATOR_TYPE=BK;const VK="numeric";function tE(t,e){let r=t;r==null&&(r=""),this.allowEmpty&&r===""?e(!0):e(r===""?!1:Wn(t))}tE.VALIDATOR_TYPE=VK;const WK=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],UK="time";function rE(t,e){const r=this.timeFormat||"h:mm:ss a";let n=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const s=/^\d{1,2}$/.test(i);s&&(i+=":00");const o=At(i,WK,!0).isValid()?At(i):At(i,r);let a=o.isValid(),l=At(i,r,!0).isValid()&&!s;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(n=!1),!a&&l&&(n=!0),a&&!l)if(this.correctFormat===!0){const c=o.format(r);this.instance.setDataAtCell(this.visualRow,this.visualCol,c,"timeValidator"),n=!0}else n=!1;e(n)}rE.VALIDATOR_TYPE=UK;function jK(){Lu($v),Lu(eE),Lu(Qb),Lu(tE),Lu(rE)}const zK="autocomplete",GK={CELL_TYPE:zK,editor:Vb,renderer:Eh,validator:$v},YK="checkbox",KK={CELL_TYPE:YK,editor:Jk,renderer:Gb},XK="date";function a2(t,e,r,n,i,s,o){Eh.apply(this,[t,e,r,n,i,s,o])}a2.RENDERER_TYPE=XK;const qK="date",JK={CELL_TYPE:qK,editor:Qk,renderer:a2,validator:Qb},ZK="dropdown",QK={CELL_TYPE:ZK,editor:Ub,renderer:zb,validator:eE},eX="handsontable",tX={CELL_TYPE:eX,editor:Bb,renderer:Kb},rX="numeric",nX={CELL_TYPE:rX,editor:e2,renderer:Xb,validator:tE,dataType:"number"},iX="password",sX={CELL_TYPE:iX,editor:t2,renderer:qb,copyable:!1},oX="select",aX={CELL_TYPE:oX,editor:r2,renderer:Jb},lX="time",cX={CELL_TYPE:lX,editor:n2,renderer:Zb,validator:rE};function uX(){gs(GK),gs(KK),gs(JK),gs(QK),gs(tX),gs(nX),gs(sX),gs(aX),gs(Vk),gs(cX)}function hX(t,e){l2(t,e),e.add(t)}function fX(t,e,r){l2(t,e),e.set(t,r)}function l2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uu(t,e,r){return(e=dX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dX(t){var e=gX(t,"string");return typeof e=="symbol"?e:e+""}function gX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hu(t,e){return t.get(c2(t,e))}function c2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const oA=new Map([["plugin",XU],["cell-type",Pk],["editor",HP],["renderer",jP],["validator",zP]]),mX="base",OC=[];let Ws=null;var Pl=new WeakMap,aA=new WeakSet;class kt{static get PLUGIN_KEY(){return mX}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){hX(this,aA),uu(this,"eventManager",new Ms(this)),uu(this,"pluginName",null),uu(this,"pluginsInitializedCallbacks",[]),uu(this,"isPluginsReady",!1),uu(this,"enabled",!1),uu(this,"initialized",!1),fX(this,Pl,{}),ua(this,"hot",e,{writable:!1}),Ws=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const i=[];if(r.forEach(s=>{const[o,a]=s.split(":");if(!oA.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);oA.get(o)(a)||i.push(` - ${a} (${o})`)}),i.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");OC.push(s)}}if(Ws||(Ws=UP()),Ws.indexOf("UndoRedo")>=0&&Ws.splice(Ws.indexOf("UndoRedo"),1),Ws.indexOf(this.pluginName)>=0&&Ws.splice(Ws.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Ws.length===0){if(OC.length>0){const i=[`${OC.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,r,n){hu(Pl,this)[e]=hu(Pl,this)[e]||[];const i=hu(Pl,this)[e];this.hot.addHook(e,r,n),i.push(r),hu(Pl,this)[e]=i}removeHooks(e){J(hu(Pl,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=hu(Pl,this);gt(e,(r,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){J(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=c2(aA,this,pX).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),gt(this,(r,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function pX(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function kl(t,e,r){return(e=vX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vX(t){var e=wX(t,"string");return typeof e=="symbol"?e:e+""}function wX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let u2=class{constructor(e){kl(this,"hot",null),kl(this,"container",null),kl(this,"injected",!1),kl(this,"rows",[]),kl(this,"columns",[]),kl(this,"samples",null),kl(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),J(this.rows,r=>{const{height:n}=r.table.getBoundingClientRect();e(r.row,Math.ceil(n)-1)})}getWidths(e){this.injected||this.injectTable(),J(this.columns,r=>{const{width:n}=r.table.getBoundingClientRect();e(r.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{J(n.strings,i=>{r.appendChild(this.createColElement(i.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),n.appendChild(i)),this.samples.forEach(s=>{J(s.strings,o=>{const a=o.col,l=this.hot.getCellMeta(e,a),c=this.hot.getCellRenderer(l),u=r.createElement("td");u.setAttribute("ghost-table",1),c(this.hot,u,e,a,this.hot.colToProp(a),o.value,l),n.appendChild(u)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");n.push([-1,i]),r.appendChild(i)}this.samples.forEach(i=>{J(i.strings,s=>{const o=s.col,a=e.createElement("th");n.push([o,a]),r.appendChild(a)})}),this.table.tHead.appendChild(r),J(n,i=>{const[s,o]=i;this.hot.view.appendColHeader(s,o)})}createCol(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment();return this.samples.forEach(i=>{J(i.strings,s=>{const o=s.row,a=this.hot.getCellMeta(o,e),l=this.hot.getCellRenderer(a),c=r.createElement("td"),u=r.createElement("tr");c.setAttribute("ghost-table",1),l(this.hot,c,o,e,this.hot.colToProp(e),s.value,a),u.appendChild(c),n.appendChild(u)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const n=this.hot.rootDocument.createElement("col");let i=0;r>=0&&e>=0&&(i=this.hot.getCellMeta(r,e).colspan);let s=this.hot.getColWidth(e);if(i>1)for(let o=e+1;o<e+i;o++)s+=this.hot.getColWidth(o);return n.style.width=`${s}px`,n}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("table"),s=r.createElement("thead"),o=r.createElement("tbody"),a=r.createElement("colgroup"),l=r.createElement("tr"),c=r.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(c),s.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(s),this.isVertical()&&o.appendChild(l),i.appendChild(o),_e(i,e),n.appendChild(i),{fragment:n,table:i,tHead:s,tBody:o,colGroup:a,tr:l,th:c}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return _e(i,s),n.appendChild(i),{fragment:n,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function M0(t,e,r){return(e=CX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CX(t){var e=yX(t,"string");return typeof e=="symbol"?e:e+""}function yX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bv{static get SAMPLE_COUNT(){return 3}constructor(e){M0(this,"samples",null),M0(this,"dataFactory",null),M0(this,"customSampleCount",null),M0(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Bv.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,n){const i=new Map,{from:s,to:o}=typeof n=="number"?{from:n,to:n}:n;return Ge(s,o,a=>{const l=this.generateSample(e,r,a);i.set(a,l)}),i}generateSample(e,r,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,s=e==="row"?"col":"row",o=[];return Ge(r.from,r.to,a=>{const l=e==="row"?this.dataFactory(n,a):this.dataFactory(a,n);if(l===!1)return;const{value:c,bundleSeed:u}=l,h=typeof u=="string"&&u.length>0;let f;h?f=u:dt(c)?f=`${Object.keys(c).length}`:Array.isArray(c)?f=`${c.length}`:f=`${Nr(c).length}`,i.has(f)||i.set(f,{needed:this.getSampleCount(),strings:[]});const d=i.get(f);d.needed&&(!(o.indexOf(c)>-1)||this.allowDuplicates||h)&&(d.strings.push({value:c,[s]:a}),o.push(c),d.needed-=1)}),i}}function xX(t,e){h2(t,e),e.add(t)}function lA(t,e,r){h2(t,e),e.set(t,r)}function h2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sf(t,e,r){return(e=SX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SX(t){var e=bX(t,"string");return typeof e=="symbol"?e:e+""}function bX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lc(t,e){return t.get(ao(t,e))}function nE(t,e,r){return t.set(ao(t,e),r),r}function ao(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}We.getSingleton().register("modifyAutoColumnSizeSeed");const of="autoColumnSize",EX=10,RX="autoColumnSize";var $u=new WeakMap,gh=new WeakMap,Uo=new WeakSet;class qf extends kt{static get PLUGIN_KEY(){return of}static get PLUGIN_PRIORITY(){return EX}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),xX(this,Uo),sf(this,"ghostTable",new u2(this.hot)),sf(this,"samplesGenerator",new Bv((r,n)=>{const i=this.hot.toPhysicalRow(r),s=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s))return!1;const o=this.hot.getCellMeta(r,n);let a="";o.spanned||(a=this.hot.getDataAtCell(r,n));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,o,a)),{value:a,bundleSeed:l}})),sf(this,"inProgress",!1),sf(this,"measuredColumns",0),sf(this,"columnWidthsMap",new fl),lA(this,$u,[]),lA(this,gh,[]),this.hot.columnIndexMapper.registerMap(RX,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,n,i)=>ao(Uo,this,cA).call(this,r,n,i))}isEnabled(){return this.hot.getSettings()[of]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[of];r&&r.useHeaders!==null&&r.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",r.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return ao(Uo,e,AX).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return ao(Uo,e,IX).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return ao(Uo,e,OX).call(e,...i)}),this.addHook("beforeRender",()=>ao(Uo,this,_X).call(this)),this.addHook("modifyColWidth",(n,i)=>this.getColumnWidth(i,n)),this.addHook("init",()=>ao(Uo,this,MX).call(this)),super.enablePlugin()}updatePlugin(){nE(gh,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,n)=>ao(Uo,this,cA).call(this,e,r,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const n=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:r},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof r=="number"?{from:r,to:r}:r;Ge(i.from,i.to,o=>{let a=this.hot.toPhysicalColumn(o);a===null&&(a=o),(n||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&this.samplesGenerator.generateColumnSamples(o,s).forEach((c,u)=>this.ghostTable.addColumn(u,c))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((o,a)=>{const l=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countCols()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){fp(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+qf.CALCULATION_STEP,i)},e,r),n=n+qf.CALCULATION_STEP+1,n<i?s=zx(o):(fp(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,r),n=a+1),n<i?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[of],r=e&&Cr(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&Cr(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[of];let r=qf.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return dt(e)&&(r=e.syncLimit,rP(r)?r=BP(n,r):r>>=0),Math.min(r,n)}getColumnWidth(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=r;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof i=="number"&&(i=Math.max(i,Iv))),i}getFirstVisibleColumn(){var e;return(e=this.hot.view.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.view.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((n,i,s)=>{const o=lc($u,this).length;return(o-1<s||lc($u,this)[s]!==i)&&n.push(this.hot.toVisualColumn(s)),o-1<s?lc($u,this).push(i):lc($u,this)[s]=i,n},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function TX(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const n=this.hot.toPhysicalColumn(r);n!==null&&(this.hot._getColWidthFromSettings(n)||this.samplesGenerator.generateColumnSamples(r,e).forEach((s,o)=>this.ghostTable.addColumn(o,s)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((r,n)=>{const i=this.hot.toPhysicalColumn(r);this.columnWidthsMap.setValueAtIndex(i,n)})},!0),this.ghostTable.clean())}function _X(){this.calculateVisibleColumnsWidth(),this.inProgress||(ao(Uo,this,TX).call(this,lc(gh,this)),nE(gh,this,[]))}function AX(t,e){e||this.recalculateAllColumnsWidth()}function IX(t){const e=t.reduce((r,n)=>{let[,i]=n;const s=this.hot.propToCol(i);return Number.isInteger(s)&&r.indexOf(s)===-1&&r.push(s),r},[]);lc(gh,this).push(...e)}function cA(t,e,r){let n=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function MX(){nE($u,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function OX(t){const e=t.reduce((r,n)=>{var i;const s=(i=n.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(s)){const o=this.hot.toVisualColumn(s);r.indexOf(o)===-1&&r.push(o)}return r},[]);lc(gh,this).push(...e)}const cc={horizontal:"horizontal",vertical:"vertical"};function PX(t,e,r){let n,i,s;return e[0]===t[0]&&e[1]<t[1]?(s="left",n=r(e[0],e[1]),i=r(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(s="right",n=r(e[0],t[3]+1),i=r(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(s="up",n=r(e[0],e[1]),i=r(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(s="down",n=r(t[2]+1,e[1]),i=r(e[2],e[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:s,startOfDragCoords:n,endOfDragCoords:i}}function kX(t){const e={};return t===!0?(e.directions=Object.keys(cc),e.autoInsertRow=!0):dt(t)?(Ue(t.autoInsertRow)?t.direction===cc.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Ue(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(cc)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function NX(t,e){FX(t,e),e.add(t)}function FX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fu(t,e,r){return(e=HX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HX(t){var e=DX(t,"string");return typeof e=="symbol"?e:e+""}function DX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function af(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}We.getSingleton().register("modifyAutofillRange");We.getSingleton().register("beforeAutofill");We.getSingleton().register("afterAutofill");const uA="autofill",LX=20,$X=["fillHandle"],BX="insert_row_below",VX=200;var du=new WeakSet;class WX extends kt{constructor(){super(...arguments),NX(this,du),fu(this,"addingStarted",!1),fu(this,"mouseDownOnCellCorner",!1),fu(this,"mouseDragOutside",!1),fu(this,"handleDraggedCells",0),fu(this,"directions",[]),fu(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return uA}static get PLUGIN_PRIORITY(){return LX}static get SETTING_KEYS(){return[uA,...$X]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>af(du,this,jX).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>af(du,this,UX).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,r)=>af(du,this,zX).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:r,col:n}=e.getTopStartCorner(),{row:i,col:s}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:n,endRow:i,endCol:s}]),a=[],l=[],c=[];return J(o,u=>{for(let h=u.startRow;h<=u.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=u.startCol;h<=u.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),J(a,u=>{const h=[];J(l,f=>{h.push(this.hot.getCopyableData(u,f))}),c.push(h)}),c}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,r,n,i]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),o=s.getTopStartCorner(),a=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[o.row,o.col,a.row,a.col],c=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,r),Math.max(a.row,n),Math.max(a.col,i)],l),{directionOfDrag:u,startOfDragCoords:h,endOfDragCoords:f}=PX(l,c,(d,g)=>this.hot._createCellCoords(d,g));if(h&&h.row>-1&&h.col>-1){const d=this.getSelectionData(),g=s.clone(),m=this.hot._createCellRange(h,h,f),p=this.hot.runHooks("beforeAutofill",d,g,m,u);if(p===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let y=p;const S=p;if(["up","left"].indexOf(u)>-1&&!(S.length===1&&S[0].length===0))if(y=[],u==="up"){const C=f.row-h.row+1,A=C%S.length;for(let I=0;I<C;I++)y.push(S[(I+(S.length-A))%S.length])}else{const C=f.col-h.col+1,A=C%S[0].length;for(let I=0;I<S.length;I++){y.push([]);for(let O=0;O<C;O++)y[I].push(S[I][(O+(S[I].length-A))%S[I].length])}}this.hot.populateFromArray(h.row,h.col,y,f.row,f.col,`${this.pluginName}.fill`,null),this.setSelection(c),this.hot.runHooks("afterAutofill",y,g,m,u),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const r=this.hot.getSelectedRangeLast(),n=r.getBottomEndCorner();let i=e;if(this.directions.includes(cc.vertical)&&this.directions.includes(cc.horizontal)){const s=r.getTopStartCorner();(n.col<=e.col||s.col>=e.col)&&(i=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||s.row>e.row)&&(i=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes(cc.vertical))i=this.hot._createCellCoords(e.row,n.col);else if(this.directions.includes(cc.horizontal))i=this.hot._createCellCoords(n.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const r=this.getCoordsOfDragAndDropBorders(e);r&&this.redrawBorders(r)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(BX,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},VX)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),r=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&r[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const r=this.hot.getData(),n=this.hot.countRows();let i;for(let s=e[2]+1;s<n;s++){for(let l=e[1];l<=e[3];l++){const c=r[s][l];if(!_r(c))return-1}const o=r[s][e[1]-1],a=r[s][e[3]+1];(!_r(o)||!_r(a))&&(i=s)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,r){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(r,e[3])).commit()}setSelection(e){this.hot.selectCell(...bt(e,r=>Math.max(r,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),r=this.getIndexOfLastAdjacentFilledInRow(e);return r===-1||r===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,r),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:r}=this.hot.rootDocument,n=sn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||r.scrollTop)+Fr(this.hot.table),i=sn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||r.scrollLeft)+rr(this.hot.table);return e.clientY>n&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>af(du,this,GX).call(this)),this.eventManager.addEventListener(e,"mousemove",r=>af(du,this,YX).call(this,r))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=kX(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function UX(){this.selectAdjacent()&&this.fillIn()}function jX(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function zX(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function GX(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function YX(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function KX(t,e){f2(t,e),e.add(t)}function XX(t,e,r){f2(t,e),e.set(t,r)}function f2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gu(t,e,r){return(e=qX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qX(t){var e=JX(t,"string");return typeof e=="symbol"?e:e+""}function JX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ZX(t,e,r){return t.set(lo(t,e),r),r}function iE(t,e){return t.get(lo(t,e))}function lo(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const O0="autoRowSize",QX=40,eq="autoRowSize";var Od=new WeakMap,jo=new WeakSet;class Jf extends kt{static get PLUGIN_KEY(){return O0}static get PLUGIN_PRIORITY(){return QX}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),KX(this,jo),gu(this,"headerHeight",null),gu(this,"ghostTable",new u2(this.hot)),gu(this,"samplesGenerator",new Bv((r,n)=>{const i=this.hot.toPhysicalRow(r),s=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s)||r>=0&&n>=0&&this.hot.getCellMeta(r,n).hidden)return!1;let o;return r>=0?o=this.hot.getDataAtCell(r,n):r===-1&&(o=this.hot.getColHeader(n)),{value:o}})),gu(this,"inProgress",!1),gu(this,"measuredRows",0),gu(this,"rowHeightsMap",new fl),XX(this,Od,[]),this.hot.rowIndexMapper.registerMap(eq,this.rowHeightsMap),this.addHook("beforeRowResize",(r,n,i)=>lo(jo,this,hA).call(this,r,n,i))}isEnabled(){const e=this.hot.getSettings()[O0];return e===!0||dt(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return lo(jo,e,nq).call(e,...n)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return lo(jo,e,iq).call(e,...n)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return lo(jo,e,oq).call(e,...n)}),this.addHook("beforeRender",()=>lo(jo,this,rq).call(this)),this.addHook("modifyRowHeight",(r,n)=>this.getRowHeight(n,r)),this.addHook("init",()=>lo(jo,this,sq).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,r,n)=>lo(jo,this,hA).call(this,e,r,n))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(e===-1||r===-1)return;const n=this.hot.renderCall;this.calculateRowsHeight({from:e,to:r},void 0,n)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof r=="number"?{from:r,to:r}:r;if(this.hot.getColHeader(0)!==null){const o=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(o.get(-1))}Ge(i.from,i.to,o=>{let a=this.hot.toPhysicalRow(o);a===null&&(a=o),(n||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(o,s).forEach((c,u)=>this.ghostTable.addRow(u,c))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((o,a)=>{o<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(o),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countRows()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){fp(s),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+Jf.CALCULATION_STEP,i)},e,r),n=n+Jf.CALCULATION_STEP+1,n<i?s=zx(o):(fp(s),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,r),n=a+1),n<i?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}setSamplingOptions(){const e=this.hot.getSettings()[O0],r=e&&Cr(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&Cr(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[O0];let r=Jf.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return dt(e)&&(r=e.syncLimit,rP(r)?r=BP(n,r):r>>=0),Math.min(r,n)}getRowHeight(e,r){const n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=r;return n!==null&&n>(r||0)&&(i=n),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.view.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.view.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:r,to:n}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{Ge(Math.min(r,n),Math.max(r,n),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function tq(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(r=>{this.samplesGenerator.generateRowSamples(r,e).forEach((i,s)=>this.ghostTable.addRow(s,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((r,n)=>{const i=this.hot.toPhysicalRow(r);this.rowHeightsMap.setValueAtIndex(i,n)})},!0),this.ghostTable.clean())}function rq(){this.calculateVisibleRowsHeight(),this.inProgress||(lo(jo,this,tq).call(this,iE(Od,this)),ZX(Od,this,[]))}function hA(t,e,r){let n=t;return r&&(this.calculateRowsHeight(e,void 0,!0),n=this.getRowHeight(e)),n}function nq(t,e){e||this.recalculateAllRowsHeight()}function iq(t){const e=t.reduce((r,n)=>{let[i]=n;return r.indexOf(i)===-1&&r.push(i),r},[]);iE(Od,this).push(...e)}function sq(){this.recalculateAllRowsHeight()}function oq(t){const e=t.reduce((r,n)=>{var i;const s=(i=n.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(s)){const o=this.hot.toVisualRow(s);r.indexOf(o)===-1&&r.push(o)}return r},[]);iE(Od,this).push(...e)}const{getListWithInsertedItems:aq,getListWithRemovedItems:lq}=gk("physicallyIndexed");class cq extends Uc{constructor(){super(e=>e)}insert(e,r){const n=xS(this.indexedValues,r);this.indexedValues=aq(n,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){const r=lq(this.indexedValues,e);this.indexedValues=yS(r,e),super.remove(e)}}const{getListWithInsertedItems:uq,getListWithRemovedItems:hq}=gk("physicallyIndexed");class fq extends Uc{constructor(){super(e=>e)}insert(e,r){this.indexedValues=uq(this.indexedValues,e,r,(n,i)=>this.getNextValue(i)),super.insert(e,r)}remove(e){this.indexedValues=hq(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function dq(t,e){gq(t,e),e.add(t)}function gq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mq(t,e,r){return(e=pq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pq(t){var e=vq(t,"string");return typeof e=="symbol"?e:e+""}function vq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wq(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PC="bindRowsWithHeaders",Cq=210,yq="loose",xq=new Map([["loose",cq],["strict",fq]]);var fA=new WeakSet;class Sq extends kt{constructor(){super(...arguments),dq(this,fA),mq(this,"headerIndexes",null)}static get PLUGIN_KEY(){return PC}static get PLUGIN_PRIORITY(){return Cq}isEnabled(){return!!this.hot.getSettings()[PC]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[PC];typeof e!="string"&&(e=yq);const r=xq.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new r),this.addHook("modifyRowHeader",n=>wq(fA,this,bq).call(this,n)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function bq(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Eq(t,e){d2(t,e),e.add(t)}function Rq(t,e,r){d2(t,e),e.set(t,r)}function d2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dA(t,e,r){return(e=Tq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Tq(t){var e=_q(t,"string");return typeof e=="symbol"?e:e+""}function _q(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gA(t,e){return t.get(Yu(t,e))}function kC(t,e,r){return t.set(Yu(t,e),r),r}function Yu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Gm="collapsibleColumns",Aq=290,Iq=["nestedHeaders"],Zu="collapsibleIndicator",mA=Gm,pA=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var mu=new WeakMap,lf=new WeakSet;class Mq extends kt{constructor(){super(...arguments),Eq(this,lf),dA(this,"nestedHeadersPlugin",null),dA(this,"headerStateManager",null),Rq(this,mu,null)}static get PLUGIN_KEY(){return Gm}static get PLUGIN_PRIORITY(){return Aq}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Gm,...Iq]}isEnabled(){return!!this.hot.getSettings()[Gm]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();r||Ft("You need to configure the Nested Headers plugin in order to use collapsible headers."),kC(mu,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Yu(lf,this,kq).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Yu(lf,e,Nq).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Yu(lf,e,Oq).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(n,i,s)=>Yu(lf,this,Pq).call(this,n,i,s)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(r=>({collapsible:r.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),kC(mu,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:r,col:n}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:s,columnIndex:o}=(e=this.headerStateManager.getHeaderTreeNodeData(r,n))!==null&&e!==void 0?e:{};if(i)return s?this.expandSection({row:r,col:o}):this.collapseSection({row:r,col:o}),!1},runOnlyIf:()=>{var e,r;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isHeader())},group:mA,relativeToGroup:dl,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(mA)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,r=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(o){o&&o.parentNode.removeChild(o)};Ge(0,e-1,o=>{const a=r.childNodes[o],l=n.childNodes[o],c=i?i.childNodes[o]:null;Ge(0,a.childNodes.length-1,u=>{let h=a.childNodes[u].querySelector(`.${Zu}`);s(h),l&&l.childNodes[u]&&(h=l.childNodes[u].querySelector(`.${Zu}`),s(h)),i&&c&&c.childNodes[u]&&(h=c.childNodes[u].querySelector(`.${Zu}`),s(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const r=this.headerStateManager.mapNodes(n=>{const{collapsible:i,origColspan:s,headerLevel:o,columnIndex:a,isCollapsed:l}=n;if(i===!0&&s>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(o),col:a}});this.toggleCollapsibleSection(r,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,r){if(!pA.has(r))throw new Error(`Unsupported action is passed (${r}).`);if(!Array.isArray(e))return;const n=rl(e,d=>{let{row:g}=d;return g<0});let i=n.length>0;J(n,d=>{var g;let{row:m,col:p}=d;const{collapsible:y,isCollapsed:S}=(g=this.headerStateManager.getHeaderSettings(m,p))!==null&&g!==void 0?g:{};if(!y||S&&r==="collapse"||!S&&r==="expand")return i=!1,!1});const s=[],o=[];i&&J(n,d=>{let{row:g,col:m}=d;const{colspanCompensation:p,affectedColumns:y,rollbackModification:S}=this.headerStateManager.triggerNodeModification(r,g,m);p>0&&(o.push(...y),s.push(S))});const a=this.getCollapsedColumns();let l=[];r==="collapse"?l=eP([...a,...o]):r==="expand"&&(l=rl(a,d=>!o.includes(d)));const c=pA.get(r);if(this.hot.runHooks(c.beforeHook,a,l,i)===!1){J(s,d=>{d()});return}this.hot.batchExecution(()=>{J(o,d=>{gA(mu,this).setValueAtIndex(this.hot.toPhysicalColumn(d),c.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,f=this.hot.getSelectedRangeLast();if(r==="collapse"&&h&&f){const{row:d,col:g}=f.highlight;if((this.hot.rowIndexMapper.isHidden(d)||this.hot.columnIndexMapper.isHidden(g))&&o.includes(g)){const p=d>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(d,1,!0):d,y=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;p!==null&&y!==null&&this.hot.selectCell(p,y)}}this.hot.runHooks(c.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return gA(mu,this).getHiddenIndexes()}destroy(){kC(mu,this,null),super.destroy()}}function Oq(t,e,r){var n;const{collapsible:i,origColspan:s,isCollapsed:o}=(n=this.headerStateManager.getHeaderSettings(r,t))!==null&&n!==void 0?n:{},a=i&&s>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let c=e.querySelector(`.${Zu}`);if(yh(e,[qi("")[0]]),a)c||(c=this.hot.rootDocument.createElement("div"),_e(c,Zu),e.querySelector("div:first-child").appendChild(c)),it(c,["collapsed","expanded"]),o?(_e(c,"collapsed"),Sc(c,"+"),l&&Ze(e,...qi(!1))):(_e(c,"expanded"),Sc(c,"-"),l&&Ze(e,...qi(!0))),l&&Ze(c,...Wc());else{var u;(u=c)===null||u===void 0||u.remove()}}function Pq(t,e){Qe(t.target,Zu)&&(Qe(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Qe(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),ks(t))}function kq(){this.updatePlugin()}function Nq(t,e){e||this.updatePlugin()}function Nl(t,e,r){return(e=Fq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fq(t){var e=Hq(t,"string");return typeof e=="symbol"?e:e+""}function Hq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Dq=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Lq=!1,$q=!0,Bq=!0;class Vq{constructor(e,r){Nl(this,"hot",void 0),Nl(this,"sortingStates",new kv),Nl(this,"sortEmptyCells",Lq),Nl(this,"indicator",$q),Nl(this,"headerAction",Bq),Nl(this,"compareFunctionFactory",void 0),Nl(this,"mapName",void 0),this.hot=e,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}updateAllColumnsProperties(e){dt(e)&&gt(e,(r,n)=>{Dq.includes(n)&&(this[n]=r)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var r;return(r=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||r===void 0?void 0:r.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(r=>{let[n]=r;return n===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return dt(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(r=>{let[n,i]=r;return{column:this.hot.toVisualColumn(n),...i}})}getColumnSortState(e){const r=this.getSortOrderOfColumn(e);if(Ue(r))return{column:e,sortOrder:r}}setSortStates(e){this.sortingStates.clear();for(let r=0;r<e.length;r+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[r].column),{sortOrder:e[r].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function g2(t,e,r){const n=e.locale;return function(i,s){const{sortEmptyCells:o}=r;return typeof i=="string"&&(i=i.toLocaleLowerCase(n)),typeof s=="string"&&(s=s.toLocaleLowerCase(n)),i===s?vo:_r(i)?_r(s)?vo:o&&t==="asc"?vr:wr:_r(s)?o&&t==="asc"?wr:vr:isNaN(i)&&!isNaN(s)?t==="asc"?wr:vr:!isNaN(i)&&isNaN(s)||(isNaN(i)||isNaN(s)||(i=parseFloat(i),s=parseFloat(s)),i<s)?t==="asc"?vr:wr:i>s?t==="asc"?wr:vr:vo}}const m2="default";function Wq(t,e,r){return function(n,i){const s=parseFloat(n),o=parseFloat(i),{sortEmptyCells:a}=r;if(s===o||isNaN(s)&&isNaN(o))return vo;if(a){if(_r(n))return t==="asc"?vr:wr;if(_r(i))return t==="asc"?wr:vr}return isNaN(s)?wr:isNaN(o)?vr:s<o?t==="asc"?vr:wr:s>o?t==="asc"?wr:vr:vo}}const Uq="numeric";function jq(t,e,r){const n=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:s}=r;return function(o,a){const l=_r(o),c=_r(a),u=l?i:o,h=c?i:a,f=u===i||u===n,d=h===i||h===n;if(s===!1){if(l&&c===!1)return wr;if(l===!1&&c)return vr}return f===!1&&d?t==="asc"?vr:wr:f&&d===!1?t==="asc"?wr:vr:f===!1&&d===!1?g2(t,e,r)(o,a):u===i&&h===n?t==="asc"?vr:wr:u===n&&h===i?t==="asc"?wr:vr:vo}}const zq="checkbox";function Gq(t,e,r){return x2(t,e.dateFormat,r)}const Yq="date";function Kq(t,e,r){return x2(t,e.timeFormat,r)}const Xq="time",{register:vg,getItem:vA,hasItem:qq}=Ns("sorting.compareFunctionFactory"),{register:p2,getItem:Jq}=Ns("sorting.mainSortComparator");function v2(t){return qq(t)?vA(t):vA(m2)}vg(zq,jq);vg(Yq,Gq);vg(m2,g2);vg(Uq,Wq);vg(Xq,Kq);const vo=0,vr=-1,wr=1;function Zq(t,e){const r=Jq(e);for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];t.sort(r(...i))}const Ap="asc",Ip="desc",w2="colHeader";function Qq(t){if(dt(t)===!1)return!1;const{column:e,sortOrder:r}=t;return Number.isInteger(e)&&[Ap,Ip].includes(r)}function eJ(t){if(t.some(r=>Qq(r)===!1))return!1;const e=t.map(r=>{let{column:n}=r;return n});return new Set(e).size===e.length}function wA(t){if(t!==Ip)return t===Ap?Ip:Ap}function C2(t){return t.querySelector(`.${w2}`)}function y2(t,e){if(t<0||!e.parentNode)return!1;const r=e.parentNode.parentNode.childNodes;return Array.from(r).indexOf(e.parentNode)-r.length===-1}function sE(t,e,r){return t===-1&&e>=0&&bc(r)===!1}function x2(t,e,r){return function(n,i){const{sortEmptyCells:s}=r;if(n===i)return vo;if(_r(n))return _r(i)?vo:s&&t==="asc"?vr:wr;if(_r(i))return s&&t==="asc"?wr:vr;const o=At(n,e),a=At(i,e);return o.isValid()?a.isValid()?a.isAfter(o)?t==="asc"?vr:wr:a.isBefore(o)?t==="asc"?wr:vr:vo:vr:wr}}const tJ="ascending",rJ="descending",S2="indicatorDisabled",b2="columnSorting",E2="sortAction",R2=new Map([[Ap,tJ],[Ip,rJ]]);function nJ(t,e,r,n){const i=[b2];if(n&&i.push(E2),r===!1)return i.push(S2),i;const s=t.getSortOrderOfColumn(e);return Ue(s)&&i.push(R2.get(s)),i}function iJ(){return Array.from(R2.values()).concat(E2,S2,b2)}function sJ(t,e){return function(r,n){const[,...i]=r,[,...s]=n;return function(a){const l=t[a],c=e[a],u=i[a],h=s[a],f=c.columnSorting;return(f.compareFunctionFactory?f.compareFunctionFactory:v2(c.type))(l,c,f)(u,h)}(0)}}function oJ(t,e){aJ(t,e),e.add(t)}function aJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function P0(t,e,r){return(e=lJ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lJ(t){var e=cJ(t,"string");return typeof e=="symbol"?e:e+""}function cJ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Mp="columnSorting",uJ=50,Op="append",hJ="replace",CA=Mp;p2(Mp,sJ);We.getSingleton().register("beforeColumnSort");We.getSingleton().register("afterColumnSort");var nc=new WeakSet;class T2 extends kt{constructor(){super(...arguments),oJ(this,nc),P0(this,"columnStatesManager",null),P0(this,"columnMetaCache",null),P0(this,"pluginKey",Mp),P0(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Mp}static get PLUGIN_PRIORITY(){return uJ}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new Vq(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new fl(r=>{let n=this.hot.toVisualColumn(r);return n===null&&(n=r),this.getMergedPluginSettings(n)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(r,n)=>Bu(nc,this,fJ).call(this,r,n)),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Bu(nc,e,gJ).call(e,...n)}),this.addHook("afterOnCellMouseDown",(r,n)=>this.onAfterOnCellMouseDown(r,n)),this.addHook("afterInit",()=>Bu(nc,this,Dy).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Bu(nc,e,dJ).call(e,...n)}),this.hot.view&&Bu(nc,this,Dy).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(r,n)=>{const i=C2(n);y2(r,n)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.row===-1&&n.col>=0},relativeToGroup:dl,position:"before",group:CA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(CA)}sort(e){const r=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(n);this.hot.runHooks("beforeColumnSort",r,n,i)!==!1&&(r.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new mk),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",r,i?n:r,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return Ue(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const r=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(r)&&this.columnStatesManager.setSortStates(r)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const r=this.hot.countCols();return eJ(e)&&e.every(n=>{let{column:i}=n;return i<=r&&i>=0})}saveAllSortSettings(e){const r=this.columnStatesManager.getAllColumnsProperties(),n=i=>{let{column:s,...o}=i;return{column:this.hot.toPhysicalColumn(s),...o}};r.initialConfig=bt(e,n),this.hot.runHooks("persistentStateSave","columnSorting",r)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const r=e.value,n=i=>{let{column:s,...o}=i;return{column:this.hot.toVisualColumn(s),...o}};return Ue(r)&&Array.isArray(r.initialConfig)&&(r.initialConfig=bt(r.initialConfig,n)),r}getColumnNextConfig(e){const r=this.columnStatesManager.getSortOrderOfColumn(e);if(Ue(r)){const i=wA(r);return Ue(i)?{column:e,sortOrder:i}:void 0}const n=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<n)return{column:e,sortOrder:wA()}}getNextSortConfig(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Op;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=n!==-1,s=this.getSortConfig(),o=this.getColumnNextConfig(e);if(i){if(tr(o))return[...s.slice(0,n),...s.slice(n+1)];if(r===Op)return[...s.slice(0,n),...s.slice(n+1),o];if(r===hJ)return[...s.slice(0,n),o,...s.slice(n+1)]}return Ue(o)?s.concat(o):s}getPluginColumnConfig(e){if(dt(e)){const r=e[this.pluginKey];if(dt(r))return r}return{}}getMergedPluginSettings(e){const r=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(i);return Array.isArray(s.columns)?Object.assign(n,r,this.getPluginColumnConfig(s.columns[e])):er(s.columns)?Object.assign(n,r,this.getPluginColumnConfig(s.columns(e))):Object.assign(n,r)}getFirstCellSettings(e){const r=this.hot.getCellMeta(0,e),n=Object.create(r);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}getNumberOfRowsToSort(e){const r=this.hot.getSettings();return r.maxRows<=e?r.maxRows:e-r.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const r=[],n=this.hot.countRows(),i=c=>bt(e,u=>this.hot.getDataAtCell(c,u.column));for(let c=0;c<this.getNumberOfRowsToSort(n);c+=1)r.push([this.hot.toPhysicalRow(c)].concat(i(c)));const s=bt(r,c=>c[0]);Zq(r,this.pluginKey,bt(e,c=>c.sortOrder),bt(e,c=>this.getFirstCellSettings(c.column)));for(let c=r.length;c<n;c+=1)r.push([c].concat(i(c)));const o=bt(r,c=>c[0]),a=new Map(bt(s,(c,u)=>[c,o[u]])),l=bt(this.hot.rowIndexMapper.getIndexesSequence(),c=>a.has(c)?a.get(c):c);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(dt(e)){this.columnStatesManager.updateAllColumnsProperties(e);const r=e.initialConfig;(Array.isArray(r)||dt(r))&&this.sort(r)}else this.hot.render()}updateHeaderClasses(e){if(it(e,iJ()),this.enabled!==!1){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];_e(e,nJ(...n))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Ue(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,r){return this.getFirstCellSettings(r)[this.pluginKey].headerAction&&Qe(e.target,w2)}onAfterOnCellMouseDown(e,r){if(sE(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(r.col));const n=this.hot.getActiveEditor(),i=this.getColumnNextConfig(r.col);n!=null&&n.isOpened()&&this.hot.getCellValidator(n.row,n.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function Dy(){const t=this.getAllSavedSortSettings();if(dt(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function fJ(t,e){const r=C2(e);if(y2(t,e)===!1||r===null)return;const n=this.getFirstCellSettings(t)[this.pluginKey],i=n.indicator,s=n.headerAction;if(this.updateHeaderClasses(r,this.columnStatesManager,t,i,s),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(t);Ze(e,...x8(o?`${o}ending`:"none"))}}function dJ(t){t===!0&&this.hot.view&&Bu(nc,this,Dy).call(this)}function gJ(t,e,r,n){sE(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(n.column=!0)}function Fl(t,e,r){return(e=mJ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mJ(t){var e=pJ(t,"string");return typeof e=="symbol"?e:e+""}function pJ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vJ{constructor(e,r){Fl(this,"plugin",void 0),Fl(this,"hot",void 0),Fl(this,"endpoints",[]),Fl(this,"settings",void 0),Fl(this,"settingsType","array"),Fl(this,"currentEndpoint",null),Fl(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=r}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const r=[];let n=e;if(!n&&typeof this.settings=="function"){this.settingsType="function";return}return n||(n=this.settings),J(n,i=>{const s={};this.assignSetting(i,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,s,"reversedRowCoords",!1),this.assignSetting(i,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"sourceColumn",i.destinationColumn),this.assignSetting(i,s,"type","sum"),this.assignSetting(i,s,"forceNumeric",!1),this.assignSetting(i,s,"suppressDataTypeErrors",!0),this.assignSetting(i,s,"customFunction",null),this.assignSetting(i,s,"readOnly",!0),this.assignSetting(i,s,"roundFloat",!1),r.push(s)}),r}assignSetting(e,r,n,i){if(n==="ranges"&&e[n]===void 0){r[n]=i;return}else if(n==="ranges"&&e[n].length===0)return;if(e[n]===void 0){if(i instanceof Error)throw i;r[n]=i}else n==="destinationRow"&&r.reversedRowCoords?r[n]=this.hot.countRows()-e[n]-1:r[n]=e[n]}resetSetupBeforeStructureAlteration(e,r,n){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();J(s,o=>{i==="row"&&o.destinationRow>=r&&(e==="insert_row"?o.alterRowOffset=n:e==="remove_row"&&(o.alterRowOffset=-1*n)),i==="col"&&o.destinationColumn>=r&&(e==="insert_col"?o.alterColumnOffset=n:e==="remove_col"&&(o.alterColumnOffset=-1*n))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,r,n,i,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const f=()=>(this.hot.removeHook("beforeViewRender",f),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",f);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,c=this.getAllEndpoints(),u=e.indexOf("move_row")===0,h=r;J(c,f=>{a==="row"&&f.destinationRow>=h&&(f.alterRowOffset=l*n),a==="col"&&f.destinationColumn>=h&&(f.alterColumnOffset=l*n)}),this.resetAllEndpoints(c,!u),u?J(c,f=>{this.extendEndpointRanges(f,h,i[0],i.length),this.recreatePhysicalRanges(f),this.clearOffsetInformation(f)}):J(c,f=>{this.shiftEndpointCoordinates(f,h)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,r,n,i){J(e.ranges,s=>{s[1]&&(r>=s[0]&&r<=s[1]?n>s[1]?s[1]+=i:n<s[0]&&(s[0]-=i):n>=s[0]&&n<=s[1]&&(s[1]-=i,r<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const r=e.ranges,n=[],i=[];J(r,s=>{const o=[];if(s[1])for(let a=s[0];a<=s[1];a++)o.push(this.hot.toPhysicalRow(a));else o.push(this.hot.toPhysicalRow(s[0]));i.push(o)}),J(i,s=>{let o=[];J(s,(a,l)=>{l===0?o.push(a):s[l]!==s[l-1]+1&&(o.push(s[l-1]),n.push(o),o=[],o.push(a)),l===s.length-1&&(o.push(a),n.push(o))})}),e.ranges=n}shiftEndpointCoordinates(e,r){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,J(e.ranges,n=>{J(n,(i,s)=>{i>=r&&(n[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const s=i.alterRowOffset||0,o=i.alterColumnOffset||0;return i.destinationRow+s>=this.hot.countRows()||i.destinationColumn+o>=this.hot.countCols()})||(this.cellsToSetCache=[],J(e,i=>{this.resetEndpointValue(i,r)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],J(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const r=[];this.cellsToSetCache=[],J(e,(n,i,s)=>{`${n[2]||""}`!=`${n[3]}`&&J(this.getAllEndpoints(),(o,a)=>{this.hot.propToCol(s[i][1])===o.sourceColumn&&r.indexOf(a)===-1&&r.push(a)})}),J(r,n=>{this.refreshEndpoint(this.getEndpoint(n))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const r=this.hot.toVisualRow(e.destinationRow);if(r!==null){const n=this.hot.getCellMeta(r,e.destinationColumn);n.readOnly=e.readOnly,n.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(r?n:0)),this.hot.toVisualColumn(e.destinationColumn+(r?i:0)),""])}setEndpointValue(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const o=this.hot.getCellMeta(s,e.destinationColumn);(r==="init"||o.readOnly!==e.readOnly)&&(o.readOnly=e.readOnly,o.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const o=e.roundFloat;let a=0;Number.isInteger(o)&&(a=Math.min(Math.max(0,o),100)),e.result=e.result.toFixed(a)}n?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Ft("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function NC(t){return t==null||isNaN(t)}function wJ(t,e){CJ(t,e),e.add(t)}function CJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yJ(t,e,r){return(e=xJ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xJ(t){var e=SJ(t,"string");return typeof e=="symbol"?e:e+""}function SJ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function k0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const FC="columnSummary",bJ=220;var cf=new WeakSet;class EJ extends kt{constructor(){super(...arguments),wJ(this,cf),yJ(this,"endpoints",null)}static get PLUGIN_KEY(){return FC}static get PLUGIN_PRIORITY(){return bJ}isEnabled(){return!!this.hot.getSettings()[FC]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[FC],this.endpoints=new vJ(this,this.settings),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return k0(cf,e,RJ).call(e,...n)}),this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return k0(cf,e,_J).call(e,...n)}),this.addHook("afterUpdateSettings",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return k0(cf,e,TJ).call(e,...n)}),this.addHook("beforeCreateRow",(r,n,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",r,n,null,i)),this.addHook("beforeCreateCol",(r,n,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",r,n,null,i)),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)}),this.addHook("afterCreateRow",(r,n,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",r,n,null,i)),this.addHook("afterCreateCol",(r,n,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",r,n,null,i)),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)}),this.addHook("afterRowMove",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return k0(cf,e,AJ).call(e,...n)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let r=0;return gt(e.ranges,n=>{r+=this.getPartialSum(n,e.sourceColumn)}),r}getPartialSum(e,r){let n=0,i=e[1]||e[0],s=null,o=0;do{if(s=this.getCellValue(i,r),s=NC(s)?null:s,s!==null){const a=(`${s}`.split(".")[1]||[]).length||1;a>o&&(o=a)}n+=s||0,i-=1}while(i>=e[0]);return Math.round(n*10**o)/10**o}calculateMinMax(e,r){let n=null;return gt(e.ranges,i=>{const s=this.getPartialMinMax(i,e.sourceColumn,r);if(n===null&&s!==null&&(n=s),s!==null)switch(r){case"min":n=Math.min(n,s);break;case"max":n=Math.max(n,s);break}}),n===null?"Not enough data":n}getPartialMinMax(e,r,n){let i=null,s=e[1]||e[0],o;do{if(o=this.getCellValue(s,r),o=NC(o)?null:o,i===null)i=o;else if(o!==null)switch(n){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}s-=1}while(s>=e[0]);return i}countEmpty(e,r){let n,i=0,s=e[1]||e[0];do n=this.getCellValue(s,r),n=NC(n)?null:n,n===null&&(i+=1),s-=1;while(s>=e[0]);return i}countEntries(e){let r=0;const n=e.ranges;return gt(n,i=>{const s=i[1]===void 0?1:i[1]-i[0]+1,o=this.countEmpty(i,e.sourceColumn);r+=s,r-=o}),r}calculateAverage(e){const r=this.calculateSum(e),n=this.countEntries(e);return r/n}getCellValue(e,r){const n=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(r);let s=this.hot.getSourceDataAtCell(e,r),o="";if(n!==null&&i!==null&&(o=this.hot.getCellMeta(n,i).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Ht`ColumnSummary plugin: cell at (${e}, ${r}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}}function RJ(){this.endpoints.initEndpoints()}function TJ(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function _J(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function AJ(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function IJ(t,e){_2(t,e),e.add(t)}function HC(t,e,r){_2(t,e),e.set(t,r)}function _2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vu(t,e){return t.get(oE(t,e))}function Ly(t,e,r){return t.set(oE(t,e),r),r}function oE(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Pp=new WeakMap,N0=new WeakMap,F0=new WeakMap,yA=new WeakSet;class A2{constructor(){IJ(this,yA),HC(this,Pp,!0),HC(this,N0,null),HC(this,F0,new ResizeObserver(e=>oE(yA,this,MJ).call(this,e)))}setObservedElement(e){Ly(N0,this,e)}unobserve(){Vu(F0,this).unobserve(Vu(N0,this))}observe(){Ly(Pp,this,!0),Vu(F0,this).observe(Vu(N0,this))}destroy(){Vu(F0,this).disconnect()}}function MJ(t){if(Vu(Pp,this)||!Array.isArray(t)||!t.length){Ly(Pp,this,!1);return}t.forEach(e=>{let{borderBoxSize:r}=e;const{inlineSize:n,blockSize:i}=r[0];this.runLocalHooks("resize",n,i)})}jt(A2,vn);function Hl(t,e,r){OJ(t,e),e.set(t,r)}function OJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zt(t,e){return t.get(I2(t,e))}function Lo(t,e,r){return t.set(I2(t,e),r),r}function I2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Dl=new WeakMap,DC=new WeakMap,$o=new WeakMap,Ll=new WeakMap,xa=new WeakMap,H0=new WeakMap,pu=new WeakMap;class uc{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,r){var n=this;Hl(this,Dl,void 0),Hl(this,DC,!1),Hl(this,$o,null),Hl(this,Ll,void 0),Hl(this,xa,void 0),Hl(this,H0,!0),Hl(this,pu,new A2),Lo(Dl,this,e),Lo(DC,this,r),Lo(Ll,this,this.createEditor()),Lo(xa,this,zt(Ll,this).style),zt(pu,this).setObservedElement(this.getInputElement()),zt(pu,this).addLocalHook("resize",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,r){zt(xa,this).left=`${e}px`,zt(xa,this).top=`${r}px`}setSize(e,r){if(e&&r){const n=this.getInputElement();n.style.width=`${e}px`,n.style.height=`${r}px`}}getSize(){return{width:rr(this.getInputElement()),height:Fr(this.getInputElement())}}observeSize(){zt(pu,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const r=this.getInputElement();r.readOnly=e}show(){zt(xa,this).display="block",Lo(H0,this,!1)}hide(){zt(pu,this).unobserve(),zt(H0,this)||(zt(xa,this).display="none"),Lo(H0,this,!0)}isVisible(){return zt(xa,this).display==="block"}setValue(){const r=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=r}getValue(){return this.getInputElement().value}isFocused(){return zt(Dl,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=zt(Dl,this).createElement("div"),r=zt(Dl,this).createElement("textarea");return e.style.display="none",Lo($o,this,zt(Dl,this).createElement("div")),zt($o,this).setAttribute("dir",zt(DC,this)?"rtl":"ltr"),_e(zt($o,this),uc.CLASS_EDITOR_CONTAINER),zt(Dl,this).body.appendChild(zt($o,this)),_e(e,uc.CLASS_EDITOR),_e(r,uc.CLASS_INPUT),r.setAttribute("data-hot-input",!0),e.appendChild(r),zt($o,this).appendChild(e),e}getInputElement(){return zt(Ll,this).querySelector(`.${uc.CLASS_INPUT}`)}destroy(){const e=zt($o,this)?zt($o,this).parentNode:null;zt(Ll,this).parentNode.removeChild(zt(Ll,this)),Lo(Ll,this,null),Lo(xa,this,null),zt(pu,this).destroy(),e&&e.removeChild(zt($o,this))}}jt(uc,vn);function LC(t,e,r){return(e=PJ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PJ(t){var e=kJ(t,"string");return typeof e=="symbol"?e:e+""}function kJ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const NJ=250,FJ=250;class M2{constructor(e){LC(this,"wasLastActionShow",!0),LC(this,"showDebounced",null),LC(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},FJ)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:NJ;this.showDebounced=Wx(r=>{this.wasLastActionShow&&this.runLocalHooks("show",r.from.row,r.from.col)},e)}destroy(){this.clearLocalHooks()}}jt(M2,vn);function HJ(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function DJ(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function $l(t,e){const r={};return J(t,n=>{n.forAll((i,s)=>{i>=0&&s>=0&&(r[i]||(r[i]=[]),r[i][s]=e(i,s))})}),r}function Na(t,e,r,n,i){J(t,s=>{s.forAll((o,a)=>{o>=0&&a>=0&&LJ(o,a,e,r,n,i)})})}function LJ(t,e,r,n,i,s){const o=i(t,e);let a=n;o.className&&(r==="vertical"?a=HJ(o.className,n):a=DJ(o.className,n)),s(t,e,"className",a)}function Go(t){return`<span class="selected">â</span>${t}`}function Zf(t,e){let r=!1;return Array.isArray(t)&&J(t,n=>(n.forAll((i,s)=>{if(i>=0&&s>=0&&e(i,s))return r=!0,!1}),r)),r}function Vv(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:n}=e.defaultView,{top:i,left:s}=n.getBoundingClientRect();r.top=i,r.left=s}return r}function $J(t){return function(e,r){const n=this.getCellMeta(e,r).className;return n&&n.indexOf(t)!==-1}}function Jn(t,e){return Zf(t.getSelectedRange(),$J(e).bind(t))}const ft="---------";function BJ(){return{name:ft}}const Ui="alignment";function VJ(){return{key:Ui,name(){return this.getTranslatedPhrase(GS)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Ui}:left`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(pp)},ariaChecked(){return Jn(this,"htLeft")},name(){let t=this.getTranslatedPhrase(pp);return Jn(this,"htLeft")&&(t=Go(t)),t},callback(){const t=this.getSelectedRange(),e=$l(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,r,n),Na(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Ui}:center`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(vp)},ariaChecked(){return Jn(this,"htCenter")},name(){let t=this.getTranslatedPhrase(vp);return Jn(this,"htCenter")&&(t=Go(t)),t},callback(){const t=this.getSelectedRange(),e=$l(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,r,n),Na(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Ui}:right`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(wp)},ariaChecked(){return Jn(this,"htRight")},name(){let t=this.getTranslatedPhrase(wp);return Jn(this,"htRight")&&(t=Go(t)),t},callback(){const t=this.getSelectedRange(),e=$l(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,r,n),Na(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Ui}:justify`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Cp)},ariaChecked(){return Jn(this,"htJustify")},name(){let t=this.getTranslatedPhrase(Cp);return Jn(this,"htJustify")&&(t=Go(t)),t},callback(){const t=this.getSelectedRange(),e=$l(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,r,n),Na(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{name:ft},{key:`${Ui}:top`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(yp)},ariaChecked(){return Jn(this,"htTop")},name(){let t=this.getTranslatedPhrase(yp);return Jn(this,"htTop")&&(t=Go(t)),t},callback(){const t=this.getSelectedRange(),e=$l(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,r,n),Na(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Ui}:middle`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(xp)},ariaChecked(){return Jn(this,"htMiddle")},name(){let t=this.getTranslatedPhrase(xp);return Jn(this,"htMiddle")&&(t=Go(t)),t},callback(){const t=this.getSelectedRange(),e=$l(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,n),Na(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Ui}:bottom`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Sp)},ariaChecked(){return Jn(this,"htBottom")},name(){let t=this.getTranslatedPhrase(Sp);return Jn(this,"htBottom")&&(t=Go(t)),t},callback(){const t=this.getSelectedRange(),e=$l(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,r,n),Na(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1}]}}}const Wv="clear_column";function WJ(){return{key:Wv,name(){return this.getTranslatedPhrase(PS)},callback(t,e){const r=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const wg="col_left";function UJ(){return{key:wg,name(){return this.getTranslatedPhrase(TS)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Cg="col_right";function jJ(){return{key:Cg,name(){return this.getTranslatedPhrase(_S)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const yg="make_read_only";function zJ(){return{key:yg,checkable:!0,ariaChecked(){return Zf(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(mp)},name(){let t=this.getTranslatedPhrase(mp);return Zf(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly)&&(t=Go(t)),t},callback(){const t=this.getSelectedRange(),e=Zf(t,(r,n)=>this.getCellMeta(r,n).readOnly);J(t,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&this.setCellMeta(n,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Uv="redo";function GJ(){return{key:Uv,name(){return this.getTranslatedPhrase(OS)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const xg="remove_col";function YJ(){return{key:xg,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(IS,e)},callback(){this.alter("remove_col",cz(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const jv="remove_row";function KJ(){return{key:jv,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(AS,e)},callback(){this.alter("remove_row",uz(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const zv="row_above";function XJ(){return{key:zv,name(){return this.getTranslatedPhrase(ES)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Gv="row_below";function qJ(){return{key:Gv,name(){return this.getTranslatedPhrase(RS)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Pd="no_items";function JJ(){return{key:Pd,name(){return this.getTranslatedPhrase(bS)},disabled:!0,isCommand:!1}}const Yv="undo";function ZJ(){return{key:Yv,name(){return this.getTranslatedPhrase(MS)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const QJ=[zv,Gv,wg,Cg,Wv,jv,xg,Yv,Uv,yg,Ui,ft,Pd],eZ={[ft]:BJ,[Pd]:JJ,[zv]:XJ,[Gv]:qJ,[wg]:UJ,[Cg]:jJ,[Wv]:WJ,[jv]:KJ,[xg]:YJ,[Yv]:ZJ,[Uv]:GJ,[yg]:zJ,[Ui]:VJ};function O2(){const t={};return gt(eZ,(e,r)=>{t[r]=e()}),t}function tZ(t){return{key:"commentsAddEdit",name(){var e;const r=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r!=null&&r.isCell()&&t.getCommentAtCell(r.row,r.col)?this.getTranslatedPhrase(US):this.getTranslatedPhrase(WS)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function rZ(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(jS)},callback(){this.getSelectedRangeLast().forAll((r,n)=>{r>=0&&n>=0&&t.removeCommentAtCell(r,n,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function nZ(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(zS);return Zf(this.getSelectedRange(),(n,i)=>t.getCommentMeta(n,i,Ym))?Go(e):e},callback(){this.getSelectedRangeLast().forAll((r,n)=>{if(r>=0&&n>=0){const i=!!t.getCommentMeta(r,n,Ym);t.updateCommentMeta(r,n,{[Ym]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function iZ(t,e){P2(t,e),e.add(t)}function vu(t,e,r){P2(t,e),e.set(t,r)}function P2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sZ(t,e,r){return(e=oZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oZ(t){var e=aZ(t,"string");return typeof e=="symbol"?e:e+""}function aZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ya(t,e,r){return t.set(ps(t,e),r),r}function wt(t,e){return t.get(ps(t,e))}function ps(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Qf="comments",lZ=60,Yo="comment",$f="value",k2="style",Ym="readOnly",D0=Qf,$y=`plugin:${Qf}`;var Yt=new WeakMap,io=new WeakMap,Kv=new WeakMap,Km=new WeakMap,By=new WeakMap,kp=new WeakMap,Us=new WeakSet;class cZ extends kt{constructor(){super(...arguments),iZ(this,Us),sZ(this,"range",{}),vu(this,Yt,null),vu(this,io,null),vu(this,Kv,!1),vu(this,Km,!1),vu(this,By,null),vu(this,kp,"")}static get PLUGIN_KEY(){return Qf}static get PLUGIN_PRIORITY(){return lZ}isEnabled(){return!!this.hot.getSettings()[Qf]}enablePlugin(){var e=this;this.enabled||(wt(Yt,this)||(Ya(Yt,this,new uc(this.hot.rootDocument,this.hot.isRtl())),wt(Yt,this).addLocalHook("resize",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ps(Us,e,pZ).call(e,...n)})),wt(io,this)||Ya(io,this,new M2(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",r=>this.addToContextMenu(r)),this.addHook("afterRenderer",(r,n,i,s,o,a)=>ps(Us,this,dZ).call(this,r,a)),this.addHook("afterScroll",()=>ps(Us,this,wZ).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",r=>ps(Us,this,vZ).call(this,r)),wt(io,this).addLocalHook("hide",()=>this.hide()),wt(io,this).addLocalHook("show",(r,n)=>this.showAtCell(r,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){wt(io,this).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),r=e.getContext("grid"),n=e.addContext($y);r.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();Ya(Km,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName($y),this.hot._registerTimeout(()=>{Ya(Km,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!wt(Yt,this).isVisible()},group:D0}),n.addShortcut({keys:[["Escape"]],callback:()=>{wt(Yt,this).setValue(wt(kp,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>wt(Yt,this).isVisible()&&wt(Yt,this).isFocused(),group:D0}),n.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>wt(Yt,this).isVisible()&&wt(Yt,this).isFocused(),group:D0})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(D0)}registerListeners(){const{rootDocument:e}=this.hot,r=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",n=>ps(Us,this,hZ).call(this,n)),this.eventManager.addEventListener(e,"mousedown",n=>ps(Us,this,uZ).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>ps(Us,this,fZ).call(this)),this.eventManager.addEventListener(r,"focus",()=>ps(Us,this,mZ).call(this)),this.eventManager.addEventListener(r,"blur",()=>ps(Us,this,gZ).call(this))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const r=xc(e.target,"TD","TBODY");return!!(r&&Qe(r,"htCommentCell")&&xc(r,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const r=wt(Yt,this).getValue();let n="";e!=null?n=e:r!=null&&(n=r);const i=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(i,s,{[$f]:n}),this.hot.render()}setCommentAtCell(e,r,n){this.setRange({from:this.hot._createCellCoords(e,r)}),this.setComment(n)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Yo),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,r)}),this.removeComment(n)}getComment(){const e=this.range.from.row,r=this.range.from.col;return this.getCommentMeta(e,r,$f)}getCommentAtCell(e,r){return this.getCommentMeta(e,r,$f)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:r,col:n}}=this.range;if(r<0||r>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return wt(io,this).cancelHiding(),wt(Yt,this).setValue((e=i[Yo]?i[Yo][$f]:null)!==null&&e!==void 0?e:""),wt(Yt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,r){return this.setRange({from:this.hot._createCellCoords(e,r)}),this.show()}hide(){wt(Yt,this).hide()}refreshEditor(){var e,r;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!wt(Yt,this).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:s}=this.hot,{row:o,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(o),c=s.getRenderableFromVisualIndex(a);const u=l===null;wt(Yt,this).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o,-1))),c===null&&(c=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(a,-1)));const h=l===null,f=c===null;l=(e=l)!==null&&e!==void 0?e:0,c=(r=c)!==null&&r!==void 0?r:0;const{rootWindow:d,view:{_wt:g}}=this.hot,{wtTable:m}=g,p=g.getCell({row:l,col:c},!0),y=this.getCommentMeta(o,a,k2);y?wt(Yt,this).setSize(y.width,y.height):wt(Yt,this).resetSize();const S=f?0:m.getStretchedColumnWidth(c),C=u&&!h?Fr(p):0,{left:A,top:I,width:O,height:_}=p.getBoundingClientRect(),{width:E,height:b}=wt(Yt,this).getSize(),{innerWidth:k,innerHeight:B}=this.hot.rootWindow,N=this.hot.rootDocument.documentElement;let q=A+d.scrollX+S,ue=I+d.scrollY+C;this.hot.isRtl()&&(q-=E+S),this.hot.isLtr()&&A+O+E>k?q=A+d.scrollX-E-1:this.hot.isRtl()&&q<-(N.scrollWidth-N.clientWidth)&&(q=A+d.scrollX+S+1),I+b>B&&(ue-=b-_+1),wt(Yt,this).setPosition(q,ue),wt(Yt,this).setReadOnlyState(this.getCommentMeta(o,a,Ym)),wt(Yt,this).observeSize()}focusEditor(){wt(Yt,this).focus()}updateCommentMeta(e,r,n){const i=this.hot.getCellMeta(e,r)[Yo];let s;i?(s=zn(i),_v(s,n)):s=n,this.hot.setCellMeta(e,r,Yo,s)}getCommentMeta(e,r,n){const i=this.hot.getCellMeta(e,r);if(i[Yo])return i[Yo][n]}addToContextMenu(e){e.items.push({name:ft},tZ(this),rZ(this),nZ(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[Qf];if(dt(e))return e.displayDelay}getEditorInputElement(){return wt(Yt,this).getInputElement()}destroy(){var e,r;(e=wt(Yt,this))===null||e===void 0||e.destroy(),(r=wt(io,this))===null||r===void 0||r.destroy(),super.destroy()}}function uZ(t){if(!(!this.hot.view||!this.hot.view._wt)&&!wt(Kv,this)&&!this.targetIsCommentTextArea(t)){const e=xc(t.target,"TD","TBODY");let r=null;e&&(r=this.hot.getCoords(e)),(!e||this.range.from&&r&&(this.range.from.row!==r.row||this.range.from.col!==r.col))&&this.hide()}}function hZ(t){const{rootDocument:e}=this.hot;if(!(wt(Kv,this)||wt(Yt,this).isFocused()||Qe(t.target,"wtBorder")||wt(By,this)===t.target||!wt(Yt,this)))if(Ya(By,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const r=this.hot._createCellRange(this.hot.getCoords(t.target));wt(io,this).show(r)}else pc(t.target,e)&&!this.targetIsCommentTextArea(t)&&wt(io,this).hide()}function fZ(){Ya(Kv,this,!1)}function dZ(t,e){e[Yo]&&e[Yo][$f]&&_e(t,e.commentedCellClassName)}function gZ(){Ya(kp,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function mZ(){Ya(kp,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName($y)}function pZ(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[k2]:{width:t,height:e}})}function vZ(t){wt(Yt,this).isVisible()&&ks(t)}function wZ(){wt(Km,this)||this.hide()}var xA=yv,CZ=TypeError,yZ=function(t,e){if(!delete t[e])throw new CZ("Cannot delete property "+xA(e)+" of "+xA(t))},xZ=pn,SZ=rg,bZ=sg,EZ=NO,RZ=yZ,TZ=FO,_Z=[].unshift(0)!==1,AZ=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},IZ=_Z||!AZ();xZ({target:"Array",proto:!0,arity:1,forced:IZ},{unshift:function(e){var r=SZ(this),n=bZ(r),i=arguments.length;if(i){TZ(n+i);for(var s=n;s--;){var o=s+i;s in r?r[o]=r[s]:RZ(r,o)}for(var a=0;a<i;a++)r[a]=arguments[a]}return EZ(r,n+i)}});function $C(t,e,r){return(e=MZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MZ(t){var e=OZ(t,"string");return typeof e=="symbol"?e:e+""}function OZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class N2{constructor(e){$C(this,"hot",void 0),$C(this,"commands",{}),$C(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const s=e.split(":"),o=s[0],a=s.length===2?s[1]:null;let l=this.commands[o];if(!l)throw new Error(`Menu command '${o}' not exists.`);if(a&&l.submenu&&(l=PZ(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Cr(l,"submenu"))return;const c=[];typeof l.callback=="function"&&c.push(l.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),n.unshift(s.join(":")),J(c,u=>u.apply(this.hot,n))}}function PZ(t,e){let r;return J(e,n=>{const i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}function BC(t,e,r){return(e=kZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kZ(t){var e=NZ(t,"string");return typeof e=="symbol"?e:e+""}function NZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class F2{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;BC(this,"hot",void 0),BC(this,"predefinedItems",O2()),BC(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,gt(e,(n,i)=>{let s="";n.name===ft?(r[ft]=n,s=ft):isNaN(parseInt(i,10))?(n.key=n.key===void 0?i:n.key,r[i]=n,s=n.key):(r[n.key]=n,s=n.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return FZ(e,this.defaultOrderPattern,this.predefinedItems)}}function FZ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),dt(i)?gt(i,(s,o)=>{let a=r[typeof s=="string"?s:o];a||(a=s),dt(s)?Ur(a,s):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=o),n.push(a)}):J(i,(s,o)=>{let a=r[s];!a&&QJ.indexOf(s)>=0||(a||(a={name:s,key:`${o}`}),dt(s)&&Ur(a,s),a.key===void 0&&(a.key=o),n.push(a))}),n}function Sa(t,e,r){return(e=HZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HZ(t){var e=DZ(t,"string");return typeof e=="symbol"?e:e+""}function DZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LZ{constructor(e,r){Sa(this,"top",void 0),Sa(this,"topRelative",void 0),Sa(this,"left",void 0),Sa(this,"leftRelative",void 0),Sa(this,"scrollTop",void 0),Sa(this,"scrollLeft",void 0),Sa(this,"cellHeight",void 0),Sa(this,"cellWidth",void 0);const n=r.scrollY,i=r.scrollX;let s,o,a,l,c,u;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),a=parseInt(e.left,10),c=e.height||0,u=e.width||0,o=s,l=a,s+=n,a+=i):this.type==="event"&&(s=parseInt(e.pageY,10),a=parseInt(e.pageX,10),c=e.target.clientHeight,u=e.target.clientWidth,o=s-n,l=a-i),this.top=s,this.topRelative=o,this.left=a,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=c,this.cellWidth=u}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function uf(t,e,r){$Z(t,e),e.set(t,r)}function $Z(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Et(t,e){return t.get(H2(t,e))}function L0(t,e,r){return t.set(H2(t,e),r),r}function H2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var kn=new WeakMap,ba=new WeakMap,Zn=new WeakMap,VC=new WeakMap,wu=new WeakMap;class BZ{constructor(e){uf(this,kn,void 0),uf(this,ba,void 0),uf(this,Zn,void 0),uf(this,VC,!1),uf(this,wu,{above:0,below:0,left:0,right:0}),L0(VC,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Et(wu,this)[e]=r,this}setElement(e){return L0(kn,this,e),this}setParentElement(e){return L0(ba,this,e),this}updatePosition(e){L0(Zn,this,new LZ(e,Et(kn,this).ownerDocument.defaultView)),Et(VC,this)?(Et(Zn,this).fitsBelow(Et(kn,this))?this.setPositionBelowCursor():Et(Zn,this).fitsAbove(Et(kn,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Et(kn,this).dir==="rtl"?Et(Zn,this).fitsOnLeft(Et(kn,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Et(Zn,this).fitsOnRight(Et(kn,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Et(wu,this).above+Et(Zn,this).top-Et(kn,this).offsetHeight;Et(ba,this)&&(e=Et(Zn,this).top+Et(Zn,this).cellHeight-Et(kn,this).offsetHeight+3),Et(kn,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Et(wu,this).below+Et(Zn,this).top+1;Et(ba,this)&&(e=Et(Zn,this).top-1),Et(kn,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Et(Zn,this).left;if(Et(ba,this)){const r=Number.parseInt(getComputedStyle(Et(ba,this).querySelector(".htCore")).borderRightWidth,10);e+=Et(Zn,this).cellWidth+r}else e+=Et(wu,this).right;Et(kn,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Et(wu,this).left+Et(Zn,this).left-Et(kn,this).offsetWidth;if(Et(ba,this)){const r=Number.parseInt(getComputedStyle(Et(ba,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}Et(kn,this).style.left=`${e}px`}}function D2(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:n=()=>{},onClear:i=()=>{}}=t;const s=new Set;let o=$t(e,-1,g()-1);function a(p,y){const S=g()-1;return p<0&&(p=S),p>S&&(p=0),s.has(p)?-1:(s.add(p),n(p,!1)===!1&&(p=a(y===1?++p:--p,y)),p)}function l(p){p>-1&&p<g()&&n(p,!0)!==!1&&(o=p)}function c(){return o}function u(){g()>0&&(s.clear(),o=a(0,1))}function h(){g()>0&&(s.clear(),o=a(g()-1,-1))}function f(){g()>0&&(s.clear(),o=a(++o,1))}function d(){g()>0&&(s.clear(),o=a(--o,-1))}function g(){return Math.max(r(),0)}function m(){s.clear(),o=e,i()}return{setCurrentPage:l,getCurrentPage:c,toFirstItem:u,toLastItem:h,toNextItem:f,toPreviousItem:d,getSize:g,clear:m}}function VZ(t){return bt(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Vy(t){return Cr(t,"submenu")}function Wy(t){return new RegExp(ft,"i").test(t.name)}function Xm(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function SA(t){return Cr(t,"disableSelection")}function WZ(t){return Qe(t,"htSeparator")}function UZ(t){return Qe(t,"htSubmenu")}function jZ(t){return Qe(t,"htDisabled")}function zZ(t){return Qe(t,"htSelectionDisabled")}function GZ(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function L2(t,e){const r=t.slice(0);for(let n=0;n<r.length&&r[n].name===e;)r.shift();return r}function YZ(t,e){let r=t.slice(0);return r.reverse(),r=L2(r,e),r.reverse(),r}function KZ(t){const e=[];return J(t,(r,n)=>{n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function XZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ft,r=t.slice(0);return r=L2(r,e),r=YZ(r,e),r=KZ(r),r}function qZ(t){return t.checkable===!0}function JZ(t){return D2({size:()=>t.countRows(),onItemSelect(e,r){const n=t.getCell(e,0);if(!n||WZ(n)||jZ(n)||zZ(n))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function ZZ(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,i)=>{const s=e.getSettings(),o=typeof s.tabMoves=="function"?s.tabMoves(n):s.tabMoves;i.includes("shift")?e.selection.transformStart(-o.row,-o.col):e.selection.transformStart(o.row,o.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const n=r.getSelectedLast();if(n){const i=t.openSubMenu(n[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{r.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{const i=r.getSelectedLast();i&&(r.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(n),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const $2="menu",bA=$2;function QZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];n(ZZ(t)),e.forEach(c=>{let{shortcuts:u,contextName:h}=c;i(u,h)});function n(c,u){a(u).addShortcuts(c,{group:$2})}function i(c,u){const h=a(u);c.forEach(f=>{let{keys:d}=f;d.forEach(g=>h.removeShortcutsByKeys(g))}),r.push({shortcuts:c,contextName:u}),n(c,u)}function s(){return[...r]}function o(c){return c?`${bA}:${c}`:bA}function a(c){var u;const h=t.hotMenu.getShortcutManager(),f=o(c);return(u=h.getContext(f))!==null&&u!==void 0?u:h.addContext(f)}function l(c){t.hotMenu.getShortcutManager().setActiveContextName(o(c))}return{addCustomShortcuts:i,getCustomShortcuts:s,getContext:a,listen:l}}function eQ(t){return(e,r,n,i,s,o)=>{const a=e.getSourceDataAtRow(n),l=t.rootDocument.createElement("div"),c=typeof o=="function"?o.call(t):o,u=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(wo(r),_e(l,"htItemWrapper"),t.getSettings().ariaTags){const f=!Xm(a,t)&&!SA(a)&&!Wy(a);Ze(r,[...qZ(a)?[f8(),up(u),cP(h)]:[h8(),up(c)],...f?[Ch(-1)]:[],...Xm(a,t)?[C8()]:[],...Vy(a)?[qi(!1)]:[]])}r.className="",r.appendChild(l),Wy(a)?_e(r,"htSeparator"):typeof a.renderer=="function"?(_e(r,"htCustomMenuRenderer"),r.appendChild(a.renderer(e,l,n,i,s,c))):xh(l,c),Xm(a,t)?_e(r,"htDisabled"):SA(a)?_e(r,"htSelectionDisabled"):Vy(a)&&_e(r,"htSubmenu")}}function WC(t,e,r){tQ(t,e),e.set(t,r)}function tQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function js(t,e,r){return(e=rQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rQ(t){var e=nQ(t,"string");return typeof e=="symbol"?e:e+""}function nQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function UC(t,e,r){return t.set(B2(t,e),r),r}function Bl(t,e){return t.get(B2(t,e))}function B2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const EA=215;var hf=new WeakMap,$0=new WeakMap,B0=new WeakMap;class Rh{get tableBorderWidth(){return Bl(B0,this)===void 0&&this.hotMenu&&UC(B0,this,parseInt(sa(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Bl(B0,this)}constructor(e,r){var n=this;js(this,"hot",void 0),js(this,"options",void 0),js(this,"eventManager",new Ms(this)),js(this,"container",void 0),js(this,"positioner",void 0),js(this,"hotMenu",null),js(this,"hotSubMenus",{}),js(this,"parentMenu",void 0),js(this,"menuItems",null),js(this,"origOutsideClickDeselects",null),WC(this,hf,void 0),WC(this,$0,void 0),WC(this,B0,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:EA,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new BZ(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.parentMenu.runLocalHooks("afterSelectionChange",...s)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=oh(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Bl(hf,this)}getKeyboardShortcutsCtrl(){return Bl($0,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Wx(a=>this.openSubMenu(a),300),r=this.options.minWidth||EA;let n=!1,i=rl(this.menuItems,a=>(a.key===Pd&&(n=!0),GZ(a,this.hot)));if(i.length<1&&!n)i.push(O2()[Pd]);else if(i.length===0)return;i=XZ(i,ft);let s=!1;const o={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return Ue(a)&&a<r?r:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:eQ(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{Bl(hf,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===ft?1:void 0,afterOnCellContextMenu:a=>{a.preventDefault(),HT()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,c,u,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!HT()||!bc(a))&&s&&this.hasSelectedItem()&&(za()||MP()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),UC(hf,this,JZ(this.hotMenu)),UC($0,this,QZ(this)),Bl($0,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Bl(hf,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedLast();if(r){const n=this.parentMenu.hotMenu.getCell(r[0],0);Ze(n,[qi(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!UZ(r))return!1;const n=this.hotMenu.getSourceDataAtRow(e),i=new Rh(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(n.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=i,this.hot.getSettings().ariaTags&&Ze(r,[qi(!0)]),i}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[r.key];if(n){n.destroy(),delete this.hotSubMenus[r.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Ze(i,[qi(!1)])}}closeAllSubMenus(){J(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const n=this.hot.getSelectedRange(),i=n?VZ(n):[];this.runLocalHooks("executeCommand",r.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,i,e)}isCommandPassive(e){return e.isCommand===!1||Wy(e)||Xm(e,this.hot)||Vy(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,n=e.hider.style,i=e.holder.style,s=parseInt(n.width,10),o=Gn(r,(a,l,c)=>{const h=this.hotMenu.getCell(c,0)?Fr(this.hotMenu.getCell(c,0)):0;return a+(l.name===ft?1:h)},0);i.width=`${s+3}px`,i.height=`${o+3}px`,n.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let n=e,i;return n&&(er(n)&&(n=n.call(this.hot),n===null||tr(n)?n="":n=n.toString()),n=n.replace(/[^A-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,i=r.querySelector(`.${this.options.className}.${n}`)),i||(i=r.createElement("div"),_e(i,`htMenu ${this.options.className}`),n&&_e(i,n),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Ze(this.hotMenu.rootElement,[u8(),Ch(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!pc(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!pc(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Qe(e.target,"htCore")&&pc(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}jt(Rh,vn);function iQ(t,e){sQ(t,e),e.add(t)}function sQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jC(t,e,r){return(e=oQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oQ(t){var e=aQ(t,"string");return typeof e=="symbol"?e:e+""}function aQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function V0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Bf="contextMenu",lQ=70,RA=Bf;We.getSingleton().register("afterContextMenuDefaultOptions");We.getSingleton().register("beforeContextMenuShow");We.getSingleton().register("afterContextMenuShow");We.getSingleton().register("afterContextMenuHide");We.getSingleton().register("afterContextMenuExecute");var ff=new WeakSet;class Xv extends kt{constructor(){super(...arguments),iQ(this,ff),jC(this,"commandExecutor",new N2(this.hot)),jC(this,"itemsFactory",null),jC(this,"menu",null)}static get PLUGIN_KEY(){return Bf}static get PLUGIN_PRIORITY(){return lQ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[zv,Gv,ft,wg,Cg,ft,jv,xg,ft,Yv,Uv,ft,yg,ft,Ui]}isEnabled(){return!!this.hot.getSettings()[Bf]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[Bf];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new Rh(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>V0(ff,this,uQ).call(this)),this.menu.addLocalHook("afterOpen",()=>V0(ff,this,hQ).call(this)),this.menu.addLocalHook("afterClose",()=>V0(ff,this,fQ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",n=>V0(ff,this,cQ).call(this,n)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=Vv(this.menu.container,this.hot.rootDocument);this.open({left:r.left+n.left,top:r.top+n.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:RA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(RA)}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((r=this.menu)!==null&&r!==void 0&&r.isOpened())return;this.prepareMenuItems(),this.menu.open(),this.menu.tableBorderWidth>0||(n.below+=1,n.right+=1,n.above-=1,n.left-=1),gt(n,(s,o)=>{this.menu.setOffset(o,s)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new F2(this.hot,Xv.DEFAULT_ITEMS);const e=this.hot.getSettings()[Bf],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),J(n,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function cQ(t){const e=this.hot.getSettings(),r=e.rowHeaders,n=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const s=t.target;if(this.close(),Qe(s,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||n)&&!i(s)&&!(Qe(s,"current")&&Qe(s,"wtBorder"))))return;const o=Vv(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+o.top,left:t.clientX+o.left})}function uQ(){this.hot.runHooks("beforeContextMenuShow",this)}function hQ(){this.hot.runHooks("afterContextMenuShow",this)}function fQ(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Xv.SEPARATOR={name:ft};function dQ(t){return{key:"copy",name(){return this.getTranslatedPhrase(kS)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function gQ(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),r=e?$t(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(HS,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function mQ(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),r=e?$t(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(FS,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function pQ(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),r=e?$t(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(NS,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function vQ(t){return{key:"cut",name(){return this.getTranslatedPhrase(DS)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class wQ{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class CQ{constructor(){this.clipboardData=new wQ}preventDefault(){}}function yQ(t,e){V2(t,e),e.add(t)}function Cu(t,e,r){V2(t,e),e.set(t,r)}function V2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hn(t,e){return t.get(Ku(t,e))}function yu(t,e,r){return t.set(Ku(t,e),r),r}function Ku(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ea=new WeakMap,zC=new WeakMap,df=new WeakMap,Uy=new WeakMap,jy=new WeakMap,gf=new WeakMap,mf=new WeakSet;class xQ{constructor(e){let{countRows:r,countColumns:n,rowsLimit:i,columnsLimit:s,countColumnHeaders:o}=e;yQ(this,mf),Cu(this,Ea,void 0),Cu(this,zC,void 0),Cu(this,df,void 0),Cu(this,Uy,void 0),Cu(this,jy,void 0),Cu(this,gf,void 0),yu(zC,this,r),yu(df,this,n),yu(Uy,this,i),yu(jy,this,s),yu(gf,this,o)}setSelectedRange(e){yu(Ea,this,e)}getCellsRange(){if(Hn(zC,this).call(this)===0||Hn(df,this).call(this)===0)return null;const{row:e,col:r}=Hn(Ea,this).getTopStartCorner(),{row:n,col:i}=Hn(Ea,this).getBottomEndCorner(),s=Ku(mf,this,SQ).call(this,e,n),o=Ku(mf,this,GC).call(this,r,i);return{isRangeTrimmed:n!==s||i!==o,startRow:e,startCol:r,endRow:s,endCol:o}}getMostBottomColumnHeadersRange(){if(Hn(df,this).call(this)===0||Hn(gf,this).call(this)===0)return null;const{col:e}=Hn(Ea,this).getTopStartCorner(),{col:r}=Hn(Ea,this).getBottomEndCorner(),n=Ku(mf,this,GC).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(Hn(df,this).call(this)===0||Hn(gf,this).call(this)===0)return null;const{col:e}=Hn(Ea,this).getTopStartCorner(),{col:r}=Hn(Ea,this).getBottomEndCorner(),n=Ku(mf,this,GC).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-Hn(gf,this).call(this),startCol:e,endRow:-1,endCol:n}}}function GC(t,e){return Math.min(e,Math.max(t+Hn(jy,this).call(this)-1,t))}function SQ(t,e){return Math.min(e,Math.max(t+Hn(Uy,this).call(this)-1,t))}function W2(t){const e=[],r=[];return J(t,n=>{const i=Math.min(n.startRow,n.endRow),s=Math.max(n.startRow,n.endRow);Ge(i,s,l=>{e.indexOf(l)===-1&&e.push(l)});const o=Math.min(n.startCol,n.endCol),a=Math.max(n.startCol,n.endCol);Ge(o,a,l=>{r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function bQ(t,e){U2(t,e),e.add(t)}function Ra(t,e,r){U2(t,e),e.set(t,r)}function U2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pf(t,e,r){return(e=EQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EQ(t){var e=RQ(t,"string");return typeof e=="symbol"?e:e+""}function RQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ni(t,e){return t.get(ii(t,e))}function ms(t,e,r){return t.set(ii(t,e),r),r}function ii(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}We.getSingleton().register("afterCopyLimit");We.getSingleton().register("modifyCopyableRange");We.getSingleton().register("beforeCut");We.getSingleton().register("afterCut");We.getSingleton().register("beforePaste");We.getSingleton().register("afterPaste");We.getSingleton().register("beforeCopy");We.getSingleton().register("afterCopy");const W0="copyPaste",TQ=80,_Q=["fragmentSelection"],TA=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var zy=new WeakMap,Gy=new WeakMap,Yy=new WeakMap,xu=new WeakMap,U0=new WeakMap,j0=new WeakMap,Su=new WeakMap,Np=new WeakMap,vi=new WeakSet;class AQ extends kt{constructor(){super(...arguments),bQ(this,vi),pf(this,"columnsLimit",1/0),pf(this,"rowsLimit",1/0),pf(this,"pasteMode","overwrite"),pf(this,"uiContainer",this.hot.rootDocument.body),Ra(this,zy,!1),Ra(this,Gy,!1),Ra(this,Yy,!1),Ra(this,xu,"cells-only"),Ra(this,U0,!1),Ra(this,j0,!1),Ra(this,Su,new xQ({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Ra(this,Np,!1),pf(this,"copyableRanges",[])}static get PLUGIN_KEY(){return W0}static get SETTING_KEYS(){return[W0,..._Q]}static get PLUGIN_PRIORITY(){return TQ}isEnabled(){return!!this.hot.getSettings()[W0]}enablePlugin(){var e=this;if(this.enabled)return;const{[W0]:r}=this.hot.getSettings();if(typeof r=="object"){var n,i;this.pasteMode=(n=r.pasteMode)!==null&&n!==void 0?n:this.pasteMode,this.rowsLimit=isNaN(r.rowsLimit)?this.rowsLimit:r.rowsLimit,this.columnsLimit=isNaN(r.columnsLimit)?this.columnsLimit:r.columnsLimit,ms(zy,this,!!r.copyColumnHeaders),ms(Gy,this,!!r.copyColumnGroupHeaders),ms(Yy,this,!!r.copyColumnHeadersOnly),this.uiContainer=(i=r.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",s=>ii(vi,this,OQ).call(this,s)),this.addHook("afterSelection",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return ii(vi,e,PQ).call(e,...o)}),this.addHook("afterSelectionEnd",()=>ii(vi,this,kQ).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),AP()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return ii(vi,e,NQ).call(e,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return ii(vi,e,FQ).call(e,...o)}),this.addHook("afterSelection",()=>ii(vi,this,HQ).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";ms(xu,this,e),ms(U0,this,!0),ii(vi,this,_A).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){ms(j0,this,!0),ii(vi,this,_A).call(this,"cut")}getRangedCopyableData(e){return Xf(this.getRangedData(e))}getRangedData(e){const r=[],{rows:n,columns:i}=W2(e);return J(n,s=>{const o=[];J(i,a=>{s<0?o.push(this.hot.getColHeader(a,s)):o.push(this.hot.getCopyableData(s,a))}),r.push(o)}),r}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const n=new CQ;e&&n.clipboardData.setData("text/plain",e),r&&n.clipboardData.setData("text/html",r),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}ni(Su,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);ni(xu,this)==="column-headers-only"?r.set("headers",ni(Su,this).getMostBottomColumnHeadersRange()):(ni(xu,this)==="with-column-headers"?r.set("headers",ni(Su,this).getMostBottomColumnHeadersRange()):ni(xu,this)==="with-column-group-headers"&&r.set("headers",ni(Su,this).getAllColumnHeadersRange()),r.set("cells",ni(Su,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(i=>i!==null).map(i=>{let{startRow:s,startCol:o,endRow:a,endCol:l}=i;return{startRow:s,startCol:o,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=r.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:i,startCol:s,endRow:o,endCol:a}=n;this.hot.runHooks("afterCopyLimit",o-i+1,a-s+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const n=e.length,i=e[0].length,s=[],{row:o,col:a}=r.getTopStartCorner(),{row:l,col:c}=r.getBottomEndCorner();let u=o,h=a,f=o,d=a;for(;s.length<n||u<=l;){const{skipRowOnPaste:g,visualRow:m}=this.hot.getCellMeta(u,a);if(u=m+1,g===!0)continue;f=m,h=a;const p=[],y=s.length%n;for(;p.length<i||h<=c;){const{skipColumnOnPaste:S,visualCol:C}=this.hot.getCellMeta(o,h);if(h=C+1,S===!0)continue;d=C;const A=p.length%i;p.push(e[y][A])}s.push(p)}return ms(Np,this,!0),this.hot.populateFromArray(o,a,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,a,f,d]}onCopy(e){var r;const n=this.hot.getFocusManager().getRefocusElement(),i=(r=e.target)===null||r===void 0?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ni(U0,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(i&&e.target!==n||!i&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),ms(U0,this,!1);const s=this.getRangedData(this.copyableRanges),o=ii(vi,this,IQ).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",s,this.copyableRanges,o)){const l=Xf(s);if(e&&e.clipboardData){const c=KT(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[TA,c].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",s,this.copyableRanges,o)}ms(xu,this,"cells-only")}onCut(e){var r;const n=this.hot.getFocusManager().getRefocusElement(),i=(r=e.target)===null||r===void 0?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ni(j0,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(i&&e.target!==n||!i&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),ms(j0,this,!1);const s=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",s,this.copyableRanges)){const a=Xf(s);if(e&&e.clipboardData){const l=KT(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[TA,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",s,this.copyableRanges)}}onPaste(e){var r;const n=this.hot.getFocusManager().getRefocusElement(),i=(r=e.target)===null||r===void 0?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||e.target instanceof HTMLElement&&(i&&e.target!==n||!i&&e.target!==this.hot.rootDocument.body))return;e.preventDefault();let s;if(e&&typeof e.clipboardData<"u"){const u=Hx(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});u&&/(<table)|(<TABLE)/g.test(u)?s=LU(u,this.hot.rootDocument).data:s=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(s=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof s=="string"&&(s=mz(s)),s===void 0||s&&s.length===0||this.hot.runHooks("beforePaste",s,this.copyableRanges)===!1)return;const[o,a,l,c]=this.populateValues(s);this.hot.selectCell(o,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,c)),this.hot.runHooks("afterPaste",s,this.copyableRanges)}destroy(){super.destroy()}}function _A(t){if(AP()){const e=this.hot.getSelectedRangeLast();if(e){const{row:r,col:n}=e.highlight,i=this.hot.getCell(r,n,!0);i&&V8(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function IQ(t){const{rows:e}=W2(t);let r=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)r+=1;return{columnHeadersCount:r}}function MQ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n&&CP(n)}}}function j2(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n!=null&&n.hasAttribute("contenteditable")&&yP(n)}}}function OQ(t){t.items.push({name:"---------"},dQ(this)),ni(zy,this)&&t.items.push(pQ(this)),ni(Gy,this)&&t.items.push(mQ(this)),ni(Yy,this)&&t.items.push(gQ(this)),t.items.push(vQ(this))}function PQ(t,e,r,n,i){ni(Np,this)&&(i.value=!0),ms(Np,this,!1)}function kQ(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function NQ(){ii(vi,this,j2).call(this)}function FQ(){ii(vi,this,MQ).call(this)}function HQ(){ii(vi,this,j2).call(this)}function z2(t,e){return`border_row${t}col${e}`}function Vf(){return{width:1,color:"#000"}}function Jo(){return{hide:!0}}function DQ(){return{width:1,color:"#000",cornerVisible:!1}}function YC(t){if(Ue(t.start)||Ue(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(Ue(t.end)||Ue(t.right)){var r;t.end=(r=t.end)!==null&&r!==void 0?r:t.right}return delete t.left,delete t.right,t}function vf(t){return Ue(t.start)&&(t.left=t.start),Ue(t.end)&&(t.right=t.end),t}function KC(t,e){return{id:z2(t,e),border:DQ(),row:t,col:e,top:Jo(),bottom:Jo(),start:Jo(),end:Jo()}}function LQ(t,e){return Cr(e,"border")&&e.border&&(t.border=e.border),Cr(e,"top")&&Ue(e.top)&&(e.top?(dt(e.top)||(e.top=Vf()),t.top=e.top):(e.top=Jo(),t.top=e.top)),Cr(e,"bottom")&&Ue(e.bottom)&&(e.bottom?(dt(e.bottom)||(e.bottom=Vf()),t.bottom=e.bottom):(e.bottom=Jo(),t.bottom=e.bottom)),Cr(e,"start")&&Ue(e.start)&&(e.start?(dt(e.start)||(e.start=Vf()),t.start=e.start):(e.start=Jo(),t.start=e.start)),Cr(e,"end")&&Ue(e.end)&&(e.end?(dt(e.end)||(e.end=Vf()),t.end=e.end):(e.end=Jo(),t.end=e.end)),t}function oa(t,e){let r=!1;return J(t.getSelectedRange(),n=>{n.forAll((i,s)=>{if(i<0||s<0)return;const o=t.getCellMeta(i,s).borders;if(o)if(e){if(!Cr(o[e],"hide")||o[e].hide===!1)return r=!0,!1}else return r=!0,!1})}),r}function qv(t){return`<span class="selected">â</span>${t}`}function $Q(t){return t.some(e=>Ue(e.left)||Ue(e.right))}function BQ(t){return t.some(e=>Ue(e.start)||Ue(e.end))}const VQ=new Map([["left","start"],["right","end"]]);function WQ(t){var e;return(e=VQ.get(t))!==null&&e!==void 0?e:t}function UQ(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(qS);return oa(this,"bottom")&&(e=qv(e)),e},callback(e,r){const n=oa(this,"bottom");t.prepareBorder(r,"bottom",n)}}}function jQ(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let r=this.getTranslatedPhrase(JS);return oa(this,e)&&(r=qv(r)),r},callback(r,n){const i=oa(this,e);t.prepareBorder(n,e,i)}}}function zQ(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(ZS)},callback(e,r){t.prepareBorder(r,"noBorders")},disabled(){return!oa(this)}}}function GQ(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let r=this.getTranslatedPhrase(XS);return oa(this,e)&&(r=qv(r)),r},callback(r,n){const i=oa(this,e);t.prepareBorder(n,e,i)}}}function YQ(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(KS);return oa(this,"top")&&(e=qv(e)),e},callback(e,r){const n=oa(this,"top");t.prepareBorder(r,"top",n)}}}function KQ(t,e){XQ(t,e),e.add(t)}function XQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qQ(t,e,r){return(e=JQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JQ(t){var e=ZQ(t,"string");return typeof e=="symbol"?e:e+""}function ZQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AA(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const qm="customBorders",QQ=90;var XC=new WeakSet;class eee extends kt{constructor(){super(...arguments),KQ(this,XC),qQ(this,"savedBorders",[])}static get PLUGIN_KEY(){return qm}static get PLUGIN_PRIORITY(){return QQ}isEnabled(){return!!this.hot.getSettings()[qm]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>AA(XC,this,tee).call(this,e)),this.addHook("init",()=>AA(XC,this,ree).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,r){let n=["top","bottom","start","end"],i=null;r&&(this.checkSettingsCohesion([r]),n=Object.keys(r),i=YC(r));const s=ch(e),o=Ad(s,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});J(e,a=>{o(a).forAll((l,c)=>{J(n,u=>{this.prepareBorderFromCustomAdded(l,c,i,WQ(u))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const r=ch(e),n=Ad(r,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return J(e,s=>{n(s).forAll((o,a)=>{J(this.savedBorders,l=>{l.row===o&&l.col===a&&i.push(vf(l))})})}),i}clearBorders(e){e?this.setBorders(e):(J(this.savedBorders,r=>{this.clearBordersFromSelectionSettings(r.id),this.clearNullCellRange(),this.hot.removeCellMeta(r.row,r.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,r){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,r)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,r,n,i){const s=this.hot.countRows(),o=this.hot.countCols();if(e>=s||r>=o)return;let a=KC(e,r);n&&(a=LQ(a,n),J(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,n),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,r,"borders",vf(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,r){const n=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);Ge(e.from.row,n,s=>{Ge(e.from.col,i,o=>{const a=KC(s,o);let l=0;s===e.from.row&&Cr(r,"top")&&(l+=1,a.top=r.top),s===e.to.row&&Cr(r,"bottom")&&(l+=1,a.bottom=r.bottom),o===e.from.col&&Cr(r,"start")&&(l+=1,a.start=r.start),o===e.to.col&&Cr(r,"end")&&(l+=1,a.end=r.end),l>0&&(this.hot.setCellMeta(s,o,"borders",vf(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,r){const n=z2(e,r);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,r,"borders")}setBorder(e,r,n,i){let s=this.hot.getCellMeta(e,r).borders;!s||s.border===void 0?s=KC(e,r):s=YC(s),i?(s[n]=Jo(),this.countHide(s)===4?this.removeAllBorders(e,r):(this.checkCustomSelectionsFromContextMenu(s,n,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,r,"borders",vf(s)))):(s[n]=Vf(),this.checkCustomSelectionsFromContextMenu(s,n,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,r,"borders",vf(s)))}prepareBorder(e,r,n){J(e,i=>{let{start:s,end:o}=i;if(s.row===o.row&&s.col===o.col)r==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,r,n);else switch(r){case"noBorders":Ge(s.col,o.col,a=>{Ge(s.row,o.row,l=>{this.removeAllBorders(l,a)})});break;case"top":Ge(s.col,o.col,a=>{this.setBorder(s.row,a,r,n)});break;case"bottom":Ge(s.col,o.col,a=>{this.setBorder(o.row,a,r,n)});break;case"start":Ge(s.row,o.row,a=>{this.setBorder(a,s.col,r,n)});break;case"end":Ge(s.row,o.row,a=>{this.setBorder(a,o.col,r,n)});break}})}createCustomBorders(e){J(e,r=>{const n=YC(r);r.range?this.prepareBorderFromCustomAddedRange(r.range,n):this.prepareBorderFromCustomAdded(r.row,r.col,n)})}countHide(e){const{top:r,bottom:n,start:i,end:s}=e;return Gn([r,n,i,s],(a,l)=>{let c=a;return l&&l.hide&&(c+=1),c},0)}clearBordersFromSelectionSettings(e){const r=bt(this.hot.selection.highlight.customSelections,n=>n.settings.id).indexOf(e);r>-1&&this.hot.selection.highlight.customSelections[r].clear()}clearNullCellRange(){J(this.hot.selection.highlight.customSelections,(e,r)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[r].destroy(),this.hot.selection.highlight.customSelections.splice(r,1),!1})}hideBorders(){J(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const r=bt(this.savedBorders,n=>n.id).indexOf(e);r>-1&&this.savedBorders.splice(r,1)}checkSavedBorders(e){let r=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),r=!0):J(this.savedBorders,(i,s)=>{if(e.id===i.id)return this.savedBorders[s]=e,r=!0,!1}),r}checkCustomSelectionsFromContextMenu(e,r,n){let i=!1;return J(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){const o=this.hot.view._wt.selectionManager.getBorderInstances(s);return J(o,a=>{a.toggleHiddenClass(r,n)}),i=!0,!1}}),i}checkCustomSelections(e,r,n){const i=this.countHide(e);let s=!1;return i===4?(this.removeAllBorders(e.row,e.col),s=!0):J(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){if(o.visualCellRange=r,o.commit(),n){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);J(a,l=>{l.changeBorderStyle(n,e)})}return s=!0,!1}}),s}changeBorderSettings(){const e=this.hot.getSettings()[qm];if(Array.isArray(e)){const r=zn(e);this.checkSettingsCohesion(r),r.length||(this.savedBorders=r),this.createCustomBorders(r)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const r=$Q(e),n=BQ(e);if(r&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&r)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function tee(t){this.hot.getSettings()[qm]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(YS)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[YQ(this),GQ(this),UQ(this),jQ(this),zQ(this)]}})}function ree(){this.changeBorderSettings()}function nee(t,e){iee(t,e),e.add(t)}function iee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qC(t,e,r){return(e=see(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function see(t){var e=oee(t,"string");return typeof e=="symbol"?e:e+""}function oee(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function IA(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const MA="dragToScroll",aee=100;var JC=new WeakSet;class lee extends kt{constructor(){super(...arguments),nee(this,JC),qC(this,"boundaries",null),qC(this,"callback",null),qC(this,"listening",!1)}static get PLUGIN_KEY(){return MA}static get PLUGIN_PRIORITY(){return aee}isEnabled(){return!!this.hot.getSettings()[MA]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>IA(JC,this,OA).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>IA(JC,this,OA).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,r){let n=0,i=0;r<this.boundaries.top?i=r-this.boundaries.top:r>this.boundaries.bottom&&(i=r-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let r=e;for(;r;)this.eventManager.addEventListener(r.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mousemove",n=>this.onMouseMove(n)),r=oh(r)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function OA(t){if(bc(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((r,n)=>{var i,s;const o=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(s=e.scrollTop)!==null&&s!==void 0?s:e.scrollY;e.scroll(o+Math.sign(r)*50,a+Math.sign(n)*20)}),this.listen()}function cee(t,e){G2(t,e),e.add(t)}function uee(t,e,r){G2(t,e),e.set(t,r)}function G2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZC(t,e,r){return(e=hee(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hee(t){var e=fee(t,"string");return typeof e=="symbol"?e:e+""}function fee(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dee(t,e){return t.get(ji(t,e))}function Y2(t,e,r){return t.set(ji(t,e),r),r}function ji(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}We.getSingleton().register("afterDropdownMenuDefaultOptions");We.getSingleton().register("beforeDropdownMenuShow");We.getSingleton().register("afterDropdownMenuShow");We.getSingleton().register("afterDropdownMenuHide");We.getSingleton().register("afterDropdownMenuExecute");const Jm="dropdownMenu",gee=230,kd="changeType",QC=Jm;var Jv=new WeakMap,vs=new WeakSet;class Zv extends kt{static get PLUGIN_KEY(){return Jm}static get PLUGIN_PRIORITY(){return gee}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[wg,Cg,ft,xg,ft,Wv,ft,yg,ft,Ui]}constructor(e){super(e),cee(this,vs),ZC(this,"commandExecutor",new N2(this.hot)),ZC(this,"itemsFactory",null),ZC(this,"menu",null),uee(this,Jv,!1),this.hot.addHook("afterGetColHeader",(r,n)=>ji(vs,this,pee).call(this,r,n))}isEnabled(){return this.hot.getSettings()[Jm]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new F2(this.hot,Zv.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return ji(vs,e,See).call(e,...s)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return ji(vs,e,xee).call(e,...s)});const r=this.hot.getSettings()[Jm],n={items:this.itemsFactory.getItems(r)};this.registerEvents(),typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(r);this.menu&&this.menu.destroy(),this.menu=new Rh(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>ji(vs,this,vee).call(this)),this.menu.addLocalHook("afterOpen",()=>ji(vs,this,wee).call(this)),this.menu.addLocalHook("afterSubmenuOpen",s=>ji(vs,this,Cee).call(this,s)),this.menu.addLocalHook("afterClose",()=>ji(vs,this,yee).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return e.executeCommand.call(e,...o)}),J(i,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),r=()=>{const{highlight:n}=this.hot.getSelectedRangeLast();if((n.isHeader()&&n.row===-1||n.isCell())&&n.col>=0){this.hot.selectColumns(n.col,n.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),s=Vv(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,i.col,!0).querySelector(`.${kd}`),a=o.getBoundingClientRect();this.open({left:a.left+s.left,top:a.top+o.offsetHeight+s.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:r,runOnlyIf:()=>{var n;const i=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:QC},{keys:[["Shift","Alt","ArrowDown"]],callback:r,runOnlyIf:()=>{var n;const i=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:QC}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(QC)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>ji(vs,this,mee).call(this,e))}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(r=this.menu)!==null&&r!==void 0&&r.isOpened()||(this.menu.open(),gt(n,(i,s)=>{this.menu.setOffset(s,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function K2(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function mee(t){if(Qe(t.target,kd)){const e=Vv(this.menu.container,this.hot.rootDocument),r=t.target.getBoundingClientRect();t.stopPropagation(),Y2(Jv,this,!1),this.open({left:r.left+e.left,top:r.top+t.target.offsetHeight+e.top},{left:r.width,right:0,above:0,below:3})}}function pee(t,e){const r=e.parentNode;if(!r)return;const n=r.parentNode.childNodes,i=Array.prototype.indexOf.call(n,r);if(t<0||i!==n.length-1)return;const s=e.querySelector(`.${kd}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const o=this.hot.rootDocument.createElement("button");o.className=kd,o.type="button",o.tabIndex=-1,this.hot.getSettings().ariaTags&&(Ze(o,[Wc(),up(" ")]),Ze(e,[oP("menu")])),o.onclick=function(){return!1},e.firstChild.insertBefore(o,e.firstChild.firstChild)}function vee(){this.hot.runHooks("beforeDropdownMenuShow",this)}function wee(){this.hot.runHooks("afterDropdownMenuShow",this),ji(vs,this,K2).call(this,this.menu)}function Cee(t){ji(vs,this,K2).call(this,t)}function yee(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function xee(t){return dee(Jv,this)?null:t}function See(t){Qe(t.target,kd)&&Y2(Jv,this,!0)}Zv.SEPARATOR={name:ft};function PA(t,e,r){return(e=bee(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bee(t){var e=Eee(t,"string");return typeof e=="symbol"?e:e+""}function Eee(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ree{constructor(e){PA(this,"hot",void 0),PA(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:r,endRow:n,endCol:i}=this._getDataRange(),s=this.options,o=[];return Ge(e,n,a=>{const l=[];!s.exportHiddenRows&&this._isHiddenRow(a)||(Ge(r,i,c=>{!s.exportHiddenColumns&&this._isHiddenColumn(c)||l.push(this.hot.getDataAtCell(a,c))}),o.push(l))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:r,endRow:n}=this._getDataRange(),i=this.hot.getRowHeader();Ge(r,n,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(i[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:r,endCol:n}=this._getDataRange(),i=this.hot.getColHeader();Ge(r,n,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(i[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,r=this.hot.countRows()-1;let[n=0,i=0,s=r,o=e]=this.options.range;return n=Math.max(n,0),i=Math.max(i,0),s=Math.min(s,r),o=Math.min(o,e),{startRow:n,startCol:i,endRow:s,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function kA(t,e,r){return(e=Tee(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Tee(t){var e=_ee(t,"string");return typeof e=="symbol"?e:e+""}function _ee(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aE{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,r){kA(this,"dataProvider",void 0),kA(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let r=Co(this.constructor.DEFAULT_OPTIONS);const n=new Date;return r=Ur(Co(aE.DEFAULT_OPTIONS),r),r=Ur(r,e),r.filename=nP(r.filename,{YYYY:n.getFullYear(),MM:`${n.getMonth()+1}`.padStart(2,"0"),DD:`${n.getDate()}`.padStart(2,"0")}),r}}const Aee="\r",Iee='"',Mee=`
`;class Oee extends aE{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,r=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const i=n.length>0,s=this.dataProvider.getRowHeaders(),o=s.length>0;let a=e.bom?"\uFEFF":"";return i&&(n=bt(n,l=>this._escapeCell(l,!0)),o&&(a+=e.columnDelimiter),a+=n.join(e.columnDelimiter),a+=e.rowDelimiter),J(r,(l,c)=>{c>0&&(a+=e.rowDelimiter),o&&(a+=this._escapeCell(s[c])+e.columnDelimiter),a+=l.map(u=>this._escapeCell(u)).join(e.columnDelimiter)}),a}_escapeCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=Nr(e);return n!==""&&(r||n.indexOf(Aee)>=0||n.indexOf(Iee)>=0||n.indexOf(Mee)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n=`"${n}"`),n}}const Pee="csv",Ky={[Pee]:Oee};function kee(t,e,r){return typeof Ky[t]=="function"?new Ky[t](e,r):null}const Nee="exportFile",Fee=240;class Hee extends kt{static get PLUGIN_KEY(){return Nee}static get PLUGIN_PRIORITY(){return Fee}isEnabled(){return!0}exportAsString(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,r).export()}exportAsBlob(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,r))}downloadFile(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:n,rootWindow:i}=this.hot,s=this._createTypeFormatter(e,r),o=this._createBlob(s),a=i.URL||i.webkitURL,l=n.createElement("a"),c=`${s.options.filename}.${s.options.fileExtension}`;if(l.download!==void 0){const u=a.createObjectURL(o);l.style.display="none",l.setAttribute("href",u),l.setAttribute("download",c),n.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),n.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(u)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,c)}_createTypeFormatter(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Ky[e])throw new Error(`Export format type "${e}" is not supported.`);return kee(e,new Ree(this.hot),r)}_createBlob(e){let r=null;return typeof Blob<"u"&&(r=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),r}}function bu(t,e,r){return(e=Dee(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Dee(t){var e=Lee(t,"string");return typeof e=="symbol"?e:e+""}function Lee(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sg{constructor(e,r){let{id:n,stateless:i=!0}=r;bu(this,"hot",void 0),bu(this,"id",void 0),bu(this,"elements",[]),bu(this,"hidden",!1),bu(this,"stateId",""),bu(this,"state",void 0),this.hot=e,this.id=n,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new kv)}getElements(){return this.elements}reset(){J(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),J(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}jt(Sg,vn);const Nd={};function nl(t,e){if(!Nd[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:r,descriptor:n}=Nd[t];let i=e;return n.inputValuesDecorator&&(i=n.inputValuesDecorator(i)),function(s){return r.apply(s.meta.instance,[].concat([s],[i]))}}function hc(t){if(!Nd[t])throw Error(`Filter condition "${t}" does not exist.`);return Nd[t].descriptor}function Dr(t,e,r){r.key=t,Nd[t]={condition:e,descriptor:r}}const nn="none";function $ee(){return!0}Dr(nn,$ee,{name:Nv,inputsCount:0,showOperators:!1});const ed="empty";function Bee(t){return _r(t.value)}Dr(ed,Bee,{name:sb,inputsCount:0,showOperators:!0});const Zm="not_empty";function Vee(t,e){return!nl(ed,e)(t)}Dr(Zm,Vee,{name:ob,inputsCount:0,showOperators:!0});const td="eq";function Wee(t,e){let[r]=e;return Nr(t.value).toLocaleLowerCase(t.meta.locale)===Nr(r)}Dr(td,Wee,{name:ab,inputsCount:1,showOperators:!0});const Qm="neq";function Uee(t,e){return!nl(td,e)(t)}Dr(Qm,Uee,{name:lb,inputsCount:1,showOperators:!0});const X2="gt";function jee(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value>n}Dr(X2,jee,{name:db,inputsCount:1,showOperators:!0});const q2="gte";function zee(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value>=n}Dr(q2,zee,{name:gb,inputsCount:1,showOperators:!0});const J2="lt";function Gee(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value<n}Dr(J2,Gee,{name:mb,inputsCount:1,showOperators:!0});const Z2="lte";function Yee(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value<=n}Dr(Z2,Yee,{name:pb,inputsCount:1,showOperators:!0});const lE="date_after";function Kee(t,e){let[r]=e;const n=At(t.value,t.meta.dateFormat),i=At(r,t.meta.dateFormat);return!n.isValid()||!i.isValid()?!1:n.diff(i)>=0}Dr(lE,Kee,{name:Cb,inputsCount:1,showOperators:!0});const cE="date_before";function Xee(t,e){let[r]=e;const n=At(t.value,t.meta.dateFormat),i=At(r,t.meta.dateFormat);return!n.isValid()||!i.isValid()?!1:n.diff(i)<=0}Dr(cE,Xee,{name:yb,inputsCount:1,showOperators:!0});const Fp="between";function qee(t,e){let[r,n]=e,i=r,s=n;if(t.meta.type==="numeric"){const o=parseFloat(i,10),a=parseFloat(s,10);i=Math.min(o,a),s=Math.max(o,a)}else if(t.meta.type==="date"){const o=nl(cE,[s]),a=nl(lE,[i]);return o(t)&&a(t)}return t.value>=i&&t.value<=s}Dr(Fp,qee,{name:vb,inputsCount:2,showOperators:!0});const Q2="not_between";function Jee(t,e){return!nl(Fp,e)(t)}Dr(Q2,Jee,{name:wb,inputsCount:2,showOperators:!0});const eN="begins_with";function Zee(t,e){let[r]=e;return Nr(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Nr(r))}Dr(eN,Zee,{name:cb,inputsCount:1,showOperators:!0});const tN="ends_with";function Qee(t,e){let[r]=e;return Nr(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Nr(r))}Dr(tN,Qee,{name:ub,inputsCount:1,showOperators:!0});const uE="contains";function ete(t,e){let[r]=e;return Nr(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Nr(r))>=0}Dr(uE,ete,{name:hb,inputsCount:1,showOperators:!0});const rN="not_contains";function tte(t,e){return!nl(uE,e)(t)}Dr(rN,tte,{name:fb,inputsCount:1,showOperators:!0});const nN="date_tomorrow";function rte(t){const e=At(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(At().subtract(-1,"days").startOf("day"),"d"):!1}Dr(nN,rte,{name:Sb,inputsCount:0});const iN="date_today";function nte(t){const e=At(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(At().startOf("day"),"d"):!1}Dr(iN,nte,{name:xb,inputsCount:0});const sN="date_yesterday";function ite(t){const e=At(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(At().subtract(1,"days").startOf("day"),"d"):!1}Dr(sN,ite,{name:bb,inputsCount:0});o6();function ste(t,e){let r=t;return r===""&&(r=`(${e})`),r}const Xy=new Set([1]).has(1),ote=Xy&&typeof Array.from=="function";function bg(t){let e=t;return Xy&&(e=new Set(e)),function(r){let n;return Xy?n=e.has(r):n=!!~e.indexOf(r),n}}function oN(t){return t??""}function qy(t){let e=t;return ote?e=Array.from(new Set(e)):e=eP(e),e=e.sort((r,n)=>typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1),e}function NA(t,e,r,n){const i=[],s=t===e;let o;return s||(o=bg(e)),J(t,a=>{let l=!1;(s||o(a))&&(l=!0);const c={checked:l,value:a,visualValue:ste(a,r)};n&&n(c),i.push(c)}),i}const fc="by_value";function ate(t,e){let[r]=e;return r(t.value)}Dr(fc,ate,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[bg(e)]},showOperators:!1});const Fd={};function lte(t){if(!Fd[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Fd[t].func;return function(r,n){return e(r,n)}}function cte(t){return Fd[t].name}function hE(t,e,r){Fd[t]={name:e,func:r}}const el="conjunction",ute=Tb;function hte(t,e){return t.every(r=>r.func(e))}hE(el,ute,hte);const Hp="disjunction",fte=Fv;function dte(t,e){return t.some(r=>r.func(e))}hE(Hp,fte,dte);const fE="disjunctionWithExtraCondition",gte=Fv;function mte(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(r=>r.func(e))&&t[t.length-1].func(e)}hE(fE,gte,mte);const pte="numeric",aN="text",vte="date",FA={[pte]:[nn,ft,ed,Zm,ft,td,Qm,ft,X2,q2,J2,Z2,Fp,Q2],[aN]:[nn,ft,ed,Zm,ft,td,Qm,ft,eN,tN,ft,uE,rN],[vte]:[nn,ft,ed,Zm,ft,td,Qm,ft,cE,lE,Fp,ft,nN,iN,sN]};function wte(t){const e=[];let r=t;return FA[r]||(r=aN),J(FA[r],n=>{let i;n===ft?i={name:ft}:i=Co(hc(n)),e.push(i)}),e}function wf(t,e,r){return(e=Cte(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Cte(t){var e=yte(t,"string");return typeof e=="symbol"?e:e+""}function yte(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const e1="built",t1="building",HA=["click","input","keydown","keypress","keyup","focus","blur","change"];let Ts=class lN{static get DEFAULTS(){return Co({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,r){wf(this,"hot",void 0),wf(this,"eventManager",new Ms(this)),wf(this,"options",void 0),wf(this,"_element",void 0),wf(this,"buildState",void 0),this.hot=e,this.options=Ur(lN.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===t1?this._element:this.buildState===e1?(this.update(),this._element):(this.buildState=t1,this.build(),this.buildState=e1,this._element)}isBuilt(){return this.buildState===e1}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Yn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(r,n)=>{this.eventManager.addEventListener(r,n,i=>this.runLocalHooks(n,i,this))};if(this.buildState||(this.buildState=t1),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&_e(this._element,this.options.className),this.options.children.length)J(this.options.children,r=>this._element.appendChild(r.element));else if(this.options.wrapIt){const r=this.hot.rootDocument.createElement(this.options.tagName);r.setAttribute("data-hot-input",!0),gt(this.options,(n,i)=>{r[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(r[i]=this.translateIfPossible(n))}),this._element.appendChild(r),J(HA,n=>e(r,n))}else J(HA,r=>e(this._element,r))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};jt(Ts,vn);function xte(t,e){cN(t,e),e.add(t)}function Ste(t,e,r){cN(t,e),e.set(t,r)}function cN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function z0(t,e){return t.get(dE(t,e))}function bte(t,e,r){return t.set(dE(t,e),r),r}function dE(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Eu=new WeakMap,DA=new WeakSet;class tl extends Ts{static get DEFAULTS(){return Co({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,r){super(e,Ur(tl.DEFAULTS,r)),xte(this,DA),Ste(this,Eu,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>dE(DA,this,Ete).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");bte(Eu,this,this._element.firstChild),_e(this._element,"htUIInput"),_e(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(z0(Eu,this).type=this.options.type,z0(Eu,this).placeholder=this.translateIfPossible(this.options.placeholder),z0(Eu,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&z0(Eu,this).focus()}}function Ete(t){this.options.value=t.target.value}function Rte(t,e){uN(t,e),e.add(t)}function Cf(t,e,r){uN(t,e),e.set(t,r)}function uN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ru(t,e,r){return t.set(rd(t,e),r),r}function fr(t,e){return t.get(rd(t,e))}function rd(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Yr=new WeakMap,G0=new WeakMap,Y0=new WeakMap,r1=new WeakMap,K0=new WeakMap,X0=new WeakSet;class Hd extends Ts{static get DEFAULTS(){return Co({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,r){super(e,Ur(Hd.DEFAULTS,r)),Rte(this,X0),Cf(this,Yr,null),Cf(this,G0,[]),Cf(this,Y0,void 0),Cf(this,r1,void 0),Cf(this,K0,void 0),this.registerHooks()}getMenu(){return fr(Yr,this)}registerHooks(){this.addLocalHook("click",()=>rd(X0,this,Ate).call(this))}setItems(e){Ru(G0,this,this.translateNames(e)),fr(Yr,this)&&fr(Yr,this).setMenuItems(fr(G0,this))}translateNames(e){return J(e,r=>{r.name=this.translateIfPossible(r.name)}),e}build(){super.build(),Ru(Yr,this,new Rh(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),fr(Yr,this).setMenuItems(fr(G0,this));const e=new Ts(this.hot,{className:"htUISelectCaption"}),r=new Ts(this.hot,{className:"htUISelectDropdown"});Ru(Y0,this,e),Ru(r1,this,e.element),Ru(K0,this,r),this.hot.getSettings().ariaTags&&(Ze(r.element,[Wc()]),Ze(this._element,[sP()])),J([e,r],n=>this._element.appendChild(n.element)),fr(Yr,this).addLocalHook("select",n=>rd(X0,this,Tte).call(this,n)),fr(Yr,this).addLocalHook("afterClose",()=>rd(X0,this,_te).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=fr(Yr,this).hot.getTranslatedPhrase(Nv),fr(r1,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();fr(Yr,this)&&(fr(Yr,this).open(),fr(Yr,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),fr(Yr,this).getNavigator().toFirstItem(),fr(Yr,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:r=>{this.closeOptions(),this.runLocalHooks("tabKeydown",r)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){fr(Yr,this)&&fr(Yr,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){fr(Yr,this)&&(fr(Yr,this).destroy(),Ru(Yr,this,null)),fr(Y0,this)&&fr(Y0,this).destroy(),fr(K0,this)&&fr(K0,this).destroy(),super.destroy()}}function Tte(t){t.name!==ft&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function _te(){this.runLocalHooks("afterClose")}function Ate(){this.openOptions()}function Ite(t,e){Mte(t,e),e.add(t)}function Mte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LA(t,e,r){return(e=Ote(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ote(t){var e=Pte(t,"string");return typeof e=="symbol"?e:e+""}function Pte(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $A(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var n1=new WeakSet;class Jy extends Sg{constructor(e,r){super(e,{id:r.id,stateless:!1}),Ite(this,n1),LA(this,"name",""),LA(this,"addSeparator",!1),this.name=r.name,this.addSeparator=r.addSeparator,this.elements.push(new Hd(this.hot,{menuContainer:r.menuContainer})),this.elements.push(new tl(this.hot,{placeholder:Pb})),this.elements.push(new tl(this.hot,{placeholder:kb})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>$A(n1,this,kte).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),J(this.getInputElements(),e=>{e.addLocalHook("keydown",r=>$A(n1,this,Nte).call(this,r))})}setState(e){if(this.reset(),!e)return;const r=Co(e.command);r.name.startsWith(Sr)&&(r.name=this.hot.getTranslatedPhrase(r.name)),this.getSelectElement().setValue(r),J(e.args,(n,i)=>{if(i>r.inputsCount-1)return!1;const s=this.getInputElement(i);s.setValue(n),s[r.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||hc(nn),r=[];return J(this.getInputElements(),(n,i)=>{e.inputsCount>i&&r.push(n.getValue())}),{command:e,args:r}}updateState(e,r){const n=hc(e?e.name:nn);this.state.setValueAtIndex(r,{command:n,args:e?e.args:[]}),e||J(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Hd)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof tl)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,n,i,s,o)=>{_e(r.parentNode,"htFiltersMenuCondition"),this.addSeparator&&_e(r.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return _e(a,"htFiltersMenuLabel"),a.textContent=o,r.appendChild(a),r.parentElement.hasAttribute("ghost-table")||J(this.elements,l=>r.appendChild(l.element)),r}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let r=[hc(nn)];if(e!==null){const{visualIndex:n}=e;r=wte(this.hot.getDataType(0,n,this.hot.countRows(),n))}J(this.getInputElements(),n=>n.hide()),this.getSelectElement().setItems(r),super.reset(),this.getSelectElement().setValue(r[0])}}function kte(t){J(this.getInputElements(),(e,r)=>{e[t.inputsCount>r?"show":"hide"](),r===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function Nte(t){hg(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ks(t))}function BA(t,e,r){Fte(t,e),e.set(t,r)}function Fte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yf(t,e){return t.get(hN(t,e))}function VA(t,e,r){return t.set(hN(t,e),r),r}function hN(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Tu=new WeakMap,i1=new WeakMap;class Dp extends Ts{static get DEFAULTS(){return Co({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,r){super(e,Ur(Dp.DEFAULTS,r)),BA(this,Tu,void 0),BA(this,i1,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),VA(i1,this,e),VA(Tu,this,this._element.firstChild),yf(Tu,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(yf(i1,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?yf(Tu,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(yf(Tu,this).checked=e)}focus(){this.isBuilt()&&yf(Tu,this).focus()}}function Hte(t,e){Dte(t,e),e.add(t)}function Dte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lte(t,e,r){return(e=$te(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $te(t){var e=Bte(t,"string");return typeof e=="symbol"?e:e+""}function Bte(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vte(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const WA=0;var UA=new WeakSet;class Wte extends Sg{constructor(e,r){super(e,{id:r.id,stateless:!1}),Hte(this,UA),Lte(this,"name",""),this.name=r.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(_e(r.parentNode,"htFiltersMenuOperators"),J(this.elements,n=>r.appendChild(n.element)),r)}}buildOperatorsElement(){const e=[el,Hp];J(e,r=>{const n=new Dp(this.hot,{name:"operator",label:{htmlFor:r,textContent:cte(r)},value:r,checked:r===e[WA],id:r});n.addLocalHook("change",i=>Vte(UA,this,Ute).call(this,i)),this.elements.push(n)})}setChecked(e){if(this.elements.length<e)throw Error(Ht`Radio button with index ${e} doesn't exist.`);J(this.elements,(r,n)=>{r.setChecked(n===e)})}getActiveOperationId(){const e=this.elements.find(r=>r instanceof Dp&&r.isChecked());return e?e.getValue():el}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&J(this.elements,r=>{r.setChecked(r.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:el,r=arguments.length>1?arguments[1]:void 0,n=e;n===fE&&(n=Hp),this.state.setValueAtIndex(r,n)}reset(){this.setChecked(WA)}}function Ute(t){this.setState(t.target.value)}function jte(t,e,r){zte(t,e),e.set(t,r)}function zte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function s1(t,e){return t.get(fN(t,e))}function Gte(t,e,r){return t.set(fN(t,e),r),r}function fN(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var xf=new WeakMap;class Dd extends Ts{static get DEFAULTS(){return Co({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,r){super(e,Ur(Dd.DEFAULTS,r)),jte(this,xf,void 0)}build(){super.build(),Gte(xf,this,this._element.firstChild)}update(){this.isBuilt()&&(s1(xf,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&s1(xf,this).focus()}activate(){s1(xf,this).click()}}function Yte(t,e){dN(t,e),e.add(t)}function _u(t,e,r){dN(t,e),e.set(t,r)}function dN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function at(t,e){return t.get(Xu(t,e))}function cs(t,e,r){return t.set(Xu(t,e),r),r}function Xu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const jA="multipleSelect.itemBox";var ws=new WeakMap,kr=new WeakMap,o1=new WeakMap,Bo=new WeakMap,Ta=new WeakMap,_a=new WeakMap,Sf=new WeakSet;class Ld extends Ts{static get DEFAULTS(){return Co({className:"htUIMultipleSelect",value:[]})}constructor(e,r){super(e,Ur(Ld.DEFAULTS,r)),Yte(this,Sf),_u(this,ws,[]),_u(this,kr,void 0),_u(this,o1,void 0),_u(this,Bo,void 0),_u(this,Ta,void 0),_u(this,_a,void 0),cs(Bo,this,new tl(this.hot,{placeholder:Ob,className:"htUIMultipleSelectSearch"})),cs(Ta,this,new Dd(this.hot,{textContent:_b,className:"htUISelectAll"})),cs(_a,this,new Dd(this.hot,{textContent:Ab,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return at(kr,this)}registerHooks(){at(Bo,this).addLocalHook("keydown",e=>Xu(Sf,this,Xte).call(this,e)),at(Bo,this).addLocalHook("input",e=>Xu(Sf,this,Kte).call(this,e)),at(Ta,this).addLocalHook("click",e=>Xu(Sf,this,qte).call(this,e)),at(_a,this).addLocalHook("click",e=>Xu(Sf,this,Jte).call(this,e))}setItems(e){var r;cs(ws,this,e),(r=at(kr,this))===null||r===void 0||r.loadData(at(ws,this))}setLocale(e){cs(o1,this,e)}getLocale(){return at(o1,this)}getItems(){return[...at(ws,this)]}getValue(){return Qte(at(ws,this))}getSearchInputElement(){return at(Bo,this)}getSelectAllElement(){return at(Ta,this)}getClearAllElement(){return at(_a,this)}isSelectedAllValues(){return at(ws,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,r=e.createElement("div"),n=new Ts(this.hot,{className:"htUISelectionControls",children:[at(Ta,this),at(_a,this)]});this._element.appendChild(at(Bo,this).element),this._element.appendChild(n.element),this._element.appendChild(r);const i=s=>{var o;if(!this._element)return;(o=at(kr,this))===null||o===void 0||o.destroy(),_e(s,"htUIMultipleSelectHot"),cs(kr,this,new this.hot.constructor(s,{data:at(ws,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(c,u,h,f,d,g)=>{c.title=g.instance.getDataAtRowProp(u,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{at(kr,this).listen()},colWidths:()=>at(kr,this).container.scrollWidth-ln(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),at(kr,this).init();const l=at(kr,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:c=>{this.runLocalHooks("keydown",c,this)},group:jA}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:c=>{at(kr,this).deselectCell(),this.runLocalHooks("keydown",c,this),this.runLocalHooks("listTabKeydown",c,this)},group:jA})};i(r),this.hot._registerTimeout(()=>i(r),100)}focus(){this.isBuilt()&&at(kr,this).listen()}reset(){at(Bo,this).reset(),at(Ta,this).reset(),at(_a,this).reset()}update(){this.isBuilt()&&(at(kr,this).loadData(Zte(at(ws,this),this.options.value)),super.update())}destroy(){var e;(e=at(kr,this))===null||e===void 0||e.destroy(),at(Bo,this).destroy(),at(_a,this).destroy(),at(Ta,this).destroy(),cs(Bo,this,null),cs(_a,this,null),cs(Ta,this,null),cs(kr,this,null),cs(ws,this,null),super.destroy()}}function Kte(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let r;e===""?r=[...at(ws,this)]:r=at(ws,this).filter(n=>`${n.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),at(kr,this).loadData(r)}function Xte(t){this.runLocalHooks("keydown",t,this),xP(hg,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),ks(t),at(kr,this).listen(),at(kr,this).selectCell(0,0))}function qte(t){const e=[];t.preventDefault(),at(kr,this).getSourceData().forEach((r,n)=>{r.checked=!0,e.push(fk(r,n)[0])}),at(kr,this).setSourceDataAtCell(e)}function Jte(t){const e=[];t.preventDefault(),at(kr,this).getSourceData().forEach((r,n)=>{r.checked=!1,e.push(fk(r,n)[0])}),at(kr,this).setSourceDataAtCell(e)}function Zte(t,e){const r=bg(e);return t.map(n=>(n.checked=r(n.value),n))}function Qte(t){const e=[];return t.forEach(r=>{r.checked&&e.push(r.value)}),e}function ere(t,e){tre(t,e),e.add(t)}function tre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rre(t,e,r){return(e=nre(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nre(t){var e=ire(t,"string");return typeof e=="symbol"?e:e+""}function ire(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function q0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var bf=new WeakSet;class sre extends Sg{constructor(e,r){super(e,{id:r.id,stateless:!1}),ere(this,bf),rre(this,"name",""),this.name=r.name,this.elements.push(new Ld(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>q0(bf,this,ore).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,r)=>q0(bf,this,are).call(this,e,r))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===fc){const r=this.getMultipleSelectElement();r.setItems(e.itemsSnapshot),r.setValue(e.args[0]),r.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),r=e.getItems();return{command:{key:e.isSelectedAllValues()||!r.length?nn:fc},args:[e.getValue()],itemsSnapshot:r}}updateState(e){const r=(n,i,s,o,a)=>{const[l]=rl(i,h=>h.name===fc),c={},u=this.hot.getTranslatedPhrase(bp);if(l){const h=o(n,a),f=bt(h,S=>S.value),d=new Map(h.map(S=>[S.value,this.hot.getCellMeta(S.meta.visualRow,S.meta.visualCol)])),g=qy(f);s&&(l.args[0]=s);const m=[],p=NA(g,l.args[0],u,S=>{S.checked&&m.push(S.value),q0(bf,this,zA).call(this,S,d)}),y=e.editedConditionStack.column;c.locale=this.hot.getCellMeta(0,y).locale,c.args=[m],c.command=hc(fc),c.itemsSnapshot=p}else c.args=[],c.command=hc(nn);this.state.setValueAtIndex(n,c)};r(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&r(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Ld)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,n,i,s,o)=>{_e(r.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return _e(a,"htFiltersMenuLabel"),a.textContent=o,r.appendChild(a),r.parentElement.hasAttribute("ghost-table")||J(this.elements,l=>r.appendChild(l.element)),r}}}reset(){const e=this.hot.getTranslatedPhrase(bp),r=this._getColumnVisibleValues(),n=r.map(l=>l.value),i=new Map(r.map(l=>[l.value,l.meta])),s=qy(n),o=NA(s,s,e,l=>{q0(bf,this,zA).call(this,l,i)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(s);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:bt(this.hot.getDataAtCol(e.visualIndex),(r,n)=>({value:oN(r),meta:this.hot.getCellMeta(n,e.visualIndex)}))}}function ore(t){hg(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ks(t))}function zA(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function are(t,e){switch(e.type){case"numeric":return o2(t,e);default:return t}}var gN;function lre(t,e){cre(t,e),e.add(t)}function cre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ure(t,e,r){return(e=hre(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hre(t){var e=fre(t,"string");return typeof e=="symbol"?e:e+""}function fre(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dre(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var GA=new WeakSet;class $d extends Sg{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,r){super(e,{id:r.id,stateless:!0}),lre(this,GA),ure(this,"name",""),this.name=r.name,this.elements.push(new tl(this.hot,{type:"button",value:Ib,className:"htUIButton htUIButtonOK",identifier:$d.BUTTON_OK})),this.elements.push(new tl(this.hot,{type:"button",value:Mb,className:"htUIButton htUIButtonCancel",identifier:$d.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){J(this.elements,e=>{e.addLocalHook("click",(r,n)=>dre(GA,this,gre).call(this,r,n))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(_e(r.parentNode,"htFiltersMenuActionBar"),J(this.elements,n=>r.appendChild(n.element)),r)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}gN=$d;function gre(t,e){e.options.identifier===gN.BUTTON_OK?this.accept():this.cancel()}function J0(t,e,r){return(e=mre(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mre(t){var e=pre(t,"string");return typeof e=="symbol"?e:e+""}function pre(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const YA="ConditionCollection.filteringStates";class gE{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;J0(this,"hot",void 0),J0(this,"isMapRegistrable",void 0),J0(this,"filteringStates",new kv),J0(this,"previousConditionStack",null),this.hot=e,this.isMapRegistrable=r,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(YA,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,r){var n;const i=this.filteringStates.getValueAtIndex(r),s=(n=i==null?void 0:i.conditions)!==null&&n!==void 0?n:[],o=i==null?void 0:i.operation;return this.isMatchInConditions(s,e,o)}isMatchInConditions(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:el;return e.length?lte(n)(e,r):!0}addCondition(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:el,i=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,o=bt(r.args,u=>typeof u=="string"?u.toLocaleLowerCase(s):u),a=r.name||r.command.key;this.previousConditionStack===null&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==n)throw Error(Ht`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(tr(Fd[n]))throw new Error(Ht`Unexpected operation named \`${n}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const c=this.getConditions(e);c.length===0?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:a,args:o,func:nl(a,o)}]},i):c.push({name:a,args:o,func:nl(a,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var r,n;return(r=(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.conditions)!==null&&r!==void 0?r:[]}getOperation(e){var r;return(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[r]=e;return r})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Gn(this.filteringStates.getEntries(),(e,r)=>{let[n,{operation:i,conditions:s}]=r;return e.push({column:n,operation:i,conditions:bt(s,o=>{let{name:a,args:l}=o;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),J(e,r=>{J(r.conditions,n=>this.addCondition(r.column,n))})}removeConditions(e){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,r){const n=this.getConditions(e);return r?n.some(i=>i.name===r):n.length>0}setPreviousConditionStack(e){this.previousConditionStack=e}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(YA),this.filteringStates=null,this.clearLocalHooks()}}jt(gE,vn);function KA(t,e,r){return(e=vre(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vre(t){var e=wre(t,"string");return typeof e=="symbol"?e:e+""}function wre(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mN{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];KA(this,"conditionCollection",void 0),KA(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=r}filter(){let e=[];return J(this.conditionCollection.getFilteredColumns(),(r,n)=>{let i=this.columnDataFactory(r);n&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(r,i)}),e}filterByColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];return J(r,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&n.push(i)}),n}_getIntersectData(e,r){const n=[];return J(r,i=>{const s=i.meta.visualRow;e[s]!==void 0&&(n[s]=e[s])}),n}}function Cre(t,e){yre(t,e),e.add(t)}function yre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vl(t,e,r){return(e=xre(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xre(t){var e=Sre(t,"string");return typeof e=="symbol"?e:e+""}function Sre(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function a1(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Z0=new WeakSet;class pN{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];Cre(this,Z0),Vl(this,"hot",void 0),Vl(this,"conditionCollection",void 0),Vl(this,"columnDataFactory",void 0),Vl(this,"changes",[]),Vl(this,"grouping",!1),Vl(this,"latestEditedColumnPosition",-1),Vl(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=r,this.columnDataFactory=n,this.conditionCollection.addLocalHook("beforeRemove",i=>a1(Z0,this,bre).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>a1(Z0,this,Ere).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>a1(Z0,this,Rre).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,J(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,r){var n=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const o=i.slice(0,s),a=i.slice(s);a.length&&a[0].column===e&&a.shift();const l=W8(function(u,h){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const d=new gE(n.hot,!1),g=[].concat(u,f);d.importAllConditions(g);const m=n.columnDataFactory(h);let p;d.isEmpty()?p=m:p=new mN(d,S=>n.columnDataFactory(S)).filter(),p=bt(p,S=>S.meta.visualRow);const y=bg(p);return d.destroy(),rl(m,S=>y(S.meta.visualRow))})(o),c=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:c},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:r})}destroy(){this.clearLocalHooks(),gt(this,(e,r)=>{this[r]=null})}}function bre(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function Ere(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Rre(){J(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}jt(pN,vn);function Tre(t){return D2({initialPage:0,size:()=>t.length,onItemSelect:(r,n)=>{const i=t[r];if(i instanceof Ld)return n;if(i.element&&!ah(i.element))return!1;i.focus()}})}const Ef="filters";function _re(t,e){let r=-1;const n=Tre(e),i=l=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(Ef),n.setCurrentPage(e.indexOf(l))};e.forEach(l=>{l instanceof Ts&&(l.addLocalHook("click",i(l)),l.addLocalHook("focus",i(l)),l.addLocalHook("afterClose",i(l)))}),t.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||n.clear()});function s(l){const c=t.getKeyboardShortcutsCtrl(),u=l.getKeyboardShortcutsCtrl();n.clear(),u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:c.getContext(Ef),callback:()=>{l.isSubMenu()&&l.close(),c.listen(Ef)}}]),!l.isSubMenu()&&c.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:h=>{const f=t.getNavigator();f.getCurrentPage()>-1&&(r=f.getCurrentPage()),f.clear(),h.shiftKey?n.toPreviousItem():n.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:h=>{const f=e[n.getCurrentPage()];f instanceof Hd&&(f.openOptions(),h.preventDefault()),f instanceof Dd&&(f.activate(),h.preventDefault()),f instanceof Ts||h.preventDefault()}}],Ef)}t.addLocalHook("afterSubmenuOpen",s),t.addLocalHook("afterOpen",s);function o(){t.focus(),t.getKeyboardShortcutsCtrl().listen(Ef)}function a(){return r}return{...n,listen:o,getLastMenuPage:a}}function Are(t,e){vN(t,e),e.add(t)}function Ire(t,e,r){vN(t,e),e.set(t,r)}function vN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rf(t,e,r){return(e=Mre(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mre(t){var e=Ore(t,"string");return typeof e=="symbol"?e:e+""}function Ore(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pre(t,e,r){return t.set(pi(t,e),r),r}function Tf(t,e){return t.get(pi(t,e))}function pi(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Zy="filters",kre=250,XA=Zy;var Wl=new WeakMap,Ni=new WeakSet;class Nre extends kt{static get PLUGIN_KEY(){return Zy}static get PLUGIN_PRIORITY(){return kre}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),Are(this,Ni),Rf(this,"dropdownMenuPlugin",null),Rf(this,"conditionCollection",null),Rf(this,"conditionUpdateObserver",null),Rf(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Rf(this,"filtersRowsMap",null),Ire(this,Wl,void 0),this.hot.addHook("afterGetColHeader",(r,n)=>pi(Ni,this,Bre).call(this,r,n))}isEnabled(){return!!this.hot.getSettings()[Zy]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new mg),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,r=e&&e.uiContainer||this.hot.rootDocument.body,n=o=>(o.addLocalHook("accept",()=>pi(Ni,this,qA).call(this,"accept")),o.addLocalHook("cancel",()=>pi(Ni,this,qA).call(this,"cancel")),o.addLocalHook("change",a=>pi(Ni,this,$re).call(this,o,a)),o),i=()=>`${this.hot.getTranslatedPhrase(Eb)}:`,s=()=>`${this.hot.getTranslatedPhrase(Rb)}:`;if(!this.components.get("filter_by_condition")){const o=new Jy(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:r});o.addLocalHook("afterClose",()=>pi(Ni,this,JA).call(this)),this.components.set("filter_by_condition",n(o))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Wte(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const o=new Jy(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});o.addLocalHook("afterClose",()=>pi(Ni,this,JA).call(this)),this.components.set("filter_by_condition2",n(o))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",n(new sre(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",n(new $d(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new gE(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new pN(this.hot,this.conditionCollection,o=>this.getDataMapAtColumn(o)),this.conditionUpdateObserver.addLocalHook("update",o=>pi(Ni,this,Vre).call(this,o))),this.components.forEach(o=>o.show()),this.addHook("afterDropdownMenuDefaultOptions",o=>pi(Ni,this,Lre).call(this,o)),this.addHook("afterDropdownMenuShow",()=>pi(Ni,this,Hre).call(this)),this.addHook("afterDropdownMenuHide",()=>pi(Ni,this,Dre).call(this)),this.addHook("afterChange",o=>pi(Ni,this,Fre).call(this,o)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Tf(Wl,this)&&this.dropdownMenuPlugin.enabled){const o=this.dropdownMenuPlugin.menu,a=[{focus:()=>{const c=o.getNavigator(),u=Tf(Wl,this).getLastMenuPage();o.focus(),u>0?c.setCurrentPage(u):c.toFirstItem()}},...Array.from(this.components).map(c=>{let[,u]=c;return u.getElements()}).flat()];Pre(Wl,this,_re(o,a));const l=c=>{Tf(Wl,this).listen(),c.preventDefault(),hg(c.keyCode,"TAB")&&(c.shiftKey?Tf(Wl,this).toPreviousItem():Tf(Wl,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((r,n)=>{r.destroy(),this.components.set(n,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:XA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(XA)}addCondition(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:el;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:r},args:n},i)}removeConditions(e){const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),r=this._createDataFilter(),n=!this.conditionCollection.isEmpty();let i=[];const s=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",s,this.conditionCollection.previousConditionStack)!==!1)if(n){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=bt(r.filter(),c=>c.meta.visualRow);const l=bg(i);Ge(this.hot.countSourceRows()-1,c=>{l(c)||a.push(c)}),J(a,c=>{this.filtersRowsMap.setValueAtIndex(c,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r?{visualIndex:r.col,physicalIndex:this.hot.toPhysicalColumn(r.col)}:null}getDataMapAtColumn(e){const r=this.hot.toVisualColumn(e),n=[];return J(this.hot.getSourceDataAtCol(r),(i,s)=>{var o;const{row:a,col:l,visualCol:c,visualRow:u,type:h,instance:f,dateFormat:d,locale:g}=this.hot.getCellMeta(s,r),m=(o=this.hot.getDataAtCell(this.hot.toVisualRow(s),r))!==null&&o!==void 0?o:i;n.push({meta:{row:a,col:l,visualCol:c,visualRow:u,type:h,instance:f,dateFormat:d,locale:g},value:oN(m)})}),n}updateValueComponentCondition(e){const r=this.hot.getDataAtCol(e),n=qy(r);this.conditionUpdateObserver.updateStatesAtColumn(e,n)}restoreComponents(e){var r;const n=(r=this.getSelectedColumn())===null||r===void 0?void 0:r.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(n)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,r,n,i){let s=e;return s===Hp&&r.command.key!==nn&&n.command.key!==nn&&i.command.key!==nn?s=fE:i.command.key!==nn&&(r.command.key===nn||n.command.key===nn)&&(s=el),s}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:r}=e.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];r.showOperators?this.showComponents(...n):this.hideComponents(...n)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new mN(e,r=>this.getDataMapAtColumn(r))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const r=this.dropdownMenuPlugin.menu;for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return J(i,o=>{J(r.menuItems,(a,l)=>{a.key===o.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const n=this.dropdownMenuPlugin.menu.hotMenu,i=n.getPlugin("hiddenRows");for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];const l=this.getIndexesOfComponents(...o);e?i.showRows(l):i.hideRows(l),n.render()}hideComponents(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.changeComponentsVisibility(!1,...r)}showComponents(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.changeComponentsVisibility(!0,...r)}destroy(){this.enabled&&(this.components.forEach((e,r)=>{e!==null&&(e.destroy(),this.components.set(r,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Fre(t){t&&J(t,e=>{const[,r]=e,n=this.hot.propToCol(r);this.conditionCollection.hasConditions(n)&&this.updateValueComponentCondition(n)})}function Hre(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function Dre(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Lre(t){t.items.push({name:ft}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function qA(t){var e;if(t==="accept"){const n=this.getSelectedColumn();if(n===null){var r;(r=this.dropdownMenuPlugin)===null||r===void 0||r.close();return}const{physicalIndex:i}=n,s=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,o,a);this.conditionUpdateObserver.groupChanges();let c=this.conditionCollection.getColumnStackPosition(i);c===-1&&(c=void 0),this.conditionCollection.removeConditions(i),s.command.key!==nn&&(this.conditionCollection.addCondition(i,s,l,c),o.command.key!==nn&&this.conditionCollection.addCondition(i,o,l,c)),a.command.key!==nn&&this.conditionCollection.addCondition(i,a,l,c),this.conditionUpdateObserver.flush(),this.components.forEach(u=>u.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function $re(t,e){this.updateDependentComponentsVisibility(),t.constructor===Jy&&!e.inputsCount&&this.setListeningDropdownMenu()}function JA(){this.setListeningDropdownMenu()}function Bre(t,e){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)?_e(e,"htFiltersActive"):it(e,"htFiltersActive")}function Vre(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:r,column:n}}=t,i=r.filter(o=>o.name===fc),s=r.filter(o=>o.name!==fc);if(i.length>=2||s.length>=3)Ft(Ht`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const o=this.conditionCollection.getOperation(n);this.components.get("filter_by_condition").updateState(s[0],n),this.components.get("filter_by_condition2").updateState(s[1],n),this.components.get("filter_operators").updateState(o,n),this.components.get("filter_by_value").updateState(t)}}const wN="internal-use-in-handsontable",Qy={licenseKey:wN,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function CN(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Tn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function yN(t){return Object.keys(t).reduce((e,r)=>(r!=="hyperformula"&&(e[r]=t[r]),e),{})}function Wre(t){var e;const r=t[Tn],n=yN(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=CN(t);return{...Qy,...n,...i}}function Ure(t){var e;const r=t[Tn],n=yN(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=CN(t);return{...n,...i}}function jre(t,e){return Object.keys(e).some(r=>e[r]!==void 0&&e[r]!==t[r])}function Qv(){const t="engine_relationship",e=Ns(Tn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function mE(){const t="shared_engine_usage",e=Ns(Tn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function zre(t){const e=t.getSettings(),r=e[Tn],n=r==null?void 0:r.engine;if(r===!0||tr(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var i;return Gre((i=n.hyperformula)!==null&&i!==void 0?i:n,e,t)}else if(typeof n=="object"&&tr(n.hyperformula)){const s=Qv(),o=mE().get(n);return s.has(n)||s.set(n,[]),s.get(n).push(t),o&&o.push(t.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:wN}),(n.getConfig().leapYear1900!==Qy.leapYear1900||Ux(n.getConfig().nullDate,Qy.nullDate)===!1)&&Ft(Ht`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),n}return null}function Gre(t,e,r){const n=e[Tn],i=Wre(e),s=Qv(),o=mE();Yre(t,n.functions),Kre(t,n.language);const a=t.buildEmpty(i);return s.set(a,[r]),o.set(a,[r.guid]),Xre(a,n.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function ZA(t){var e;const r=Qv(),n=r.size===0?[]:Array.from((e=r.get(t))!==null&&e!==void 0?e:[]);return new Map(n.map(i=>[i.getPlugin("formulas").sheetId,i]))}function QA(t,e){if(t){const r=Qv(),n=r.get(t),i=mE(),s=i.get(t);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),n.length===0&&r.delete(t)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(i.delete(t),t.destroy()))}}function Yre(t,e){e&&e.forEach(r=>{const{name:n,plugin:i,translations:s}=r;try{t.registerFunction(n,i,s)}catch(o){Ft(o.message)}})}function Kre(t,e){if(e){const{langCode:r}=e;try{t.registerLanguage(r,e)}catch(n){Ft(n.message)}}}function Xre(t,e){e&&(t.suspendEvaluation(),e.forEach(r=>{const{name:n,expression:i,scope:s,options:o}=r;try{t.addNamedExpression(n,i,s,o)}catch(a){Ft(a.message)}}),t.resumeEvaluation())}function qre(t,e){return(tr(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const xN="DD/MM/YYYY";function SN(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Jre(t){return SN(t)?t.substr(1):t}function Zre(t){return typeof t=="string"&&t.startsWith("=")}function pE(t,e){return typeof t=="string"&&e==="date"}function bN(t,e){return At(t,e,!0).isValid()}function EN(t,e){return At(t,e,!0).format(xN)}function Qre(t,e){return At(t,xN,!0).format(e)}function RN(t,e){const n=new Date(Date.UTC(0,0,t+-1));return At(n).format(e)}function ene(t,e,r){const n=Array.from(Array(r).keys()).filter(s=>t.includes(s)===!1);if(e===0){var i;return(i=n[e])!==null&&i!==void 0?i:0}return n[e-1]+1}function tne(t,e){const r=[];return t.forEach(n=>{const i={from:n,to:e};r.forEach(s=>{const o=s.from>s.to,a=s.to<=i.from;s.from>i.from&&a&&o&&(i.from+=1)}),i.from>=e&&(e+=1),r.push(i)}),r}function rne(t){return t.forEach((e,r)=>{t.slice(r+1).forEach(i=>{const s=i.from<i.to;i.from>e.from&&s&&(i.from-=1)})}),t}function vE(t,e,r){const n=tne(t,ene(t,e,r));return rne(n)}function Ul(t,e,r){nne(t,e),e.set(t,r)}function nne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sr(t,e){return t.get(TN(t,e))}function Aa(t,e,r){return t.set(TN(t,e),r),r}function TN(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _f=new WeakMap,Ia=new WeakMap,fi=new WeakMap,Q0=new WeakMap,l1=new WeakMap,c1=new WeakMap,em=new WeakMap;class eI{constructor(e,r,n){Ul(this,_f,void 0),Ul(this,Ia,void 0),Ul(this,fi,void 0),Ul(this,Q0,[]),Ul(this,l1,[]),Ul(this,c1,void 0),Ul(this,em,[]),Aa(_f,this,e),Aa(Ia,this,r),Aa(fi,this,n)}setRemovedHfIndexes(e){return Aa(em,this,e.map(r=>{const n=sr(Ia,this).getVisualFromPhysicalIndex(r);return this.getHfIndexFromVisualIndex(n)})),sr(em,this)}getRemovedHfIndexes(){return sr(em,this)}getHfIndexFromVisualIndex(e){const r=sr(Ia,this).getIndexesSequence(),n=sr(Ia,this).getNotTrimmedIndexes();return r.indexOf(n[e])}syncMoves(e){const n=`move${Is(sr(_f,this))}s`;sr(fi,this).getEngine().batch(()=>{e.forEach(i=>{const s=i.from!==i.to,o=i.from+1!==i.to;s&&o&&sr(fi,this).getEngine()[n](sr(fi,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,r,n){n!==!1&&(Aa(l1,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),Aa(c1,this,this.getHfIndexFromVisualIndex(r)))}calculateAndSyncMoves(e,r){if(sr(fi,this).isPerformingUndoRedo()||e===!1||r===!1)return;const n=vE(sr(l1,this),sr(c1,this),sr(Ia,this).getNumberOfIndexes());sr(fi,this).getSheetId()===null?sr(fi,this).getPostponeAction(()=>this.syncMoves(n)):this.syncMoves(n)}getIndexesChangeSyncMethod(){const e=`set${Is(sr(_f,this))}Order`;return r=>{if(sr(fi,this).isPerformingUndoRedo())return;const n=sr(Ia,this).getIndexesSequence();if(r==="update"&&n.length>0){const i=sr(Q0,this).map(l=>n.indexOf(l)),s=sr(fi,this).getEngine().getSheetDimensions(sr(fi,this).getSheetId());let o;sr(_f,this)==="row"?o=s.height:o=s.width;const a=i.length;for(let l=a;l<o;l+=1)i.push(l);sr(fi,this).getEngine()[e](sr(fi,this).getSheetId(),i)}Aa(Q0,this,n)}}init(){Aa(Q0,this,sr(Ia,this).getIndexesSequence())}}function jl(t,e,r){ine(t,e),e.set(t,r)}function ine(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vo(t,e){return t.get(_N(t,e))}function zl(t,e,r){return t.set(_N(t,e),r),r}function _N(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var tm=new WeakMap,rm=new WeakMap,u1=new WeakMap,h1=new WeakMap,f1=new WeakMap,d1=new WeakMap,g1=new WeakMap;class sne{constructor(e,r,n){jl(this,tm,void 0),jl(this,rm,void 0),jl(this,u1,void 0),jl(this,h1,!1),jl(this,f1,!1),jl(this,d1,null),jl(this,g1,null),zl(tm,this,new eI("row",e,this)),zl(rm,this,new eI("column",r,this)),zl(u1,this,n)}getForAxis(e){return e==="row"?Vo(tm,this):Vo(rm,this)}setPerformUndo(e){zl(h1,this,e)}setPerformRedo(e){zl(f1,this,e)}isPerformingUndoRedo(){return Vo(h1,this)||Vo(f1,this)}getSheetId(){return Vo(g1,this)}getEngine(){return Vo(d1,this)}getPostponeAction(){return Vo(u1,this)}setupSyncEndpoint(e,r){zl(d1,this,e),zl(g1,this,r),Vo(tm,this).init(),Vo(rm,this).init()}}function one(t,e){AN(t,e),e.add(t)}function Au(t,e,r){return(e=ane(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ane(t){var e=lne(t,"string");return typeof e=="symbol"?e:e+""}function lne(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function m1(t,e,r){AN(t,e),e.set(t,r)}function AN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function il(t,e,r){return t.set(Lt(t,e),r),r}function Qu(t,e){return t.get(Lt(t,e))}function Lt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Tn="formulas",cne=["maxRows","maxColumns","language"],une=260;We.getSingleton().register("afterNamedExpressionAdded");We.getSingleton().register("afterNamedExpressionRemoved");We.getSingleton().register("afterSheetAdded");We.getSingleton().register("afterSheetRemoved");We.getSingleton().register("afterSheetRenamed");We.getSingleton().register("afterFormulasValuesUpdate");const Th=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var aa=new WeakMap,wE=new WeakMap,Af=new WeakMap,Gt=new WeakSet;class hne extends kt{constructor(){var e;super(...arguments),e=this,one(this,Gt),m1(this,aa,!1),m1(this,wE,!1),m1(this,Af,[["valuesUpdated",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Lt(Gt,e,_ne).call(e,...n)}],["namedExpressionAdded",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Lt(Gt,e,Ane).call(e,...n)}],["namedExpressionRemoved",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Lt(Gt,e,Ine).call(e,...n)}],["sheetAdded",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Lt(Gt,e,Mne).call(e,...n)}],["sheetRenamed",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Lt(Gt,e,One).call(e,...n)}],["sheetRemoved",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Lt(Gt,e,Pne).call(e,...n)}]]),Au(this,"staticRegister",Ns("formulas")),Au(this,"engine",null),Au(this,"sheetName",null),Au(this,"indexSyncer",null),Au(this,"rowAxisSyncer",null),Au(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Tn}static get PLUGIN_PRIORITY(){return une}static get SETTING_KEYS(){return[Tn,...cne]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Tn]}enablePlugin(){var e,r=this;if(!this.enabled){if(this.engine=(e=zre(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Ft("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const n=this.addSheet(this.sheetName,this.hot.getSourceDataArray());n!==!1&&(this.sheetName=n)}this.addHook("beforeLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,tI).call(r,...i)}),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,rI).call(r,...i)}),this.addHook("beforeUpdateData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,tI).call(r,...i)}),this.addHook("afterUpdateData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,rI).call(r,...i)}),this.addHook("modifyData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,mne).call(r,...i)}),this.addHook("modifySourceData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,pne).call(r,...i)}),this.addHook("beforeValidate",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,fne).call(r,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,vne).call(r,...i)}),this.addHook("afterSetDataAtCell",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,nI).call(r,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,nI).call(r,...i)}),this.addHook("beforeCreateRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,wne).call(r,...i)}),this.addHook("beforeCreateCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,Cne).call(r,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,Sne).call(r,...i)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,bne).call(r,...i)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,yne).call(r,...i)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,xne).call(r,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,Ene).call(r,...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,Rne).call(r,...i)}),this.indexSyncer=new sne(this.hot.rowIndexMapper,this.hot.columnIndexMapper,n=>{this.hot.addHookOnce("init",()=>{n()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(n,i,s,o)=>{this.rowAxisSyncer.storeMovesInformation(n,i,o)}),this.hot.addHook("beforeColumnMove",(n,i,s,o)=>{this.columnAxisSyncer.storeMovesInformation(n,i,o)}),this.hot.addHook("afterRowMove",(n,i,s,o,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("afterColumnMove",(n,i,s,o,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("beforeColumnFreeze",(n,i)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(n,i)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,gne).call(r,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,Tne).call(r,...i)}),this.addHook("beforeAutofill",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Lt(Gt,r,dne).call(r,...i)}),Qu(Af,this).forEach(n=>{let[i,s]=n;return this.engine.on(i,s)}),super.enablePlugin()}}disablePlugin(){Qu(Af,this).forEach(e=>{let[r,n]=e;return this.engine.off(r,n)}),QA(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const r=Ure(this.hot.getSettings());jre(this.engine.getConfig(),r)&&this.engine.updateConfig(r);const n=this.hot.getSettings()[Tn];if(Ue(n)&&Ue(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Tn].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Qu(Af,this).forEach(e=>{var r;let[n,i]=e;return(r=this.engine)===null||r===void 0?void 0:r.off(n,i)}),il(Af,this,null),QA(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,r){if(Ue(r)&&!r7(r))return Ft("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Ft("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(e??void 0);return r&&this.engine.setSheetContent(this.engine.getSheetId(n),r),n}catch(n){return Ft(n.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){Kx(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const r=this.engine.getSheetSerialized(this.sheetId);r.length>0&&this.hot.loadData(r,`${Is(Tn)}.switchSheet`)}getCellType(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(r);return i!==null&&s!==null?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)}):"EMPTY"}isFormulaCellType(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)})}renderDependentSheets(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=new Set;e.forEach(i=>{var s;const o=i==null||(s=i.address)===null||s===void 0?void 0:s.sheet;o!==void 0&&(n.has(o)||n.add(o))}),ZA(this.engine).forEach((i,s)=>{if((r||s!==this.sheetId)&&n.has(s)){var o;i.render(),(o=i.view)===null||o===void 0||o.adjustElementsSize()}})}validateDependentCells(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=s=>{var o;const{row:a,col:l,sheet:c}=(o=s==null?void 0:s.address)!==null&&o!==void 0?o:{};return Ue(c)?`${c}:${a}x${l}`:""},i=new Set(r.map(s=>n(s)));e.forEach(s=>{var o,a;const{row:l,col:c}=(o=s.address)!==null&&o!==void 0?o:{};if(Ue(l)===!1||Ue(c)===!1||l>=this.hot.countRows()||c>=this.hot.countCols())return;const u=s==null||(a=s.address)===null||a===void 0?void 0:a.sheet,h=n(s);if(u!==void 0&&!i.has(h)){const f=ZA(this.engine).get(u);if(!f)return;f.validateCell(f.getDataAtCell(l,c),f.getCellMeta(l,c),()=>{})}})}syncChangeWithEngine(e,r,n){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){Ft(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const s=this.hot.getCellMeta(e,r);return pE(n,s.type)&&(bN(n,s.dateFormat)?n=EN(n,s.dateFormat):Zre(n)===!1&&(n=`'${n}`)),this.engine.setCellContents(i,n)}}function fne(t,e,r){const n=this.hot.propToCol(r);if(this.isFormulaCellType(e,n)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},s=this.hot.getCellMeta(e,n);let o=this.engine.getCellValue(i);return s.type==="date"&&Wn(o)&&(o=RN(o,s.dateFormat)),typeof o=="object"&&o!==null?o.value:o}return t}function dne(t,e,r){const{row:n,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),{row:a,col:l}=r.getTopStartCorner(),{row:c,col:u}=r.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId}},f={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(f)===!1)return!1;const d=this.engine.getFillRangeData(h,f),{row:g,col:m}=h.start,{row:p,col:y}=h.end,S=p-g+1,C=y-m+1;for(let A=0;A<d.length;A+=1)for(let I=0;I<d[A].length;I+=1){const O=d[A][I],_=g+A%S,E=m+I%C,b=this.hot.getCellMeta(_,E);pE(O,b.type)&&(O.startsWith("'")?d[A][I]=O.slice(1):this.isFormulaCellType(_,E,this.sheetId)===!1&&(d[A][I]=Qre(O,b.dateFormat)))}return d}function tI(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Is(Tn))||il(wE,this,tr(this.hot.getSettings().data))}function gne(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((r,n)=>{r.forEach((i,s)=>{const o=this.hot.getCellMeta(n,s),a=o.dateFormat;pE(i,o.type)&&(e=!0,bN(i,a)?t[n][s]=EN(i,a):this.isFormulaCellType(n,s)===!1&&(t[n][s]=`'${i}`))})}),e===!0&&(il(aa,this,!0),this.engine.setSheetContent(this.sheetId,t),il(aa,this,!1))}function rI(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Is(Tn)))if(this.sheetName=qre(this.engine,this.hot.getSettings()[Tn].sheetName),Qu(wE,this))this.switchSheet(this.sheetName);else{const n=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,n)){il(aa,this,!0);const i=this.engine.setSheetContent(this.sheetId,n);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),il(aa,this,!1)}}}function mne(t,e,r,n){if(n!=="get"||Qu(aa,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){SN(r.value)&&(r.value=Jre(r.value));return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(o),l=this.hot.getCellsMeta().find(u=>u.visualRow===i&&u.visualCol===e);l===void 0&&(l={}),l.type==="date"&&Wn(a)&&(a=RN(a,l.dateFormat));const c=typeof a=="object"&&a!==null?a.value:a;r.value=c}function pne(t,e,r,n){if(n!=="get"||Qu(aa,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),s=this.hot.propToCol(e);if(i===null||s===null||!this.isFormulaCellType(i,s)&&this.getCellType(i,s)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};r.value=this.engine.getCellSerialized(l)}function nI(t,e){if(Th(e))return;const r=[],n=[],i=this.engine.batch(()=>{t.forEach(s=>{let[o,a,,l]=s;const c=this.hot.propToCol(a),u=this.hot.toPhysicalRow(o),h=this.hot.toPhysicalColumn(c),f={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId};u!==null&&h!==null?this.syncChangeWithEngine(o,c,l):r.push([o,c,l]),n.push({address:f})})});r.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{r.forEach(o=>{let[a,l,c]=o;this.syncChangeWithEngine(a,l,c)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,n)}function vne(t,e){if(Th(e))return;const r=[],n=[];t.forEach(i=>{let[s,o,,a]=i;const l=this.hot.propToCol(o);if(!Wn(l))return;const c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(c)){Ft(`Not possible to set source cell data at ${JSON.stringify(c)}`);return}n.push({address:c}),r.push(...this.engine.setCellContents(c,a))}),this.renderDependentSheets(r),this.validateDependentCells(r,n)}function wne(t,e){let r=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[r,e]))return!1}function Cne(t,e){let r=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[r,e]))return!1}function yne(t,e,r){return this.rowAxisSyncer.setRemovedHfIndexes(r).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}function xne(t,e,r){return this.columnAxisSyncer.setRemovedHfIndexes(r).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}function Sne(t,e,r){if(Th(r))return;const n=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function bne(t,e,r){if(Th(r))return;const n=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function Ene(t,e,r,n){if(Th(n))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeRows(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function Rne(t,e,r,n){if(Th(n))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeColumns(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function Tne(t,e,r){var n;il(aa,this,!0);const i=this.hot.getSourceDataArray(r,0,r+(((n=e.__children)===null||n===void 0?void 0:n.length)||0),this.hot.countSourceCols());il(aa,this,!1),i.forEach((s,o)=>{s.forEach((a,l)=>{this.engine.setCellContents({col:l,row:r+o,sheet:this.sheetId},[[a]])})})}function _ne(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function Ane(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function Ine(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function Mne(t){this.hot.runHooks("afterSheetAdded",t)}function One(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function Pne(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function kne(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[,n,,i]=e;n-i!==0&&(r=1)}return this.getTranslatedPhrase(tb,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.col,r.col),0),i=Math.max(e.col,r.col),s=[];for(let l=n;l<=i;l+=1)s.push(l);t.hideColumns(s);const o=s[s.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Nne(t){const e=[];return{key:"hidden_columns_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(rb,r)},callback(){var r,n;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(r=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&r!==void 0?r:0,s=(n=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&n!==void 0?n:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countCols()||this.selectColumns(i,s)},disabled:!1,hidden(){const r=bt(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().col,s=n.getBottomEndCorner().col,o=this.columnIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),c=o.getNotTrimmedIndexes(),u=[];if(i!==s){const h=s-i+1,f=l-a+1;if(h>f){const d=c.slice(i,s+1);u.push(...d.filter(g=>r.includes(g)))}}else if(a===0&&a<i)u.push(...c.slice(0,i));else if(a===null)u.push(...c.slice(0,this.countCols()));else{const h=this.countCols()-1,f=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===f&&h>s&&u.push(...c.slice(s+1))}return J(u,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function Fne(t,e){IN(t,e),e.add(t)}function iI(t,e,r){IN(t,e),e.set(t,r)}function IN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Si(t,e){return t.get(Ha(t,e))}function If(t,e,r){return t.set(Ha(t,e),r),r}function Ha(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}We.getSingleton().register("beforeHideColumns");We.getSingleton().register("afterHideColumns");We.getSingleton().register("beforeUnhideColumns");We.getSingleton().register("afterUnhideColumns");const p1="hiddenColumns",Hne=310;var mo=new WeakMap,zs=new WeakMap,Gl=new WeakSet;class Dne extends kt{constructor(){super(...arguments),Fne(this,Gl),iI(this,mo,{}),iI(this,zs,null)}static get PLUGIN_KEY(){return p1}static get PLUGIN_PRIORITY(){return Hne}isEnabled(){return!!this.hot.getSettings()[p1]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[p1];dt(r)&&(If(mo,this,r),tr(r.copyPasteEnabled)&&(r.copyPasteEnabled=!0)),If(zs,this,new Pv),Si(zs,this).addLocalHook("init",()=>Ha(Gl,this,Une).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Si(zs,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ha(Gl,e,Wne).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,s)=>Ha(Gl,this,$ne).call(this,n,i,s)),this.addHook("modifyColWidth",(n,i)=>Ha(Gl,this,Lne).call(this,n,i),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ha(Gl,e,Vne).call(e,...i)}),this.addHook("modifyCopyableRange",n=>Ha(Gl,this,Bne).call(this,n)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),If(mo,this,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const r=this.getHiddenColumns(),n=this.isValidConfig(e);let i=r;const s=Si(zs,this).getValues().slice(),o=e.length>0;if(n&&o){const l=e.map(c=>this.hot.toPhysicalColumn(c));J(l,c=>{s[c]=!1}),i=Gn(s,(c,u,h)=>(u&&c.push(this.hot.toVisualColumn(h)),c),[])}this.hot.runHooks("beforeUnhideColumns",r,i,n&&o)!==!1&&(n&&o&&Si(zs,this).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",r,i,n&&o,n&&i.length<r.length))}showColumn(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.showColumns(r)}hideColumns(e){const r=this.getHiddenColumns(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideColumns",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{J(e,o=>{Si(zs,this).setValueAtIndex(this.hot.toPhysicalColumn(o),!0)})},!0),this.hot.runHooks("afterHideColumns",r,i,n,n&&i.length>r.length))}hideColumn(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.hideColumns(r)}getHiddenColumns(){return bt(Si(zs,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Si(zs,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const r=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<r):!1}resetCellsMeta(){J(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){If(mo,this,null),If(zs,this,null),super.destroy()}}function Lne(t,e){if(this.isHidden(e))return 0;if(Si(mo,this).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function $ne(t,e,r){if(Si(mo,this).copyPasteEnabled===!1&&this.isHidden(e)&&(r.skipColumnOnPaste=!0),this.isHidden(e-1))r.className=r.className||"",r.className.indexOf("afterHiddenColumn")===-1&&(r.className+=" afterHiddenColumn");else if(r.className){const n=r.className.split(" ");if(n.length>0){const i=n.indexOf("afterHiddenColumn");i>-1&&n.splice(i,1),r.className=n.join(" ")}}}function Bne(t){if(Si(mo,this).copyPasteEnabled)return t;const e=[],r=(n,i,s,o)=>{e.push({startRow:n,endRow:i,startCol:s,endCol:o})};return J(t,n=>{let i=!0,s=0;Ge(n.startCol,n.endCol,o=>{this.isHidden(o)?(i||r(n.startRow,n.endRow,s,o-1),i=!0):(i&&(s=o),o===n.endCol&&r(n.startRow,n.endRow,s,o),i=!1)})}),e}function Vne(t,e){if(!Si(mo,this).indicators||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&r.push("beforeHiddenColumn"),_e(e,r)}function Wne(t){t.items.push({name:ft},kne(this),Nne(this))}function Une(){Array.isArray(Si(mo,this).columns)&&this.hideColumns(Si(mo,this).columns)}function jne(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[n,,i]=e;n-i!==0&&(r=1)}return this.getTranslatedPhrase(nb,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.row,r.row),0),i=Math.max(e.row,r.row),s=[];for(let l=n;l<=i;l+=1)s.push(l);t.hideRows(s);const o=s[s.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function zne(t){const e=[];return{key:"hidden_rows_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(ib,r)},callback(){var r,n;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(r=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&r!==void 0?r:0,s=(n=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&n!==void 0?n:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countRows()||this.selectRows(i,s)},disabled:!1,hidden(){const r=bt(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().row,s=n.getBottomEndCorner().row,o=this.rowIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),c=o.getNotTrimmedIndexes(),u=[];if(i!==s){const h=s-i+1,f=l-a+1;if(h>f){const d=c.slice(i,s+1);u.push(...d.filter(g=>r.includes(g)))}}else if(a===0&&a<i)u.push(...c.slice(0,i));else if(a===null)u.push(...c.slice(0,this.countRows()));else{const h=this.countRows()-1,f=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===f&&h>s&&u.push(...c.slice(s+1))}return J(u,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function Gne(t,e){MN(t,e),e.add(t)}function sI(t,e,r){MN(t,e),e.set(t,r)}function MN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yi(t,e){return t.get(Da(t,e))}function Mf(t,e,r){return t.set(Da(t,e),r),r}function Da(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}We.getSingleton().register("beforeHideRows");We.getSingleton().register("afterHideRows");We.getSingleton().register("beforeUnhideRows");We.getSingleton().register("afterUnhideRows");const v1="hiddenRows",Yne=320;var Zo=new WeakMap,Gs=new WeakMap,Yl=new WeakSet;class Kne extends kt{constructor(){super(...arguments),Gne(this,Yl),sI(this,Zo,{}),sI(this,Gs,null)}static get PLUGIN_KEY(){return v1}static get PLUGIN_PRIORITY(){return Yne}isEnabled(){return!!this.hot.getSettings()[v1]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[v1];dt(r)&&(Mf(Zo,this,r),tr(r.copyPasteEnabled)&&(r.copyPasteEnabled=!0)),Mf(Gs,this,new Pv),Yi(Gs,this).addLocalHook("init",()=>Da(Yl,this,eie).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Yi(Gs,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Da(Yl,e,Qne).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,s)=>Da(Yl,this,qne).call(this,n,i,s)),this.addHook("modifyRowHeight",(n,i)=>Da(Yl,this,Xne).call(this,n,i)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Da(Yl,e,Zne).call(e,...i)}),this.addHook("modifyCopyableRange",n=>Da(Yl,this,Jne).call(this,n)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Mf(Zo,this,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const r=this.getHiddenRows(),n=this.isValidConfig(e);let i=r;const s=Yi(Gs,this).getValues().slice(),o=e.length>0;if(n&&o){const l=e.map(c=>this.hot.toPhysicalRow(c));J(l,c=>{s[c]=!1}),i=Gn(s,(c,u,h)=>(u&&c.push(this.hot.toVisualRow(h)),c),[])}this.hot.runHooks("beforeUnhideRows",r,i,n&&o)!==!1&&(n&&o&&Yi(Gs,this).setValues(s),this.hot.runHooks("afterUnhideRows",r,i,n&&o,n&&i.length<r.length))}showRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.showRows(r)}hideRows(e){const r=this.getHiddenRows(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideRows",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{J(e,o=>{Yi(Gs,this).setValueAtIndex(this.hot.toPhysicalRow(o),!0)})},!0),this.hot.runHooks("afterHideRows",r,i,n,n&&i.length>r.length))}hideRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.hideRows(r)}getHiddenRows(){return bt(Yi(Gs,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Yi(Gs,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const r=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<r):!1}resetCellsMeta(){J(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){Mf(Zo,this,null),Mf(Gs,this,null),super.destroy()}}function Xne(t,e){return this.isHidden(e)?0:t}function qne(t,e,r){if(Yi(Zo,this).copyPasteEnabled===!1&&this.isHidden(t)&&(r.skipRowOnPaste=!0),this.isHidden(t-1))r.className=r.className||"",r.className.indexOf("afterHiddenRow")===-1&&(r.className+=" afterHiddenRow");else if(r.className){const n=r.className.split(" ");if(n.length>0){const i=n.indexOf("afterHiddenRow");i>-1&&n.splice(i,1),r.className=n.join(" ")}}}function Jne(t){if(Yi(Zo,this).copyPasteEnabled)return t;const e=[],r=(n,i,s,o)=>{e.push({startRow:n,endRow:i,startCol:s,endCol:o})};return J(t,n=>{let i=!0,s=0;Ge(n.startRow,n.endRow,o=>{this.isHidden(o)?(i||r(s,o-1,n.startCol,n.endCol),i=!0):(i&&(s=o),o===n.endRow&&r(s,o,n.startCol,n.endCol),i=!1)})}),e}function Zne(t,e){if(!Yi(Zo,this).indicators||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&r.push("beforeHiddenRow"),_e(e,r)}function Qne(t){t.items.push({name:ft},jne(this),zne(this))}function eie(){Array.isArray(Yi(Zo,this).rows)&&this.hideRows(Yi(Zo,this).rows)}function tie(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(LS)},callback(e,r){const[{start:{col:n}}]=r;t.freezeColumn(n),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(r=!0),r}}}function rie(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase($S)},callback(e,r){const[{start:{col:n}}]=r;t.unfreezeColumn(n),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(r=!0),r}}}function nie(t,e){ON(t,e),e.add(t)}function iie(t,e,r){ON(t,e),e.set(t,r)}function ON(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ex(t,e){return t.get(Lp(t,e))}function w1(t,e,r){return t.set(Lp(t,e),r),r}function Lp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}We.getSingleton().register("beforeColumnFreeze");We.getSingleton().register("afterColumnFreeze");We.getSingleton().register("beforeColumnUnfreeze");We.getSingleton().register("afterColumnUnfreeze");const oI="manualColumnFreeze",sie=110;var ic=new WeakMap,C1=new WeakSet;class oie extends kt{constructor(){super(...arguments),nie(this,C1),iie(this,ic,!1)}static get PLUGIN_KEY(){return oI}static get PLUGIN_PRIORITY(){return sie}isEnabled(){return!!this.hot.getSettings()[oI]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Lp(C1,this,aie).call(this,e)),this.addHook("beforeColumnMove",(e,r)=>Lp(C1,this,lie).call(this,e,r)),super.enablePlugin())}disablePlugin(){w1(ic,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const r=this.hot.getSettings(),n=r.fixedColumnsStart<this.hot.countCols()&&e>r.fixedColumnsStart-1;ex(ic,this)||w1(ic,this,!0),this.hot.runHooks("beforeColumnFreeze",e,n)!==!1&&(n&&(this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart),r._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,n))}unfreezeColumn(e){const r=this.hot.getSettings(),n=r.fixedColumnsStart>0&&e<=r.fixedColumnsStart-1;ex(ic,this)||w1(ic,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,n)!==!1&&(n&&(r._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,n))}}function aie(t){t.items.push({name:"---------"},tie(this),rie(this))}function lie(t,e){if(ex(ic,this)){const r=this.hot.getSettings().fixedColumnsStart;if(e<r||t.some(n=>n<r))return!1}}function nm(t,e,r){return(e=cie(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cie(t){var e=uie(t,"string");return typeof e=="symbol"?e:e+""}function uie(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const y1=0,aI=1,lI=2,Iu="px";let PN=class{constructor(e){nm(this,"hot",void 0),nm(this,"_element",null),nm(this,"state",y1),nm(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=lI}build(){this.state===y1&&(this._element=this.hot.rootDocument.createElement("div"),this.state=aI)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=y1}isAppended(){return this.state===lI}isBuilt(){return this.state>=aI}setPosition(e,r){Wn(e)&&(this._element.style.top=e+Iu),Wn(r)&&(this._element.style[this.inlineProperty]=r+Iu)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,r){Wn(e)&&(this._element.style.width=e+Iu),Wn(r)&&(this._element.style.height=r+Iu)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){Wn(e)&&(this._element.style.marginTop=e+Iu),Wn(r)&&(this._element.style[`margin${Is(this.inlineProperty)}`]=r+Iu)}getOffset(){const e=this._element.style,r=`margin${Is(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[r]?parseInt(e[r],10):0}}};const hie="ht__manualColumnMove--backlight";let fie=class extends PN{build(){super.build(),_e(this._element,hie)}};const die="ht__manualColumnMove--guideline";let gie=class extends PN{build(){super.build(),_e(this._element,die)}};function mie(t,e){kN(t,e),e.add(t)}function us(t,e,r){kN(t,e),e.set(t,r)}function kN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function si(t,e,r){return t.set(La(t,e),r),r}function je(t,e){return t.get(La(t,e))}function La(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}We.getSingleton().register("beforeColumnMove");We.getSingleton().register("afterColumnMove");const x1="manualColumnMove",pie=120,cI="ht__manualColumnMove",$p="show-ui",tx="on-moving--columns",rx="after-selection--columns";var Bn=new WeakMap,Va=new WeakMap,Qo=new WeakMap,ep=new WeakMap,Ka=new WeakMap,Dn=new WeakMap,im=new WeakMap,Bi=new WeakMap,Wu=new WeakMap,Bp=new WeakMap,nd=new WeakMap,Kl=new WeakSet;class vie extends kt{constructor(){super(...arguments),mie(this,Kl),us(this,Bn,new fie(this.hot)),us(this,Va,new gie(this.hot)),us(this,Qo,[]),us(this,ep,0),us(this,Ka,!1),us(this,Dn,{}),us(this,im,void 0),us(this,Bi,void 0),us(this,Wu,void 0),us(this,Bp,void 0),us(this,nd,void 0)}static get PLUGIN_KEY(){return x1}static get PLUGIN_PRIORITY(){return pie}isEnabled(){return!!this.hot.getSettings()[x1]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return La(Kl,e,wie).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return La(Kl,e,yie).call(e,...n)}),this.addHook("afterScrollVertically",()=>La(Kl,this,Sie).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return La(Kl,e,bie).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),_e(this.hot.rootElement,cI),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){it(this.hot.rootElement,cI),this.unregisterEvents(),je(Bn,this).destroy(),je(Va,this).destroy(),super.disablePlugin()}moveColumn(e,r){return this.moveColumns([e],r)}moveColumns(e,r){const n=je(im,this),i=this.isMovePossible(e,r),s=this.hot.runHooks("beforeColumnMove",e,r,n,i);if(si(im,this,void 0),s===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,r);const o=i&&this.isColumnOrderChanged(e,r);return this.hot.runHooks("afterColumnMove",e,r,n,i,o),o}dragColumn(e,r){return this.dragColumns([e],r)}dragColumns(e,r){const n=this.countFinalIndex(e,r);return si(im,this,r),this.moveColumns(e,n)}isMovePossible(e,r){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+r>n,s=r<0,o=e.some(l=>l<0),a=e.some(l=>l>=n);return!(i||s||o||a)}isColumnOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}countFinalIndex(e,r){const n=Gn(e,(i,s)=>(s<r&&(i+=1),i),0);return r-n}getColumnsWidth(e,r){const n=this.hot.columnIndexMapper;let i=0;for(let s=e;s<=r;s+=1){const o=n.getRenderableFromVisualIndex(s);s<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:o!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(o)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[x1];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveColumns(r,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,r){const n=[];return Ge(e,r,i=>{n.push(i)}),n}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(je(Bi,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const r=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof n.scrollX=="number"?n.scrollX:n.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,je(Bi,this)-1);const o=r.hider.offsetWidth,a=r.TBODY.offsetLeft,l=je(Bn,this).getOffset().start,c=je(Bn,this).getSize().width;let u=0,h=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,m=rr(this.hot.rootElement),p=g.innerWidth-je(Wu,this)-m;h=g.innerWidth-je(Dn,this).eventPageX-p-(n.scrollX===void 0?i:0)}else h=je(Dn,this).eventPageX-(je(Wu,this)-(n.scrollX===void 0?i:0));if(je(Bp,this)&&(u=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(je(Bi,this))&&(s+=i),s+=u,je(Bi,this)<0)je(nd,this)>0?je(Dn,this).col=0:je(Dn,this).col=e>0?e-1:e;else if(je(Dn,this).TD.offsetWidth/2+s<=h){const g=je(Bi,this)>=je(ep,this)?je(ep,this)-1:je(Bi,this);je(Dn,this).col=g+1,s+=je(Dn,this).TD.offsetWidth}else je(Dn,this).col=je(Bi,this);let f=h,d=s;h+c+l>=o?f=o-c-l:h+l<a+u&&(f=a+u+Math.abs(l)),s>=o-1?d=o-1:d===0?d=1:n.scrollX!==void 0&&je(Bi,this)<je(nd,this)&&(d-=je(Wu,this)<=n.scrollX?je(Wu,this):0),je(Bn,this).setPosition(null,f),je(Va,this).setPosition(null,d)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>La(Kl,this,Cie).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>La(Kl,this,xie).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){je(Bn,this).build(),je(Va,this).build()}destroy(){je(Bn,this).destroy(),je(Va,this).destroy(),super.destroy()}}function wie(t,e,r,n){const i=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),o=this.hot.getSelectedRangeLast(),a=Qe(t.target,"sortAction");if(!o||!s||je(Ka,this)||t.button!==0||a){si(Ka,this,!1),je(Qo,this).length=0,it(this.hot.rootElement,[tx,$p]);return}const l=je(Va,this).isBuilt()&&!je(Va,this).isAppended(),c=je(Bn,this).isBuilt()&&!je(Bn,this).isAppended();l&&c&&(je(Va,this).appendTo(i.hider),je(Bn,this).appendTo(i.hider));const{from:u,to:h}=o,f=Math.min(u.col,h.col),d=Math.max(u.col,h.col);if(e.row<0&&e.col>=f&&e.col<=d){n.column=!0,si(Ka,this,!0);const g=r.firstChild?p6(t,r.firstChild).x:t.offsetX;je(Dn,this).eventPageX=t.pageX,si(Bi,this,e.col),je(Dn,this).TD=r,je(Dn,this).col=e.col,si(Qo,this,this.prepareColumnsToMoving(f,d)),si(Bp,this,!!this.hot.getSettings().rowHeaders),si(ep,this,this.hot.countCols()),si(nd,this,this.hot.getSettings().fixedColumnsStart),si(Wu,this,sn(this.hot.rootElement).left);const m=je(Bp,this)?-1:0,p=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,y=e.col<je(nd,this),S=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),C=Math.abs(g-(this.hot.isRtl()?r.offsetWidth:0)),A=this.getColumnsWidth(f,e.col-1)+C,I=this.getColumnsWidth(m,f-1)+(y?S:0)+A;je(Bn,this).setPosition(p,I),je(Bn,this).setSize(this.getColumnsWidth(f,d),i.hider.offsetHeight-p),je(Bn,this).setOffset(null,-A),_e(this.hot.rootElement,tx)}else it(this.hot.rootElement,rx),si(Ka,this,!1),je(Qo,this).length=0}function Cie(t){je(Ka,this)&&(je(Dn,this).eventPageX=t.pageX,this.refreshPositions())}function yie(t,e,r,n){!this.hot.getSelectedRangeLast()||!je(Ka,this)||(je(Qo,this).indexOf(e.col)>-1?it(this.hot.rootElement,$p):_e(this.hot.rootElement,$p),n.row=!0,n.column=!0,n.cell=!0,si(Bi,this,e.col),je(Dn,this).TD=r)}function xie(){const t=je(Dn,this).col,e=je(Qo,this).length;if(si(Bi,this,void 0),si(Ka,this,!1),it(this.hot.rootElement,[tx,$p,rx]),this.hot.selection.isSelectedByColumnHeader()&&_e(this.hot.rootElement,rx),e<1||t===void 0)return;const r=je(Qo,this)[0],n=this.hot.toPhysicalColumn(r),i=this.dragColumns(je(Qo,this),t);if(je(Qo,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualColumn(n),o=s+e-1;this.hot.selectColumns(s,o)}}function Sie(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,r=t.holder.scrollTop,n=e+r;je(Bn,this).setPosition(n),je(Bn,this).setSize(null,t.hider.offsetHeight-n)}function bie(){this.moveBySettingsOrLoad()}function Eie(t,e){NN(t,e),e.add(t)}function yn(t,e,r){NN(t,e),e.set(t,r)}function NN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rr(t,e,r){return t.set(Cs(t,e),r),r}function Ve(t,e){return t.get(Cs(t,e))}function Cs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Vp="manualColumnResize",Rie=130,uI="manualColumnWidths";var Ko=new WeakMap,sm=new WeakMap,Ci=new WeakMap,Wp=new WeakMap,ho=new WeakMap,Tie=new WeakMap,eh=new WeakMap,om=new WeakMap,ti=new WeakMap,zo=new WeakMap,Ac=new WeakMap,Up=new WeakMap,id=new WeakMap,sd=new WeakMap,xi=new WeakMap,od=new WeakMap,Ys=new WeakSet;class _ie extends kt{static get PLUGIN_KEY(){return Vp}static get PLUGIN_PRIORITY(){return Rie}constructor(e){super(e),Eie(this,Ys),yn(this,Ko,null),yn(this,sm,null),yn(this,Ci,[]),yn(this,Wp,null),yn(this,ho,null),yn(this,Tie,null),yn(this,eh,null),yn(this,om,null),yn(this,ti,this.hot.rootDocument.createElement("DIV")),yn(this,zo,this.hot.rootDocument.createElement("DIV")),yn(this,Ac,null),yn(this,Up,!1),yn(this,id,0),yn(this,sd,null),yn(this,xi,void 0),yn(this,od,void 0),_e(Ve(ti,this),"manualColumnResizer"),_e(Ve(zo,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Vp]}enablePlugin(){this.enabled||(Rr(xi,this,new fl),Ve(xi,this).addLocalHook("init",()=>Cs(Ys,this,Aie).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Ve(xi,this)),this.addHook("modifyColWidth",(e,r)=>Cs(Ys,this,Nie).call(this,e,r),1),this.addHook("beforeStretchingColumnWidth",(e,r)=>Cs(Ys,this,Fie).call(this,e,r)),this.addHook("beforeColumnResize",(e,r,n)=>Cs(Ys,this,Hie).call(this,e,r,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Rr(od,this,Ve(xi,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",uI,Ve(xi,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",uI,e),e.value}setManualSize(e,r){const n=Math.max(r,20),i=this.hot.toPhysicalColumn(e);return Ve(xi,this).setValueAtIndex(i,n),n}clearManualSize(e){const r=this.hot.toPhysicalColumn(e);Ve(xi,this).setValueAtIndex(r,null)}setupHandlePosition(e){if(!e.parentNode)return;Rr(Ko,this,e);const{_wt:r}=this.hot.view,n=r.wtTable.getCoords(Ve(Ko,this)),i=n.col;if(i<0)return;const s=Fr(Ve(Ko,this)),o=Ve(Ko,this).getBoundingClientRect(),a=i<r.getSetting("fixedColumnsStart");let l;a&&(l=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Ve(Ko,this),n.row,n.col)),l||(l=r.wtOverlays.topOverlay.getRelativeCellPosition(Ve(Ko,this),n.row,n.col)),Rr(sm,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Rr(Ci,this,[]);const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&c){const u=this.hot.getSelectedRange();J(u,h=>{const f=h.getTopStartCorner().col,d=h.getBottomEndCorner().col;Ge(f,d,g=>{Ve(Ci,this).includes(g)||Ve(Ci,this).push(g)})})}Ve(Ci,this).includes(Ve(sm,this))||Rr(Ci,this,[Ve(sm,this)]),Rr(om,this,l.start-6),Rr(eh,this,parseInt(o.width,10)),Ve(ti,this).style.top=`${l.top}px`,Ve(ti,this).style[this.inlineDir]=`${Ve(om,this)+Ve(eh,this)}px`,Ve(ti,this).style.height=`${s}px`,this.hot.rootElement.appendChild(Ve(ti,this))}refreshHandlePosition(){Ve(ti,this).style[this.inlineDir]=`${Ve(om,this)+Ve(Wp,this)}px`}setupGuidePosition(){const e=parseInt(Fr(Ve(ti,this)),10),r=parseInt(Ve(ti,this).style.top,10)+e,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);_e(Ve(ti,this),"active"),_e(Ve(zo,this),"active"),Ve(zo,this).style.top=`${r}px`,this.refreshGuidePosition(),Ve(zo,this).style.height=`${n-e}px`,this.hot.rootElement.appendChild(Ve(zo,this))}refreshGuidePosition(){Ve(zo,this).style[this.inlineDir]=Ve(ti,this).style[this.inlineDir]}hideHandleAndGuide(){it(Ve(ti,this),"active"),it(Ve(zo,this),"active")}checkIfColumnHeader(e){const r=xc(e,["THEAD"],this.hot.rootElement),{topOverlay:n,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},r=(n,i)=>{const s=this.hot.runHooks("beforeColumnResize",Ve(ho,this),n,!0);s!==void 0&&Rr(ho,this,s),this.hot.getSettings().stretchH==="all"?this.clearManualSize(n):this.setManualSize(n,Ve(ho,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Ve(ho,this),n,!0),i&&e()};Ve(id,this)>=2&&(Ve(Ci,this).length>1?(J(Ve(Ci,this),i=>{r(i)}),e()):J(Ve(Ci,this),i=>{r(i,!0)})),Rr(id,this,0),Rr(sd,this,null)}bindEvents(){const{rootWindow:e,rootElement:r}=this.hot;this.eventManager.addEventListener(r,"mouseover",n=>Cs(Ys,this,Iie).call(this,n)),this.eventManager.addEventListener(r,"mousedown",n=>Cs(Ys,this,Mie).call(this,n)),this.eventManager.addEventListener(e,"mousemove",n=>Cs(Ys,this,Oie).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Cs(Ys,this,Pie).call(this)),this.eventManager.addEventListener(Ve(ti,this),"contextmenu",()=>Cs(Ys,this,kie).call(this))}destroy(){super.destroy()}}function Aie(){const t=this.hot.getSettings()[Vp],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((r,n)=>{Ve(xi,this).setValueAtIndex(n,r)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((r,n)=>{Ve(xi,this).setValueAtIndex(n,r)})},!0),Rr(od,this,t)):t===!0&&Array.isArray(Ve(od,this))&&this.hot.batchExecution(()=>{Ve(od,this).forEach((r,n)=>{Ve(xi,this).setValueAtIndex(n,r)})},!0)}function Iie(t){if(!wP(t.target)&&Ve(Up,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const r=e.getAttribute("colspan");e&&(r===null||r==="1")&&(Ve(Ac,this)||this.setupHandlePosition(e))}}function Mie(t){t.target.parentNode===this.hot.rootElement&&Qe(t.target,"manualColumnResizer")&&(this.setupHandlePosition(Ve(Ko,this)),this.setupGuidePosition(),Rr(Ac,this,!0),Ve(sd,this)===null&&(Rr(sd,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Ve(sd,this))),Rr(id,this,Ve(id,this)+1),this.startX=t.pageX,Rr(ho,this,Ve(eh,this)))}function Oie(t){if(Ve(Ac,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Rr(Wp,this,Ve(eh,this)+e),J(Ve(Ci,this),r=>{Rr(ho,this,this.setManualSize(r,Ve(Wp,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Pie(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(r,n)=>{this.hot.runHooks("beforeColumnResize",Ve(ho,this),r,!1),n&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Ve(ho,this),r,!1)};Ve(Ac,this)&&(this.hideHandleAndGuide(),Rr(Ac,this,!1),Ve(ho,this)!==Ve(eh,this)&&(Ve(Ci,this).length>1?(J(Ve(Ci,this),n=>{e(n)}),t()):J(Ve(Ci,this),n=>{e(n,!0)})),this.setupHandlePosition(Ve(Ko,this)))}function kie(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Ve(ti,this)),this.hot.rootElement.removeChild(Ve(zo,this)),Rr(Ac,this,!1),Rr(Up,this,!0),this.hot._registerImmediate(()=>{Rr(Up,this,!1)})}function Nie(t,e){let r=t;if(this.enabled){const n=this.hot.toPhysicalColumn(e),i=Ve(xi,this).getValueAtIndex(n);this.hot.getSettings()[Vp]&&i&&(r=i)}return r}function Fie(t,e){let r=Ve(xi,this).getValueAtIndex(e);return r===null&&(r=t),r}function Hie(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function S1(t,e,r){return(e=Die(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Die(t){var e=Lie(t,"string");return typeof e=="symbol"?e:e+""}function Lie(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const b1=0,hI=1,fI=2,Mu="px";let FN=class{constructor(e){S1(this,"hot",void 0),S1(this,"_element",null),S1(this,"state",b1),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=fI}build(){this.state===b1&&(this._element=this.hot.rootDocument.createElement("div"),this.state=hI)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=b1}isAppended(){return this.state===fI}isBuilt(){return this.state>=hI}setPosition(e,r){e!==void 0&&(this._element.style.top=e+Mu),r!==void 0&&(this._element.style.left=r+Mu)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,r){e&&(this._element.style.width=e+Mu),r&&(this._element.style.height=r+Mu)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){e&&(this._element.style.marginTop=e+Mu),r&&(this._element.style.marginLeft=r+Mu)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const $ie="ht__manualRowMove--backlight";class Bie extends FN{build(){super.build(),_e(this._element,$ie)}}const Vie="ht__manualRowMove--guideline";class Wie extends FN{build(){super.build(),_e(this._element,Vie)}}function Uie(t,e){HN(t,e),e.add(t)}function Ou(t,e,r){HN(t,e),e.set(t,r)}function HN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dc(t,e,r){return t.set($a(t,e),r),r}function st(t,e){return t.get($a(t,e))}function $a(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}We.getSingleton().register("beforeRowMove");We.getSingleton().register("afterRowMove");const E1="manualRowMove",jie=140,dI="ht__manualRowMove",jp="show-ui",nx="on-moving--rows",ix="after-selection--rows";var Vn=new WeakMap,Wa=new WeakMap,ea=new WeakMap,Xa=new WeakMap,ai=new WeakMap,am=new WeakMap,Xl=new WeakSet;class zie extends kt{constructor(){super(...arguments),Uie(this,Xl),Ou(this,Vn,new Bie(this.hot)),Ou(this,Wa,new Wie(this.hot)),Ou(this,ea,[]),Ou(this,Xa,void 0),Ou(this,ai,{}),Ou(this,am,void 0)}static get PLUGIN_KEY(){return E1}static get PLUGIN_PRIORITY(){return jie}isEnabled(){return!!this.hot.getSettings()[E1]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $a(Xl,e,Gie).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $a(Xl,e,Kie).call(e,...n)}),this.addHook("afterScrollHorizontally",()=>$a(Xl,this,qie).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $a(Xl,e,Jie).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),_e(this.hot.rootElement,dI),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){it(this.hot.rootElement,dI),this.unregisterEvents(),st(Vn,this).destroy(),st(Wa,this).destroy(),super.disablePlugin()}moveRow(e,r){return this.moveRows([e],r)}moveRows(e,r){const n=st(am,this),i=this.isMovePossible(e,r),s=this.hot.runHooks("beforeRowMove",e,r,n,i);if(dc(am,this,void 0),s===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,r);const o=i&&this.isRowOrderChanged(e,r);return this.hot.runHooks("afterRowMove",e,r,n,i,o),o}dragRow(e,r){return this.dragRows([e],r)}dragRows(e,r){const n=this.countFinalIndex(e,r);return dc(am,this,r),this.moveRows(e,n)}isMovePossible(e,r){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+r>n,s=r<0,o=e.some(l=>l<0),a=e.some(l=>l>=n);return!(i||s||o||a)}isRowOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}countFinalIndex(e,r){const n=Gn(e,(i,s)=>(s<r&&(i+=1),i),0);return r-n}getRowsHeight(e,r){const n=this.hot.rowIndexMapper;let i=0;for(let s=e;s<=r;s++){const o=n.getRenderableFromVisualIndex(s);o!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(o)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[E1];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveRows(r,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),r=[];if(!e)return r;const{from:n,to:i}=e,s=Math.min(n.row,i.row),o=Math.max(n.row,i.row);return Ge(s,o,a=>{r.push(a)}),r}refreshPositions(){const e=st(ai,this).coords,r=this.hot.view.getFirstFullyVisibleRow(),n=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&r>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1)),this.isFixedRowBottom(e.row)&&n<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,o=st(ai,this).TD,a=this.hot.rootElement,l=sn(a),c=lh(a),u=s.holder.scrollTop,h=this.hot.rootWindow!==c?c.scrollTop:0,f=l.top-h,d=st(ai,this).eventPageY-f+u,g=s.hider.offsetHeight,m=s.TBODY.offsetTop,p=st(Vn,this).getOffset().top,y=st(Vn,this).getSize().height,S=o.offsetHeight/2,C=o.offsetHeight;let A=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const I=d>=A+S;this.isFixedRowTop(e.row)&&(A+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?st(ai,this).row=r>0?r-1:r:I?(st(ai,this).row=e.row+1,A+=e.row===0?C-1:C):st(ai,this).row=e.row;let O=d,_=A;d+y+p>=g?O=g-y-p:d+p<m&&(O=m+Math.abs(p)),A>=g-1&&(_=g-1),st(Vn,this).setPosition(O),st(Wa,this).setPosition(_)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>$a(Xl,this,Yie).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>$a(Xl,this,Xie).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){st(Vn,this).build(),st(Wa,this).build()}destroy(){st(Vn,this).destroy(),st(Wa,this).destroy(),super.destroy()}}function Gie(t,e,r,n){const{wtTable:i,wtViewport:s}=this.hot.view._wt,o=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!o||st(Xa,this)||t.button!==0){dc(Xa,this,!1),st(ea,this).length=0,it(this.hot.rootElement,[nx,jp]);return}const l=st(Wa,this).isBuilt()&&!st(Wa,this).isAppended(),c=st(Vn,this).isBuilt()&&!st(Vn,this).isAppended();l&&c&&(st(Wa,this).appendTo(i.hider),st(Vn,this).appendTo(i.hider));const{from:u,to:h}=a,f=Math.min(u.row,h.row),d=Math.max(u.row,h.row);if(e.col<0&&e.row>=f&&e.row<=d){n.row=!0,dc(Xa,this,!0),st(ai,this).eventPageY=t.pageY,st(ai,this).coords=e,st(ai,this).TD=r,dc(ea,this,this.prepareRowsToMoving());const g=i.holder.scrollLeft+s.getRowHeaderWidth(),m=this.getRowsHeight(f,e.row-1)+t.offsetY;st(Vn,this).setPosition(null,g),st(Vn,this).setSize(i.hider.offsetWidth-g,this.getRowsHeight(f,d)),st(Vn,this).setOffset(-m,null),_e(this.hot.rootElement,nx),this.refreshPositions()}else it(this.hot.rootElement,ix),dc(Xa,this,!1),st(ea,this).length=0}function Yie(t){st(Xa,this)&&(st(ai,this).eventPageY=t.pageY,this.refreshPositions())}function Kie(t,e,r,n){!this.hot.getSelectedRangeLast()||!st(Xa,this)||(st(ea,this).indexOf(e.row)>-1?it(this.hot.rootElement,jp):_e(this.hot.rootElement,jp),n.row=!0,n.column=!0,n.cell=!0,st(ai,this).coords=e,st(ai,this).TD=r)}function Xie(){const t=st(ai,this).row,e=st(ea,this).length;if(dc(Xa,this,!1),it(this.hot.rootElement,[nx,jp,ix]),this.hot.selection.isSelectedByRowHeader()&&_e(this.hot.rootElement,ix),e<1||t===void 0)return;const r=st(ea,this)[0],n=this.hot.toPhysicalRow(r),i=this.dragRows(st(ea,this),t);if(st(ea,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualRow(n),o=s+e-1;this.hot.selectRows(s,o)}}function qie(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),r=t.holder.scrollLeft,n=e+r;st(Vn,this).setPosition(null,n),st(Vn,this).setSize(t.hider.offsetWidth-n)}function Jie(){this.moveBySettingsOrLoad()}function Zie(t,e){DN(t,e),e.add(t)}function xn(t,e,r){DN(t,e),e.set(t,r)}function DN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mr(t,e,r){return t.set(Xo(t,e),r),r}function Be(t,e){return t.get(Xo(t,e))}function Xo(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const zp="manualRowResize",Qie=30,gI="manualRowHeights";var so=new WeakMap,lm=new WeakMap,yi=new WeakMap,ad=new WeakMap,Ua=new WeakMap,CE=new WeakMap,th=new WeakMap,cm=new WeakMap,Fn=new WeakMap,to=new WeakMap,Ic=new WeakMap,Gp=new WeakMap,ld=new WeakMap,cd=new WeakMap,ys=new WeakMap,ud=new WeakMap,Ma=new WeakSet;class ese extends kt{static get PLUGIN_KEY(){return zp}static get PLUGIN_PRIORITY(){return Qie}constructor(e){super(e),Zie(this,Ma),xn(this,so,null),xn(this,lm,null),xn(this,yi,[]),xn(this,ad,null),xn(this,Ua,null),xn(this,CE,null),xn(this,th,null),xn(this,cm,null),xn(this,Fn,this.hot.rootDocument.createElement("DIV")),xn(this,to,this.hot.rootDocument.createElement("DIV")),xn(this,Ic,!1),xn(this,Gp,!1),xn(this,ld,0),xn(this,cd,null),xn(this,ys,void 0),xn(this,ud,void 0),_e(Be(Fn,this),"manualRowResizer"),_e(Be(to,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[zp]}enablePlugin(){this.enabled||(mr(ys,this,new fl),Be(ys,this).addLocalHook("init",()=>Xo(Ma,this,ase).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Be(ys,this)),this.addHook("modifyRowHeight",(e,r)=>Xo(Ma,this,ose).call(this,e,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){mr(ud,this,Be(ys,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",gI,Be(ys,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",gI,e),e.value}setManualSize(e,r){const n=this.hot.toPhysicalRow(e),i=Math.max(r,XP);return Be(ys,this).setValueAtIndex(n,i),i}getLastDesiredRowHeight(){return Be(ad,this)}setupHandlePosition(e){mr(so,this,e);const{view:r}=this.hot,{_wt:n}=r,i=n.wtTable.getCoords(Be(so,this)),s=i.row;if(s<0)return;const o=rr(Be(so,this)),a=Be(so,this).getBoundingClientRect(),l=s<n.getSetting("fixedRowsTop"),c=s>=r.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let u;l?u=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Be(so,this),i.row,i.col):c&&(u=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(Be(so,this),i.row,i.col)),u||(u=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(Be(so,this),i.row,i.col)),mr(lm,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),mr(yi,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const f=this.hot.getSelectedRange();J(f,d=>{const g=d.getTopStartCorner().row,m=d.getBottomStartCorner().row;Ge(g,m,p=>{Be(yi,this).includes(p)||Be(yi,this).push(p)})})}Be(yi,this).includes(Be(lm,this))||mr(yi,this,[Be(lm,this)]),mr(cm,this,u.top-6),mr(th,this,parseInt(a.height,10)),Be(Fn,this).style.top=`${Be(cm,this)+Be(th,this)}px`,Be(Fn,this).style[this.inlineDir]=`${u.start}px`,Be(Fn,this).style.width=`${o}px`,this.hot.rootElement.appendChild(Be(Fn,this))}refreshHandlePosition(){Be(Fn,this).style.top=`${Be(cm,this)+Be(ad,this)}px`}setupGuidePosition(){const e=parseInt(rr(Be(Fn,this)),10),r=parseInt(Be(Fn,this).style[this.inlineDir],10)+e,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);_e(Be(Fn,this),"active"),_e(Be(to,this),"active"),Be(to,this).style.top=Be(Fn,this).style.top,Be(to,this).style[this.inlineDir]=`${r}px`,Be(to,this).style.width=`${n-e}px`,this.hot.rootElement.appendChild(Be(to,this))}refreshGuidePosition(){Be(to,this).style.top=Be(Fn,this).style.top}hideHandleAndGuide(){it(Be(Fn,this),"active"),it(Be(to,this),"active")}checkIfRowHeader(e){const r=xc(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.TBODY,i.clone.wtTable.TBODY,s.clone.wtTable.TBODY].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const r=this.hot.view._wt.wtTable.getRowHeight(e);return r!==void 0&&Be(Ua,this)<r?r:Be(Ua,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},r=(n,i)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!0);s!==void 0&&mr(Ua,this,s),this.setManualSize(n,Be(Ua,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!0),i&&e()};Be(ld,this)>=2&&(Be(yi,this).length>1?(J(Be(yi,this),i=>{r(i)}),e()):J(Be(yi,this),i=>{r(i,!0)})),mr(ld,this,0),mr(cd,this,null)}bindEvents(){const{rootElement:e,rootWindow:r}=this.hot;this.eventManager.addEventListener(e,"mouseover",n=>Xo(Ma,this,tse).call(this,n)),this.eventManager.addEventListener(e,"mousedown",n=>Xo(Ma,this,rse).call(this,n)),this.eventManager.addEventListener(r,"mousemove",n=>Xo(Ma,this,nse).call(this,n)),this.eventManager.addEventListener(r,"mouseup",()=>Xo(Ma,this,ise).call(this)),this.eventManager.addEventListener(Be(Fn,this),"contextmenu",()=>Xo(Ma,this,sse).call(this))}destroy(){super.destroy()}}function tse(t){if(!wP(t.target)&&Be(Gp,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(Be(Ic,this)||this.setupHandlePosition(e))}}function rse(t){Qe(t.target,"manualRowResizer")&&(this.setupHandlePosition(Be(so,this)),this.setupGuidePosition(),mr(Ic,this,!0),Be(cd,this)===null&&(mr(cd,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Be(cd,this))),mr(ld,this,Be(ld,this)+1),mr(CE,this,t.pageY),mr(Ua,this,Be(th,this)))}function nse(t){Be(Ic,this)&&(mr(ad,this,Be(th,this)+(t.pageY-Be(CE,this))),J(Be(yi,this),e=>{mr(Ua,this,this.setManualSize(e,Be(ad,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function ise(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(r,n)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!1),n&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!1)};Be(Ic,this)&&(this.hideHandleAndGuide(),mr(Ic,this,!1),Be(Ua,this)!==Be(th,this)&&(Be(yi,this).length>1?(J(Be(yi,this),n=>{e(n)}),t()):J(Be(yi,this),n=>{e(n,!0)})),this.setupHandlePosition(Be(so,this)))}function sse(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Be(Fn,this)),this.hot.rootElement.removeChild(Be(to,this)),mr(Ic,this,!1),mr(Gp,this,!0),this.hot._registerImmediate(()=>{mr(Gp,this,!1)})}function ose(t,e){let r=t;if(this.enabled){const n=this.hot.toPhysicalRow(e),i=Be(ys,this).getValueAtIndex(n);this.hot.getSettings()[zp]&&i&&(r=i)}return r}function ase(){const t=this.hot.getSettings()[zp],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((r,n)=>{Be(ys,this).setValueAtIndex(n,r)}):Array.isArray(t)?(t.forEach((r,n)=>{Be(ys,this).setValueAtIndex(n,r)}),mr(ud,this,t)):t===!0&&Array.isArray(Be(ud,this))&&Be(ud,this).forEach((r,n)=>{Be(ys,this).setValueAtIndex(n,r)})},!0)}function lse(t,e,r){cse(t,e),e.set(t,r)}function cse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ql(t,e,r){return(e=use(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function use(t){var e=hse(t,"string");return typeof e=="symbol"?e:e+""}function hse(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mI(t,e){return t.get(LN(t,e))}function um(t,e,r){return t.set(LN(t,e),r),r}function LN(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Jl=new WeakMap;class oo{constructor(e,r,n,i,s,o){ql(this,"row",void 0),ql(this,"col",void 0),ql(this,"rowspan",void 0),ql(this,"colspan",void 0),ql(this,"removed",!1),ql(this,"cellCoordsFactory",void 0),ql(this,"cellRangeFactory",void 0),lse(this,Jl,null),this.row=e,this.col=r,this.rowspan=n,this.colspan=i,this.cellCoordsFactory=s,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:r,col:n,rowspan:i,colspan:s}=e;return Ht`The merged cell declared with {row: ${r}, col: ${n},\x20
      rowspan: ${i}, colspan: ${s}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:r,col:n}=e;return Ht`The merged cell declared at [${r}, ${n}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:r,col:n}=e;return Ht`The merged cell declared at [${r}, ${n}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:r,col:n}=e;return Ht`The merged cell declared at [${r}, ${n}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:r,col:n,rowspan:i,colspan:s}=e;return r<0||n<0||i<0||s<0}static isSingleCell(e){let{rowspan:r,colspan:n}=e;return n===1&&r===1}static containsZeroSpan(e){let{rowspan:r,colspan:n}=e;return n===0||r===0}static isOutOfBounds(e,r,n){return e.row<0||e.col<0||e.row>=r||e.row+e.rowspan-1>=r||e.col>=n||e.col+e.colspan-1>=n}normalize(e){const r=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>r-1&&(this.row=r-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>r-1&&(this.rowspan=r-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col),um(Jl,this,null)}includes(e,r){return this.row<=e&&this.col<=r&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=r}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,r){const n=e[0]||e[1],i=r+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",a=Math.min(r,i),l=Math.max(r,i),c=this[o],u=this[o]+this[s]-1;if(c>=r&&(this[o]+=n),n>0)r<=u&&r>c&&(this[s]+=n);else if(n<0){if(a<=c&&l>=u)return this.removed=!0,um(Jl,this,null),!1;if(c>=a&&c<=l){const h=l-c+1,f=Math.abs(n)-h;this[o]-=f+n,this[s]-=h}else if(c<=a&&u>=l)this[s]+=n;else if(c<=a&&u>=a&&u<l){const h=u-a+1;this[s]-=h}}return um(Jl,this,null),!0}isFarther(e,r){return e?r==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:r==="up"?e.row>this.row:r==="right"?e.col+e.colspan-1<this.col+this.colspan-1:r==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return mI(Jl,this)||um(Jl,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),mI(Jl,this)}}function fse(t,e){dse(t,e),e.add(t)}function dse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hm(t,e,r){return(e=gse(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gse(t){var e=mse(t,"string");return typeof e=="symbol"?e:e+""}function mse(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Oa=new WeakSet;class Yp{constructor(e){fse(this,Oa),hm(this,"plugin",void 0),hm(this,"mergedCells",[]),hm(this,"mergedCellsMatrix",new Map),hm(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:r,col:n}=e;return Ht`The merged cell declared at [${r}, ${n}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,r){var n;return this.mergedCellsMatrix.has(e)&&(n=this.mergedCellsMatrix.get(e).get(r))!==null&&n!==void 0?n:!1}getByRange(e){let r=!1;return J(this.mergedCells,n=>n.row<=e.from.row&&n.row+n.rowspan-1>=e.to.row&&n.col<=e.from.col&&n.col+n.colspan-1>=e.to.col?(r=n,r):!0),r}filterOverlappingMergeCells(e){const r=new Set;return this.mergedCells.forEach(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i;for(let c=s;c<s+l;c++)for(let u=o;u<o+a;u++)r.add(`r${c},c${u}`)}),e.filter(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i,c=new Set;let u=!1;for(let h=s;h<s+l;h++){for(let f=o;f<o+a;f++){const d=`r${h},c${f}`;if(r.has(d)){Ft(Yp.IS_OVERLAPPING_WARNING(i)),u=!0;break}c.add(d)}if(u)break}return u||r.add(...c),!u})}getWithinRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:n,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),a=[];for(let l=n;l<=s;l++)for(let c=i;c<=o;c++){const u=this.get(l,c);u&&(r||!r&&u.row===l&&u.col===c)&&a.push(u)}return a}add(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=e.row,i=e.col,s=e.rowspan,o=e.colspan,a=new oo(n,i,s,o,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(n,i),c=r?!1:this.isOverlapping(a);return!l&&!c?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Zl(Oa,this,pI).call(this,a),a):(Ft(Yp.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,r){const n=this.get(e,r),i=n?this.mergedCells.indexOf(n):-1;return n&&i!==-1?(this.mergedCells.splice(i,1),Zl(Oa,this,pse).call(this,n),n):!1}clear(){J(this.mergedCells,e=>{let{row:r,col:n,rowspan:i,colspan:s}=e;Ge(r,r+i,o=>{Ge(n,n+s,a=>{const l=this.hot.getCell(o,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const r=e.getRange();for(let n=0;n<this.mergedCells.length;n++)if(this.mergedCells[n].getRange().overlaps(r))return!0;return!1}isFirstRenderableMergedCell(e,r){const n=this.get(e,r);return n&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)===r}getFirstRenderableCoords(e,r){const n=this.get(e,r);if(!n||this.isFirstRenderableMergedCell(e,r))return this.hot._createCellCoords(e,r);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(i,s)}getStartMostColumnIndex(e,r){const n=Zl(Oa,this,fm).call(this,e,"col",-1);let i=r;for(let s=0;s<n.length;s++)if(n[s]<=r){i=n[s];break}return i}getEndMostColumnIndex(e,r){const n=Zl(Oa,this,fm).call(this,e,"col",1);let i=r;for(let s=0;s<n.length;s++)if(n[s]>=r){i=n[s];break}return i}getTopMostRowIndex(e,r){const n=Zl(Oa,this,fm).call(this,e,"row",-1);let i=r;for(let s=0;s<n.length;s++)if(n[s]<=r){i=n[s];break}return i}getBottomMostRowIndex(e,r){const n=Zl(Oa,this,fm).call(this,e,"row",1);let i=r;for(let s=0;s<n.length;s++)if(n[s]>=r){i=n[s];break}return i}shiftCollections(e,r,n){const i=[0,0];switch(e){case"right":i[0]+=n;break;case"left":i[0]-=n;break;case"down":i[1]+=n;break;case"up":i[1]-=n;break}const s=[];this.mergedCells.forEach(o=>{o.shift(i,r),o.removed&&s.push(o)}),s.forEach(o=>{this.mergedCells.splice(this.mergedCells.indexOf(o),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(o=>{Zl(Oa,this,pI).call(this,o)})}}function fm(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const n=new Map,i=r===1?t.getTopStartCorner():t.getBottomEndCorner(),s=r===1?t.getBottomEndCorner():t.getTopStartCorner();for(let o=i.row;r===1?o<=s.row:o>=s.row;o+=r)for(let a=i.col;r===1?a<=s.col:a>=s.col;a+=r){const l=e==="row"?o:a,c=this.get(o,a);let u=l;c&&(u=r===1?c[e]+c[`${e}span`]-1:c[e]),n.has(l)||n.set(l,new Set),n.get(l).add(u)}return Array.from(new Set(Array.from(n.entries()).filter(o=>{let[,a]=o;return a.size===1}).flatMap(o=>{let[,a]=o;return Array.from(a)})))}function pI(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(r,t)}function pse(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.get(e).delete(r)}function R1(t,e,r){return(e=vse(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vse(t){var e=wse(t,"string");return typeof e=="symbol"?e:e+""}function wse(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cse{constructor(e){R1(this,"plugin",void 0),R1(this,"mergedCellsCollection",void 0),R1(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const r=this.mergedCellsCollection.get(e[0],e[1]);r&&(e[2]=e[0]+r.rowspan-1,e[3]=e[1]+r.colspan-1)}}getDirection(e,r){let n=null;return r[0]===e[0]&&r[1]===e[1]&&r[3]===e[3]?n="down":r[2]===e[2]&&r[1]===e[1]&&r[3]===e[3]?n="up":r[1]===e[1]&&r[2]===e[2]?n="right":n="left",n}snapDragArea(e,r,n,i){const s=r.slice(0),o=this.getAutofillSize(e,r,n),[a,l,c,u]=e,f=["up","down"].indexOf(n)>-1?c-a+1:u-l+1,d=Math.floor(o/f)*f,g=o-d,m=this.getFarthestCollection(e,r,n,i);if(m){if(n==="down"){const p=m.row+m.rowspan-a-g;s[2]+p>=this.plugin.hot.countRows()?s[2]-=g:s[2]+=g?p:0}else if(n==="right"){const p=m.col+m.colspan-l-g;s[3]+p>=this.plugin.hot.countCols()?s[3]-=g:s[3]+=g?p:0}else if(n==="up"){const p=c-g-m.row+1;s[0]+p<0?s[0]+=g:s[0]-=g?p:0}else if(n==="left"){const p=u-g-m.col+1;s[1]+p<0?s[1]+=g:s[1]-=g?p:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:i,fillSize:o,dragArea:s,cycleLength:f}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Ur(this.currentFillData,e)}getAutofillSize(e,r,n){const[i,s,o,a]=e,[l,c,u,h]=r;switch(n){case"up":return i-l;case"down":return u-o;case"left":return s-c;case"right":return h-a;default:return null}}getDragArea(e,r,n){const[i,s,o,a]=e,[l,c,u,h]=r;switch(n){case"up":return[l,c,i-1,a];case"down":return[o+1,s,u,a];case"left":return[l,c,o,s-1];case"right":return[i,a+1,u,h];default:return null}}getFarthestCollection(e,r,n,i){const[s,o,a,l]=e,c=["up","down"].indexOf(n)>-1,u=c?a:l,h=c?s:o,f=this.getAutofillSize(e,r,n),d=c?a-s+1:l-o+1,g=Math.floor(f/d)*d,m=f-g;let p=null,y=null,S=null;switch(n){case"up":p="includesVertically",S=u-m+1;break;case"left":p="includesHorizontally",S=u-m+1;break;case"down":p="includesVertically",S=h+m-1;break;case"right":p="includesHorizontally",S=h+m-1;break}return J(i,C=>{C[p](S)&&C.isFarther(y,n)&&(y=C)}),y}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const r=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,s=(c,u)=>{switch(i){case"up":return c.row-u>=r.from.row;case"down":return c.row+c.rowspan-1+u<=r.to.row;case"left":return c.col-u>=r.from.column;case"right":return c.col+c.colspan-1+u<=r.to.column;default:return null}};let o=0,a=null,l=1;do for(let c=0;c<n.length;c+=1){if(a=n[c],o=l*this.currentFillData.cycleLength,s(a,o))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan});break}c===n.length-1&&(l+=1)}while(s(a,o));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const r={min:null,max:null},n={min:null,max:null};return J(e,i=>{const s=i[0],o=this.plugin.hot.propToCol(i[1]);(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s),(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o)}),{from:{row:r.min,column:n.min},to:{row:r.max,column:n.max}}}dragAreaOverlapsCollections(e,r,n){const i=this.getDragArea(e,r,n),[s,o,a,l]=i,c=this.plugin.hot._createCellCoords(s,o),u=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(c,c,u);return this.mergedCellsCollection.getWithinRange(h,!0).length>0}}function T1(t,e,r){return(e=yse(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yse(t){var e=xse(t,"string");return typeof e=="symbol"?e:e+""}function xse(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sse{constructor(e){T1(this,"plugin",void 0),T1(this,"hot",void 0),T1(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,r,n,i){const s=Math.min(n[0],n[2]),o=Math.min(n[1],n[3]),a=Math.max(n[0],n[2]),l=Math.max(n[1],n[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,r))return;const u=this.plugin.mergedCellsCollection.get(e,r);if(!u)return;const h=u.getLastRow(),f=u.getLastColumn();if(s<=u.row&&o<=u.col&&a>=h&&l>=f)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,r){const n=[];if(!r||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let s=0;s<e.colspan;s+=1)n.push(this.hot._createCellCoords(e.row+i,e.col+s));for(let i=0;i<n.length;i+=1){const s=[];for(let o=0;o<r.length;o+=1)s[o]=r[o].includes(n[i]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let r=0;r<=7;r+=1)e.push(`${this.fullySelectedMergedCellClassName}-${r}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function bse(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const r=t.mergedCellsCollection.get(e[0],e[1]);if(r.row===e[0]&&r.col===e[1]&&r.row+r.rowspan-1===e[2]&&r.col+r.colspan-1===e[3])return this.getTranslatedPhrase(VS)}return this.getTranslatedPhrase(BS)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:r,to:n}=e;t.toggleMerge(e),this.selectCell(r.row,r.col,n.row,n.col,!1)},disabled(){const e=this.getSelectedLast();return e?oo.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function hd(t,e,r){return(e=Ese(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ese(t){var e=Rse(t,"string");return typeof e=="symbol"?e:e+""}function Rse(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vI{constructor(e){hd(this,"data",void 0),hd(this,"next",null),hd(this,"prev",null),this.data=e}}class dm{constructor(){hd(this,"first",null),hd(this,"last",null)}push(e){const r=new vI(e);if(this.first===null)this.first=r,this.last=r;else{const n=this.last;this.last=r,r.prev=n,n.next=r}return r}unshift(e){const r=new vI(e);if(this.first===null)this.first=r,this.last=r;else{const n=this.first;this.first=r,r.next=n,n.prev=r}}inorder(e){let r=this.first;for(;r;){const n=e(r);if(r===this.last||n===!0)break;r=r.next}}remove(e){if(this.first===null)return!1;let r=this.first,n,i;for(;r;){if(r.data===e)return n=r.next,i=r.prev,n&&(n.prev=i),i&&(i.next=n),r===this.first&&(this.first=n),r===this.last&&(this.last=i),!0;r=r.next}return!1}hasCycle(){let e=this.first,r=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,r=r.next,e===r)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(n,i){i&&(e(i,i.next),i.next=n)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const r=this.first;this.first=this.last,this.last=r}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,r=this.first,n;for(;e;)n=e.next,e.next=r,r.prev=e,r=e,e=n;this.first.next=null,this.last.prev=null,n=this.first,this.first=r,this.last=n}}function Tse(t,e){$N(t,e),e.add(t)}function Ql(t,e,r){$N(t,e),e.set(t,r)}function $N(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pt(t,e){return t.get(Kp(t,e))}function di(t,e,r){return t.set(Kp(t,e),r),r}function Kp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ks=new WeakMap,Xs=new WeakMap,qs=new WeakMap,Js=new WeakMap,sx=new WeakMap,gm=new WeakMap,mm=new WeakMap,_1=new WeakSet;class _se{constructor(e){let{mergedCellsGetter:r,rowIndexMapper:n,columnIndexMapper:i}=e;Tse(this,_1),Ql(this,Ks,new dm),Ql(this,Xs,new dm),Ql(this,qs,null),Ql(this,Js,null),Ql(this,sx,null),Ql(this,gm,null),Ql(this,mm,null),di(sx,this,r),di(gm,this,n),di(mm,this,i)}getCurrentVerticalNode(){return Pt(Js,this).data}getFirstVerticalNode(){return Pt(Xs,this).first.data}getNextVerticalNode(){return Pt(Js,this).next.data}getPrevVerticalNode(){return Pt(Js,this).prev.data}getCurrentHorizontalNode(){return Pt(qs,this).data}getFirstHorizontalNode(){return Pt(Ks,this).first.data}getNextHorizontalNode(){return Pt(qs,this).next.data}getPrevHorizontalNode(){return Pt(qs,this).prev.data}setPrevNodeAsActive(){di(Js,this,Pt(Js,this).prev),di(qs,this,Pt(qs,this).prev)}setNextNodeAsActive(){di(Js,this,Pt(Js,this).next),di(qs,this,Pt(qs,this).next)}buildFocusOrder(e){const r=e.getTopStartCorner(),n=e.getBottomEndCorner(),i=new WeakSet;di(Ks,this,new dm);for(let o=r.row;o<=n.row;o++)if(!Pt(gm,this).isHidden(o))for(let a=r.col;a<=n.col;a++){if(Pt(mm,this).isHidden(a))continue;const l=Kp(_1,this,wI).call(this,e,Pt(Ks,this),i,o,a);l&&di(qs,this,l)}Pt(Ks,this).first&&(Pt(Ks,this).first.prev=Pt(Ks,this).last,Pt(Ks,this).last.next=Pt(Ks,this).first);const s=new WeakSet;di(Xs,this,new dm);for(let o=r.col;o<=n.col;o++)if(!Pt(mm,this).isHidden(o))for(let a=r.row;a<=n.row;a++){if(Pt(gm,this).isHidden(a))continue;const l=Kp(_1,this,wI).call(this,e,Pt(Xs,this),s,a,o);l&&di(Js,this,l)}Pt(Xs,this).first&&(Pt(Xs,this).first.prev=Pt(Xs,this).last,Pt(Xs,this).last.next=Pt(Xs,this).first)}setActiveNode(e,r){return Pt(Ks,this).inorder(n=>{const{rowStart:i,rowEnd:s,colStart:o,colEnd:a}=n.data;if(e>=i&&e<=s&&r>=o&&r<=a)return di(qs,this,n),!1}),Pt(Xs,this).inorder(n=>{const{rowStart:i,rowEnd:s,colStart:o,colEnd:a}=n.data;if(e>=i&&e<=s&&r>=o&&r<=a)return di(Js,this,n),!1}),this}}function wI(t,e,r,n,i){const s=t.getTopStartCorner(),o=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=Pt(sx,this).call(this,n,i);if(l&&r.has(l))return null;const c={colStart:i,colEnd:i,rowStart:n,rowEnd:n};if(l){if(r.add(l),l.row<s.row||l.row+l.rowspan-1>o.row||l.col<s.col||l.col+l.colspan-1>o.col)return null;c.colStart=l.col,c.colEnd=l.col+l.colspan-1,c.rowStart=l.row,c.rowEnd=l.row+l.rowspan-1}const u=e.push(c);return n===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?u:null}function Ase(t){const{hot:e}=t,{rowIndexMapper:r,columnIndexMapper:n}=e;function i(){}function s(o,a,l){const c=t.mergedCellsCollection.get(a,l);if(!dt(c)){o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="";return}const{row:u,col:h,colspan:f,rowspan:d}=c,[g,m]=t.translateMergedCellToRenderable(u,d,h,f),p=r.getRenderableFromVisualIndex(a),y=n.getRenderableFromVisualIndex(l),S=g-p+1,C=m-y+1,A=r.getNearestNotHiddenIndex(u,1),I=n.getNearestNotHiddenIndex(h,1),O=Math.min(d,S),_=Math.min(f,C);A===a&&I===l?(o.setAttribute("rowspan",O),o.setAttribute("colspan",_)):(o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="none")}return{before:i,after:s}}function Ise(t,e){BN(t,e),e.add(t)}function pm(t,e,r){BN(t,e),e.set(t,r)}function BN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function A1(t,e,r){return(e=Mse(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mse(t){var e=Ose(t,"string");return typeof e=="symbol"?e:e+""}function Ose(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bd(t,e,r){return t.set(Nt(t,e),r),r}function qt(t,e){return t.get(Nt(t,e))}function Nt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}We.getSingleton().register("beforeMergeCells");We.getSingleton().register("afterMergeCells");We.getSingleton().register("beforeUnmergeCells");We.getSingleton().register("afterUnmergeCells");const fd="mergeCells",Pse=150,CI=fd;var Ki=new WeakMap,Xi=new WeakMap,fo=new WeakMap,yI=new WeakMap,Dt=new WeakSet;class kse extends kt{constructor(){super(...arguments),Ise(this,Dt),A1(this,"mergedCellsCollection",null),A1(this,"autofillCalculations",null),A1(this,"selectionCalculations",null),pm(this,Ki,null),pm(this,Xi,{row:0,col:0}),pm(this,fo,new _se({mergedCellsGetter:(e,r)=>this.mergedCellsCollection.get(e,r),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),pm(this,yI,Ase(this))}static get PLUGIN_KEY(){return fd}static get PLUGIN_PRIORITY(){return Pse}isEnabled(){return!!this.hot.getSettings()[fd]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Yp(this),this.autofillCalculations=new Cse(this),this.selectionCalculations=new Sse(this),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,Nse).call(e,...n)}),this.addHook("modifyTransformFocus",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,Hse).call(e,...n)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,Dse).call(e,...n)}),this.addHook("modifyTransformEnd",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,Lse).call(e,...n)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,$se).call(e,...n)}),this.addHook("beforeSetRangeStart",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,xI).call(e,...n)}),this.addHook("beforeSetRangeStartOnly",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,xI).call(e,...n)}),this.addHook("beforeSelectionFocusSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,Wse).call(e,...n)}),this.addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,Use).call(e,...n)}),this.addHook("afterSelectionEnd",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,jse).call(e,...n)}),this.addHook("modifyGetCellCoords",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,Bse).call(e,...n)}),this.addHook("afterIsMultipleSelection",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,Fse).call(e,...n)}),this.addHook("afterRenderer",function(){return qt(yI,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,Vse).call(e,...n)}),this.addHook("afterGetCellMeta",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,zse).call(e,...n)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,Gse).call(e,...n)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,Yse).call(e,...n)}),this.addHook("modifyAutofillRange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,Kse).call(e,...n)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,Xse).call(e,...n)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,qse).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,Jse).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,Zse).call(e,...n)}),this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,Qse).call(e,...n)}),this.addHook("beforeDrawBorders",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,eoe).call(e,...n)}),this.addHook("afterDrawSelection",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,toe).call(e,...n)}),this.addHook("beforeRemoveCellClassNames",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,roe).call(e,...n)}),this.addHook("beforeBeginEditing",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,noe).call(e,...n)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nt(Dt,e,ioe).call(e,...n)}),this.addHook("beforeUndoStackChange",(r,n)=>{if(n==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[fd];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!_P())return;const e=[];let r=[];this.mergedCellsCollection.mergedCells.forEach(n=>{const{row:i,rowspan:s}=n;for(let o=i+1;o<i+s;o++)r.push(o)}),r=[...new Set(r)],r.forEach(n=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(n);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>(s==null?void 0:s.name)==="master"?s:s.clone.wtTable).forEach(s=>{const o=s.getRow(i);o&&(o.style.background=Ed(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))})}),this.hot._registerTimeout(()=>{e.forEach(n=>{n.style.background=Ed(n,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?oo.containsNegativeValues(e)?(Ft(oo.NEGATIVE_VALUES_WARNING(e)),!1):oo.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Ft(oo.IS_OUT_OF_BOUNDS_WARNING(e)),!1):oo.isSingleCell(e)?(Ft(oo.IS_SINGLE_CELL(e)),!1):oo.containsZeroSpan(e)?(Ft(oo.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(e){if(!Array.isArray(e))return;const r=e.filter(s=>this.validateSetting(s)),n=this.mergedCellsCollection.filterOverlappingMergeCells(r),i=[];n.forEach(s=>{const{row:o,col:a,rowspan:l,colspan:c}=s,u=this.hot._createCellCoords(o,a),h=this.hot._createCellCoords(o+l-1,a+c-1),f=this.hot._createCellRange(u,u,h);this.mergeRange(f,!0,!0);for(let d=o;d<o+l;d++)for(let g=a;g<a+c;g++)(d!==o||g!==a)&&i.push([d,g,null])}),i.length!==0&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:r,to:n}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(r.row,r.col,n.row,n.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:r,to:n}=e;this.unmergeRange(e,!0),this.hot.selectCell(r.row,r.col,n.row,n.col,!1)}mergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),s=e.getBottomEndCorner(),o={row:i.row,col:i.col,rowspan:s.row-i.row+1,colspan:s.col-i.col+1},a=[];let l=null;return this.canMergeRange(o,r)?(this.hot.runHooks("beforeMergeCells",e,r),Ge(0,o.rowspan-1,u=>{Ge(0,o.colspan-1,h=>{let f=null;a[u]||(a[u]=[]),u===0&&h===0?f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+u,o.col+h,"hidden",!0),a[u][h]=f})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),this.mergedCellsCollection.add(o,r)?(n?l=[o.row,o.col,a]:this.hot.populateFromArray(o.row,o.col,a,void 0,void 0,this.pluginName),r||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,r),l):!0):!1}unmergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.mergedCellsCollection.getWithinRange(e);n.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,r),J(n,i=>{this.mergedCellsCollection.remove(i.row,i.col),Ge(0,i.rowspan-1,s=>{Ge(0,i.colspan-1,o=>{this.hot.removeCellMeta(i.row+s,i.col+o,"hidden"),this.hot.removeCellMeta(i.row+s,i.col+o,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,r),this.hot.render())}toggleMerge(e){const r=this.mergedCellsCollection.get(e.from.row,e.from.col);r.row===e.from.row&&r.col===e.from.col&&r.row+r.rowspan-1===e.to.row&&r.col+r.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,r,n,i){const s=this.hot._createCellCoords(e,r),o=this.hot._createCellCoords(n,i);this.mergeRange(this.hot._createCellRange(s,s,o))}unmerge(e,r,n,i){const s=this.hot._createCellCoords(e,r),o=this.hot._createCellCoords(n,i);this.unmergeRange(this.hot._createCellRange(s,s,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const n=this.hot.getSelectedRangeLast();n&&!n.isSingleHeader()&&(this.toggleMerge(n),this.hot.render())},runOnlyIf:n=>!n.altKey,group:CI})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(CI)}modifyViewportRowStart(e,r){const n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(i,s);if(dt(o)){const a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,r);return}}}}modifyViewportRowEnd(e,r){const n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(i,s);if(dt(o)){const a=o.row+o.rowspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,r);return}}}}modifyViewportColumnStart(e,r){const n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(s,i);if(dt(o)){const a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,r);return}}}}modifyViewportColumnEnd(e,r){const n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(s,i);if(dt(o)){const a=o.col+o.colspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,r);return}}}}translateMergedCellToRenderable(e,r,n,i){const{rowIndexMapper:s,columnIndexMapper:o}=this.hot;let a,l;r===0?a=s.getNearestNotHiddenIndex(e,1):a=s.getNearestNotHiddenIndex(e+r-1,-1),i===0?l=o.getNearestNotHiddenIndex(n,1):l=o.getNearestNotHiddenIndex(n+i-1,-1);const c=e>=0?s.getRenderableFromVisualIndex(a):e,u=n>=0?o.getRenderableFromVisualIndex(l):n;return[c,u]}}function Nse(){this.generateFromSettings(this.hot.getSettings()[fd]),this.hot.render()}function Fse(t){if(t){const e=this.mergedCellsCollection.mergedCells,r=this.hot.getSelectedRangeLast(),n=r.getTopStartCorner(),i=r.getBottomEndCorner();for(let s=0;s<e.length;s+=1)if(n.row===e[s].row&&n.col===e[s].col&&i.row===e[s].row+e[s].rowspan-1&&i.col===e[s].col+e[s].colspan-1)return!1}return t}function Hse(t){qt(Xi,this).row=t.row,qt(Xi,this).col=t.col}function Dse(t){const e=this.hot.getSelectedRangeLast(),{highlight:r}=e,{columnIndexMapper:n,rowIndexMapper:i}=this.hot;qt(Ki,this)&&(i.getRenderableFromVisualIndex(qt(Ki,this).row)!==null&&(r.row=qt(Ki,this).row),n.getRenderableFromVisualIndex(qt(Ki,this).col)!==null&&(r.col=qt(Ki,this).col),Bd(Ki,this,null));const s=this.mergedCellsCollection.get(r.row,r.col);if(!s)return;const o=s.col,a=s.col+s.colspan-1;if(t.col<0){const u=r.col>=o&&r.col<=a?o-1:a,h=n.getNearestNotHiddenIndex(u,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,r.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,r.col)-1,1)}else if(t.col>0){const u=r.col>=o&&r.col<=a?a+1:o,h=n.getNearestNotHiddenIndex(u,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(r.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,h)-1,1)}const l=s.row,c=s.row+s.rowspan-1;if(t.row<0){const u=r.row>=l&&r.row<=c?l-1:c,h=i.getNearestNotHiddenIndex(u,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,r.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,r.row)-1,1)}else if(t.row>0){const u=r.row>=l&&r.row<=c?c+1:l,h=i.getNearestNotHiddenIndex(u,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(r.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,h)-1,1)}}function Lse(t){const e=this.hot.getSelectedRangeLast(),r=e.clone(),{to:n}=e,{columnIndexMapper:i,rowIndexMapper:s}=this.hot,o=(a,l)=>{r.expand(this.hot._createCellCoords(a,l));for(let c=0;c<this.mergedCellsCollection.mergedCells.length;c+=1)r.expandByRange(this.mergedCellsCollection.mergedCells[c].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,n.col)+t.col;o(n.row,a),e.getHorizontalDirection()==="E-W"&&r.getHorizontalDirection()==="E-W"&&(a=r.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,n.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,n.col)+t.col;o(n.row,a),e.getHorizontalDirection()==="W-E"&&r.getHorizontalDirection()==="W-E"&&(a=r.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,n.row)+t.row;o(a,n.col),e.getVerticalDirection()==="S-N"&&r.getVerticalDirection()==="S-N"&&(a=r.getTopStartCorner().row);const l=s.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,n.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,n.row)+t.row;o(a,n.col),e.getVerticalDirection()==="N-S"&&r.getVerticalDirection()==="N-S"&&(a=r.getBottomStartCorner().row);const l=s.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,l)-1,1))}}function $se(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Bd(Ki,this,e.clone());return}for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);const r=this.mergedCellsCollection.get(e.row,e.col);Bd(Ki,this,e.clone()),r&&e.assign(r)}function Bse(t,e){if(t<0||e<0)return;const r=this.mergedCellsCollection.get(t,e);if(!r)return;const{row:n,col:i,colspan:s,rowspan:o}=r;return[n,i,n+o-1,i+s-1]}function Vse(t){t.items.push({name:"---------"},bse(this))}function xI(){Bd(Ki,this,null)}function Wse(){if(qt(Ki,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),r=t.getHorizontalDirection(),n=qt(Ki,this).clone().normalize();qt(fo,this).setActiveNode(n.row,n.col),qt(Xi,this).row>0||qt(Xi,this).col>0?qt(fo,this).setPrevNodeAsActive():(r==="E-W"&&qt(Xi,this).col<0||e==="S-N"&&qt(Xi,this).row<0)&&qt(fo,this).setNextNodeAsActive()}function Use(t,e){const r=this.hot.getSelectedRangeLast(),{columnIndexMapper:n,rowIndexMapper:i}=this.hot;let s=null,o=null;if(qt(Xi,this).col<0){const{rowEnd:a,colEnd:l}=qt(fo,this).getPrevHorizontalNode();o=n.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1)}else if(qt(Xi,this).col>0){const{rowStart:a,colStart:l}=qt(fo,this).getNextHorizontalNode();o=n.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1)}else if(qt(Xi,this).row<0){const{rowEnd:a,colEnd:l}=qt(fo,this).getPrevVerticalNode();o=n.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1)}else if(qt(Xi,this).row>0){const{rowStart:a,colStart:l}=qt(fo,this).getNextVerticalNode();o=n.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1)}if(s!==null||o!==null){const a=this.hot._createCellCoords(s,o),l=this.mergedCellsCollection.get(a.row,a.col),c=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?r.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):r.highlight.assign(a),c.clear(),c.add(a).commit()}qt(fo,this).setActiveNode(t,e),Bd(Xi,this,{row:0,col:0})}function jse(){this.hot.getSelectedRangeLast().isHeader()||qt(fo,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function zse(t,e,r){const n=this.mergedCellsCollection.get(t,e);n&&(n.row!==t||n.col!==e?r.copyable=!1:(r.rowspan=n.rowspan,r.colspan=n.colspan))}function Gse(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Yse(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Kse(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const r=this.autofillCalculations.getDirection(e,t);let n=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,n,r))return n=e,n;const i=this.hot._createCellCoords(e[0],e[1]),s=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(i,i,s),a=this.mergedCellsCollection.getWithinRange(o);return a.length===0||(n=this.autofillCalculations.snapDragArea(e,n,r,a)),n}function Xse(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function qse(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Jse(t,e,r){r!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Zse(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Qse(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function eoe(t,e){if(e&&e==="area"){const r=this.hot.getSelectedRangeLast(),n=this.mergedCellsCollection.getWithinRange(r);J(n,i=>{r.getBottomEndCorner().row===i.getLastRow()&&r.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function toe(t,e,r,n){if(r)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,r,n)}function roe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function noe(t,e,r,n){if(!(n instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getByRange(i);if(!s)return;const o=this.hot._createCellCoords(s.row,s.col),a=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(o,o,a))}function ioe(t,e,r){if(this.hot.getSettings().rowHeaders||r==="bottom"||r==="bottom_inline_start_corner")return t;let n,i;if(r==="master")n=this.hot.view.getFirstRenderedVisibleColumn(),i=this.hot.view.getLastRenderedVisibleColumn();else{const f=this.hot.view.getOverlayByName(r);n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(f.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(f.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,n))return t;const o=this.hot._createCellCoords(e,n),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(o,o,a),c=this.mergedCellsCollection.getWithinRange(l),u=c.reduce((f,d)=>{let{rowspan:g}=d;return Math.max(f,g)},1);let h=0;return c.length>1&&c[0].rowspan<u&&(h=u-c[0].rowspan),c.forEach(f=>{var d;let{rowspan:g}=f,m=0;r==="top"||r==="top_inline_start_corner"?m=Math.min(u,this.hot.view.countNotHiddenFixedRowsTop()-e):m=g-h,t=Math.max((d=t)!==null&&d!==void 0?d:0,Nt(Dt,this,soe).call(this,e,m))}),t}function soe(t,e){const r=this.hot.view._wt.wtSettings.getSettingPure("defaultRowHeight"),n=this.hot.getPlugin("autoRowSize");let i=0;for(let o=t;o<t+e;o++)if(!this.hot.rowIndexMapper.isHidden(o)){var s;i+=(s=n==null?void 0:n.getRowHeight(o))!==null&&s!==void 0?s:r}return i}function ooe(t,e){return function(r,n){const[,...i]=r,[,...s]=n;return function o(a){const l=t[a],c=e[a],u=i[a],h=s[a],f=c.multiColumnSorting,g=(f.compareFunctionFactory?f.compareFunctionFactory:v2(c.type))(l,c,f)(u,h);if(g===vo){const m=a+1;if(typeof e[m]<"u")return o(m)}return g}(0)}}function SI(){Ft(Ht`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const VN="sort";function aoe(t,e,r){const n=[];return r===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&n.push(`${VN}-${t.getIndexOfColumnInSortQueue(e)+1}`),n}function loe(t){const e=t.className.split(" "),r=new RegExp(`^${VN}-[0-9]{1,2}$`);return e.filter(n=>r.test(n))}function coe(t,e,r){return(e=uoe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uoe(t){var e=hoe(t,"string");return typeof e=="symbol"?e:e+""}function hoe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Xp="multiColumnSorting",foe=170,I1="columnSorting",bI=Xp;p2(Xp,ooe);class doe extends T2{constructor(){super(...arguments),coe(this,"pluginKey",Xp)}static get PLUGIN_KEY(){return Xp}static get PLUGIN_PRIORITY(){return foe}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[I1]&&(SI(),this.hot.getPlugin(I1).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Op)),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.isHeader()},relativeToGroup:dl,position:"before",group:bI})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(bI)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];super.updateHeaderClasses(e,...n),it(e,loe(e)),this.enabled!==!1&&_e(e,aoe(...n))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[I1]&&SI(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,r){sE(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(r.col),this.sort(this.getNextSortConfig(r.col,Op))):this.sort(this.getColumnNextConfig(r.col)))}}function EI(t,e,r){return(e=goe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function goe(t){var e=moe(t,"string");return typeof e=="symbol"?e:e+""}function moe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const poe="multipleSelectionHandles",voe=160;class woe extends kt{constructor(){super(...arguments),EI(this,"dragged",[]),EI(this,"lastSetCell",null)}static get PLUGIN_KEY(){return poe}static get PLUGIN_PRIORITY(){return voe}isEnabled(){return za()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:r}=this.hot;function n(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(i);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(r,"touchstart",i=>{let s;if(Qe(i.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1;if(Qe(i.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchend",i=>{if(Qe(i.target,"topSelectionHandle-HitArea"))return n.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(Qe(i.target,"bottomSelectionHandle-HitArea"))return n.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchmove",i=>{const{rootDocument:s}=this.hot;let o,a,l,c,u,h;if(e.dragged.length===0)return;const f=s.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!f||f===e.lastSetCell||((f.nodeName==="TD"||f.nodeName==="TH")&&(o=e.hot.getCoords(f),o.col===-1&&(o.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),c=a.getHeight(),u=a.getDirection(),l===1&&c===1&&e.hot.selection.setRangeEnd(o),h=e.getCurrentRangeCoords(a,o,e.touchStartRange.direction,u,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=f),i.preventDefault())})}getCurrentRangeCoords(e,r,n,i,s){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),c=e.getTopEndCorner();let u={start:null,end:null};switch(n){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":s==="top"?u={start:this.hot._createCellCoords(r.row,e.highlight.col),end:this.hot._createCellCoords(l.row,r.col)}:u={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,o.col)};break;case"SE-NW":s==="bottom"&&(u={start:this.hot._createCellCoords(a.row,r.col),end:this.hot._createCellCoords(r.row,o.col)});break}break;case"NW-SE":switch(i){case"NE-SW":s==="top"?u={start:r,end:l}:u.end=r;break;case"NW-SE":s==="top"?u={start:r,end:a}:u.end=r;break;case"SE-NW":s==="top"?u={start:r,end:o}:u.end=r;break;case"SW-NE":s==="top"?u={start:r,end:c}:u.end=r;break}break;case"SW-NE":switch(i){case"NW-SE":s==="bottom"?u={start:this.hot._createCellCoords(r.row,o.col),end:this.hot._createCellCoords(l.row,r.col)}:u={start:this.hot._createCellCoords(o.row,r.col),end:this.hot._createCellCoords(r.row,a.col)};break;case"SW-NE":s==="top"?u={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,a.col)}:u={start:this.hot._createCellCoords(r.row,o.col),end:this.hot._createCellCoords(o.row,r.col)};break;case"SE-NW":s==="bottom"?u={start:this.hot._createCellCoords(r.row,c.col),end:this.hot._createCellCoords(o.row,r.col)}:s==="top"&&(u={start:l,end:r});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(u.end=r);break;case"SE-NW":s==="top"?u.end=r:u={start:r,end:o};break}break}return u}isDragged(){return this.dragged.length>0}}function ox(){let{label:t="",colspan:e=1,origColspan:r=1,collapsible:n=!1,crossHiddenColumns:i=[],isCollapsed:s=!1,isHidden:o=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:c=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:r,collapsible:n,isCollapsed:s,crossHiddenColumns:i,isHidden:o,isRoot:a,isPlaceholder:l,headerClassNames:c}}function WN(){return{label:"",isPlaceholder:!0}}function Coe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const r=[];if(e===0)return r;J(t,i=>{const s=[];let o=0;r.push(s),J(i,a=>{const l=ox();if(dt(a)){const{label:u,colspan:h,headerClassName:f}=a;l.label=Nr(u),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof f=="string"&&(l.headerClassNames=[...f.split(" ")])}else l.label=Nr(a);o+=l.origColspan;let c=!1;if(o>=e&&(l.colspan=l.origColspan-(o-e),l.origColspan=l.colspan,c=!0),s.push(l),l.colspan>1)for(let u=0;u<l.colspan-1;u++)s.push(WN());return!c})});const n=Math.max(...bt(r,i=>i.length));return J(r,i=>{if(i.length<n){const s=bt(new Array(n-i.length),()=>ox());i.splice(i.length,0,...s)}}),r}function M1(t,e,r){yoe(t,e),e.set(t,r)}function yoe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hs(t,e){return t.get(UN(t,e))}function Of(t,e,r){return t.set(UN(t,e),r),r}function UN(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const RI=["label","collapsible"];var Wo=new WeakMap,ec=new WeakMap,O1=new WeakMap;class xoe{constructor(){M1(this,Wo,[]),M1(this,ec,0),M1(this,O1,1/0)}setColumnsLimit(e){Of(O1,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Of(Wo,this,Coe(e,hs(O1,this))),Of(ec,this,hs(Wo,this).length)}getData(){return hs(Wo,this)}mergeWith(e){J(e,r=>{let{row:n,col:i,...s}=r;const o=this.getHeaderSettings(n,i);o!==null&&Ur(o,s,RI)})}map(e){J(hs(Wo,this),r=>{J(r,n=>{const i=e({...n});dt(i)&&Ur(n,i,RI)})})}getHeaderSettings(e,r){var n;if(e>=hs(ec,this)||e<0)return null;const i=hs(Wo,this)[e];return Array.isArray(i)===!1||r>=i.length?null:(n=i[r])!==null&&n!==void 0?n:null}getHeadersSettings(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=hs(ec,this)||e<0)return i;const s=hs(Wo,this)[e];let o=0;for(let a=r;a<s.length;a++){const l=s[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),o===n)break;if(o>n)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return hs(ec,this)}getColumnsCount(){return hs(ec,this)>0?hs(Wo,this)[0].length:0}clear(){Of(Wo,this,[]),Of(ec,this,0)}}function P1(t,e,r){return(e=Soe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Soe(t){var e=boe(t,"string");return typeof e=="symbol"?e:e+""}function boe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const jN="DF-pre-order";function zN(t,e){let r=t.call(e,this);for(let n=0;n<this.childs.length;n++){if(r===!1)return!1;r=zN.call(this.childs[n],t,e)}return r}const Eoe="DF-post-order";function GN(t,e){for(let r=0;r<this.childs.length;r++)if(GN.call(this.childs[r],t,e)===!1)return!1;return t.call(e,this)}const YN="BF";function Roe(t,e){const r=[this];function n(){if(r.length===0)return;const i=r.shift();r.push(...i.childs),t.call(e,i)!==!1&&n()}n()}const Toe=YN,TI=new Map([[jN,zN],[Eoe,GN],[YN,Roe]]);class qp{constructor(e){P1(this,"data",{}),P1(this,"parent",null),P1(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const r=new qp({...e.data});for(let n=0;n<e.childs.length;n++)r.addChild(this.cloneTree(e.childs[n]));return r}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let r=0;r<e.childs.length;r++)this.addChild(e.childs[r])}walkDown(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Toe;if(!TI.has(r))throw new Error(`Traversal strategy "${r}" does not exist`);TI.get(r).call(this,e,this)}walkUp(e){const r=this,n=i=>{e.call(r,i)!==!1&&i.parent!==null&&n(i.parent)};n(this)}}function k1(t,e,r){_oe(t,e),e.set(t,r)}function _oe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nn(t,e){return t.get(KN(t,e))}function Aoe(t,e,r){return t.set(KN(t,e),r),r}function KN(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Pu=new WeakMap,tc=new WeakMap,ku=new WeakMap;class Ioe{constructor(e){k1(this,Pu,new Map),k1(this,tc,new Map),k1(this,ku,null),Aoe(ku,this,e)}getRoots(){return Array.from(Nn(Pu,this).values())}getRootByColumn(e){let r;return Nn(tc,this).has(e)&&(r=Nn(Pu,this).get(Nn(tc,this).get(e))),r}getNode(e,r){const n=this.getRootByColumn(r);if(!n)return;const i=r-Nn(tc,this).get(r);let s=0,o;return n.walkDown(a=>{const{data:{origColspan:l,headerLevel:c}}=a;if(e===c){if(i>=s&&i<=s+l-1)return o=a,o.data.isRoot=r===o.data.columnIndex,!1;s+=l}}),o}rebuildTreeIndex(){let e=0;Nn(tc,this).clear(),J(Nn(Pu,this),r=>{let[,{data:{colspan:n}}]=r;for(let i=e;i<e+n;i++)Nn(tc,this).set(i,e);e+=n})}buildTree(){this.clear();const e=Nn(ku,this).getColumnsCount();let r=0;for(;r<e;){const n=Nn(ku,this).getHeaderSettings(0,r),i=new qp;Nn(Pu,this).set(r,i),this.buildLeaves(i,r,0,n.origColspan),r+=n.origColspan}this.rebuildTreeIndex()}buildLeaves(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=Nn(ku,this).getHeadersSettings(n,r,i);n+=1,J(s,o=>{const a={...o,headerLevel:n-1,columnIndex:r};let l;n===1?(e.data=a,l=e):(l=new qp(a),e.addChild(l)),n<Nn(ku,this).getLayersCount()&&this.buildLeaves(l,r,n,o.origColspan),r+=o.origColspan})}clear(){Nn(Pu,this).clear(),Nn(tc,this).clear()}}function XN(t,e){t.walkDown(r=>{let{data:n,childs:i}=r;if(!n.isHidden&&(e(n.columnIndex),i.length===0))for(let s=1;s<n.colspan;s++)e(n.columnIndex+s)})}function Jp(t,e){let{childs:r}=t;if(r.length!==0)return r[0].data[e]}function Zp(t){return Jp(t,"origColspan")===t.data.origColspan}function yE(t){const{data:e,childs:r}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Zp(t))return yE(r[0]);e.isCollapsed=!1;const i=r.slice(1),s=new Set;let o=0;if(i.length>0)J(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;o+=l.colspan,XN(a,c=>{s.add(c)})});else{const{colspan:a,origColspan:l,columnIndex:c}=e;o=l-a;for(let u=1;u<l;u++)s.add(c+u)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=o,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Zp(a)&&(l.isCollapsed=Jp(a,"isCollapsed"))}),{rollbackModification:()=>xE(t),affectedColumns:Array.from(s),colspanCompensation:o}}function xE(t){var e;const{data:r,childs:n}=t;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Zp(t))return xE(n[0]);r.isCollapsed=!0;const s=n.slice(1),o=new Set;if(s.length>0)J(s,l=>{XN(l,c=>{o.add(c)}),l.data.clonedTree=l.cloneTree(),l.walkDown(c=>{let{data:u}=c;u.isHidden=!0})});else{const{origColspan:l,columnIndex:c}=r;for(let u=1;u<l;u++){const h=c+u;o.add(h)}}const a=r.colspan-((e=Jp(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:c}=l;c.colspan-=a,c.colspan<=1?(c.colspan=1,c.isCollapsed=!0):Zp(l)&&(c.isCollapsed=Jp(l,"isCollapsed"))}),{rollbackModification:()=>yE(t),affectedColumns:Array.from(o),colspanCompensation:a}}function Moe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Ht`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(r.includes(e))return;let n=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return n=!0,!1}),!n&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function Ooe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Ht`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(!r.includes(e))return;let n=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return n=!0,!1}),!n&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const _I=new Map([["collapse",xE],["expand",yE],["hide-column",Moe],["show-column",Ooe]]);function Poe(t,e,r){if(!_I.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return _I.get(t)(e,r)}function vm(t){const e=[];return J(t,r=>{r.walkDown(n=>{const i=n.data,{origColspan:s,columnIndex:o,headerLevel:a,crossHiddenColumns:l}=i,c=Noe(e,a);let u=!1;for(let h=o;h<o+s;h++)if(l.includes(h)||u)c.push(WN());else{const d=koe(i);d.isRoot=!0,c.push(d),u=!0}})}),e}function koe(t){const{crossHiddenColumns:e,...r}=ox(t);return r}function Noe(t,e){let r;return Array.isArray(t[e])?r=t[e]:(r=[],t[e]=r),r}function N1(t,e,r){Foe(t,e),e.set(t,r)}function Foe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pf(t,e,r){return t.set(qN(t,e),r),r}function dr(t,e){return t.get(qN(t,e))}function qN(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Zs=new WeakMap,Qn=new WeakMap,rc=new WeakMap;class Hoe{constructor(){N1(this,Zs,new xoe),N1(this,Qn,new Ioe(dr(Zs,this))),N1(this,rc,[[]])}setState(e){dr(Zs,this).setData(e);let r=!1;try{dr(Qn,this).buildTree()}catch{dr(Qn,this).clear(),dr(Zs,this).clear(),r=!0}return Pf(rc,this,vm(dr(Qn,this).getRoots())),r}setColumnsLimit(e){dr(Zs,this).setColumnsLimit(e)}mergeStateWith(e){const r=bt(e,n=>{let{row:i,...s}=n;return{row:i<0?this.rowCoordsToLevel(i):i,...s}});dr(Zs,this).mergeWith(r),dr(Qn,this).buildTree(),Pf(rc,this,vm(dr(Qn,this).getRoots()))}mapState(e){dr(Zs,this).map(e),dr(Qn,this).buildTree(),Pf(rc,this,vm(dr(Qn,this).getRoots()))}mapNodes(e){return Gn(dr(Qn,this).getRoots(),(r,n)=>(n.walkDown(i=>{const s=e(i.data);s!==void 0&&r.push(s)}),r),[])}triggerNodeModification(e,r,n){r<0&&(r=this.rowCoordsToLevel(r));const i=dr(Qn,this).getNode(r,n);let s;return i&&(s=Poe(e,i,n),Pf(rc,this,vm(dr(Qn,this).getRoots()))),s}triggerColumnModification(e,r){return this.triggerNodeModification(e,-1,r)}rowCoordsToLevel(e){if(e>=0)return null;const r=e+Math.max(this.getLayersCount(),1);return r<0?null:r}levelToRowCoords(e){if(e<0)return null;const r=e-Math.max(this.getLayersCount(),1);return r>=0?null:r}getHeaderSettings(e,r){var n,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(n=(i=dr(rc,this)[e])===null||i===void 0?void 0:i[r])!==null&&n!==void 0?n:null}getHeaderTreeNodeData(e,r){const n=this.getHeaderTreeNode(e,r);return n?{...n.data}:null}getHeaderTreeNode(e,r){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const n=dr(Qn,this).getNode(e,r);return n||null}findTopMostEntireHeaderLevel(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=n-e+1;let s=!1,o=null;for(let a=e;a<=n;a++){const l=dr(Qn,this).getRootByColumn(a);if(!l)break;s=!0,l.walkDown(c=>{const{columnIndex:u,headerLevel:h,origColspan:f,isHidden:d}=c.data;d||f<=i&&u>=e&&u+f-1<=n&&(o===null||h<o)&&(o=h)},jN)}return s&&o===null?-1:this.levelToRowCoords((r=o)!==null&&r!==void 0?r:0)}findLeftMostColumnIndex(e,r){var n;const{isRoot:i}=(n=this.getHeaderSettings(e,r))!==null&&n!==void 0?n:{isRoot:!0};if(i)return r;let s=r-1;for(;s>=0;){var o;const{isRoot:a}=(o=this.getHeaderSettings(e,s))!==null&&o!==void 0?o:{isRoot:!0};if(a)break;s-=1}return s}findRightMostColumnIndex(e,r){var n;const{isRoot:i,origColspan:s}=(n=this.getHeaderSettings(e,r))!==null&&n!==void 0?n:{isRoot:!0,origColspan:1};if(i)return r+s-1;let o=r+1;for(;o<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;o+=1}return o-1}getLayersCount(){return dr(Zs,this).getLayersCount()}getColumnsCount(){return dr(Zs,this).getColumnsCount()}clear(){Pf(rc,this,[]),dr(Zs,this).clear(),dr(Qn,this).clear()}}function kf(t,e,r){return(e=Doe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Doe(t){var e=Loe(t,"string");return typeof e=="symbol"?e:e+""}function Loe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $oe{constructor(e,r){kf(this,"hot",void 0),kf(this,"nestedHeaderSettingsGetter",void 0),kf(this,"layersCount",0),kf(this,"container",void 0),kf(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),r=e.length;this.widthsMap.clear();for(let n=0;n<r;n++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),s=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(s,e[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:r,columnIndexMapper:n}=this.hot,i=r.createDocumentFragment(),s=r.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,a=n.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const c=r.createElement("tr");for(let u=0;u<a;u++){let h=n.getVisualFromRenderableIndex(u);h===null&&(h=u);const f=r.createElement("th"),d=this.nestedHeaderSettingsGetter(l,h);if(d&&(!d.isPlaceholder||d.isHidden)){let g=d.label;o&&(g+='<button class="changeType"></button>'),xh(f,g),f.colSpan=d.colspan,c.appendChild(f)}}s.appendChild(c)}i.appendChild(s),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function Boe(t,e){JN(t,e),e.add(t)}function AI(t,e,r){return(e=Voe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Voe(t){var e=Woe(t,"string");return typeof e=="symbol"?e:e+""}function Woe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wm(t,e,r){JN(t,e),e.set(t,r)}function JN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gc(t,e,r){return t.set(gr(t,e),r),r}function Rt(t,e){return t.get(gr(t,e))}function gr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const II="nestedHeaders",Uoe=280;var Vt=new WeakMap,Pa=new WeakMap,dd=new WeakMap,ew=new WeakMap,br=new WeakSet;class joe extends kt{constructor(){super(...arguments),Boe(this,br),wm(this,Vt,new Hoe),wm(this,Pa,null),wm(this,dd,null),wm(this,ew,!1),AI(this,"ghostTable",new $oe(this.hot,(e,r)=>this.getHeaderSettings(e,r))),AI(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return II}static get PLUGIN_PRIORITY(){return Uoe}isEnabled(){return!!this.hot.getSettings()[II]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();(!Array.isArray(r)||!Array.isArray(r[0]))&&Ft(Ht`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>gr(br,this,oae).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return gr(br,e,aae).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return gr(br,e,Koe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return gr(br,e,Xoe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return gr(br,e,qoe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return gr(br,e,Joe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return gr(br,e,Zoe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return gr(br,e,Qoe).call(e,...i)}),this.addHook("afterSelection",()=>gr(br,this,Cm).call(this)),this.addHook("afterSelectionFocusSet",()=>gr(br,this,Cm).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return gr(br,e,zoe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",n=>gr(br,this,tae).call(this,n)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return gr(br,e,nae).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return gr(br,e,iae).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return gr(br,e,Goe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return gr(br,e,Yoe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return gr(br,e,eae).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return gr(br,e,rae).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return gr(br,e,sae).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>gr(br,this,Cm).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>gr(br,this,Cm).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Rt(Vt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Rt(Vt,this).setState(e)),this.detectedOverlappedHeaders&&Ft(Ht`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((r,n)=>{const i=r===!0?"hide-column":"show-column";Rt(Vt,this).triggerColumnModification(i,n)}),!Rt(Pa,this)&&this.enabled&&gc(Pa,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(r=>{r.forEach(n=>{let{op:i,index:s,newValue:o}=n;if(i==="replace"){const a=o===!0?"hide-column":"show-column";Rt(Vt,this).triggerColumnModification(a,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Rt(Vt,this).clear(),Rt(Pa,this).unsubscribe(),gc(Pa,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Rt(Vt,this)}getLayersCount(){return Rt(Vt,this).getLayersCount()}getHeaderSettings(e,r){return Rt(Vt,this).getHeaderSettings(e,r)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,r=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<r;o++){const a=n.childNodes[o];if(!a)break;const l=i.childNodes[o],c=s?s.childNodes[o]:null;for(let u=0,h=a.childNodes.length;u<h;u++)a.childNodes[u].removeAttribute("colspan"),it(a.childNodes[u],"hiddenHeader"),l&&l.childNodes[u]&&(l.childNodes[u].removeAttribute("colspan"),it(l.childNodes[u],"hiddenHeader")),s&&c&&c.childNodes[u]&&(c.childNodes[u].removeAttribute("colspan"),it(c.childNodes[u],"hiddenHeader"))}}headerRendererFactory(e){var r=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,s)=>{var o;const{columnIndexMapper:a,view:l}=this.hot;let c=a.getVisualFromRenderableIndex(i);c===null&&(c=i),s.removeAttribute("colspan"),it(s,"hiddenHeader");const{colspan:u,isHidden:h,isPlaceholder:f,headerClassNames:d}=(o=Rt(Vt,this).getHeaderSettings(e,c))!==null&&o!==void 0?o:{label:""};if(f||h)_e(s,"hiddenHeader");else if(u>1){var g,m;const{wtOverlays:p}=l._wt,y=(g=p.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(s),S=(m=p.inlineStartOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(s),C=y||S?Math.min(u,n-i):u;C>1&&s.setAttribute("colspan",C)}if(this.hot.view.appendColHeader(c,s,function(){return r.getColumnHeaderValue(...arguments)},e),!f&&!h){const p=s.querySelector("div.relative");p&&d&&d.length>0&&(it(p,this.hot.getColumnMeta(c).headerClassName),_e(p,d))}}}getColumnHeaderValue(e,r){var n;const{isHidden:i,isPlaceholder:s}=(n=Rt(Vt,this).getHeaderSettings(r,e))!==null&&n!==void 0?n:{};return s||i?"":this.hot.getColHeader(e,r)}destroy(){gc(Vt,this,null),Rt(Pa,this)!==null&&(Rt(Pa,this).unsubscribe(),gc(Pa,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Rt(Vt,this).getHeaderTreeNodeData(e.row,e.col)}}function Cm(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:r}=e;if(r.isHeader()&&r.col>=0){const i=Rt(Vt,this).findLeftMostColumnIndex(r.row,r.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=i,s.visualCellRange.from.col=i,s.visualCellRange.to.col=i,s.commit()}}function zoe(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:r}=e;if(!(r.isHeader()&&r.col>=0))return t;const i=this.hot.view.getFirstFullyVisibleColumn(),s=this.hot.view.getLastFullyVisibleColumn(),o=Rt(Vt,this).findLeftMostColumnIndex(r.row,r.col),a=Rt(Vt,this).findRightMostColumnIndex(r.row,r.col);return o<i&&a>s?t:o<i?o:a}function Goe(t,e,r){const n=Rt(Vt,this).getHeaderTreeNodeData(e,t);if(!n)return t;const{columnCursor:i,selectionType:s,selectionWidth:o}=r,{isRoot:a,colspan:l}=Rt(Vt,this).getHeaderSettings(e,t);if(s===oS){if(!a)return n.columnIndex}else if(s===sk&&(l>o-i||!a))return null;return t}function Yoe(t,e,r){let{columnHeadersCount:n}=r;if(n!==0)for(let s=0;s<e.length;s++){const{startRow:o,startCol:a,endRow:l,endCol:c}=e[s],u=l-o+1,h=a-c+1;if(o>=0||h===1)break;for(let f=a;f<=c;f++)for(let d=o;d<=l;d++){var i;const g=u+d,m=f-a;if(m===0)continue;((i=Rt(Vt,this).getHeaderTreeNodeData(d,f))===null||i===void 0?void 0:i.isRoot)===!1&&(t[g][m]="")}}}function Koe(t,e,r,n){this._getHeaderTreeNodeDataByCoords(e)&&(n.column=!0)}function Xoe(t,e){const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;gc(dd,this,e.clone()),gc(ew,this,!0);const{selection:n}=this.hot,i=n.isSelected()?n.getSelectedRange().current():null,s=[],{columnIndex:o,origColspan:a}=r,l=!n.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?s.push(i.getTopEndCorner().col,o,e.row):e.col>i.from.col?s.push(i.getTopStartCorner().col,o+a-1,e.row):s.push(o,o+a-1,e.row):(Gx(t)||bc(t)&&l||m6(t))&&s.push(o,o+a-1,e.row),n.selectColumns(...s)}function qoe(t,e,r,n){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:s,origColspan:o}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),c=a.getBottomEndCorner(),{from:u}=a;n.column=!0,n.cell=!0;const h=[],f=$t(e.row,-1/0,-1);e.col<u.col?h.push(c.col,s,f):e.col>u.col?h.push(l.col,s+o-1,f):h.push(s,s+o-1,f),this.hot.selection.selectColumns(...h)}function Joe(){gc(ew,this,!1)}function Zoe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Rt(ew,this)||!t)return;const e=this.hot.getSelectedRangeLast(),r=e.getTopStartCorner().col,n=e.getBottomEndCorner().col,{columnIndex:i,origColspan:s}=Rt(Vt,this).getHeaderTreeNodeData(Rt(dd,this).row,Rt(dd,this).col);if(e.setHighlight(Rt(dd,this)),s>e.getWidth()||i<r||i+s-1>n){const o=Rt(Vt,this).findTopMostEntireHeaderLevel($t(r,i,i+s-1),$t(n,i,i+s-1));e.highlight.row=o,e.highlight.col=e.from.col}}function Qoe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),r=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(r.isHeader()&&r.col>=0))return;const i=Rt(Vt,this).findLeftMostColumnIndex(r.row,r.col),s=Rt(Vt,this).findRightMostColumnIndex(r.row,r.col);if(t.col<0){const o=e.col>=i&&e.col<=s?i-1:s,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const o=e.col>=i&&e.col<=s?s+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function eae(t,e){const r=t.row,n=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});e.col<t.col?(n&&(t.col=n.columnIndex+n.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(n&&(t.col=n.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function tae(t){t.length=0;for(let e=0;e<Rt(Vt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function rae(t){const e=Rt(Vt,this).getLayersCount();let r=t.startColumn,n=!!e;for(let i=0;i<e;i++){const s=Rt(Vt,this).findLeftMostColumnIndex(i,t.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(n=!1),Wn(o)&&o<t.startColumn){r=o;break}}t.startColumn=n?Rt(Vt,this).getHeaderTreeNodeData(0,r).columnIndex:r}function nae(t,e){const r=this.ghostTable.getWidth(e);return t>r?t:r}function iae(t,e,r){var n;const{label:i}=(n=Rt(Vt,this).getHeaderTreeNodeData(r,e))!==null&&n!==void 0?n:{label:""};return i}function sae(t,e){if(t<0)return this.hot.getCell(t,Rt(Vt,this).findLeftMostColumnIndex(t,e),!0)}function oae(){this.updatePlugin()}function aae(t,e){e||this.updatePlugin()}function Nf(t,e,r){return(e=lae(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lae(t){var e=cae(t,"string");return typeof e=="symbol"?e:e+""}function cae(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uae{constructor(e,r){Nf(this,"hot",void 0),Nf(this,"data",null),Nf(this,"plugin",void 0),Nf(this,"parentReference",new WeakMap),Nf(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=r,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ge(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,r,n){this.cache.levels[r]||(this.cache.levels[r]=[],this.cache.levelCount+=1),this.cache.levels[r].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:r}),this.hasChildren(e)&&J(e.__children,i=>{this.cacheNode(i,r+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,r,n,i){let s=!1,o=r;if(isNaN(o)&&o.end)return o;let a=e;return a||(a={__children:this.data},s=!0,o-=1),n!=null&&o===n?{result:a,end:!0}:i!=null&&a===i?{result:o,end:!0}:(o+=1,a.__children&&J(a.__children,l=>{if(this.parentReference.set(l,s?null:a),o=this.readTreeNodes(l,o,n,i),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return gt(this.data[0],(r,n)=>{e[n]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let r=null;isNaN(e)?r=e:r=this.getDataObject(e);const n=this.getRowParent(e);return n==null?this.data.indexOf(r):n.__children.indexOf(r)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let r=0,n=e;return isNaN(n)||(n=this.getDataObject(n)),!n||!n.__children?0:(J(n.__children,i=>{r+=1,i.__children&&(r+=this.countChildren(i))}),r)}getRowParent(e){let r;return isNaN(e)?r=e:r=this.getDataObject(e),this.getRowObjectParent(r)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let r=null;return isNaN(e)?r=e:r=this.getDataObject(e),r?this.getRowObjectLevel(r):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let r=e;return isNaN(r)||(r=this.getDataObject(r)),!!(r.__children&&r.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,r){var n;return((n=e.__children)===null||n===void 0?void 0:n[r])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var r;let n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&((r=n.__children)===null||r===void 0?void 0:r.length)!==0}addChild(e,r){let n=r;this.hot.runHooks("beforeAddChild",e,n);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),n||(n=this.mockNode()),s.__children.push(n),this.rewriteCache();const o=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,n)}addChildAtIndex(e,r,n){let i=n,s;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,r),e){const a=this.getRowIndex(e)+r+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(r,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),s=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",r,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[r]);i=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,i,r)}addSibling(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const n=this.translateTrimmedRow(e),i=this.getRowParent(n),s=this.getRowIndexWithinParent(n);switch(r){case"below":this.addChildAtIndex(i,s+1,null);break;case"above":this.addChildAtIndex(i,s,null);break}}detachFromParent(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=null;const i=[];Array.isArray(e)?(Ge(e[0],e[2],f=>{const d=this.translateTrimmedRow(f);i.push(this.getDataObject(d))}),Ge(0,i.length-2,f=>{this.detachFromParent(i[f],!1)}),n=i[i.length-1]):n=e;const s=this.getRowIndex(n),o=this.countChildren(n),a=this.getRowIndexWithinParent(n),l=this.getRowParent(n),c=this.getRowParent(l),u=this.getRowIndex(c);let h=null;if(this.hot.runHooks("beforeDetachChild",l,n),a!=null){const f=Array.from(new Array(s+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",s,o+1,f,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,o+1,f,this.plugin.pluginName),c){h=u+this.countChildren(c);const d=this.getChild(c,this.countChildren(c)-1),g=this.getRowIndex(d);this.hot.runHooks("beforeCreateRow",g+1,o+1,this.plugin.pluginName),c.__children.push(n)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,o+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,n,this.getRowIndex(n)),r&&this.hot.render()}filterData(e,r,n){const i=[];J(n,s=>{i.push(this.getDataObject(s))}),J(i,s=>{const o=this.getRowIndexWithinParent(s),a=this.getRowParent(s);a===null?this.data.splice(o,1):a.__children.splice(o,1)}),this.rewriteCache()}spliceData(e,r,n){const i=this.getDataObject(e-1);let s=null,o=e;i&&i.__children&&i.__children.length===0?(s=i,o=0):e<this.countAllRows()&&(s=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),s?n?s.__children.splice(o,r,...n):s.__children.splice(o,r):n?this.data.splice(o,r,...n):this.data.splice(o,r),this.rewriteCache()}syncRowWithRawSource(e){let r=e,n=null;do n=this.getRowParent(n),n!==null&&(r=n);while(n!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(r),"__children",r.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,r,n,i){const s=r===this.hot.countRows(),o=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=o.__children.slice(a,a+1),c=e>r;let u=s?this.getRowParent(r-1):this.getRowParent(r);u==null&&(u=this.getRowParent(r-1)),u==null&&(u=this.getDataObject(r-1)),u?u.__children||(u.__children=[]):(u=this.getDataObject(r),u.__children=[]);const h=s||n||i?u.__children.length:this.getRowIndexWithinParent(r),f=o===u;u.__children.splice(h,0,l[0]),o.__children.splice(a+(c&&f?1:0),1),this.syncRowWithRawSource(o),f||this.syncRowWithRawSource(u)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function MI(t,e,r){return(e=hae(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hae(t){var e=fae(t,"string");return typeof e=="symbol"?e:e+""}function fae(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SE{constructor(e,r){MI(this,"hot",void 0),MI(this,"plugin",void 0),this.hot=r,this.plugin=e}}class co extends SE{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,r){super(e,r),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,r){const n=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(n),s=this.dataManager.getDataObject(n),o=r.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),l=o.querySelectorAll('[class^="ht_nesting"]'),c=this.hot.getSettings().ariaTags;if(J(l,u=>{u&&o.removeChild(u)}),_e(r,co.CSS_CLASSES.indicatorContainer),i){const{rootDocument:u}=this.hot,h=a.cloneNode(!0);o.innerHTML="",Ge(0,i-1,()=>{const f=u.createElement("SPAN");_e(f,co.CSS_CLASSES.emptyIndicator),o.appendChild(f)}),o.appendChild(h)}if(this.dataManager.hasChildren(s)){const u=this.hot.rootDocument.createElement("DIV");c&&Ze(u,[Wc()]),_e(r,co.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?(_e(u,`${co.CSS_CLASSES.button} ${co.CSS_CLASSES.expandButton}`),c&&Ze(r,[qi(!1)])):(_e(u,`${co.CSS_CLASSES.button} ${co.CSS_CLASSES.collapseButton}`),c&&Ze(r,[qi(!0)])),o.appendChild(u)}}updateRowHeaderWidth(e){let r=e;r||(r=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*r+25),this.hot.render()}}class dae extends SE{constructor(e,r){var n;super(e,r),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,i)},shiftStash:function(i,s){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),J(n.lastCollapsedRows,(a,l)=>{a>=i&&a<s&&(n.lastCollapsedRows[l]=a+o)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;n.collapseMultipleChildren(n.lastCollapsedRows,i),n.lastCollapsedRows=void 0},trimStash:(i,s)=>{Ge(i,i+s-1,o=>{const a=this.lastCollapsedRows.indexOf(o);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(s)&&J(s.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),n&&this.trimRows(a),r&&this.renderAndAdjust(),this.collapsedRows.indexOf(o)===-1&&this.collapsedRows.push(o),a}collapseMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];J(e,s=>{i.push(...this.collapseChildren(s,!1,!1))}),n&&this.trimRows(i),r&&this.renderAndAdjust()}collapseRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],r)}collapseRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return J(e,s=>{i.push(s),r&&this.collapseChildRows(s,i)}),n&&this.trimRows(i),i}collapseChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);J(i.__children,s=>{const o=this.dataManager.getRowIndex(s);r.push(o),this.collapseChildRows(o,r)})}n&&this.trimRows(r)}expandRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],r)}expandRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return J(e,s=>{i.push(s),r&&this.expandChildRows(s,i)}),n&&this.untrimRows(i),i}expandChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);J(i.__children,s=>{if(!this.isAnyParentCollapsed(s)){const o=this.dataManager.getRowIndex(s);r.push(o),this.expandChildRows(o,r)}})}n&&this.untrimRows(r)}expandChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(s)&&J(s.__children,l=>{const c=this.dataManager.getRowIndex(l);i.push(c)}),a=this.expandRows(i,!0,!1),n&&this.untrimRows(a),r&&this.renderAndAdjust(),a}expandMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];J(e,s=>{i.push(...this.expandChildren(s,!1,!1))}),n&&this.untrimRows(i),r&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),r=[];J(e,n=>{this.dataManager.hasChildren(n)&&r.push(n)}),this.collapseMultipleChildren(r),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),r=[];J(e,n=>{this.dataManager.hasChildren(n)&&r.push(n)}),this.expandMultipleChildren(r),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{J(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{J(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!1)})},!0)}areChildrenCollapsed(e){let r=isNaN(e)?e:this.dataManager.getDataObject(e),n=!0;return r===null&&(r={__children:this.dataManager.data}),this.dataManager.hasChildren(r)&&J(r.__children,i=>{const s=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return n=!1,!1}),n}isAnyParentCollapsed(e){let r=e;for(;r!==null;){r=this.dataManager.getRowParent(r);const n=this.dataManager.getRowIndex(r);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}toggleState(e,r){if(r.col>=0)return;const n=this.translateTrimmedRow(r.row);Qe(e.target,co.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),ks(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function gae(t,e,r){mae(t,e),e.set(t,r)}function mae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pae(t,e,r){return(e=vae(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vae(t){var e=wae(t,"string");return typeof e=="symbol"?e:e+""}function wae(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cae(t,e){return t.get(yae(t,e))}function yae(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var OI=new WeakMap;class xae extends SE{constructor(){super(...arguments),pae(this,"dataManager",this.plugin.dataManager),gae(this,OI,{row_above:(e,r)=>{const n=r[r.length-1];this.dataManager.addSibling(n.start.row,"above")},row_below:(e,r)=>{const n=r[r.length-1];this.dataManager.addSibling(n.start.row,"below")}})}appendOptions(e){const r=[{key:"add_child",name(){return this.getTranslatedPhrase(QS)},callback:()=>{const n=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(n);this.dataManager.addChild(i)},disabled:()=>{const n=this.hot.getSelectedLast();return!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(eb)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const n=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(n[0]);return!this.dataManager.getRowParent(i)||!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Ge(0,e.items.length-1,n=>{if(n===0)return J(r,(i,s)=>{e.items.splice(n+s,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return Ge(0,e.items.length-1,r=>{const n=Cae(OI,this)[e.items[r].key];n!=null&&(e.items[r].callback=n)}),e}}function ym(t,e,r){return(e=Sae(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sae(t){var e=bae(t,"string");return typeof e=="symbol"?e:e+""}function bae(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Eae{constructor(e){ym(this,"plugin",void 0),ym(this,"hot",void 0),ym(this,"dataManager",void 0),ym(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,r,n,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:r,dropIndex:n,movePossible:i}))return!1;this.movedToCollapsed=!1;const o=n===this.hot.countRows(),a=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let l=!0;const c=e.map(g=>{if(!l)return!1;const m=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(m,a),m}),u=c.indexOf(a)===-1;if(!l||!u)return!1;const h=this.getBaseParent(c),f=this.getTargetParent(o,a),d=h===f;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(f),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,a,d),this.moveRows(c,a,f),this.dataManager.rewriteCache(),this.moveCellsMeta(c,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,r,n,i,i&&this.isRowOrderChanged(e,r)),this.hot.render(),this.selectCells(e,n),!1}displayAPICompatibilityWarning(e){const{rows:r,finalIndex:n,dropIndex:i,movePossible:s}=e;let o=!1;return tr(i)&&(Ft(Ht`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",r,n,i,s,!1),o=!0),o}shouldAllowMoving(e,r){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===r||r===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,r){let n=this.dataManager.getRowParent(e?r-1:r);return n==null&&(n=this.dataManager.getRowParent(r-1)),n}shiftCollapsibleParentsLocations(e,r,n){n||(Math.max(...e)<=r?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],r,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(r,e[0],e.length))}moveRows(e,r,n){const i=r===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,r,this.movedToCollapsed,i)})})}moveCellsMeta(e,r){const n=[],i=Math.max(...e)<r;e.forEach(s=>{n.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(r-(i?n.length:0),0,...n)}selectCells(e,r){const n=e.length;let i=0,s=0,o=null,a=null;if(this.movedToCollapsed){let l=null;e[n-1]<r?l=this.dataManager.translateTrimmedRow(r-n):l=this.dataManager.translateTrimmedRow(r);const c=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),u=this.dataManager.getRowIndex(c);i=this.dataManager.untranslateTrimmedRow(u),s=i}else e[n-1]<r?(s=r-1,i=s-n+1):(i=r,s=i+n-1);o=this.hot.selection,a=this.hot.countCols()-1,o.setRangeStart(this.hot._createCellCoords(i,0)),o.setRangeEnd(this.hot._createCellCoords(s,a),!0)}isRowOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}}function Rae(t,e){ZN(t,e),e.add(t)}function PI(t,e,r){ZN(t,e),e.set(t,r)}function ZN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function F1(t,e,r){return(e=Tae(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Tae(t){var e=_ae(t,"string");return typeof e=="symbol"?e:e+""}function _ae(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tp(t,e){return t.get(Xr(t,e))}function Qp(t,e,r){return t.set(Xr(t,e),r),r}function Xr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const ev="nestedRows",Aae=300,kI=ev,Iae="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var tw=new WeakMap,Nu=new WeakMap,en=new WeakSet;class Mae extends kt{constructor(){super(...arguments),Rae(this,en),F1(this,"dataManager",null),F1(this,"headersUI",null),F1(this,"collapsedRowsMap",null),PI(this,tw,!1),PI(this,Nu,!1)}static get PLUGIN_KEY(){return ev}static get PLUGIN_PRIORITY(){return Aae}isEnabled(){return!!this.hot.getSettings()[ev]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new mg),this.dataManager=new uae(this,this.hot),this.collapsingUI=new dae(this,this.hot),this.headersUI=new co(this,this.hot),this.contextMenuUI=new xae(this,this.hot),this.rowMoveController=new Eae(this),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xr(en,e,jae).call(e,...n)}),this.addHook("beforeViewRender",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xr(en,e,zae).call(e,...n)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xr(en,e,kae).call(e,...n)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xr(en,e,Nae).call(e,...n)}),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xr(en,e,Fae).call(e,...n)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xr(en,e,Pae).call(e,...n)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xr(en,e,Lae).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xr(en,e,Dae).call(e,...n)}),this.addHook("beforeAddChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xr(en,e,$ae).call(e,...n)}),this.addHook("afterAddChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xr(en,e,Bae).call(e,...n)}),this.addHook("beforeDetachChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xr(en,e,Vae).call(e,...n)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xr(en,e,Wae).call(e,...n)}),this.addHook("modifyRowHeaderWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xr(en,e,Hae).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xr(en,e,Uae).call(e,...n)}),this.addHook("beforeRowMove",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xr(en,e,Oae).call(e,...n)}),this.addHook("beforeLoadData",r=>Xr(en,this,NI).call(this,r)),this.addHook("beforeUpdateData",r=>Xr(en,this,NI).call(this,r)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),r=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(r)?this.collapsingUI.expandChildren(r):this.collapsingUI.collapseChildren(r),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.col===-1&&n.row>=0},group:kI,relativeToGroup:dl,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(kI)}disableCoreAPIModifiers(){Qp(Nu,this,!0)}enableCoreAPIModifiers(){Qp(Nu,this,!1)}onModifyRowData(e){if(!tp(Nu,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!tp(Nu,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,r,n){return tp(Nu,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,r,n),!1)}destroy(){super.destroy()}}function Oae(t,e,r,n){return this.rowMoveController.onBeforeRowMove(t,e,r,n)}function Pae(t,e,r){this.collapsingUI.toggleState(t,e,r)}function kae(t,e,r){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(r[0],null,-1*e),this.dataManager.filterData(t,e,r),Qp(tw,this,!0),this.dataManager.getData().slice()}function Nae(t){return this.contextMenuUI.appendOptions(t)}function Fae(t,e){this.headersUI.appendLevelIndicators(t,e)}function Hae(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Dae(t,e,r,n){n!==this.pluginName&&this.hot._registerTimeout(()=>{Qp(tw,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Lae(t,e,r){const n=Array.from(r.reduce((i,s)=>{if(this.dataManager.isParent(s)){const o=this.dataManager.getDataObject(s).__children;return i.add(s),Array.isArray(o)&&o.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(s)},new Set));r.length=0,r.push(...n)}function $ae(){this.collapsingUI.collapsedRowsStash.stash()}function Bae(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Vae(){this.collapsingUI.collapsedRowsStash.stash()}function Wae(t,e,r){this.collapsingUI.collapsedRowsStash.shiftStash(r,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Uae(){this.dataManager.rewriteCache()}function jae(){this.headersUI.updateRowHeaderWidth()}function zae(t,e){tp(tw,this)&&(e.skipRender=!0)}function NI(t){if(!n7(t)){Kx(Iae),this.hot.getSettings()[ev]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function H1(t,e,r){return(e=Gae(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gae(t){var e=Yae(t,"string");return typeof e=="symbol"?e:e+""}function Yae(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kae{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;H1(this,"rootWindow",void 0),H1(this,"prefix",void 0),H1(this,"savedKeys",[]),this.rootWindow=r,this.prefix=e,this.loadSavedKeys()}saveValue(e,r){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(r)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,r){const n=typeof e>"u"?r:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${n}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){J(this.savedKeys,(e,r)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[r]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),r=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=r||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function Xae(t,e,r){return(e=qae(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qae(t){var e=Jae(t,"string");return typeof e=="symbol"?e:e+""}function Jae(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}We.getSingleton().register("persistentStateSave");We.getSingleton().register("persistentStateLoad");We.getSingleton().register("persistentStateReset");const FI="persistentState",Zae=0;class Qae extends kt{constructor(){super(...arguments),Xae(this,"storage",void 0)}static get PLUGIN_KEY(){return FI}static get PLUGIN_PRIORITY(){return Zae}isEnabled(){return!!this.hot.getSettings()[FI]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Kae(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,r)=>this.saveValue(e,r)),this.addHook("persistentStateLoad",(e,r)=>this.loadValue(e,r)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,r){r.value=this.storage.loadValue(e)}saveValue(e,r){this.storage.saveValue(e,r)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function ele(t,e){tle(t,e),e.add(t)}function tle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function D1(t,e,r){return(e=rle(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rle(t){var e=nle(t,"string");return typeof e=="symbol"?e:e+""}function nle(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HI(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const L1="search",ile=190,sle="htSearchResult",ole=function(t,e,r,n,i){t.getCellMeta(e,r).isSearchResult=i},ale=function(t,e,r){return tr(t)||t===null||!t.toLocaleLowerCase||t.length===0||tr(e)||e===null?!1:e.toString().toLocaleLowerCase(r.locale).indexOf(t.toLocaleLowerCase(r.locale))!==-1};var $1=new WeakSet;class lle extends kt{constructor(){super(...arguments),ele(this,$1),D1(this,"callback",ole),D1(this,"queryMethod",ale),D1(this,"searchResultClass",sle)}static get PLUGIN_KEY(){return L1}static get PLUGIN_PRIORITY(){return ile}isEnabled(){return this.hot.getSettings()[L1]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[L1];this.updatePluginSettings(r),this.addHook("beforeRenderer",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return HI($1,e,DI).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const r=function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return HI($1,e,DI).call(e,...i)};this.hot.addHook("beforeRenderer",r),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",r)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),s=this.hot.countCols(),o=[],a=this.hot;return Ge(0,i-1,l=>{Ge(0,s-1,c=>{const u=this.hot.getDataAtCell(l,c),h=this.hot.getCellMeta(l,c),f=h.search.callback||r,g=(h.search.queryMethod||n)(e,u,h);if(g){const m={row:l,col:c,data:u};o.push(m)}f&&f(a,l,c,u,g)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){dt(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function DI(t,e,r,n,i,s){const o=s.className||[];let a=[];typeof o=="string"?a=o.split(" "):a.push(...o),this.isEnabled()&&s.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),s.className=a.join(" ")}function cle(t,e){ule(t,e),e.add(t)}function ule(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xm(t,e,r){return(e=hle(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hle(t){var e=fle(t,"string");return typeof e=="symbol"?e:e+""}function fle(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function B1(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const dle="touchScroll",gle=200;var Sm=new WeakSet;class mle extends kt{constructor(){super(...arguments),cle(this,Sm),xm(this,"scrollbars",[]),xm(this,"clones",[]),xm(this,"lockedCollection",!1),xm(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return dle}static get PLUGIN_PRIORITY(){return gle}static get SETTING_KEYS(){return!0}isEnabled(){return TP()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>B1(Sm,this,ple).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>B1(Sm,this,vle).call(this)),this.addHook("afterMomentumScroll",()=>B1(Sm,this,wle).call(this))}}function ple(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:r,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(r),n&&this.scrollbars.push(n),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),n&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function vle(){this.freezeOverlays=!0,J(this.clones,t=>{_e(t,"hide-tween")})}function wle(){this.freezeOverlays=!1,J(this.clones,t=>{it(t,"hide-tween"),_e(t,"show-tween")}),this.hot._registerTimeout(()=>{J(this.clones,t=>{it(t,"show-tween")})},400),J(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Cle(t,e){yle(t,e),e.add(t)}function yle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xle(t,e,r){return(e=Sle(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sle(t){var e=ble(t,"string");return typeof e=="symbol"?e:e+""}function ble(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ele(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const rp="trimRows",Rle=330;var LI=new WeakSet;class Tle extends kt{constructor(){super(...arguments),Cle(this,LI),xle(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return rp}static get PLUGIN_PRIORITY(){return Rle}isEnabled(){return!!this.hot.getSettings()[rp]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new mg),this.trimmedRowsMap.addLocalHook("init",()=>Ele(LI,this,_le).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[rp];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),J(e,r=>{this.trimmedRowsMap.setValueAtIndex(r,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const r=this.getTrimmedRows(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeTrimRow",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{J(e,o=>{this.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),this.hot.runHooks("afterTrimRow",r,i,n,n&&i.length>r.length))}trimRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.trimRows(r)}untrimRows(e){const r=this.getTrimmedRows(),n=this.isValidConfig(e);let i=r;const s=this.trimmedRowsMap.getValues().slice(),o=e.length>0;n&&o&&(J(e,l=>{s[l]=!1}),i=Gn(s,(l,c,u)=>(c&&l.push(u),l),[])),this.hot.runHooks("beforeUntrimRow",r,i,n&&o)!==!1&&(n&&o&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",r,i,n&&o,n&&i.length<r.length))}untrimRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.untrimRows(r)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const r=this.hot.countSourceRows();return e.every(n=>Number.isInteger(n)&&n>=0&&n<r)}destroy(){super.destroy()}}function _le(){const t=this.hot.getSettings()[rp];Array.isArray(t)&&this.hot.batchExecution(()=>{J(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var QN={},Ale=cl,Ile=QN,Mle=Ale("iterator"),Ole=Array.prototype,Ple=function(t){return t!==void 0&&(Ile.Array===t||Ole[Mle]===t)},kle=AO,$I=xv,Nle=pv,Fle=QN,Hle=cl,Dle=Hle("iterator"),eF=function(t){if(!Nle(t))return $I(t,Dle)||$I(t,"@@iterator")||Fle[kle(t)]},Lle=Ps,$le=tg,Ble=ca,Vle=yv,Wle=eF,Ule=TypeError,jle=function(t,e){var r=arguments.length<2?Wle(t):e;if($le(r))return Ble(Lle(r,t));throw new Ule(Vle(t)+" is not iterable")},zle=jO,Gle=Ps,Yle=ca,Kle=yv,Xle=Ple,qle=sg,BI=wv,Jle=jle,Zle=eF,VI=Px,Qle=TypeError,np=function(t,e){this.stopped=t,this.result=e},WI=np.prototype,ece=function(t,e,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),s=!!(r&&r.IS_RECORD),o=!!(r&&r.IS_ITERATOR),a=!!(r&&r.INTERRUPTED),l=zle(e,n),c,u,h,f,d,g,m,p=function(S){return c&&VI(c,"normal",S),new np(!0,S)},y=function(S){return i?(Yle(S),a?l(S[0],S[1],p):l(S[0],S[1])):a?l(S,p):l(S)};if(s)c=t.iterator;else if(o)c=t;else{if(u=Zle(t),!u)throw new Qle(Kle(t)+" is not iterable");if(Xle(u)){for(h=0,f=qle(t);f>h;h++)if(d=y(t[h]),d&&BI(WI,d))return d;return new np(!1)}c=Jle(t,u)}for(g=s?t.next:c.next;!(m=Gle(g,c)).done;){try{d=y(m.value)}catch(S){VI(c,"throw",S)}if(typeof d=="object"&&d&&BI(WI,d))return d}return new np(!1)},tce=Os,rce=ul,nce=mv,ice=function(t,e,r){tce?rce.f(t,e,nce(0,r)):t[e]=r},sce=pn,oce=ece,ace=ice;sce({target:"Object",stat:!0},{fromEntries:function(e){var r={};return oce(e,function(n,i){ace(r,n,i)},{AS_ENTRIES:!0}),r}});const tF="undoRedo",lce="undoRedo";function He(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(n,i){const s=n&&n.length;if(!s||!n.find(l=>{const[,,c,u]=l;return c!==u}))return;const a=()=>{const l=n.reduce((u,h)=>(u.push([...h]),u),[]);J(l,u=>{u[1]=t.propToCol(u[1])});const c=s>1?this.getSelected():[[l[0][0],l[0][1]]];return new He.ChangeAction(l,c)};e.done(a,i)}),t.addHook("afterCreateRow",(n,i,s)=>{e.done(()=>new He.CreateRowAction(n,i),s)});const r=(n,i,s,o)=>{const a=["visualRow","visualCol","row","col","prop"],l=a.length,c=[];return Ge(s,o,u=>{Ge(n,i,h=>{const f=t.getCellMeta(h,u);if(Object.keys(f).length!==l){const d=Object.fromEntries(Object.entries(f).filter(g=>{let[m]=g;return a.includes(m)===!1}));c.push([f.visualRow,f.visualCol,d])}})}),c};t.addHook("beforeRemoveRow",(n,i,s,o)=>{const a=()=>{const l=t.toPhysicalRow(n),c=l+i-1,u=zn(e.instance.getSourceData(l,0,l+i-1,e.instance.countSourceCols()-1));return new He.RemoveRowAction(l,u,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),r(l,c,0,t.countCols()-1))};e.done(a,o)}),t.addHook("afterCreateCol",(n,i,s)=>{e.done(()=>new He.CreateColumnAction(n,i),s)}),t.addHook("beforeRemoveCol",(n,i,s,o)=>{const a=()=>{const l=e.instance.getSourceDataArray(),c=(e.instance.countCols()+n)%e.instance.countCols(),u=c+i-1,h=[],f=[],d=[];Ge(l.length-1,p=>{const y=[],S=l[p];Ge(c,u,C=>{y.push(S[t.toPhysicalColumn(C)])}),h.push(y)}),Ge(i-1,p=>{d.push(t.toPhysicalColumn(c+p))}),Array.isArray(t.getSettings().colHeaders)&&Ge(i-1,p=>{f.push(t.getSettings().colHeaders[t.toPhysicalColumn(c+p)]||null)});const g=t.columnIndexMapper.getIndexesSequence(),m=t.rowIndexMapper.getIndexesSequence();return new He.RemoveColumnAction(c,d,h,f,g,m,t.getSettings().fixedColumnsStart,r(0,t.countRows(),c,u))};e.done(a,o)}),t.addHook("beforeCellAlignment",(n,i,s,o)=>{e.done(()=>new He.CellAlignmentAction(n,i,s,o))}),t.addHook("beforeFilter",(n,i)=>{e.done(()=>new He.FiltersAction(n,i))}),t.addHook("beforeRowMove",(n,i)=>{n!==!1&&e.done(()=>new He.RowMoveAction(n,i))}),t.addHook("beforeColumnMove",(n,i)=>{n!==!1&&e.done(()=>new He.ColumnMoveAction(n,i))}),t.addHook("beforeMergeCells",(n,i)=>{i||e.done(()=>new He.MergeCellsAction(t,n))}),t.addHook("afterUnmergeCells",(n,i)=>{i||e.done(()=>new He.UnmergeCellsAction(t,n))}),t.addHook("beforeColumnSort",(n,i,s)=>{s&&e.done(()=>new He.ColumnSortAction(n,i))}),t.addHook("afterInit",()=>{e.init()})}He.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const n=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",n,e)===!1)return;const s=t(),o=this.undoneActions.slice();this.doneActions.push(s),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())};He.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const r=zn(e);if(this.instance.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",s),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};He.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const r=zn(e);if(this.instance.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",s),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};He.prototype.isUndoAvailable=function(){return this.doneActions.length>0};He.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};He.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};He.prototype.isEnabled=function(){return this.enabled};He.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,hce(t),this.registerShortcuts(),t.addHook("afterChange",rF)};He.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,fce(t),this.unregisterShortcuts(),t.removeHook("afterChange",rF)};He.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};He.Action=function(){};He.Action.prototype.undo=function(){};He.Action.prototype.redo=function(){};He.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};Eo(He.ChangeAction,He.Action);He.ChangeAction.prototype.undo=function(t,e){const r=zn(this.changes),n=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let o=0,a=r.length;o<a;o++)r[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.undo");for(let o=0,a=r.length;o<a;o++){const[l,c]=r[o];t.getSettings().minSpareRows&&l+1+t.getSettings().minSpareRows===t.countRows()&&n===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(l+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&c+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(c+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}const s=t.getSelectedLast();if(s!==void 0){const[o,a]=r[0],[l,c]=s,u=t.view.getFirstFullyVisibleRow(),h=t.view.getFirstFullyVisibleColumn(),f=o>=u,d=a>=h;if((f&&d)===!1&&(l!==o||c!==a)===!0){const p={row:o,col:a};f===!1&&(p.verticalSnap="top"),d===!1&&(p.horizontalSnap="start"),t.scrollViewportTo(p)}}t.selectCells(this.selected,!1,!1)};He.ChangeAction.prototype.redo=function(t,e){const r=zn(this.changes);for(let n=0,i=r.length;n<i;n++)r[n].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};He.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};Eo(He.CreateRowAction,He.Action);He.CreateRowAction.prototype.undo=function(t,e){const r=t.countRows(),n=t.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};He.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};He.RemoveRowAction=function(t,e,r,n,i,s){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=i,this.removedCellMetas=s};Eo(He.RemoveRowAction,He.Action);He.RemoveRowAction.prototype.undo=function(t,e){const r=t.getSettings(),n=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,s)=>{Object.keys(i).forEach(o=>{const a=parseInt(o,10);n.push([this.index+s,isNaN(a)?o:a,i[o]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(i=>{let[s,o,a]=i;t.setCellMetaObject(s,o,a)}),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(n,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};He.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};He.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};Eo(He.CreateColumnAction,He.Action);He.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};He.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};He.RemoveColumnAction=function(t,e,r,n,i,s,o,a){this.index=t,this.indexes=e,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=s.slice(0),this.actionType="remove_col",this.fixedColumnsStart=o,this.removedCellMetas=a};Eo(He.RemoveColumnAction,He.Action);He.RemoveColumnAction.prototype.undo=function(t,e){const r=t.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const n=this.indexes.slice(0).sort(),i=(c,u,h)=>h[this.indexes.indexOf(n[u])],s=this.data.length,o=[];for(let c=0;c<s;c++)o.push(bt(this.data[c],i));const a=bt(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),J(t.getSourceDataArray(),(c,u)=>{J(n,(h,f)=>{c[h]=o[u][f],l.push([u,h,c[h]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&J(a,(c,u)=>{t.getSettings().colHeaders[n[u]]=c}),this.removedCellMetas.forEach(c=>{let[u,h,f]=c;t.setCellMetaObject(u,h,f)}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};He.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};He.CellAlignmentAction=function(t,e,r,n){this.stateBefore=t,this.range=e,this.type=r,this.alignment=n};He.CellAlignmentAction.prototype.undo=function(t,e){J(this.range,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&t.setCellMeta(n,i,"className",this.stateBefore[n][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};He.CellAlignmentAction.prototype.redo=function(t,e){Na(this.range,this.type,this.alignment,(r,n)=>t.getCellMeta(r,n),(r,n,i,s)=>t.setCellMeta(r,n,i,s)),t.addHookOnce("afterViewRender",e),t.render()};He.FiltersAction=function(t,e){this.previousConditionsStack=e,this.conditionsStack=t,this.actionType="filter"};Eo(He.FiltersAction,He.Action);He.FiltersAction.prototype.undo=function(t,e){const r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),this.previousConditionsStack&&r.conditionCollection.importAllConditions(this.previousConditionsStack),r.filter()};He.FiltersAction.prototype.redo=function(t,e){const r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};class cce extends He.Action{constructor(e,r){super(),this.cellRange=r;const n=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(n.row,n.col,i.row,i.col)}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange)}}He.MergeCellsAction=cce;class uce extends He.Action{constructor(e,r){super(),this.cellRange=r}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange,!0)}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0),e.render()}}He.UnmergeCellsAction=uce;He.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalRowIndex=e,this.actionType="row_move"};Eo(He.RowMoveAction,He.Action);He.RowMoveAction.prototype.undo=function(t,e){const r=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),vE(this.rows,this.finalRowIndex,t.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(i=>{let{from:s,to:o}=i;s<o&&(o-=1),r.moveRow(o,s)}),t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};He.RowMoveAction.prototype.redo=function(t,e){const r=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),r.moveRows(this.rows.slice(),this.finalRowIndex),t.render(),t.deselectCell(),t.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)};He.ColumnMoveAction=function(t,e){this.columns=t.slice(),this.finalColumnIndex=e,this.actionType="col_move"};Eo(He.ColumnMoveAction,He.Action);He.ColumnMoveAction.prototype.undo=function(t,e){const r=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),vE(this.columns,this.finalColumnIndex,t.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(i=>{let{from:s,to:o}=i;s<o&&(o-=1),r.moveColumn(o,s)}),t.render(),t.deselectCell(),t.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)};He.ColumnMoveAction.prototype.redo=function(t,e){const r=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),r.moveColumns(this.columns.slice(),this.finalColumnIndex),t.render(),t.deselectCell(),t.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)};He.ColumnSortAction=function(t,e){this.previousSortState=t,this.nextSortState=e};Eo(He.ColumnSortAction,He.Action);He.ColumnSortAction.prototype.undo=function(t,e){const r=t.getPlugin("columnSorting"),n=t.getPlugin("multiColumnSorting"),i=n.isEnabled()?n:r;this.previousSortState.length?i.sort(this.previousSortState):i.clearSort(),e()};He.ColumnSortAction.prototype.redo=function(t,e){const r=t.getPlugin("columnSorting"),n=t.getPlugin("multiColumnSorting");(n.isEnabled()?n:r).sort(this.nextSortState),e()};He.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};He.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),n={runOnlyIf:i=>!i.altKey,group:tF};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],n)};He.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(tF)};function rF(t,e){const r=this;if(e==="loadData")return r.undoRedo.clear()}function hce(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function fce(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const Eg=We.getSingleton();Eg.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});Eg.register("beforeUndo");Eg.register("afterUndo");Eg.register("beforeRedo");Eg.register("afterRedo");He.PLUGIN_KEY=lce;He.SETTING_KEYS=!0;function dce(){_t(qf),_t(WX),_t(Jf),_t(Sq),_t(Mq),_t(T2),_t(EJ),_t(cZ),_t(Xv),_t(AQ),_t(eee),_t(lee),_t(Zv),_t(Hee),_t(Nre),_t(hne),_t(Dne),_t(Kne),_t(oie),_t(vie),_t(_ie),_t(zie),_t(ese),_t(kse),_t(doe),_t(woe),_t(joe),_t(Mae),_t(Qae),_t(lle),_t(mle),_t(Tle),_t(He)}function gce(){vK(),FK(),jK(),uX(),dce()}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var tv={};tv.version="0.18.5";var nF=1252,mce=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],bE={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},EE=function(t){mce.indexOf(t)!=-1&&(nF=bE[0]=t)};function pce(){EE(1252)}var bs=function(t){EE(t)};function RE(){bs(1200),pce()}function UI(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function vce(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function iF(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Wf=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?vce(t.slice(2)):e==254&&r==255?iF(t.slice(2)):e==65279?t.slice(1):t},bm=function(e){return String.fromCharCode(e)},jI=function(e){return String.fromCharCode(e)},ja,qa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Vd(t){for(var e="",r=0,n=0,i=0,s=0,o=0,a=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),s=r>>2,n=t.charCodeAt(c++),o=(r&3)<<4|n>>4,i=t.charCodeAt(c++),a=(n&15)<<2|i>>6,l=i&63,isNaN(n)?a=l=64:isNaN(i)&&(l=64),e+=qa.charAt(s)+qa.charAt(o)+qa.charAt(a)+qa.charAt(l);return e}function Ai(t){var e="",r=0,n=0,i=0,s=0,o=0,a=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=qa.indexOf(t.charAt(c++)),o=qa.indexOf(t.charAt(c++)),r=s<<2|o>>4,e+=String.fromCharCode(r),a=qa.indexOf(t.charAt(c++)),n=(o&15)<<4|a>>2,a!==64&&(e+=String.fromCharCode(n)),l=qa.indexOf(t.charAt(c++)),i=(a&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Ct=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),da=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function sl(t){return Ct?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function zI(t){return Ct?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ri=function(e){return Ct?da(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function rw(t){if(typeof ArrayBuffer>"u")return Ri(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function gl(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function wce(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function TE(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return TE(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var on=Ct?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:da(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Cce(t){for(var e=[],r=0,n=t.length+250,i=sl(t.length+255),s=0;s<t.length;++s){var o=t.charCodeAt(s);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=t.charCodeAt(++s)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|a>>6&15|(o&3)<<4,i[r++]=128|a&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(e.push(i.slice(0,r)),r=0,i=sl(65535),n=65530)}return e.push(i.slice(0,r)),on(e)}var Un=/\u0000/g,Uf=/[\u0001-\u0006]/g;function rh(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Es(t,e){var r=""+t;return r.length>=e?r:Tr("0",e-r.length)+r}function _E(t,e){var r=""+t;return r.length>=e?r:Tr(" ",e-r.length)+r}function rv(t,e){var r=""+t;return r.length>=e?r:r+Tr(" ",e-r.length)}function yce(t,e){var r=""+Math.round(t);return r.length>=e?r:Tr("0",e-r.length)+r}function xce(t,e){var r=""+t;return r.length>=e?r:Tr("0",e-r.length)+r}var GI=Math.pow(2,32);function Fu(t,e){if(t>GI||t<-GI)return yce(t,e);var r=Math.round(t);return xce(r,e)}function nv(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var YI=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],V1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Sce(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"ä¸å/ä¸å "hh"æ"mm"å"ss"ç§ "',t}var et={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸å/ä¸å "hh"æ"mm"å"ss"ç§ "'},KI={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},bce={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function iv(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,o=1,a=0,l=1,c=0,u=0,h=Math.floor(i);c<e&&(h=Math.floor(i),a=h*o+s,u=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=o,o=a,l=c,c=u;if(u>e&&(c>e?(u=l,a=s):(u=c,a=o)),!r)return[0,n*a,u];var f=Math.floor(n*a/u);return[f,n*a-f*u,u]}function mc(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,o=[],a={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),e&&e.date1904&&(n+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++n,++a.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=Ice(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}var sF=new Date(1899,11,31,0,0,0),Ece=sF.getTime(),Rce=new Date(1900,2,1,0,0,0);function oF(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=Rce&&(r+=24*60*60*1e3),(r-(Ece+(t.getTimezoneOffset()-sF.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function AE(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Tce(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function _ce(t){var e=t<0?12:11,r=AE(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function Ace(t){var e=AE(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Wd(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=_ce(t):e===10?r=t.toFixed(10).substr(0,12):r=Ace(t),AE(Tce(r.toUpperCase()))}function Mc(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Wd(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return es(14,oF(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function Ice(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function Mce(t,e,r,n){var i="",s=0,o=0,a=r.y,l,c=0;switch(t){case 98:a=r.y+543;case 121:switch(e.length){case 1:case 2:l=a%100,c=2;break;default:l=a%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return V1[r.m-1][1];case 5:return V1[r.m-1][0];default:return V1[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return YI[r.q][0];default:return YI[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Es(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(i=Es(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=a,c=1;break}var u=c>0?Es(l,c):"";return u}function Ja(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var aF=/%/g;function Oce(t,e,r){var n=e.replace(aF,""),i=e.length-n.length;return ra(t,n,r*Math.pow(10,2*i))+Tr("%",i)}function Pce(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ra(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function lF(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+lF(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var cF=/# (\?+)( ?)\/( ?)(\d+)/;function kce(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),o=i-s*n,a=n;return r+(s===0?"":""+s)+" "+(o===0?Tr(" ",t[1].length+1+t[4].length):_E(o,t[1].length)+t[2]+"/"+t[3]+Es(a,t[4].length))}function Nce(t,e,r){return r+(e===0?"":""+e)+Tr(" ",t[1].length+2+t[4].length)}var uF=/^#*0*\.([0#]+)/,hF=/\).*[0#]/,fF=/\(###\) ###\\?-####/;function Ln(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function XI(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function qI(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Fce(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function Hce(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Di(t,e,r){if(t.charCodeAt(0)===40&&!e.match(hF)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Di("n",n,r):"("+Di("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Pce(t,e,r);if(e.indexOf("%")!==-1)return Oce(t,e,r);if(e.indexOf("E")!==-1)return lF(e,r);if(e.charCodeAt(0)===36)return"$"+Di(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,o,a,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Fu(l,e.length);if(e.match(/^[#?]+$/))return i=Fu(r,0),i==="0"&&(i=""),i.length>e.length?i:Ln(e.substr(0,e.length-i.length))+i;if(s=e.match(cF))return kce(s,l,c);if(e.match(/^#+0+$/))return c+Fu(l,e.length-e.indexOf("0"));if(s=e.match(uF))return i=XI(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Ln(s[1])).replace(/\.$/,"."+Ln(s[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+Tr("0",Ln(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+XI(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+Ja(Fu(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Di(t,e,-r):Ja(""+(Math.floor(r)+Fce(r,s[1].length)))+"."+Es(qI(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Di(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=rh(Di(t,e.replace(/[\\-]/g,""),r)),o=0,rh(rh(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(e.match(fF))return i=Di(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=iv(l,Math.pow(10,o)-1,!1),i=""+c,u=ra("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=rv(a[2],o),u.length<s[4].length&&(u=Ln(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=iv(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?_E(a[1],o)+s[2]+"/"+s[3]+rv(a[2],o):Tr(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Fu(r,0),e.length<=i.length?i:Ln(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=e.indexOf(".")-o,f=e.length-i.length-h;return Ln(e.substr(0,h)+i+e.substr(e.length-f))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=qI(r,s[1].length),r<0?"-"+Di(t,e,-r):Ja(Hce(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Es(0,3-g.length):"")+g})+"."+Es(o,s[1].length);switch(e){case"###,##0.00":return Di(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=Ja(Fu(l,0));return d!=="0"?c+d:"";case"###,###.00":return Di(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Di(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Dce(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ra(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Lce(t,e,r){var n=e.replace(aF,""),i=e.length-n.length;return ra(t,n,r*Math.pow(10,2*i))+Tr("%",i)}function dF(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+dF(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ro(t,e,r){if(t.charCodeAt(0)===40&&!e.match(hF)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ro("n",n,r):"("+ro("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Dce(t,e,r);if(e.indexOf("%")!==-1)return Lce(t,e,r);if(e.indexOf("E")!==-1)return dF(e,r);if(e.charCodeAt(0)===36)return"$"+ro(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,o,a,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Es(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Ln(e.substr(0,e.length-i.length))+i;if(s=e.match(cF))return Nce(s,l,c);if(e.match(/^#+0+$/))return c+Es(l,e.length-e.indexOf("0"));if(s=e.match(uF))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Ln(s[1])).replace(/\.$/,"."+Ln(s[1])),i=i.replace(/\.(\d*)$/,function(g,m){return"."+m+Tr("0",Ln(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+Ja(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ro(t,e,-r):Ja(""+r)+"."+Tr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return ro(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=rh(ro(t,e.replace(/[\\-]/g,""),r)),o=0,rh(rh(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(e.match(fF))return i=ro(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=iv(l,Math.pow(10,o)-1,!1),i=""+c,u=ra("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=rv(a[2],o),u.length<s[4].length&&(u=Ln(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=iv(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?_E(a[1],o)+s[2]+"/"+s[3]+rv(a[2],o):Tr(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Ln(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=e.indexOf(".")-o,f=e.length-i.length-h;return Ln(e.substr(0,h)+i+e.substr(e.length-f))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ro(t,e,-r):Ja(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Es(0,3-g.length):"")+g})+"."+Es(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var d=Ja(""+l);return d!=="0"?c+d:"";default:if(e.match(/\.[0#?]*$/))return ro(t,e.slice(0,e.lastIndexOf(".")),r)+Ln(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ra(t,e,r){return(r|0)===r?ro(t,e,r):Di(t,e,r)}function $ce(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var gF=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function _h(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":nv(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="ä¸å/ä¸å")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(gF))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function Bce(t,e,r,n){for(var i=[],s="",o=0,a="",l="t",c,u,h,f="H";o<t.length;)switch(a=t.charAt(o)){case"G":if(!nv(t,o))throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(h=t.charCodeAt(++o))!==34&&o<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++o;break;case"\\":var d=t.charAt(++o),g=d==="("||d===")"?d:"t";i[i.length]={t:g,v:d},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(c==null&&(c=mc(e,r,t.charAt(o+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=mc(e,r),c==null))return"";for(s=a;++o<t.length&&t.charAt(o).toLowerCase()===a;)s+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=f),i[i.length]={t:a,v:s},l=a;break;case"A":case"a":case"ä¸":var m={t:a,v:a};if(c==null&&(c=mc(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",f="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",o+=5,f="h"):t.substr(o,5).toUpperCase()==="ä¸å/ä¸å"?(c!=null&&(m.v=c.H>=12?"ä¸å":"ä¸å"),m.t="T",o+=5,f="h"):(m.t="t",++o),c==null&&m.t==="T")return"";i[i.length]=m,l=a;break;case"[":for(s=a;t.charAt(o++)!=="]"&&o<t.length;)s+=t.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(gF)){if(c==null&&(c=mc(e,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",_h(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=a;++o<t.length&&(a=t.charAt(o))==="0";)s+=a;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=a;++o<t.length&&"0#?.,E+-%".indexOf(a=t.charAt(o))>-1;)s+=a;i[i.length]={t:"n",v:s};break;case"?":for(s=a;t.charAt(++o)===a;)s+=a;i[i.length]={t:a,v:s},l=a;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=a;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)s+=t.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:a,v:a},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=â¬acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"t",v:a},++o;break}var p=0,y=0,S;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=f,l="h",p<1&&(p=1);break;case"s":(S=i[o].v.match(/\.0+$/))&&(y=Math.max(y,S[0].length-1)),p<3&&(p=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",p<2&&(p=2));break;case"X":break;case"Z":p<1&&i[o].v.match(/[Hh]/)&&(p=1),p<2&&i[o].v.match(/[Mm]/)&&(p=2),p<3&&i[o].v.match(/[Ss]/)&&(p=3)}switch(p){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var C="",A;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=Mce(i[o].t.charCodeAt(0),i[o].v,c,y),i[o].t="t";break;case"n":case"?":for(A=o+1;i[A]!=null&&((a=i[A].t)==="?"||a==="D"||(a===" "||a==="t")&&i[A+1]!=null&&(i[A+1].t==="?"||i[A+1].t==="t"&&i[A+1].v==="/")||i[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[A].v==="/"||i[A].v===" "&&i[A+1]!=null&&i[A+1].t=="?"));)i[o].v+=i[A].v,i[A]={v:"",t:";"},++A;C+=i[o].v,o=A-1;break;case"G":i[o].t="t",i[o].v=Mc(e,r);break}var I="",O,_;if(C.length>0){C.charCodeAt(0)==40?(O=e<0&&C.charCodeAt(0)===45?-e:e,_=ra("n",C,O)):(O=e<0&&n>1?-e:e,_=ra("n",C,O),O<0&&i[0]&&i[0].t=="t"&&(_=_.substr(1),i[0].v="-"+i[0].v)),A=_.length-1;var E=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){E=o;break}var b=i.length;if(E===i.length&&_.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(A>=i[o].v.length-1?(A-=i[o].v.length,i[o].v=_.substr(A+1,i[o].v.length)):A<0?i[o].v="":(i[o].v=_.substr(0,A+1),A=-1),i[o].t="t",b=o);A>=0&&b<i.length&&(i[b].v=_.substr(0,A+1)+i[b].v)}else if(E!==i.length&&_.indexOf("E")===-1){for(A=_.indexOf(".")-1,o=E;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(u=i[o].v.indexOf(".")>-1&&o===E?i[o].v.indexOf(".")-1:i[o].v.length-1,I=i[o].v.substr(u+1);u>=0;--u)A>=0&&(i[o].v.charAt(u)==="0"||i[o].v.charAt(u)==="#")&&(I=_.charAt(A--)+I);i[o].v=I,i[o].t="t",b=o}for(A>=0&&b<i.length&&(i[b].v=_.substr(0,A+1)+i[b].v),A=_.indexOf(".")+1,o=E;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==E)){for(u=i[o].v.indexOf(".")>-1&&o===E?i[o].v.indexOf(".")+1:0,I=i[o].v.substr(0,u);u<i[o].v.length;++u)A<_.length&&(I+=_.charAt(A++));i[o].v=I,i[o].t="t",b=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(O=n>1&&e<0&&o>0&&i[o-1].v==="-"?-e:e,i[o].v=ra(i[o].t,i[o].v,O),i[o].t="t");var k="";for(o=0;o!==i.length;++o)i[o]!=null&&(k+=i[o].v);return k}var JI=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ZI(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function Vce(t,e){var r=$ce(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(JI),a=r[1].match(JI);return ZI(e,o)?[n,r[0]]:ZI(e,a)?[n,r[1]]:[n,r[o!=null&&a!=null?2:1]]}return[n,s]}function es(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:et)[t],n==null&&(n=r.table&&r.table[KI[t]]||et[KI[t]]),n==null&&(n=bce[t]||"General");break}if(nv(n,0))return Mc(e,r);e instanceof Date&&(e=oF(e,r.date1904));var i=Vce(n,e);if(nv(i[1]))return Mc(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return Bce(i[1],e,r,i[0])}function na(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(et[r]==null){e<0&&(e=r);continue}if(et[r]==t){e=r;break}}e<0&&(e=391)}return et[e]=t,e}function nw(t){for(var e=0;e!=392;++e)t[e]!==void 0&&na(t[e],e)}function Ah(){et=Sce()}var Wce={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},mF=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Uce(t){var e=typeof t=="number"?et[t]:t;return e=e.replace(mF,"(\\d+)"),new RegExp("^"+e+"$")}function jce(t,e,r){var n=-1,i=-1,s=-1,o=-1,a=-1,l=-1;(e.match(mF)||[]).forEach(function(h,f){var d=parseInt(r[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=d;break;case"d":s=d;break;case"h":o=d;break;case"s":l=d;break;case"m":o>=0?a=d:i=d;break}}),l>=0&&a==-1&&i>=0&&(a=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?c:n==-1&&i==-1&&s==-1?u:c+"T"+u}var zce=function(){var t={};t.version="1.2.0";function e(){for(var _=0,E=new Array(256),b=0;b!=256;++b)_=b,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,E[b]=_;return typeof Int32Array<"u"?new Int32Array(E):E}var r=e();function n(_){var E=0,b=0,k=0,B=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(k=0;k!=256;++k)B[k]=_[k];for(k=0;k!=256;++k)for(b=_[k],E=256+k;E<4096;E+=256)b=B[E]=b>>>8^_[b&255];var N=[];for(k=1;k!=16;++k)N[k-1]=typeof Int32Array<"u"?B.subarray(k*256,k*256+256):B.slice(k*256,k*256+256);return N}var i=n(r),s=i[0],o=i[1],a=i[2],l=i[3],c=i[4],u=i[5],h=i[6],f=i[7],d=i[8],g=i[9],m=i[10],p=i[11],y=i[12],S=i[13],C=i[14];function A(_,E){for(var b=E^-1,k=0,B=_.length;k<B;)b=b>>>8^r[(b^_.charCodeAt(k++))&255];return~b}function I(_,E){for(var b=E^-1,k=_.length-15,B=0;B<k;)b=C[_[B++]^b&255]^S[_[B++]^b>>8&255]^y[_[B++]^b>>16&255]^p[_[B++]^b>>>24]^m[_[B++]]^g[_[B++]]^d[_[B++]]^f[_[B++]]^h[_[B++]]^u[_[B++]]^c[_[B++]]^l[_[B++]]^a[_[B++]]^o[_[B++]]^s[_[B++]]^r[_[B++]];for(k+=15;B<k;)b=b>>>8^r[(b^_[B++])&255];return~b}function O(_,E){for(var b=E^-1,k=0,B=_.length,N=0,q=0;k<B;)N=_.charCodeAt(k++),N<128?b=b>>>8^r[(b^N)&255]:N<2048?(b=b>>>8^r[(b^(192|N>>6&31))&255],b=b>>>8^r[(b^(128|N&63))&255]):N>=55296&&N<57344?(N=(N&1023)+64,q=_.charCodeAt(k++)&1023,b=b>>>8^r[(b^(240|N>>8&7))&255],b=b>>>8^r[(b^(128|N>>2&63))&255],b=b>>>8^r[(b^(128|q>>6&15|(N&3)<<4))&255],b=b>>>8^r[(b^(128|q&63))&255]):(b=b>>>8^r[(b^(224|N>>12&15))&255],b=b>>>8^r[(b^(128|N>>6&63))&255],b=b>>>8^r[(b^(128|N&63))&255]);return~b}return t.table=r,t.bstr=A,t.buf=I,t.str=O,t}(),qe=function(){var e={};e.version="1.2.1";function r(M,U){for(var D=M.split("/"),V=U.split("/"),j=0,z=0,me=Math.min(D.length,V.length);j<me;++j){if(z=D[j].length-V[j].length)return z;if(D[j]!=V[j])return D[j]<V[j]?-1:1}return D.length-V.length}function n(M){if(M.charAt(M.length-1)=="/")return M.slice(0,-1).indexOf("/")===-1?M:n(M.slice(0,-1));var U=M.lastIndexOf("/");return U===-1?M:M.slice(0,U+1)}function i(M){if(M.charAt(M.length-1)=="/")return i(M.slice(0,-1));var U=M.lastIndexOf("/");return U===-1?M:M.slice(U+1)}function s(M,U){typeof U=="string"&&(U=new Date(U));var D=U.getHours();D=D<<6|U.getMinutes(),D=D<<5|U.getSeconds()>>>1,M.write_shift(2,D);var V=U.getFullYear()-1980;V=V<<4|U.getMonth()+1,V=V<<5|U.getDate(),M.write_shift(2,V)}function o(M){var U=M.read_shift(2)&65535,D=M.read_shift(2)&65535,V=new Date,j=D&31;D>>>=5;var z=D&15;D>>>=4,V.setMilliseconds(0),V.setFullYear(D+1980),V.setMonth(z-1),V.setDate(j);var me=U&31;U>>>=5;var xe=U&63;return U>>>=6,V.setHours(U),V.setMinutes(xe),V.setSeconds(me<<1),V}function a(M){fn(M,0);for(var U={},D=0;M.l<=M.length-4;){var V=M.read_shift(2),j=M.read_shift(2),z=M.l+j,me={};switch(V){case 21589:D=M.read_shift(1),D&1&&(me.mtime=M.read_shift(4)),j>5&&(D&2&&(me.atime=M.read_shift(4)),D&4&&(me.ctime=M.read_shift(4))),me.mtime&&(me.mt=new Date(me.mtime*1e3));break}M.l=z,U[V]=me}return U}var l;function c(){return l||(l={})}function u(M,U){if(M[0]==80&&M[1]==75)return _o(M,U);if((M[0]|32)==109&&(M[1]|32)==105)return kg(M,U);if(M.length<512)throw new Error("CFB file size "+M.length+" < 512");var D=3,V=512,j=0,z=0,me=0,xe=0,ge=0,pe=[],Ce=M.slice(0,512);fn(Ce,0);var ve=h(Ce);switch(D=ve[0],D){case 3:V=512;break;case 4:V=4096;break;case 0:if(ve[1]==0)return _o(M,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}V!==512&&(Ce=M.slice(0,V),fn(Ce,28));var W=M.slice(0,V);f(Ce,D);var de=Ce.read_shift(4,"i");if(D===3&&de!==0)throw new Error("# Directory Sectors: Expected 0 saw "+de);Ce.l+=4,me=Ce.read_shift(4,"i"),Ce.l+=4,Ce.chk("00100000","Mini Stream Cutoff Size: "),xe=Ce.read_shift(4,"i"),j=Ce.read_shift(4,"i"),ge=Ce.read_shift(4,"i"),z=Ce.read_shift(4,"i");for(var he=-1,Ie=0;Ie<109&&(he=Ce.read_shift(4,"i"),!(he<0));++Ie)pe[Ie]=he;var Ke=d(M,V);p(ge,z,Ke,V,pe);var mt=S(Ke,me,pe,V);mt[me].name="!Directory",j>0&&xe!==q&&(mt[xe].name="!MiniFAT"),mt[pe[0]].name="!FAT",mt.fat_addrs=pe,mt.ssz=V;var ut={},cr=[],nr=[],Ao=[];C(me,mt,Ke,cr,j,ut,nr,xe),g(nr,Ao,cr),cr.shift();var va={FileIndex:nr,FullPaths:Ao};return U&&U.raw&&(va.raw={header:W,sectors:Ke}),va}function h(M){if(M[M.l]==80&&M[M.l+1]==75)return[0,0];M.chk(ue,"Header Signature: "),M.l+=16;var U=M.read_shift(2,"u");return[M.read_shift(2,"u"),U]}function f(M,U){var D=9;switch(M.l+=2,D=M.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}M.chk("0600","Mini Sector Shift: "),M.chk("000000000000","Reserved: ")}function d(M,U){for(var D=Math.ceil(M.length/U)-1,V=[],j=1;j<D;++j)V[j-1]=M.slice(j*U,(j+1)*U);return V[D-1]=M.slice(D*U),V}function g(M,U,D){for(var V=0,j=0,z=0,me=0,xe=0,ge=D.length,pe=[],Ce=[];V<ge;++V)pe[V]=Ce[V]=V,U[V]=D[V];for(;xe<Ce.length;++xe)V=Ce[xe],j=M[V].L,z=M[V].R,me=M[V].C,pe[V]===V&&(j!==-1&&pe[j]!==j&&(pe[V]=pe[j]),z!==-1&&pe[z]!==z&&(pe[V]=pe[z])),me!==-1&&(pe[me]=V),j!==-1&&V!=pe[V]&&(pe[j]=pe[V],Ce.lastIndexOf(j)<xe&&Ce.push(j)),z!==-1&&V!=pe[V]&&(pe[z]=pe[V],Ce.lastIndexOf(z)<xe&&Ce.push(z));for(V=1;V<ge;++V)pe[V]===V&&(z!==-1&&pe[z]!==z?pe[V]=pe[z]:j!==-1&&pe[j]!==j&&(pe[V]=pe[j]));for(V=1;V<ge;++V)if(M[V].type!==0){if(xe=V,xe!=pe[xe])do xe=pe[xe],U[V]=U[xe]+"/"+U[V];while(xe!==0&&pe[xe]!==-1&&xe!=pe[xe]);pe[V]=-1}for(U[0]+="/",V=1;V<ge;++V)M[V].type!==2&&(U[V]+="/")}function m(M,U,D){for(var V=M.start,j=M.size,z=[],me=V;D&&j>0&&me>=0;)z.push(U.slice(me*N,me*N+N)),j-=N,me=ac(D,me*4);return z.length===0?ye(0):on(z).slice(0,M.size)}function p(M,U,D,V,j){var z=q;if(M===q){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(M!==-1){var me=D[M],xe=(V>>>2)-1;if(!me)return;for(var ge=0;ge<xe&&(z=ac(me,ge*4))!==q;++ge)j.push(z);p(ac(me,V-4),U-1,D,V,j)}}function y(M,U,D,V,j){var z=[],me=[];j||(j=[]);var xe=V-1,ge=0,pe=0;for(ge=U;ge>=0;){j[ge]=!0,z[z.length]=ge,me.push(M[ge]);var Ce=D[Math.floor(ge*4/V)];if(pe=ge*4&xe,V<4+pe)throw new Error("FAT boundary crossed: "+ge+" 4 "+V);if(!M[Ce])break;ge=ac(M[Ce],pe)}return{nodes:z,data:uM([me])}}function S(M,U,D,V){var j=M.length,z=[],me=[],xe=[],ge=[],pe=V-1,Ce=0,ve=0,W=0,de=0;for(Ce=0;Ce<j;++Ce)if(xe=[],W=Ce+U,W>=j&&(W-=j),!me[W]){ge=[];var he=[];for(ve=W;ve>=0;){he[ve]=!0,me[ve]=!0,xe[xe.length]=ve,ge.push(M[ve]);var Ie=D[Math.floor(ve*4/V)];if(de=ve*4&pe,V<4+de)throw new Error("FAT boundary crossed: "+ve+" 4 "+V);if(!M[Ie]||(ve=ac(M[Ie],de),he[ve]))break}z[W]={nodes:xe,data:uM([ge])}}return z}function C(M,U,D,V,j,z,me,xe){for(var ge=0,pe=V.length?2:0,Ce=U[M].data,ve=0,W=0,de;ve<Ce.length;ve+=128){var he=Ce.slice(ve,ve+128);fn(he,64),W=he.read_shift(2),de=FE(he,0,W-pe),V.push(de);var Ie={name:de,type:he.read_shift(1),color:he.read_shift(1),L:he.read_shift(4,"i"),R:he.read_shift(4,"i"),C:he.read_shift(4,"i"),clsid:he.read_shift(16),state:he.read_shift(4,"i"),start:0,size:0},Ke=he.read_shift(2)+he.read_shift(2)+he.read_shift(2)+he.read_shift(2);Ke!==0&&(Ie.ct=A(he,he.l-8));var mt=he.read_shift(2)+he.read_shift(2)+he.read_shift(2)+he.read_shift(2);mt!==0&&(Ie.mt=A(he,he.l-8)),Ie.start=he.read_shift(4,"i"),Ie.size=he.read_shift(4,"i"),Ie.size<0&&Ie.start<0&&(Ie.size=Ie.type=0,Ie.start=q,Ie.name=""),Ie.type===5?(ge=Ie.start,j>0&&ge!==q&&(U[ge].name="!StreamData")):Ie.size>=4096?(Ie.storage="fat",U[Ie.start]===void 0&&(U[Ie.start]=y(D,Ie.start,U.fat_addrs,U.ssz)),U[Ie.start].name=Ie.name,Ie.content=U[Ie.start].data.slice(0,Ie.size)):(Ie.storage="minifat",Ie.size<0?Ie.size=0:ge!==q&&Ie.start!==q&&U[ge]&&(Ie.content=m(Ie,U[ge].data,(U[xe]||{}).data))),Ie.content&&fn(Ie.content,0),z[de]=Ie,me.push(Ie)}}function A(M,U){return new Date((Ei(M,U+4)/1e7*Math.pow(2,32)+Ei(M,U)/1e7-11644473600)*1e3)}function I(M,U){return c(),u(l.readFileSync(M),U)}function O(M,U){var D=U&&U.type;switch(D||Ct&&Buffer.isBuffer(M)&&(D="buffer"),D||"base64"){case"file":return I(M,U);case"base64":return u(Ri(Ai(M)),U);case"binary":return u(Ri(M),U)}return u(M,U)}function _(M,U){var D=U||{},V=D.root||"Root Entry";if(M.FullPaths||(M.FullPaths=[]),M.FileIndex||(M.FileIndex=[]),M.FullPaths.length!==M.FileIndex.length)throw new Error("inconsistent CFB structure");M.FullPaths.length===0&&(M.FullPaths[0]=V+"/",M.FileIndex[0]={name:V,type:5}),D.CLSID&&(M.FileIndex[0].clsid=D.CLSID),E(M)}function E(M){var U="Sh33tJ5";if(!qe.find(M,"/"+U)){var D=ye(4);D[0]=55,D[1]=D[3]=50,D[2]=54,M.FileIndex.push({name:U,type:2,content:D,size:4,L:69,R:69,C:69}),M.FullPaths.push(M.FullPaths[0]+U),b(M)}}function b(M,U){_(M);for(var D=!1,V=!1,j=M.FullPaths.length-1;j>=0;--j){var z=M.FileIndex[j];switch(z.type){case 0:V?D=!0:(M.FileIndex.pop(),M.FullPaths.pop());break;case 1:case 2:case 5:V=!0,isNaN(z.R*z.L*z.C)&&(D=!0),z.R>-1&&z.L>-1&&z.R==z.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!U)){var me=new Date(1987,1,19),xe=0,ge=Object.create?Object.create(null):{},pe=[];for(j=0;j<M.FullPaths.length;++j)ge[M.FullPaths[j]]=!0,M.FileIndex[j].type!==0&&pe.push([M.FullPaths[j],M.FileIndex[j]]);for(j=0;j<pe.length;++j){var Ce=n(pe[j][0]);V=ge[Ce],V||(pe.push([Ce,{name:i(Ce).replace("/",""),type:1,clsid:Se,ct:me,mt:me,content:null}]),ge[Ce]=!0)}for(pe.sort(function(de,he){return r(de[0],he[0])}),M.FullPaths=[],M.FileIndex=[],j=0;j<pe.length;++j)M.FullPaths[j]=pe[j][0],M.FileIndex[j]=pe[j][1];for(j=0;j<pe.length;++j){var ve=M.FileIndex[j],W=M.FullPaths[j];if(ve.name=i(W).replace("/",""),ve.L=ve.R=ve.C=-(ve.color=1),ve.size=ve.content?ve.content.length:0,ve.start=0,ve.clsid=ve.clsid||Se,j===0)ve.C=pe.length>1?1:-1,ve.size=0,ve.type=5;else if(W.slice(-1)=="/"){for(xe=j+1;xe<pe.length&&n(M.FullPaths[xe])!=W;++xe);for(ve.C=xe>=pe.length?-1:xe,xe=j+1;xe<pe.length&&n(M.FullPaths[xe])!=n(W);++xe);ve.R=xe>=pe.length?-1:xe,ve.type=1}else n(M.FullPaths[j+1]||"")==n(W)&&(ve.R=j+1),ve.type=2}}}function k(M,U){var D=U||{};if(D.fileType=="mad")return Ng(M,D);switch(b(M),D.fileType){case"zip":return vl(M,D)}var V=function(de){for(var he=0,Ie=0,Ke=0;Ke<de.FileIndex.length;++Ke){var mt=de.FileIndex[Ke];if(mt.content){var ut=mt.content.length;ut>0&&(ut<4096?he+=ut+63>>6:Ie+=ut+511>>9)}}for(var cr=de.FullPaths.length+3>>2,nr=he+7>>3,Ao=he+127>>7,va=nr+Ie+cr+Ao,wa=va+127>>7,dw=wa<=109?0:Math.ceil((wa-109)/127);va+wa+dw+127>>7>wa;)dw=++wa<=109?0:Math.ceil((wa-109)/127);var Io=[1,dw,wa,Ao,cr,Ie,he,0];return de.FileIndex[0].size=he<<6,Io[7]=(de.FileIndex[0].start=Io[0]+Io[1]+Io[2]+Io[3]+Io[4]+Io[5])+(Io[6]+7>>3),Io}(M),j=ye(V[7]<<9),z=0,me=0;{for(z=0;z<8;++z)j.write_shift(1,we[z]);for(z=0;z<8;++z)j.write_shift(2,0);for(j.write_shift(2,62),j.write_shift(2,3),j.write_shift(2,65534),j.write_shift(2,9),j.write_shift(2,6),z=0;z<3;++z)j.write_shift(2,0);for(j.write_shift(4,0),j.write_shift(4,V[2]),j.write_shift(4,V[0]+V[1]+V[2]+V[3]-1),j.write_shift(4,0),j.write_shift(4,4096),j.write_shift(4,V[3]?V[0]+V[1]+V[2]-1:q),j.write_shift(4,V[3]),j.write_shift(-4,V[1]?V[0]-1:q),j.write_shift(4,V[1]),z=0;z<109;++z)j.write_shift(-4,z<V[2]?V[1]+z:-1)}if(V[1])for(me=0;me<V[1];++me){for(;z<236+me*127;++z)j.write_shift(-4,z<V[2]?V[1]+z:-1);j.write_shift(-4,me===V[1]-1?q:me+1)}var xe=function(de){for(me+=de;z<me-1;++z)j.write_shift(-4,z+1);de&&(++z,j.write_shift(-4,q))};for(me=z=0,me+=V[1];z<me;++z)j.write_shift(-4,ce.DIFSECT);for(me+=V[2];z<me;++z)j.write_shift(-4,ce.FATSECT);xe(V[3]),xe(V[4]);for(var ge=0,pe=0,Ce=M.FileIndex[0];ge<M.FileIndex.length;++ge)Ce=M.FileIndex[ge],Ce.content&&(pe=Ce.content.length,!(pe<4096)&&(Ce.start=me,xe(pe+511>>9)));for(xe(V[6]+7>>3);j.l&511;)j.write_shift(-4,ce.ENDOFCHAIN);for(me=z=0,ge=0;ge<M.FileIndex.length;++ge)Ce=M.FileIndex[ge],Ce.content&&(pe=Ce.content.length,!(!pe||pe>=4096)&&(Ce.start=me,xe(pe+63>>6)));for(;j.l&511;)j.write_shift(-4,ce.ENDOFCHAIN);for(z=0;z<V[4]<<2;++z){var ve=M.FullPaths[z];if(!ve||ve.length===0){for(ge=0;ge<17;++ge)j.write_shift(4,0);for(ge=0;ge<3;++ge)j.write_shift(4,-1);for(ge=0;ge<12;++ge)j.write_shift(4,0);continue}Ce=M.FileIndex[z],z===0&&(Ce.start=Ce.size?Ce.start-1:q);var W=z===0&&D.root||Ce.name;if(pe=2*(W.length+1),j.write_shift(64,W,"utf16le"),j.write_shift(2,pe),j.write_shift(1,Ce.type),j.write_shift(1,Ce.color),j.write_shift(-4,Ce.L),j.write_shift(-4,Ce.R),j.write_shift(-4,Ce.C),Ce.clsid)j.write_shift(16,Ce.clsid,"hex");else for(ge=0;ge<4;++ge)j.write_shift(4,0);j.write_shift(4,Ce.state||0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,Ce.start),j.write_shift(4,Ce.size),j.write_shift(4,0)}for(z=1;z<M.FileIndex.length;++z)if(Ce=M.FileIndex[z],Ce.size>=4096)if(j.l=Ce.start+1<<9,Ct&&Buffer.isBuffer(Ce.content))Ce.content.copy(j,j.l,0,Ce.size),j.l+=Ce.size+511&-512;else{for(ge=0;ge<Ce.size;++ge)j.write_shift(1,Ce.content[ge]);for(;ge&511;++ge)j.write_shift(1,0)}for(z=1;z<M.FileIndex.length;++z)if(Ce=M.FileIndex[z],Ce.size>0&&Ce.size<4096)if(Ct&&Buffer.isBuffer(Ce.content))Ce.content.copy(j,j.l,0,Ce.size),j.l+=Ce.size+63&-64;else{for(ge=0;ge<Ce.size;++ge)j.write_shift(1,Ce.content[ge]);for(;ge&63;++ge)j.write_shift(1,0)}if(Ct)j.l=j.length;else for(;j.l<j.length;)j.write_shift(1,0);return j}function B(M,U){var D=M.FullPaths.map(function(ge){return ge.toUpperCase()}),V=D.map(function(ge){var pe=ge.split("/");return pe[pe.length-(ge.slice(-1)=="/"?2:1)]}),j=!1;U.charCodeAt(0)===47?(j=!0,U=D[0].slice(0,-1)+U):j=U.indexOf("/")!==-1;var z=U.toUpperCase(),me=j===!0?D.indexOf(z):V.indexOf(z);if(me!==-1)return M.FileIndex[me];var xe=!z.match(Uf);for(z=z.replace(Un,""),xe&&(z=z.replace(Uf,"!")),me=0;me<D.length;++me)if((xe?D[me].replace(Uf,"!"):D[me]).replace(Un,"")==z||(xe?V[me].replace(Uf,"!"):V[me]).replace(Un,"")==z)return M.FileIndex[me];return null}var N=64,q=-2,ue="d0cf11e0a1b11ae1",we=[208,207,17,224,161,177,26,225],Se="00000000000000000000000000000000",ce={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:ue,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Se,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Re(M,U,D){c();var V=k(M,D);l.writeFileSync(U,V)}function Y(M){for(var U=new Array(M.length),D=0;D<M.length;++D)U[D]=String.fromCharCode(M[D]);return U.join("")}function Pe(M,U){var D=k(M,U);switch(U&&U.type||"buffer"){case"file":return c(),l.writeFileSync(U.filename,D),D;case"binary":return typeof D=="string"?D:Y(D);case"base64":return Vd(typeof D=="string"?D:Y(D));case"buffer":if(Ct)return Buffer.isBuffer(D)?D:da(D);case"array":return typeof D=="string"?Ri(D):D}return D}var w;function v(M){try{var U=M.InflateRaw,D=new U;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)w=M;else throw new Error("zlib does not expose bytesRead")}catch(V){console.error("cannot use native zlib: "+(V.message||V))}}function x(M,U){if(!w)return yt(M,U);var D=w.InflateRaw,V=new D,j=V._processChunk(M.slice(M.l),V._finishFlushFlag);return M.l+=V.bytesRead,j}function R(M){return w?w.deflateRawSync(M):se(M)}var T=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],L=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],K=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Q(M){var U=(M<<1|M<<11)&139536|(M<<5|M<<15)&558144;return(U>>16|U>>8|U)&255}for(var Z=typeof Uint8Array<"u",ie=Z?new Uint8Array(256):[],fe=0;fe<256;++fe)ie[fe]=Q(fe);function H(M,U){var D=ie[M&255];return U<=8?D>>>8-U:(D=D<<8|ie[M>>8&255],U<=16?D>>>16-U:(D=D<<8|ie[M>>16&255],D>>>24-U))}function Me(M,U){var D=U&7,V=U>>>3;return(M[V]|(D<=6?0:M[V+1]<<8))>>>D&3}function ae(M,U){var D=U&7,V=U>>>3;return(M[V]|(D<=5?0:M[V+1]<<8))>>>D&7}function ke(M,U){var D=U&7,V=U>>>3;return(M[V]|(D<=4?0:M[V+1]<<8))>>>D&15}function Ae(M,U){var D=U&7,V=U>>>3;return(M[V]|(D<=3?0:M[V+1]<<8))>>>D&31}function be(M,U){var D=U&7,V=U>>>3;return(M[V]|(D<=1?0:M[V+1]<<8))>>>D&127}function $e(M,U,D){var V=U&7,j=U>>>3,z=(1<<D)-1,me=M[j]>>>V;return D<8-V||(me|=M[j+1]<<8-V,D<16-V)||(me|=M[j+2]<<16-V,D<24-V)||(me|=M[j+3]<<24-V),me&z}function Le(M,U,D){var V=U&7,j=U>>>3;return V<=5?M[j]|=(D&7)<<V:(M[j]|=D<<V&255,M[j+1]=(D&7)>>8-V),U+3}function P(M,U,D){var V=U&7,j=U>>>3;return D=(D&1)<<V,M[j]|=D,U+1}function F(M,U,D){var V=U&7,j=U>>>3;return D<<=V,M[j]|=D&255,D>>>=8,M[j+1]=D,U+8}function G(M,U,D){var V=U&7,j=U>>>3;return D<<=V,M[j]|=D&255,D>>>=8,M[j+1]=D&255,M[j+2]=D>>>8,U+16}function ne(M,U){var D=M.length,V=2*D>U?2*D:U+5,j=0;if(D>=U)return M;if(Ct){var z=zI(V);if(M.copy)M.copy(z);else for(;j<M.length;++j)z[j]=M[j];return z}else if(Z){var me=new Uint8Array(V);if(me.set)me.set(M);else for(;j<D;++j)me[j]=M[j];return me}return M.length=V,M}function X(M){for(var U=new Array(M),D=0;D<M;++D)U[D]=0;return U}function re(M,U,D){var V=1,j=0,z=0,me=0,xe=0,ge=M.length,pe=Z?new Uint16Array(32):X(32);for(z=0;z<32;++z)pe[z]=0;for(z=ge;z<D;++z)M[z]=0;ge=M.length;var Ce=Z?new Uint16Array(ge):X(ge);for(z=0;z<ge;++z)pe[j=M[z]]++,V<j&&(V=j),Ce[z]=0;for(pe[0]=0,z=1;z<=V;++z)pe[z+16]=xe=xe+pe[z-1]<<1;for(z=0;z<ge;++z)xe=M[z],xe!=0&&(Ce[z]=pe[xe+16]++);var ve=0;for(z=0;z<ge;++z)if(ve=M[z],ve!=0)for(xe=H(Ce[z],V)>>V-ve,me=(1<<V+4-ve)-1;me>=0;--me)U[xe|me<<ve]=ve&15|z<<4;return V}var te=Z?new Uint16Array(512):X(512),ee=Z?new Uint16Array(32):X(32);if(!Z){for(var oe=0;oe<512;++oe)te[oe]=0;for(oe=0;oe<32;++oe)ee[oe]=0}(function(){for(var M=[],U=0;U<32;U++)M.push(5);re(M,ee,32);var D=[];for(U=0;U<=143;U++)D.push(8);for(;U<=255;U++)D.push(9);for(;U<=279;U++)D.push(7);for(;U<=287;U++)D.push(8);re(D,te,288)})();var le=function(){for(var U=Z?new Uint8Array(32768):[],D=0,V=0;D<K.length-1;++D)for(;V<K[D+1];++V)U[V]=D;for(;V<32768;++V)U[V]=29;var j=Z?new Uint8Array(259):[];for(D=0,V=0;D<L.length-1;++D)for(;V<L[D+1];++V)j[V]=D;function z(xe,ge){for(var pe=0;pe<xe.length;){var Ce=Math.min(65535,xe.length-pe),ve=pe+Ce==xe.length;for(ge.write_shift(1,+ve),ge.write_shift(2,Ce),ge.write_shift(2,~Ce&65535);Ce-- >0;)ge[ge.l++]=xe[pe++]}return ge.l}function me(xe,ge){for(var pe=0,Ce=0,ve=Z?new Uint16Array(32768):[];Ce<xe.length;){var W=Math.min(65535,xe.length-Ce);if(W<10){for(pe=Le(ge,pe,+(Ce+W==xe.length)),pe&7&&(pe+=8-(pe&7)),ge.l=pe/8|0,ge.write_shift(2,W),ge.write_shift(2,~W&65535);W-- >0;)ge[ge.l++]=xe[Ce++];pe=ge.l*8;continue}pe=Le(ge,pe,+(Ce+W==xe.length)+2);for(var de=0;W-- >0;){var he=xe[Ce];de=(de<<5^he)&32767;var Ie=-1,Ke=0;if((Ie=ve[de])&&(Ie|=Ce&-32768,Ie>Ce&&(Ie-=32768),Ie<Ce))for(;xe[Ie+Ke]==xe[Ce+Ke]&&Ke<250;)++Ke;if(Ke>2){he=j[Ke],he<=22?pe=F(ge,pe,ie[he+1]>>1)-1:(F(ge,pe,3),pe+=5,F(ge,pe,ie[he-23]>>5),pe+=3);var mt=he<8?0:he-4>>2;mt>0&&(G(ge,pe,Ke-L[he]),pe+=mt),he=U[Ce-Ie],pe=F(ge,pe,ie[he]>>3),pe-=3;var ut=he<4?0:he-2>>1;ut>0&&(G(ge,pe,Ce-Ie-K[he]),pe+=ut);for(var cr=0;cr<Ke;++cr)ve[de]=Ce&32767,de=(de<<5^xe[Ce])&32767,++Ce;W-=Ke-1}else he<=143?he=he+48:pe=P(ge,pe,1),pe=F(ge,pe,ie[he]),ve[de]=Ce&32767,++Ce}pe=F(ge,pe,0)-1}return ge.l=(pe+7)/8|0,ge.l}return function(ge,pe){return ge.length<8?z(ge,pe):me(ge,pe)}}();function se(M){var U=ye(50+Math.floor(M.length*1.1)),D=le(M,U);return U.slice(0,D)}var Ee=Z?new Uint16Array(32768):X(32768),Oe=Z?new Uint16Array(32768):X(32768),De=Z?new Uint16Array(128):X(128),ze=1,lt=1;function nt(M,U){var D=Ae(M,U)+257;U+=5;var V=Ae(M,U)+1;U+=5;var j=ke(M,U)+4;U+=4;for(var z=0,me=Z?new Uint8Array(19):X(19),xe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ge=1,pe=Z?new Uint8Array(8):X(8),Ce=Z?new Uint8Array(8):X(8),ve=me.length,W=0;W<j;++W)me[T[W]]=z=ae(M,U),ge<z&&(ge=z),pe[z]++,U+=3;var de=0;for(pe[0]=0,W=1;W<=ge;++W)Ce[W]=de=de+pe[W-1]<<1;for(W=0;W<ve;++W)(de=me[W])!=0&&(xe[W]=Ce[de]++);var he=0;for(W=0;W<ve;++W)if(he=me[W],he!=0){de=ie[xe[W]]>>8-he;for(var Ie=(1<<7-he)-1;Ie>=0;--Ie)De[de|Ie<<he]=he&7|W<<3}var Ke=[];for(ge=1;Ke.length<D+V;)switch(de=De[be(M,U)],U+=de&7,de>>>=3){case 16:for(z=3+Me(M,U),U+=2,de=Ke[Ke.length-1];z-- >0;)Ke.push(de);break;case 17:for(z=3+ae(M,U),U+=3;z-- >0;)Ke.push(0);break;case 18:for(z=11+be(M,U),U+=7;z-- >0;)Ke.push(0);break;default:Ke.push(de),ge<de&&(ge=de);break}var mt=Ke.slice(0,D),ut=Ke.slice(D);for(W=D;W<286;++W)mt[W]=0;for(W=V;W<30;++W)ut[W]=0;return ze=re(mt,Ee,286),lt=re(ut,Oe,30),U}function Je(M,U){if(M[0]==3&&!(M[1]&3))return[sl(U),2];for(var D=0,V=0,j=zI(U||1<<18),z=0,me=j.length>>>0,xe=0,ge=0;!(V&1);){if(V=ae(M,D),D+=3,V>>>1)V>>1==1?(xe=9,ge=5):(D=nt(M,D),xe=ze,ge=lt);else{D&7&&(D+=8-(D&7));var pe=M[D>>>3]|M[(D>>>3)+1]<<8;if(D+=32,pe>0)for(!U&&me<z+pe&&(j=ne(j,z+pe),me=j.length);pe-- >0;)j[z++]=M[D>>>3],D+=8;continue}for(;;){!U&&me<z+32767&&(j=ne(j,z+32767),me=j.length);var Ce=$e(M,D,xe),ve=V>>>1==1?te[Ce]:Ee[Ce];if(D+=ve&15,ve>>>=4,!(ve>>>8&255))j[z++]=ve;else{if(ve==256)break;ve-=257;var W=ve<8?0:ve-4>>2;W>5&&(W=0);var de=z+L[ve];W>0&&(de+=$e(M,D,W),D+=W),Ce=$e(M,D,ge),ve=V>>>1==1?ee[Ce]:Oe[Ce],D+=ve&15,ve>>>=4;var he=ve<4?0:ve-2>>1,Ie=K[ve];for(he>0&&(Ie+=$e(M,D,he),D+=he),!U&&me<de&&(j=ne(j,de+100),me=j.length);z<de;)j[z]=j[z-Ie],++z}}}return U?[j,D+7>>>3]:[j.slice(0,z),D+7>>>3]}function yt(M,U){var D=M.slice(M.l||0),V=Je(D,U);return M.l+=V[1],V[0]}function Jt(M,U){if(M)typeof console<"u"&&console.error(U);else throw new Error(U)}function _o(M,U){var D=M;fn(D,0);var V=[],j=[],z={FileIndex:V,FullPaths:j};_(z,{root:U.root});for(var me=D.length-4;(D[me]!=80||D[me+1]!=75||D[me+2]!=5||D[me+3]!=6)&&me>=0;)--me;D.l=me+4,D.l+=4;var xe=D.read_shift(2);D.l+=6;var ge=D.read_shift(4);for(D.l=ge,me=0;me<xe;++me){D.l+=20;var pe=D.read_shift(4),Ce=D.read_shift(4),ve=D.read_shift(2),W=D.read_shift(2),de=D.read_shift(2);D.l+=8;var he=D.read_shift(4),Ie=a(D.slice(D.l+ve,D.l+ve+W));D.l+=ve+W+de;var Ke=D.l;D.l=he+4,hi(D,pe,Ce,z,Ie),D.l=Ke}return z}function hi(M,U,D,V,j){M.l+=2;var z=M.read_shift(2),me=M.read_shift(2),xe=o(M);if(z&8257)throw new Error("Unsupported ZIP encryption");for(var ge=M.read_shift(4),pe=M.read_shift(4),Ce=M.read_shift(4),ve=M.read_shift(2),W=M.read_shift(2),de="",he=0;he<ve;++he)de+=String.fromCharCode(M[M.l++]);if(W){var Ie=a(M.slice(M.l,M.l+W));(Ie[21589]||{}).mt&&(xe=Ie[21589].mt),((j||{})[21589]||{}).mt&&(xe=j[21589].mt)}M.l+=W;var Ke=M.slice(M.l,M.l+pe);switch(me){case 8:Ke=x(M,Ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+me)}var mt=!1;z&8&&(ge=M.read_shift(4),ge==134695760&&(ge=M.read_shift(4),mt=!0),pe=M.read_shift(4),Ce=M.read_shift(4)),pe!=U&&Jt(mt,"Bad compressed size: "+U+" != "+pe),Ce!=D&&Jt(mt,"Bad uncompressed size: "+D+" != "+Ce),pa(V,de,Ke,{unsafe:!0,mt:xe})}function vl(M,U){var D=U||{},V=[],j=[],z=ye(1),me=D.compression?8:0,xe=0,ge=0,pe=0,Ce=0,ve=0,W=M.FullPaths[0],de=W,he=M.FileIndex[0],Ie=[],Ke=0;for(ge=1;ge<M.FullPaths.length;++ge)if(de=M.FullPaths[ge].slice(W.length),he=M.FileIndex[ge],!(!he.size||!he.content||de=="Sh33tJ5")){var mt=Ce,ut=ye(de.length);for(pe=0;pe<de.length;++pe)ut.write_shift(1,de.charCodeAt(pe)&127);ut=ut.slice(0,ut.l),Ie[ve]=zce.buf(he.content,0);var cr=he.content;me==8&&(cr=R(cr)),z=ye(30),z.write_shift(4,67324752),z.write_shift(2,20),z.write_shift(2,xe),z.write_shift(2,me),he.mt?s(z,he.mt):z.write_shift(4,0),z.write_shift(-4,Ie[ve]),z.write_shift(4,cr.length),z.write_shift(4,he.content.length),z.write_shift(2,ut.length),z.write_shift(2,0),Ce+=z.length,V.push(z),Ce+=ut.length,V.push(ut),Ce+=cr.length,V.push(cr),z=ye(46),z.write_shift(4,33639248),z.write_shift(2,0),z.write_shift(2,20),z.write_shift(2,xe),z.write_shift(2,me),z.write_shift(4,0),z.write_shift(-4,Ie[ve]),z.write_shift(4,cr.length),z.write_shift(4,he.content.length),z.write_shift(2,ut.length),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(4,0),z.write_shift(4,mt),Ke+=z.l,j.push(z),Ke+=ut.length,j.push(ut),++ve}return z=ye(22),z.write_shift(4,101010256),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,ve),z.write_shift(2,ve),z.write_shift(4,Ke),z.write_shift(4,Ce),z.write_shift(2,0),on([on(V),on(j),z])}var cn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Zt(M,U){if(M.ctype)return M.ctype;var D=M.name||"",V=D.match(/\.([^\.]+)$/);return V&&cn[V[1]]||U&&(V=(D=U).match(/[\.\\]([^\.\\])+$/),V&&cn[V[1]])?cn[V[1]]:"application/octet-stream"}function Mr(M){for(var U=Vd(M),D=[],V=0;V<U.length;V+=76)D.push(U.slice(V,V+76));return D.join(`\r
`)+`\r
`}function zr(M){var U=M.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(pe){var Ce=pe.charCodeAt(0).toString(16).toUpperCase();return"="+(Ce.length==1?"0"+Ce:Ce)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],V=U.split(`\r
`),j=0;j<V.length;++j){var z=V[j];if(z.length==0){D.push("");continue}for(var me=0;me<z.length;){var xe=76,ge=z.slice(me,me+xe);ge.charAt(xe-1)=="="?xe--:ge.charAt(xe-2)=="="?xe-=2:ge.charAt(xe-3)=="="&&(xe-=3),ge=z.slice(me,me+xe),me+=xe,me<z.length&&(ge+="="),D.push(ge)}}return D.join(`\r
`)}function Xt(M){for(var U=[],D=0;D<M.length;++D){for(var V=M[D];D<=M.length&&V.charAt(V.length-1)=="=";)V=V.slice(0,V.length-1)+M[++D];U.push(V)}for(var j=0;j<U.length;++j)U[j]=U[j].replace(/[=][0-9A-Fa-f]{2}/g,function(z){return String.fromCharCode(parseInt(z.slice(1),16))});return Ri(U.join(`\r
`))}function Oh(M,U,D){for(var V="",j="",z="",me,xe=0;xe<10;++xe){var ge=U[xe];if(!ge||ge.match(/^\s*$/))break;var pe=ge.match(/^(.*?):\s*([^\s].*)$/);if(pe)switch(pe[1].toLowerCase()){case"content-location":V=pe[2].trim();break;case"content-type":z=pe[2].trim();break;case"content-transfer-encoding":j=pe[2].trim();break}}switch(++xe,j.toLowerCase()){case"base64":me=Ri(Ai(U.slice(xe).join("")));break;case"quoted-printable":me=Xt(U.slice(xe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+j)}var Ce=pa(M,V.slice(D.length),me,{unsafe:!0});z&&(Ce.ctype=z)}function kg(M,U){if(Y(M.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=U&&U.root||"",V=(Ct&&Buffer.isBuffer(M)?M.toString("binary"):Y(M)).split(`\r
`),j=0,z="";for(j=0;j<V.length;++j)if(z=V[j],!!/^Content-Location:/i.test(z)&&(z=z.slice(z.indexOf("file")),D||(D=z.slice(0,z.lastIndexOf("/")+1)),z.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),z.slice(0,D.length)!=D););var me=(V[1]||"").match(/boundary="(.*?)"/);if(!me)throw new Error("MAD cannot find boundary");var xe="--"+(me[1]||""),ge=[],pe=[],Ce={FileIndex:ge,FullPaths:pe};_(Ce);var ve,W=0;for(j=0;j<V.length;++j){var de=V[j];de!==xe&&de!==xe+"--"||(W++&&Oh(Ce,V.slice(ve,j),D),ve=j)}return Ce}function Ng(M,U){var D=U||{},V=D.boundary||"SheetJS";V="------="+V;for(var j=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+V.slice(2)+'"',"","",""],z=M.FullPaths[0],me=z,xe=M.FileIndex[0],ge=1;ge<M.FullPaths.length;++ge)if(me=M.FullPaths[ge].slice(z.length),xe=M.FileIndex[ge],!(!xe.size||!xe.content||me=="Sh33tJ5")){me=me.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ke){return"_x"+Ke.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ke){return"_u"+Ke.charCodeAt(0).toString(16)+"_"});for(var pe=xe.content,Ce=Ct&&Buffer.isBuffer(pe)?pe.toString("binary"):Y(pe),ve=0,W=Math.min(1024,Ce.length),de=0,he=0;he<=W;++he)(de=Ce.charCodeAt(he))>=32&&de<128&&++ve;var Ie=ve>=W*4/5;j.push(V),j.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+me),j.push("Content-Transfer-Encoding: "+(Ie?"quoted-printable":"base64")),j.push("Content-Type: "+Zt(xe,me)),j.push(""),j.push(Ie?zr(Ce):Mr(Ce))}return j.push(V+`--\r
`),j.join(`\r
`)}function hw(M){var U={};return _(U,M),U}function pa(M,U,D,V){var j=V&&V.unsafe;j||_(M);var z=!j&&qe.find(M,U);if(!z){var me=M.FullPaths[0];U.slice(0,me.length)==me?me=U:(me.slice(-1)!="/"&&(me+="/"),me=(me+U).replace("//","/")),z={name:i(U),type:2},M.FileIndex.push(z),M.FullPaths.push(me),j||qe.utils.cfb_gc(M)}return z.content=D,z.size=D?D.length:0,V&&(V.CLSID&&(z.clsid=V.CLSID),V.mt&&(z.mt=V.mt),V.ct&&(z.ct=V.ct)),z}function Ph(M,U){_(M);var D=qe.find(M,U);if(D){for(var V=0;V<M.FileIndex.length;++V)if(M.FileIndex[V]==D)return M.FileIndex.splice(V,1),M.FullPaths.splice(V,1),!0}return!1}function fw(M,U,D){_(M);var V=qe.find(M,U);if(V){for(var j=0;j<M.FileIndex.length;++j)if(M.FileIndex[j]==V)return M.FileIndex[j].name=i(D),M.FullPaths[j]=D,!0}return!1}function Kn(M){b(M,!0)}return e.find=B,e.read=O,e.parse=u,e.write=Pe,e.writeFile=Re,e.utils={cfb_new:hw,cfb_add:pa,cfb_del:Ph,cfb_mov:fw,cfb_gc:Kn,ReadShift:gd,CheckField:DF,prep_blob:fn,bconcat:on,use_zlib:v,_deflateRaw:se,_inflateRaw:yt,consts:ce},e}();function Gce(t){return typeof t=="string"?rw(t):Array.isArray(t)?wce(t):t}function Rg(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=rw(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?po(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([Gce(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(t);return a.open("w"),a.encoding="binary",Array.isArray(e)&&(e=gl(e)),a.write(e),a.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function Yce(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ir(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function QI(t,e){for(var r=[],n=Ir(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function iw(t){for(var e=[],r=Ir(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function sw(t){for(var e=[],r=Ir(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function Kce(t){for(var e=[],r=Ir(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var sv=new Date(1899,11,30,0,0,0);function Jr(t,e){var r=t.getTime(),n=sv.getTime()+(t.getTimezoneOffset()-sv.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var pF=new Date,Xce=sv.getTime()+(pF.getTimezoneOffset()-sv.getTimezoneOffset())*6e4,eM=pF.getTimezoneOffset();function ow(t){var e=new Date;return e.setTime(t*24*60*60*1e3+Xce),e.getTimezoneOffset()!==eM&&e.setTime(e.getTime()+(e.getTimezoneOffset()-eM)*6e4),e}function qce(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var tM=new Date("2017-02-19T19:06:09.000Z"),vF=isNaN(tM.getFullYear())?new Date("2/19/17"):tM,Jce=vF.getFullYear()==2017;function ar(t,e){var r=new Date(t);if(Jce)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(vF.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Oc(t,e){if(Ct&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return po(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return po(iF(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return po(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return po(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"â¬":"Â","â":"Â",Æ:"Â","â":"Â","â¦":"Â","â ":"Â","â¡":"Â","Ë":"Â","â°":"Â",Å :"Â","â¹":"Â",Å:"Â",Å½:"Â","â":"Â","â":"Â","â":"Â","â":"Â","â¢":"Â","â":"Â","â":"Â","Ë":"Â","â¢":"Â",Å¡:"Â","âº":"Â",Å:"Â",Å¾:"Â",Å¸:"Â"};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[â¬âÆââ¦â â¡Ëâ°Å â¹ÅÅ½âââââ¢ââËâ¢Å¡âºÅÅ¾Å¸]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function lr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=lr(t[r]));return e}function Tr(t,e){for(var r="";r.length<e;)r+=t;return r}function _s(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var Zce=["january","february","march","april","may","june","july","august","september","october","november","december"];function mh(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&Zce.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var Qce=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],a=1;a<s.length;++a)o.push(i),o.push(s[a]);return o}}();function wF(t){return t?t.content&&t.type?Oc(t.content,!0):t.data?Wf(t.data):t.asNodeBuffer&&Ct?Wf(t.asNodeBuffer().toString("binary")):t.asBinary?Wf(t.asBinary()):t._data&&t._data.getContent?Wf(Oc(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function CF(t){if(!t)return null;if(t.data)return UI(t.data);if(t.asNodeBuffer&&Ct)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?UI(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function eue(t){return t&&t.name.slice(-4)===".bin"?CF(t):wF(t)}function Vi(t,e){for(var r=t.FullPaths||Ir(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function IE(t,e){var r=Vi(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Vr(t,e,r){if(!r)return eue(IE(t,e));if(!e)return null;try{return Vr(t,e)}catch{return null}}function Ti(t,e,r){if(!r)return wF(IE(t,e));if(!e)return null;try{return Ti(t,e)}catch{return null}}function tue(t,e,r){return CF(IE(t,e))}function rM(t){for(var e=t.FullPaths||Ir(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function ht(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Ct?n=da(r):n=Cce(r),qe.utils.cfb_add(t,e,n)}qe.utils.cfb_add(t,e,r)}else t.file(e,r)}function ME(){return qe.utils.cfb_new()}function yF(t,e){switch(e.type){case"base64":return qe.read(t,{type:"base64"});case"binary":return qe.read(t,{type:"binary"});case"buffer":case"array":return qe.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function jf(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Lr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,rue=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,nM=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,nue=/<[^>]*>/g,On=Lr.match(nM)?nM:nue,iue=/<\w*:/,sue=/<(\/?)\w+:/;function rt(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var o=t.match(rue),a=0,l="",c=0,u="",h="",f=1;if(o)for(c=0;c!=o.length;++c){for(h=o[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(u=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(f=(i=h.charCodeAt(s+1))==34||i==39?1:0,l=h.slice(s+1+f,h.length-f),a=0;a!=u.length&&u.charCodeAt(a)!==58;++a);if(a===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var d=(a===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(a+1);if(n[d]&&u.slice(a-3,a)=="ext")continue;n[d]=l,n[d.toLowerCase()]=l}}return n}function Ro(t){return t.replace(sue,"<$1")}var xF={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},OE=iw(xF),It=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(a,l){return xF[a]||String.fromCharCode(parseInt(l,a.indexOf("x")>-1?16:10))||a}).replace(e,function(a,l){return String.fromCharCode(parseInt(l,16))});var o=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,o)+r(i.slice(o+3))}}(),PE=/[&<>'"]/g,oue=/[\u0000-\u0008\u000b-\u001f]/g;function Ut(t){var e=t+"";return e.replace(PE,function(r){return OE[r]}).replace(oue,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function iM(t){return Ut(t).replace(/ /g,"_x0020_")}var SF=/[\u0000-\u001f]/g;function kE(t){var e=t+"";return e.replace(PE,function(r){return OE[r]}).replace(/\n/g,"<br/>").replace(SF,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function aue(t){var e=t+"";return e.replace(PE,function(r){return OE[r]}).replace(SF,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var sM=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function lue(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function or(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function W1(t){for(var e="",r=0,n=0,i=0,s=0,o=0,a=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,e+=String.fromCharCode(o);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}o=t.charCodeAt(r++),a=((n&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(a>>>10&1023)),e+=String.fromCharCode(56320+(a&1023))}return e}function oM(t){var e=sl(2*t.length),r,n,i=1,s=0,o=0,a;for(n=0;n<t.length;n+=i)i=1,(a=t.charCodeAt(n))<128?r=a:a<224?(r=(a&31)*64+(t.charCodeAt(n+1)&63),i=2):a<240?(r=(a&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(a&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function aM(t){return da(t,"binary").toString("utf8")}var Em="foo bar bazÃ¢ÂÂÃ°ÂÂÂ£",Kt=Ct&&(aM(Em)==W1(Em)&&aM||oM(Em)==W1(Em)&&oM)||W1,po=Ct?function(t){return da(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Ud=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),bF=function(){var t=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),cue=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),uue=/<\/?(?:vt:)?variant>/g,hue=/<(?:vt:)([^>]*)>([\s\S]*)</;function lM(t,e){var r=rt(t),n=t.match(cue(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var o=s.replace(uue,"").match(hue);o&&i.push({v:Kt(o[2]),t:o[1]})}),i}var EF=/(^\s|\s$|\n)/;function dn(t,e){return"<"+t+(e.match(EF)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function jd(t){return Ir(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Ne(t,e,r){return"<"+t+(r!=null?jd(r):"")+(e!=null?(e.match(EF)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function ax(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function fue(t,e){switch(typeof t){case"string":var r=Ne("vt:lpwstr",Ut(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ne((t|0)==t?"vt:i4":"vt:r8",Ut(String(t)));case"boolean":return Ne("vt:bool",t?"true":"false")}if(t instanceof Date)return Ne("vt:filetime",ax(t));throw new Error("Unable to serialize "+t)}function NE(t){if(Ct&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Kt(gl(TE(t)));throw new Error("Bad input format: expected Buffer or string")}var zd=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,qr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},zc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],bi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function due(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function gue(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,o=n?-e:e;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var a=0;a<=5;++a,s/=256)t[r+a]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var cM=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},uM=Ct?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:da(e)})):cM(t)}:cM,hM=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(ta(t,i)));return n.join("").replace(Un,"")},FE=Ct?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Un,""):hM(t,e,r)}:hM,fM=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},RF=Ct?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):fM(t,e,r)}:fM,dM=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Uu(t,i)));return n.join("")},Tg=Ct?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):dM(e,r,n)}:dM,TF=function(t,e){var r=Ei(t,e);return r>0?Tg(t,e+4,e+4+r-1):""},_F=TF,AF=function(t,e){var r=Ei(t,e);return r>0?Tg(t,e+4,e+4+r-1):""},IF=AF,MF=function(t,e){var r=2*Ei(t,e);return r>0?Tg(t,e+4,e+4+r-1):""},OF=MF,PF=function(e,r){var n=Ei(e,r);return n>0?FE(e,r+4,r+4+n):""},kF=PF,NF=function(t,e){var r=Ei(t,e);return r>0?Tg(t,e+4,e+4+r):""},FF=NF,HF=function(t,e){return due(t,e)},ov=HF,HE=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ct&&(_F=function(e,r){if(!Buffer.isBuffer(e))return TF(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},IF=function(e,r){if(!Buffer.isBuffer(e))return AF(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},OF=function(e,r){if(!Buffer.isBuffer(e))return MF(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},kF=function(e,r){if(!Buffer.isBuffer(e))return PF(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},FF=function(e,r){if(!Buffer.isBuffer(e))return NF(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},ov=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):HF(e,r)},HE=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Uu=function(t,e){return t[e]},ta=function(t,e){return t[e+1]*256+t[e]},mue=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Ei=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},ac=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},pue=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function gd(t,e){var r="",n,i,s=[],o,a,l,c;switch(e){case"dbcs":if(c=this.l,Ct&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(ta(this,c)),c+=2;t*=2;break;case"utf8":r=Tg(this,this.l,this.l+t);break;case"utf16le":t*=2,r=FE(this,this.l,this.l+t);break;case"wstr":return gd.call(this,t,"dbcs");case"lpstr-ansi":r=_F(this,this.l),t=4+Ei(this,this.l);break;case"lpstr-cp":r=IF(this,this.l),t=4+Ei(this,this.l);break;case"lpwstr":r=OF(this,this.l),t=4+2*Ei(this,this.l);break;case"lpp4":t=4+Ei(this,this.l),r=kF(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Ei(this,this.l),r=FF(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=Uu(this,this.l+t++))!==0;)s.push(bm(o));r=s.join("");break;case"_wstr":for(t=0,r="";(o=ta(this,this.l+t))!==0;)s.push(bm(o)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=Uu(this,c),this.l=c+1,a=gd.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(bm(ta(this,c))),c+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=Uu(this,c),this.l=c+1,a=gd.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(bm(Uu(this,c))),c+=1}r=s.join("");break;default:switch(t){case 1:return n=Uu(this,this.l),this.l++,n;case 2:return n=(e==="i"?mue:ta)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?ac:pue)(this,this.l),this.l+=4,n):(i=Ei(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=ov(this,this.l):i=ov([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=RF(this,this.l,t);break}}return this.l+=t,r}var vue=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},wue=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},Cue=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function yue(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)Cue(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,vue(this,e,this.l);break;case 8:if(n=8,r==="f"){gue(this,e,this.l);break}case 16:break;case-4:n=4,wue(this,e,this.l);break}return this.l+=n,this}function DF(t,e){var r=RF(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function fn(t,e){t.l=e,t.read_shift=gd,t.chk=DF,t.write_shift=yue}function Mn(t,e){t.l+=e}function ye(t){var e=sl(t);return fn(e,0),e}function ga(t,e,r){if(t){var n,i,s;fn(t,t.l||0);for(var o=t.length,a=0,l=0;t.l<o;){a=t.read_shift(1),a&128&&(a=(a&127)+((t.read_shift(1)&127)<<7));var c=Jd[a]||Jd[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var u=c.f&&c.f(t,s,r);if(t.l=l,e(u,c,a))return}}}function li(){var t=[],e=Ct?256:2048,r=function(c){var u=ye(c);return fn(u,0),u},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},o=function(){return i(),on(t)},a=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:a,end:o,_bufs:t}}function Te(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=Jd[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=t.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var a=0;a!=4;++a)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&HE(r)&&t.push(r)}}function md(t,e,r){var n=lr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function gM(t,e,r){var n=lr(t);return n.s=md(n.s,e.s,r),n.e=md(n.e,e.s,r),n}function pd(t,e){if(t.cRel&&t.c<0)for(t=lr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=lr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=tt(t);return!t.cRel&&t.cRel!=null&&(r=bue(r)),!t.rRel&&t.rRel!=null&&(r=xue(r)),r}function U1(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+yr(t.s.c)+":"+(t.e.cRel?"":"$")+yr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Hr(t.s.r)+":"+(t.e.rRel?"":"$")+Hr(t.e.r):pd(t.s,e.biff)+":"+pd(t.e,e.biff)}function DE(t){return parseInt(Sue(t),10)-1}function Hr(t){return""+(t+1)}function xue(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Sue(t){return t.replace(/\$(\d+)$/,"$1")}function LE(t){for(var e=Eue(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function yr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function bue(t){return t.replace(/^([A-Z])/,"$$$1")}function Eue(t){return t.replace(/^\$([A-Z])/,"$1")}function Rue(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function xr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function tt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function ci(t){var e=t.indexOf(":");return e==-1?{s:xr(t),e:xr(t)}:{s:xr(t.slice(0,e)),e:xr(t.slice(e+1))}}function ct(t,e){return typeof e>"u"||typeof e=="number"?ct(t.s,t.e):(typeof t!="string"&&(t=tt(t)),typeof e!="string"&&(e=tt(e)),t==e?t:t+":"+e)}function Mt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function mM(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=es(t.z,r?Jr(e):e)}catch{}try{return t.w=es((t.XF||{}).numFmtId||(r?14:0),r?Jr(e):e)}catch{return""+e}}function la(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?ma[t.v]||t.v:e==null?mM(t,t.v):mM(t,e))}function ml(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function LF(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),o=0,a=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?xr(n.origin):n.origin;o=l.r,a=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Mt(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),o==-1&&(c.e.r=o=u.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=e[h].length;++f)if(!(typeof e[h][f]>"u")){var d={v:e[h][f]},g=o+h,m=a+f;if(c.s.r>g&&(c.s.r=g),c.s.c>m&&(c.s.c=m),c.e.r<g&&(c.e.r=g),c.e.c<m&&(c.e.c=m),e[h][f]&&typeof e[h][f]=="object"&&!Array.isArray(e[h][f])&&!(e[h][f]instanceof Date))d=e[h][f];else if(Array.isArray(d.v)&&(d.f=e[h][f][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||et[14],n.cellDates?(d.t="d",d.w=es(d.z,Jr(d.v))):(d.t="n",d.v=Jr(d.v),d.w=es(d.z,d.v))):d.t="s";if(i)s[g]||(s[g]=[]),s[g][m]&&s[g][m].z&&(d.z=s[g][m].z),s[g][m]=d;else{var p=tt({c:m,r:g});s[p]&&s[p].z&&(d.z=s[p].z),s[p]=d}}}return c.s.c<1e7&&(s["!ref"]=ct(c)),s}function Ih(t,e){return LF(null,t,e)}function Tue(t){return t.read_shift(4,"i")}function As(t,e){return e||(e=ye(4)),e.write_shift(4,t),e}function In(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function an(t,e){var r=!1;return e==null&&(r=!0,e=ye(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function _ue(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Aue(t,e){return e||(e=ye(4)),e.write_shift(2,0),e.write_shift(2,0),e}function $E(t,e){var r=t.l,n=t.read_shift(1),i=In(t),s=[],o={t:i,h:i};if(n&1){for(var a=t.read_shift(4),l=0;l!=a;++l)s.push(_ue(t));o.r=s}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function Iue(t,e){var r=!1;return e==null&&(r=!0,e=ye(15+4*t.t.length)),e.write_shift(1,0),an(t.t,e),r?e.slice(0,e.l):e}var Mue=$E;function Oue(t,e){var r=!1;return e==null&&(r=!0,e=ye(23+4*t.t.length)),e.write_shift(1,1),an(t.t,e),e.write_shift(4,1),Aue({ich:0,ifnt:0},e),r?e.slice(0,e.l):e}function ts(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Gc(t,e){return e==null&&(e=ye(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Yc(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Kc(t,e){return e==null&&(e=ye(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var Pue=In,$F=an;function BE(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function av(t,e){var r=!1;return e==null&&(r=!0,e=ye(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var kue=In,lx=BE,VE=av;function WE(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?ov([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):ac(e,0)>>2;return r?i/100:i}function BF(t,e){e==null&&(e=ye(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?n=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function VF(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function Nue(t,e){return e||(e=ye(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Xc=VF,Mh=Nue;function An(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Pc(t,e){return(e||ye(8)).write_shift(8,t,"f")}function Fue(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),o=t.read_shift(1),a=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=vc[i];c&&(e.rgb=Yd(c));break;case 2:e.rgb=Yd([o,a,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function lv(t,e){if(e||(e=ye(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function Hue(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function Due(t,e){e||(e=ye(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function WF(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function Lue(t){return WF(t,1)}function $ue(t){return WF(t,2)}var UE=2,oi=3,Rm=11,pM=12,cv=19,Tm=64,Bue=65,Vue=71,Wue=4108,Uue=4126,rn=80,UF=81,jue=[rn,UF],cx={1:{n:"CodePage",t:UE},2:{n:"Category",t:rn},3:{n:"PresentationFormat",t:rn},4:{n:"ByteCount",t:oi},5:{n:"LineCount",t:oi},6:{n:"ParagraphCount",t:oi},7:{n:"SlideCount",t:oi},8:{n:"NoteCount",t:oi},9:{n:"HiddenCount",t:oi},10:{n:"MultimediaClipCount",t:oi},11:{n:"ScaleCrop",t:Rm},12:{n:"HeadingPairs",t:Wue},13:{n:"TitlesOfParts",t:Uue},14:{n:"Manager",t:rn},15:{n:"Company",t:rn},16:{n:"LinksUpToDate",t:Rm},17:{n:"CharacterCount",t:oi},19:{n:"SharedDoc",t:Rm},22:{n:"HyperlinksChanged",t:Rm},23:{n:"AppVersion",t:oi,p:"version"},24:{n:"DigSig",t:Bue},26:{n:"ContentType",t:rn},27:{n:"ContentStatus",t:rn},28:{n:"Language",t:rn},29:{n:"Version",t:rn},255:{},2147483648:{n:"Locale",t:cv},2147483651:{n:"Behavior",t:cv},1919054434:{}},ux={1:{n:"CodePage",t:UE},2:{n:"Title",t:rn},3:{n:"Subject",t:rn},4:{n:"Author",t:rn},5:{n:"Keywords",t:rn},6:{n:"Comments",t:rn},7:{n:"Template",t:rn},8:{n:"LastAuthor",t:rn},9:{n:"RevNumber",t:rn},10:{n:"EditTime",t:Tm},11:{n:"LastPrinted",t:Tm},12:{n:"CreatedDate",t:Tm},13:{n:"ModifiedDate",t:Tm},14:{n:"PageCount",t:oi},15:{n:"WordCount",t:oi},16:{n:"CharCount",t:oi},17:{n:"Thumbnail",t:Vue},18:{n:"Application",t:rn},19:{n:"DocSecurity",t:oi},255:{},2147483648:{n:"Locale",t:cv},2147483651:{n:"Behavior",t:cv},1919054434:{}},vM={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},zue=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Gue(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var Yue=Gue([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),vc=lr(Yue),ma={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},jF={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},hx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},_m={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function jE(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Kue(t){var e=jE();if(!t||!t.match)return e;var r={};if((t.match(On)||[]).forEach(function(n){var i=rt(n);switch(i[0].replace(iue,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[hx[i.ContentType]]!==void 0&&e[hx[i.ContentType]].push(i.PartName);break}}),e.xmlns!==qr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function zF(t,e){var r=Kce(hx),n=[],i;n[n.length]=Lr,n[n.length]=Ne("Types",null,{xmlns:qr.CT,"xmlns:xsd":qr.xsd,"xmlns:xsi":qr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Ne("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=Ne("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:_m[l][e.bookType]||_m[l].xlsx}))},o=function(l){(t[l]||[]).forEach(function(c){n[n.length]=Ne("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:_m[l][e.bookType]||_m[l].xlsx})})},a=function(l){(t[l]||[]).forEach(function(c){n[n.length]=Ne("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),o("sheets"),o("charts"),a("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),o("metadata"),a("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var St={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Gd(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function vd(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(On)||[]).forEach(function(i){var s=rt(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var a=s.TargetMode==="External"?s.Target:jf(s.Target,e);r[a]=o,n[s.Id]=o}}),r["!id"]=n,r}function nh(t){var e=[Lr,Ne("Relationships",null,{xmlns:qr.RELS})];return Ir(t["!id"]).forEach(function(r){e[e.length]=Ne("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Wt(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[St.HLINK,St.XPATH,St.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var Xue="application/vnd.oasis.opendocument.spreadsheet";function que(t,e){for(var r=NE(t),n,i;n=zd.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=rt(n[0],!1),i.path=="/"&&i.type!==Xue)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function Jue(t){var e=[Lr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function wM(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function Zue(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function Que(t){var e=[Lr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(wM(t[r][0],t[r][1])),e.push(Zue("",t[r][0]));return e.push(wM("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function GF(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+tv.version+"</meta:generator></office:meta></office:document-meta>"}var Ji=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],ehe=function(){for(var t=new Array(Ji.length),e=0;e<Ji.length;++e){var r=Ji[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function YF(t){var e={};t=Kt(t);for(var r=0;r<Ji.length;++r){var n=Ji[r],i=t.match(ehe[r]);i!=null&&i.length>0&&(e[n[1]]=It(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=ar(e[n[1]]))}return e}function j1(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Ut(e),n[n.length]=r?Ne(t,e,r):dn(t,e))}function KF(t,e){var r=e||{},n=[Lr,Ne("cp:coreProperties",null,{"xmlns:cp":qr.CORE_PROPS,"xmlns:dc":qr.dc,"xmlns:dcterms":qr.dcterms,"xmlns:dcmitype":qr.dcmitype,"xmlns:xsi":qr.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&j1("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:ax(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&j1("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:ax(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Ji.length;++s){var o=Ji[s],a=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&j1(o[0],a,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var wc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],XF=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function qF(t,e,r,n){var i=[];if(typeof t=="string")i=lM(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(u){return{v:u}}));var o=typeof e=="string"?lM(e,n).map(function(u){return u.v}):e,a=0,l=0;if(o.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"å·¥ä½è¡¨":case"ÐÐ¸ÑÑÑ":case"Ø£ÙØ±Ø§Ù Ø§ÙØ¹ÙÙ":case"ã¯ã¼ã¯ã·ã¼ã":case"××××× ××ª ×¢××××":case"ArbeitsblÃ¤tter":case"ÃalÄ±Åma SayfalarÄ±":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cÃ¡lculo":case"Planilhas":case"Regneark":case"Hojas de cÃ¡lculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=o.slice(a,a+l);break;case"Named Ranges":case"Rangos con nombre":case"ååä»ãä¸è¦§":case"Benannte Bereiche":case"Navngivne omrÃ¥der":r.NamedRanges=l,r.DefinedNames=o.slice(a,a+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=o.slice(a,a+l);break}a+=l}}function the(t,e,r){var n={};return e||(e={}),t=Kt(t),wc.forEach(function(i){var s=(t.match(Ud(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=It(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var o=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&qF(n.HeadingPairs,n.TitlesOfParts,e,r),e}function JF(t){var e=[],r=Ne;return t||(t={}),t.Application="SheetJS",e[e.length]=Lr,e[e.length]=Ne("Properties",null,{xmlns:qr.EXT_PROPS,"xmlns:vt":qr.vt}),wc.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Ut(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Ut(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var rhe=/<[^>]+>[^<]*/g;function nhe(t,e){var r={},n="",i=t.match(rhe);if(i)for(var s=0;s!=i.length;++s){var o=i[s],a=rt(o);switch(a[0]){case"<?xml":break;case"<Properties":break;case"<property":n=It(a.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var l=o.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=It(u);break;case"bool":r[n]=or(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=ar(u);break;case"cy":case"error":r[n]=It(u);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,c,l)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function ZF(t){var e=[Lr,Ne("Properties",null,{xmlns:qr.CUST_PROPS,"xmlns:vt":qr.vt})];if(!t)return e.join("");var r=1;return Ir(t).forEach(function(i){++r,e[e.length]=Ne("property",fue(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ut(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var fx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},z1;function ihe(t,e,r){z1||(z1=iw(fx)),e=z1[e]||e,t[e]=r}function she(t,e){var r=[];return Ir(fx).map(function(n){for(var i=0;i<Ji.length;++i)if(Ji[i][1]==n)return Ji[i];for(i=0;i<wc.length;++i)if(wc[i][1]==n)return wc[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(dn(fx[n[1]]||n[1],i))}}),Ne("DocumentProperties",r.join(""),{xmlns:bi.o})}function ohe(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Ir(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var o=0;o<Ji.length;++o)if(s==Ji[o][1])return;for(o=0;o<wc.length;++o)if(s==wc[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var a=t[s],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a=String(a),i.push(Ne(iM(s),a,{"dt:dt":l}))}}),e&&Ir(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var o=e[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o instanceof Date?(a="dateTime.tz",o=o.toISOString()):o=String(o),i.push(Ne(iM(s),o,{"dt:dt":a}))}}),"<"+n+' xmlns="'+bi.o+'">'+i.join("")+"</"+n+">"}function zE(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function ahe(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var o=ye(8);return o.write_shift(4,n),o.write_shift(4,i),o}function QF(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function eH(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function tH(t,e,r){return e===31?eH(t):QF(t,e,r)}function dx(t,e,r){return tH(t,e,r===!1?0:4)}function lhe(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return tH(t,e,0)}function che(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Un,""),t.l-i&2&&(t.l+=2)}return r}function uhe(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Un,"");return r}function hhe(t){var e=t.l,r=uv(t,UF);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=uv(t,oi);return[r,n]}function fhe(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(hhe(t));return r}function CM(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),o=t.read_shift(4);n[s]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(Un,"").replace(Uf,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function rH(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function dhe(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function uv(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==pM&&n!==e&&jue.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===pM?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return QF(t,n,4).replace(Un,"");case 31:return eH(t);case 64:return zE(t);case 65:return rH(t);case 71:return dhe(t);case 80:return dx(t,n,!s.raw).replace(Un,"");case 81:return lhe(t,n).replace(Un,"");case 4108:return fhe(t);case 4126:case 4127:return n==4127?che(t):uhe(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function yM(t,e){var r=ye(4),n=ye(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ye(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=ahe(e);break;case 31:case 80:for(n=ye(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return on([r,n])}function xM(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],o=0,a=0,l=-1,c={};for(o=0;o!=i;++o){var u=t.read_shift(4),h=t.read_shift(4);s[o]=[u,h+r]}s.sort(function(S,C){return S[1]-C[1]});var f={};for(o=0;o!=i;++o){if(t.l!==s[o][1]){var d=!0;if(o>0&&e)switch(e[s[o-1][0]].t){case 2:t.l+2===s[o][1]&&(t.l+=2,d=!1);break;case 80:t.l<=s[o][1]&&(t.l=s[o][1],d=!1);break;case 4108:t.l<=s[o][1]&&(t.l=s[o][1],d=!1);break}if((!e||o==0)&&t.l<=s[o][1]&&(d=!1,t.l=s[o][1]),d)throw new Error("Read Error: Expected address "+s[o][1]+" at "+t.l+" :"+o)}if(e){var g=e[s[o][0]];if(f[g.n]=uv(t,g.t,{raw:!0}),g.p==="version"&&(f[g.n]=String(f[g.n]>>16)+"."+("0000"+String(f[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(f[g.n]){case 0:f[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:bs(a=f[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[g.n])}}else if(s[o][0]===1){if(a=f.CodePage=uv(t,UE),bs(a),l!==-1){var m=t.l;t.l=s[l][1],c=CM(t,a),t.l=m}}else if(s[o][0]===0){if(a===0){l=o,t.l=s[o+1][1];continue}c=CM(t,a)}else{var p=c[s[o][0]],y;switch(t[t.l]){case 65:t.l+=4,y=rH(t);break;case 30:t.l+=4,y=dx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,y=dx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,y=t.read_shift(4,"i");break;case 19:t.l+=4,y=t.read_shift(4);break;case 5:t.l+=4,y=t.read_shift(8,"f");break;case 11:t.l+=4,y=Pr(t,4);break;case 64:t.l+=4,y=ar(zE(t));break;default:throw new Error("unparsed value: "+t[t.l])}f[p]=y}}return t.l=r+n,f}var nH=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ghe(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function SM(t,e,r){var n=ye(8),i=[],s=[],o=8,a=0,l=ye(8),c=ye(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),o+=8+l.length,!e){c=ye(8),c.write_shift(4,0),i.unshift(c);var u=[ye(4)];for(u[0].write_shift(4,t.length),a=0;a<t.length;++a){var h=t[a][0];for(l=ye(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,a+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=on(u),s.unshift(l),o+=8+l.length}for(a=0;a<t.length;++a)if(!(e&&!e[t[a][0]])&&!(nH.indexOf(t[a][0])>-1||XF.indexOf(t[a][0])>-1)&&t[a][1]!=null){var f=t[a][1],d=0;if(e){d=+e[t[a][0]];var g=r[d];if(g.p=="version"&&typeof f=="string"){var m=f.split(".");f=(+m[0]<<16)+(+m[1]||0)}l=yM(g.t,f)}else{var p=ghe(f);p==-1&&(p=31,f=String(f)),l=yM(p,f)}s.push(l),c=ye(8),c.write_shift(4,e?d:2+a),i.push(c),o+=8+l.length}var y=8*(s.length+1);for(a=0;a<s.length;++a)i[a].write_shift(4,y),y+=s[a].length;return n.write_shift(4,o),n.write_shift(4,s.length),on([n].concat(i).concat(s))}function bM(t,e,r){var n=t.content;if(!n)return{};fn(n,0);var i,s,o,a,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==qe.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),a=n.read_shift(4),i===1&&a!==n.l)throw new Error("Length mismatch: "+a+" !== "+n.l);i===2&&(o=n.read_shift(16),l=n.read_shift(4));var h=xM(n,e),f={SystemIdentifier:c};for(var d in h)f[d]=h[d];if(f.FMTID=s,i===1)return f;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var g;try{g=xM(n,null)}catch{}for(d in g)f[d]=g[d];return f.FMTID=[s,o],f}function EM(t,e,r,n,i,s){var o=ye(i?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,qe.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,i?68:48);var l=SM(t,r,n);if(a.push(l),i){var c=SM(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+l.length),a.push(c)}return on(a)}function ka(t,e){return t.read_shift(e),null}function mhe(t,e){e||(e=ye(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function phe(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function Pr(t,e){return t.read_shift(e)===1}function $n(t,e){return e||(e=ye(2)),e.write_shift(2,+!!t),e}function Wr(t){return t.read_shift(2,"u")}function zi(t,e){return e||(e=ye(2)),e.write_shift(2,t),e}function iH(t,e){return phe(t,e,Wr)}function vhe(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function sH(t,e,r){return r||(r=ye(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function _g(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?t.read_shift(n,i):"";return o}function whe(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),o=0,a,l={};i&&(o=t.read_shift(2)),n&&(a=t.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",u=e===0?"":t.read_shift(e,c);return i&&(t.l+=4*o),n&&(t.l+=a),l.t=u,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Che(t){var e=t.t||"",r=ye(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ye(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return on(i)}function kc(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Ag(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):kc(t,n,r)}function qc(t,e,r){if(r.biff>5)return Ag(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function oH(t,e,r){return r||(r=ye(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function yhe(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function xhe(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Un,"");return n&&(t.l+=24),i}function She(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(s>>1,"utf16le").replace(Un,"");return r+o}function bhe(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return xhe(t);case"0303000000000000c000000000000046":return She(t);default:throw new Error("Unsupported Moniker "+r)}}function Am(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Un,""):"";return r}function RM(t,e){e||(e=ye(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function Ehe(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,o,a,l,c="",u,h;i&16&&(s=Am(t,r-t.l)),i&128&&(o=Am(t,r-t.l)),(i&257)===257&&(a=Am(t,r-t.l)),(i&257)===1&&(l=bhe(t,r-t.l)),i&8&&(c=Am(t,r-t.l)),i&32&&(u=t.read_shift(16)),i&64&&(h=zE(t)),t.l=r;var f=o||a||l||"";f&&c&&(f+="#"+c),f||(f="#"+c),i&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var d={Target:f};return u&&(d.guid=u),h&&(d.time=h),s&&(d.Tooltip=s),d}function Rhe(t){var e=ye(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(s==28)n=n.slice(1),RM(n,e);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var a=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(a.length+1)),r=0;r<a.length;++r)e.write_shift(2,a.charCodeAt(r));e.write_shift(2,0),s&8&&RM(i>-1?n.slice(i+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function aH(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function lH(t,e){var r=aH(t);return r[3]=0,r}function To(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Nc(t,e,r,n){return n||(n=ye(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function The(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function _he(t,e,r){return e===0?"":qc(t,e,r)}function Ahe(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[i,s,o]}function cH(t){var e=t.read_shift(2),r=WE(t);return[e,r]}function Ihe(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=_g(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function aw(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function uH(t,e){return e||(e=ye(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function hH(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var Mhe=hH;function fH(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function Ohe(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function Phe(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Sn(t){t.l+=2,t.l+=t.read_shift(2)}var khe={0:Sn,4:Sn,5:Sn,6:Sn,7:Phe,8:Sn,9:Sn,10:Sn,11:Sn,12:Sn,13:Ohe,14:Sn,15:Sn,16:Sn,17:Sn,18:Sn,19:Sn,20:Sn,21:fH};function Nhe(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(khe[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Im(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function GE(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ye(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Fhe(t,e){return e===0||t.read_shift(2),1200}function Hhe(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=qc(t,0,r);return t.read_shift(e+n-t.l),i}function Dhe(t,e){var r=!e||e.biff==8,n=ye(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Lhe(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function $he(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=_g(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:s,name:o}}function Bhe(t,e){var r=!e||e.biff>=8?2:1,n=ye(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function Vhe(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],o=0;o!=i&&t.l<r;++o)s.push(whe(t));return s.Count=n,s.Unique=i,s}function Whe(t,e){var r=ye(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=Che(t[i]);var s=on([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function Uhe(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function jhe(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function zhe(t){var e=The(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function Ghe(t){return t.read_shift(2),t.read_shift(4)}function TM(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function Yhe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),a=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:o,FirstTab:a,Selected:l,TabRatio:c}}function Khe(){var t=ye(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function Xhe(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function qhe(t){var e=ye(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Jhe(){}function Zhe(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=_g(t,0,r),n}function Qhe(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=ye(i);return s.write_shift(2,(t.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function efe(t){var e=To(t);return e.isst=t.read_shift(4),e}function tfe(t,e,r,n){var i=ye(10);return Nc(t,e,n,i),i.write_shift(4,r),i}function rfe(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=To(t);r.biff==2&&t.l++;var s=Ag(t,n-t.l,r);return i.val=s,i}function nfe(t,e,r,n,i){var s=!i||i.biff==8,o=ye(8+ +s+(1+s)*r.length);return Nc(t,e,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function ife(t,e,r){var n=t.read_shift(2),i=qc(t,0,r);return[n,i]}function sfe(t,e,r,n){var i=r&&r.biff==5;n||(n=ye(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var ofe=qc;function _M(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),o=t.read_shift(i),a=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:a},e:{r:o,c:l}}}function afe(t,e){var r=e.biff==8||!e.biff?4:2,n=ye(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function lfe(t){var e=t.read_shift(2),r=t.read_shift(2),n=cH(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function cfe(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(cH(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:s}}function ufe(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:s}}function hfe(t,e,r,n){var i={},s=t.read_shift(4),o=t.read_shift(4),a=t.read_shift(4),l=t.read_shift(2);return i.patternType=zue[a>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=a&127,i.icvBottom=a>>7&127,i.icvDiag=a>>14&127,i.dgDiag=a>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function ffe(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=hfe(t,e,n.fStyle,r),n}function AM(t,e,r,n){var i=r&&r.biff==5;n||(n=ye(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function dfe(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function gfe(t){var e=ye(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function IM(t,e,r){var n=To(t);(r.biff==2||e==9)&&++t.l;var i=vhe(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function mfe(t,e,r,n,i,s){var o=ye(8);return Nc(t,e,n,o),sH(r,s,o),o}function pfe(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=To(t),i=An(t);return n.val=i,n}function vfe(t,e,r,n){var i=ye(14);return Nc(t,e,n,i),Pc(r,i),i}var MM=_he;function wfe(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=kc(t,s),a=[];n>t.l;)a.push(Ag(t));return[s,i,o,a]}function OM(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=Ihe(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var Cfe=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function PM(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),o=t.read_shift(1),a=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=kc(t,o,r);i&32&&(c=Cfe[c.charCodeAt(0)]);var u=n-t.l;r&&r.biff==2&&--u;var h=n==t.l||a===0||!(u>0)?[]:Nme(t,u,r,a);return{chKey:s,Name:c,itab:l,rgce:h}}function dH(t,e,r){if(r.biff<8)return yfe(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(Ahe(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function yfe(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=_g(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function xfe(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=kc(t,n,r),o=kc(t,i,r);return[s,o]}function Sfe(t,e,r){var n=hH(t);t.l++;var i=t.read_shift(1);return e-=8,[Fme(t,e,r),i,n]}function kM(t,e,r){var n=Mhe(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,Pme(t,e,r)]}function bfe(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function Efe(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),a=qc(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},a,o,s]}}function Rfe(t,e,r){return Efe(t,e,r)}function Tfe(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(aw(t));return r}function _fe(t){var e=ye(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)uH(t[r],e);return e}function Afe(t,e,r){if(r&&r.biff<8)return Mfe(t,e,r);var n=fH(t),i=Nhe(t,e-22,n[1]);return{cmo:n,ft:i}}var Ife={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function Mfe(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((Ife[n]||Mn)(t,e,r)),{cmo:[i,n,s],ft:o}}function Ofe(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:o=yhe(t,6,r);var a=t.read_shift(2);t.read_shift(2),Wr(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var u=t[t.l],h=kc(t,t.lens[c+1]-t.lens[c]-1);if(i+=h,i.length>=(u?a:2*a))break}if(i.length!==a&&i.length!==a*2)throw new Error("cchText: "+a+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function Pfe(t,e){var r=aw(t);t.l+=16;var n=Ehe(t,e-24);return[r,n]}function kfe(t){var e=ye(24),r=xr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return on([e,Rhe(t[1])])}function Nfe(t,e){t.read_shift(2);var r=aw(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Un,""),[r,n]}function Ffe(t){var e=t[1].Tooltip,r=ye(10+2*(e.length+1));r.write_shift(2,2048);var n=xr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function Hfe(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=vM[r]||r,r=t.read_shift(2),e[1]=vM[r]||r,e}function Dfe(t){return t||(t=ye(4)),t.write_shift(2,1),t.write_shift(2,1),t}function Lfe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(lH(t));return r}function $fe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(lH(t));return r}function Bfe(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function gH(t,e,r){if(!r.cellStyles)return Mn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),o=t.read_shift(n),a=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:s,w:o,ixfe:a,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function Vfe(t,e){var r=ye(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Wfe(t,e){var r={};return e<32||(t.l+=16,r.header=An(t),r.footer=An(t),t.l+=2),r}function Ufe(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function jfe(t){for(var e=ye(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var zfe=To,Gfe=iH,Yfe=Ag;function Kfe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function Xfe(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=To(t);++t.l;var i=qc(t,e-7,r);return n.t="str",n.val=i,n}function qfe(t){var e=To(t);++t.l;var r=An(t);return e.t="n",e.val=r,e}function Jfe(t,e,r){var n=ye(15);return Pg(n,t,e),n.write_shift(8,r,"f"),n}function Zfe(t){var e=To(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function Qfe(t,e,r){var n=ye(9);return Pg(n,t,e),n.write_shift(2,r),n}function ede(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function tde(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function rde(t,e,r){var n=t.l+e,i=To(t),s=t.read_shift(2),o=kc(t,s,r);return t.l=n,i.t="str",i.val=o,i}var nde=[2,3,48,49,131,139,140,245],gx=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=iw({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(a,l){var c=[],u=sl(1);switch(l.type){case"base64":u=Ri(Ai(a));break;case"binary":u=Ri(a);break;case"buffer":case"array":u=a;break}fn(u,0);var h=u.read_shift(1),f=!!(h&136),d=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:d=!0,f=!0;break;case 49:d=!0,f=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,p=521;h==2&&(m=u.read_shift(2)),u.l+=3,h!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(p=u.read_shift(2));var y=u.read_shift(2),S=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(S=t[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var C=[],A={},I=Math.min(u.length,h==2?521:p-10-(d?264:0)),O=g?32:11;u.l<I&&u[u.l]!=13;)switch(A={},A.name=ja.utils.decode(S,u.slice(u.l,u.l+O)).replace(/[\u0000\r\n].*$/g,""),u.l+=O,A.type=String.fromCharCode(u.read_shift(1)),h!=2&&!g&&(A.offset=u.read_shift(4)),A.len=u.read_shift(1),h==2&&(A.offset=u.read_shift(2)),A.dec=u.read_shift(1),A.name.length&&C.push(A),h!=2&&(u.l+=g?13:14),A.type){case"B":(!d||A.len!=8)&&l.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+A.type)}if(u[u.l]!==13&&(u.l=p-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=p;var _=0,E=0;for(c[0]=[],E=0;E!=C.length;++E)c[0][E]=C[E].name;for(;m-- >0;){if(u[u.l]===42){u.l+=y;continue}for(++u.l,c[++_]=[],E=0,E=0;E!=C.length;++E){var b=u.slice(u.l,u.l+C[E].len);u.l+=C[E].len,fn(b,0);var k=ja.utils.decode(S,b);switch(C[E].type){case"C":k.trim().length&&(c[_][E]=k.replace(/\s+$/,""));break;case"D":k.length===8?c[_][E]=new Date(+k.slice(0,4),+k.slice(4,6)-1,+k.slice(6,8)):c[_][E]=k;break;case"F":c[_][E]=parseFloat(k.trim());break;case"+":case"I":c[_][E]=g?b.read_shift(-4,"i")^2147483648:b.read_shift(4,"i");break;case"L":switch(k.trim().toUpperCase()){case"Y":case"T":c[_][E]=!0;break;case"N":case"F":c[_][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+k+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[_][E]="##MEMO##"+(g?parseInt(k.trim(),10):b.read_shift(4));break;case"N":k=k.replace(/\u0000/g,"").trim(),k&&k!="."&&(c[_][E]=+k||0);break;case"@":c[_][E]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":c[_][E]=new Date((b.read_shift(4)-2440588)*864e5+b.read_shift(4));break;case"Y":c[_][E]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[_][E]=-b.read_shift(-8,"f");break;case"B":if(d&&C[E].len==8){c[_][E]=b.read_shift(8,"f");break}case"G":case"P":b.l+=C[E].len;break;case"0":if(C[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[E].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=C,c}function n(a,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Ih(r(a,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function i(a,l){try{return ml(n(a,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var c=l||{};if(+c.codepage>=0&&bs(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=li(),h=dv(a,{header:1,raw:!0,cellDates:!0}),f=h[0],d=h.slice(1),g=a["!cols"]||[],m=0,p=0,y=0,S=1;for(m=0;m<f.length;++m){if(((g[m]||{}).DBF||{}).name){f[m]=g[m].DBF.name,++y;continue}if(f[m]!=null){if(++y,typeof f[m]=="number"&&(f[m]=f[m].toString(10)),typeof f[m]!="string")throw new Error("DBF Invalid column name "+f[m]+" |"+typeof f[m]+"|");if(f.indexOf(f[m])!==m){for(p=0;p<1024;++p)if(f.indexOf(f[m]+"_"+p)==-1){f[m]+="_"+p;break}}}}var C=Mt(a["!ref"]),A=[],I=[],O=[];for(m=0;m<=C.e.c-C.s.c;++m){var _="",E="",b=0,k=[];for(p=0;p<d.length;++p)d[p][m]!=null&&k.push(d[p][m]);if(k.length==0||f[m]==null){A[m]="?";continue}for(p=0;p<k.length;++p){switch(typeof k[p]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=k[p]instanceof Date?"D":"C";break;default:E="C"}b=Math.max(b,String(k[p]).length),_=_&&_!=E?"C":E}b>250&&(b=250),E=((g[m]||{}).DBF||{}).type,E=="C"&&g[m].DBF.len>b&&(b=g[m].DBF.len),_=="B"&&E=="N"&&(_="N",O[m]=g[m].DBF.dec,b=g[m].DBF.len),I[m]=_=="C"||E=="N"?b:s[_]||0,S+=I[m],A[m]=_}var B=u.next(32);for(B.write_shift(4,318902576),B.write_shift(4,d.length),B.write_shift(2,296+32*y),B.write_shift(2,S),m=0;m<4;++m)B.write_shift(4,0);for(B.write_shift(4,0|(+e[nF]||3)<<8),m=0,p=0;m<f.length;++m)if(f[m]!=null){var N=u.next(32),q=(f[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);N.write_shift(1,q,"sbcs"),N.write_shift(1,A[m]=="?"?"C":A[m],"sbcs"),N.write_shift(4,p),N.write_shift(1,I[m]||s[A[m]]||0),N.write_shift(1,O[m]||0),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(1,0),N.write_shift(4,0),N.write_shift(4,0),p+=I[m]||s[A[m]]||0}var ue=u.next(264);for(ue.write_shift(4,13),m=0;m<65;++m)ue.write_shift(4,0);for(m=0;m<d.length;++m){var we=u.next(S);for(we.write_shift(1,0),p=0;p<f.length;++p)if(f[p]!=null)switch(A[p]){case"L":we.write_shift(1,d[m][p]==null?63:d[m][p]?84:70);break;case"B":we.write_shift(8,d[m][p]||0,"f");break;case"N":var Se="0";for(typeof d[m][p]=="number"&&(Se=d[m][p].toFixed(O[p]||0)),y=0;y<I[p]-Se.length;++y)we.write_shift(1,32);we.write_shift(1,Se,"sbcs");break;case"D":d[m][p]?(we.write_shift(4,("0000"+d[m][p].getFullYear()).slice(-4),"sbcs"),we.write_shift(2,("00"+(d[m][p].getMonth()+1)).slice(-2),"sbcs"),we.write_shift(2,("00"+d[m][p].getDate()).slice(-2),"sbcs")):we.write_shift(8,"00000000","sbcs");break;case"C":var ce=String(d[m][p]!=null?d[m][p]:"").slice(0,I[p]);for(we.write_shift(1,ce,"sbcs"),y=0;y<I[p]-ce.length;++y)we.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),mH=function(){var t={AA:"Ã",BA:"Ã",CA:"Ã",DA:195,HA:"Ã",JA:197,AE:"Ã",BE:"Ã",CE:"Ã",HE:"Ã",AI:"Ã",BI:"Ã",CI:"Ã",HI:"Ã",AO:"Ã",BO:"Ã",CO:"Ã",DO:213,HO:"Ã",AU:"Ã",BU:"Ã",CU:"Ã",HU:"Ã",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã",Kc:"Ã§",q:"Ã¦",z:"Å",a:"Ã",j:"Å",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ir(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,d){var g=t[d];return typeof g=="number"?jI(g):g},n=function(f,d,g){var m=d.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?f:jI(m)};t["|"]=254;function i(f,d){switch(d.type){case"base64":return s(Ai(f),d);case"binary":return s(f,d);case"buffer":return s(Ct&&Buffer.isBuffer(f)?f.toString("binary"):gl(f),d);case"array":return s(Oc(f),d)}throw new Error("Unrecognized type "+d.type)}function s(f,d){var g=f.split(/[\n\r]+/),m=-1,p=-1,y=0,S=0,C=[],A=[],I=null,O={},_=[],E=[],b=[],k=0,B;for(+d.codepage>=0&&bs(+d.codepage);y!==g.length;++y){k=0;var N=g[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),q=N.replace(/;;/g,"\0").split(";").map(function(T){return T.replace(/\u0000/g,";")}),ue=q[0],we;if(N.length>0)switch(ue){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&A.push(N.slice(3).replace(/;;/g,";"));break;case"C":var Se=!1,ce=!1,Re=!1,Y=!1,Pe=-1,w=-1;for(S=1;S<q.length;++S)switch(q[S].charAt(0)){case"A":break;case"X":p=parseInt(q[S].slice(1))-1,ce=!0;break;case"Y":for(m=parseInt(q[S].slice(1))-1,ce||(p=0),B=C.length;B<=m;++B)C[B]=[];break;case"K":we=q[S].slice(1),we.charAt(0)==='"'?we=we.slice(1,we.length-1):we==="TRUE"?we=!0:we==="FALSE"?we=!1:isNaN(_s(we))?isNaN(mh(we).getDate())||(we=ar(we)):(we=_s(we),I!==null&&_h(I)&&(we=ow(we))),Se=!0;break;case"E":Y=!0;var v=ih(q[S].slice(1),{r:m,c:p});C[m][p]=[C[m][p],v];break;case"S":Re=!0,C[m][p]=[C[m][p],"S5S"];break;case"G":break;case"R":Pe=parseInt(q[S].slice(1))-1;break;case"C":w=parseInt(q[S].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+N)}if(Se&&(C[m][p]&&C[m][p].length==2?C[m][p][0]=we:C[m][p]=we,I=null),Re){if(Y)throw new Error("SYLK shared formula cannot have own formula");var x=Pe>-1&&C[Pe][w];if(!x||!x[1])throw new Error("SYLK shared formula cannot find base");C[m][p][1]=kH(x[1],{r:m-Pe,c:p-w})}break;case"F":var R=0;for(S=1;S<q.length;++S)switch(q[S].charAt(0)){case"X":p=parseInt(q[S].slice(1))-1,++R;break;case"Y":for(m=parseInt(q[S].slice(1))-1,B=C.length;B<=m;++B)C[B]=[];break;case"M":k=parseInt(q[S].slice(1))/20;break;case"F":break;case"G":break;case"P":I=A[parseInt(q[S].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(b=q[S].slice(1).split(" "),B=parseInt(b[0],10);B<=parseInt(b[1],10);++B)k=parseInt(b[2],10),E[B-1]=k===0?{hidden:!0}:{wch:k},ol(E[B-1]);break;case"C":p=parseInt(q[S].slice(1))-1,E[p]||(E[p]={});break;case"R":m=parseInt(q[S].slice(1))-1,_[m]||(_[m]={}),k>0?(_[m].hpt=k,_[m].hpx=vh(k)):k===0&&(_[m].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+N)}R<1&&(I=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+N)}}return _.length>0&&(O["!rows"]=_),E.length>0&&(O["!cols"]=E),d&&d.sheetRows&&(C=C.slice(0,d.sheetRows)),[C,O]}function o(f,d){var g=i(f,d),m=g[0],p=g[1],y=Ih(m,d);return Ir(p).forEach(function(S){y[S]=p[S]}),y}function a(f,d){return ml(o(f,d),d)}function l(f,d,g,m){var p="C;Y"+(g+1)+";X"+(m+1)+";K";switch(f.t){case"n":p+=f.v||0,f.f&&!f.F&&(p+=";E"+ZE(f.f,{r:g,c:m}));break;case"b":p+=f.v?"TRUE":"FALSE";break;case"e":p+=f.w||f.v;break;case"d":p+='"'+(f.w||f.v)+'"';break;case"s":p+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return p}function c(f,d){d.forEach(function(g,m){var p="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?p+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Kd(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Xd(g.wpx)),typeof g.wch=="number"&&(p+=Math.round(g.wch))),p.charAt(p.length-1)!=" "&&f.push(p)})}function u(f,d){d.forEach(function(g,m){var p="F;";g.hidden?p+="M0;":g.hpt?p+="M"+20*g.hpt+";":g.hpx&&(p+="M"+20*qd(g.hpx)+";"),p.length>2&&f.push(p+"R"+(m+1))})}function h(f,d){var g=["ID;PWXL;N;E"],m=[],p=Mt(f["!ref"]),y,S=Array.isArray(f),C=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),f["!cols"]&&c(g,f["!cols"]),f["!rows"]&&u(g,f["!rows"]),g.push("B;Y"+(p.e.r-p.s.r+1)+";X"+(p.e.c-p.s.c+1)+";D"+[p.s.c,p.s.r,p.e.c,p.e.r].join(" "));for(var A=p.s.r;A<=p.e.r;++A)for(var I=p.s.c;I<=p.e.c;++I){var O=tt({r:A,c:I});y=S?(f[A]||[])[I]:f[O],!(!y||y.v==null&&(!y.f||y.F))&&m.push(l(y,f,A,I))}return g.join(C)+C+m.join(C)+C+"E"+C}return{to_workbook:a,to_sheet:o,from_sheet:h}}(),pH=function(){function t(s,o){switch(o.type){case"base64":return e(Ai(s),o);case"binary":return e(s,o);case"buffer":return e(Ct&&Buffer.isBuffer(s)?s.toString("binary"):gl(s),o);case"array":return e(Oc(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var a=s.split(`
`),l=-1,c=-1,u=0,h=[];u!==a.length;++u){if(a[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var f=a[u].trim().split(","),d=f[0],g=f[1];++u;for(var m=a[u]||"";(m.match(/["]/g)||[]).length&1&&u<a.length-1;)m+=`
`+a[++u];switch(m=m.trim(),+d){case-1:if(m==="BOT"){h[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[l][c]=!0:m==="FALSE"?h[l][c]=!1:isNaN(_s(g))?isNaN(mh(g).getDate())?h[l][c]=g:h[l][c]=ar(g):h[l][c]=_s(g),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function r(s,o){return Ih(t(s,o),o)}function n(s,o){return ml(r(s,o),o)}var i=function(){var s=function(l,c,u,h,f){l.push(c),l.push(u+","+h),l.push('"'+f.replace(/"/g,'""')+'"')},o=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=Mt(l["!ref"]),h,f=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){o(c,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var m=tt({r:d,c:g});if(h=f?(l[d]||[])[g]:l[m],!h){o(c,1,0,"");continue}switch(h.t){case"n":var p=h.w;!p&&h.v!=null&&(p=h.v),p==null?h.f&&!h.F?o(c,1,0,"="+h.f):o(c,1,0,""):o(c,0,p,"V");break;case"b":o(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=es(h.z||et[14],Jr(ar(h.v)))),o(c,0,h.w,"V");break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var y=`\r
`,S=c.join(y);return S}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),vH=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,f){for(var d=h.split(`
`),g=-1,m=-1,p=0,y=[];p!==d.length;++p){var S=d[p].trim().split(":");if(S[0]==="cell"){var C=xr(S[1]);if(y.length<=C.r)for(g=y.length;g<=C.r;++g)y[g]||(y[g]=[]);switch(g=C.r,m=C.c,S[2]){case"t":y[g][m]=t(S[3]);break;case"v":y[g][m]=+S[3];break;case"vtf":var A=S[S.length-1];case"vtc":switch(S[3]){case"nl":y[g][m]=!!+S[4];break;default:y[g][m]=+S[4];break}S[2]=="vtf"&&(y[g][m]=[y[g][m],A])}}}return f&&f.sheetRows&&(y=y.slice(0,f.sheetRows)),y}function n(h,f){return Ih(r(h,f),f)}function i(h,f){return ml(n(h,f),f)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var f=[],d=[],g,m="",p=ci(h["!ref"]),y=Array.isArray(h),S=p.s.r;S<=p.e.r;++S)for(var C=p.s.c;C<=p.e.c;++C)if(m=tt({r:S,c:C}),g=y?(h[S]||[])[C]:h[m],!(!g||g.v==null||g.t==="z")){switch(d=["cell",m,"t"],g.t){case"s":case"str":d.push(e(g.v));break;case"n":g.f?(d[2]="vtf",d[3]="n",d[4]=g.v,d[5]=e(g.f)):(d[2]="v",d[3]=g.v);break;case"b":d[2]="vt"+(g.f?"f":"c"),d[3]="nl",d[4]=g.v?"1":"0",d[5]=e(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var A=Jr(ar(g.v));d[2]="vtc",d[3]="nd",d[4]=""+A,d[5]=g.w||es(g.z||et[14],A);break;case"e":continue}f.push(d.join(":"))}return f.push("sheet:c:"+(p.e.c-p.s.c+1)+":r:"+(p.e.r-p.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function u(h){return[s,o,a,o,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),ph=function(){function t(u,h,f,d,g){g.raw?h[f][d]=u:u===""||(u==="TRUE"?h[f][d]=!0:u==="FALSE"?h[f][d]=!1:isNaN(_s(u))?isNaN(mh(u).getDate())?h[f][d]=u:h[f][d]=ar(u):h[f][d]=_s(u))}function e(u,h){var f=h||{},d=[];if(!u||u.length===0)return d;for(var g=u.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var p=10,y=0,S=0;S<=m;++S)y=g[S].indexOf(" "),y==-1?y=g[S].length:y++,p=Math.max(p,y);for(S=0;S<=m;++S){d[S]=[];var C=0;for(t(g[S].slice(0,p).trim(),d,S,C,f),C=1;C<=(g[S].length-p)/10+1;++C)t(g[S].slice(p+(C-1)*10,p+C*10).trim(),d,S,C,f)}return f.sheetRows&&(d=d.slice(0,f.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var h={},f=!1,d=0,g=0;d<u.length;++d)(g=u.charCodeAt(d))==34?f=!f:!f&&g in r&&(h[g]=(h[g]||0)+1);g=[];for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&g.push([h[d],d]);if(!g.length){h=n;for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&g.push([h[d],d])}return g.sort(function(m,p){return m[0]-p[0]||n[m[1]]-n[p[1]]}),r[g.pop()[1]]||44}function s(u,h){var f=h||{},d="",g=f.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=i(u.slice(0,1024)):f&&f.FS?d=f.FS:d=i(u.slice(0,1024));var p=0,y=0,S=0,C=0,A=0,I=d.charCodeAt(0),O=!1,_=0,E=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var b=f.dateNF!=null?Uce(f.dateNF):null;function k(){var B=u.slice(C,A),N={};if(B.charAt(0)=='"'&&B.charAt(B.length-1)=='"'&&(B=B.slice(1,-1).replace(/""/g,'"')),B.length===0)N.t="z";else if(f.raw)N.t="s",N.v=B;else if(B.trim().length===0)N.t="s",N.v=B;else if(B.charCodeAt(0)==61)B.charCodeAt(1)==34&&B.charCodeAt(B.length-1)==34?(N.t="s",N.v=B.slice(2,-1).replace(/""/g,'"')):w0e(B)?(N.t="n",N.f=B.slice(1)):(N.t="s",N.v=B);else if(B=="TRUE")N.t="b",N.v=!0;else if(B=="FALSE")N.t="b",N.v=!1;else if(!isNaN(S=_s(B)))N.t="n",f.cellText!==!1&&(N.w=B),N.v=S;else if(!isNaN(mh(B).getDate())||b&&B.match(b)){N.z=f.dateNF||et[14];var q=0;b&&B.match(b)&&(B=jce(B,f.dateNF,B.match(b)||[]),q=1),f.cellDates?(N.t="d",N.v=ar(B,q)):(N.t="n",N.v=Jr(ar(B,q))),f.cellText!==!1&&(N.w=es(N.z,N.v instanceof Date?Jr(N.v):N.v)),f.cellNF||delete N.z}else N.t="s",N.v=B;if(N.t=="z"||(f.dense?(g[p]||(g[p]=[]),g[p][y]=N):g[tt({c:y,r:p})]=N),C=A+1,E=u.charCodeAt(C),m.e.c<y&&(m.e.c=y),m.e.r<p&&(m.e.r=p),_==I)++y;else if(y=0,++p,f.sheetRows&&f.sheetRows<=p)return!0}e:for(;A<u.length;++A)switch(_=u.charCodeAt(A)){case 34:E===34&&(O=!O);break;case I:case 10:case 13:if(!O&&k())break e;break}return A-C>0&&k(),g["!ref"]=ct(m),g}function o(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,h):Ih(e(u,h),h)}function a(u,h){var f="",d=h.type=="string"?[0,0,0,0]:oR(u,h);switch(h.type){case"base64":f=Ai(u);break;case"binary":f=u;break;case"buffer":h.codepage==65001?f=u.toString("utf8"):h.codepage&&typeof ja<"u"?f=ja.utils.decode(h.codepage,u):f=Ct&&Buffer.isBuffer(u)?u.toString("binary"):gl(u);break;case"array":f=Oc(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+h.type)}return d[0]==239&&d[1]==187&&d[2]==191?f=Kt(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=Kt(f):h.type=="binary"&&typeof ja<"u"&&h.codepage&&(f=ja.utils.decode(h.codepage,ja.utils.encode(28591,f))),f.slice(0,19)=="socialcalc:version:"?vH.to_sheet(h.type=="string"?f:Kt(f),h):o(f,h)}function l(u,h){return ml(a(u,h),h)}function c(u){for(var h=[],f=Mt(u["!ref"]),d,g=Array.isArray(u),m=f.s.r;m<=f.e.r;++m){for(var p=[],y=f.s.c;y<=f.e.c;++y){var S=tt({r:m,c:y});if(d=g?(u[m]||[])[y]:u[S],!d||d.v==null){p.push("          ");continue}for(var C=(d.w||(la(d),d.w)||"").slice(0,10);C.length<10;)C+=" ";p.push(C+(y===0?" ":""))}h.push(p.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:c}}();function ide(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=mH.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return ph.to_workbook(t,e)}}var Cc=function(){function t(v,x,R){if(v){fn(v,v.l||0);for(var T=R.Enum||Pe;v.l<v.length;){var L=v.read_shift(2),K=T[L]||T[65535],Q=v.read_shift(2),Z=v.l+Q,ie=K.f&&K.f(v,Q,R);if(v.l=Z,x(ie,K,L))return}}}function e(v,x){switch(x.type){case"base64":return r(Ri(Ai(v)),x);case"binary":return r(Ri(v),x);case"buffer":case"array":return r(v,x)}throw"Unsupported type "+x.type}function r(v,x){if(!v)return v;var R=x||{},T=R.dense?[]:{},L="Sheet1",K="",Q=0,Z={},ie=[],fe=[],H={s:{r:0,c:0},e:{r:0,c:0}},Me=R.sheetRows||0;if(v[2]==0&&(v[3]==8||v[3]==9)&&v.length>=16&&v[14]==5&&v[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(v[2]==2)R.Enum=Pe,t(v,function(be,$e,Le){switch(Le){case 0:R.vers=be,be>=4096&&(R.qpro=!0);break;case 6:H=be;break;case 204:be&&(K=be);break;case 222:K=be;break;case 15:case 51:R.qpro||(be[1].v=be[1].v.slice(1));case 13:case 14:case 16:Le==14&&(be[2]&112)==112&&(be[2]&15)>1&&(be[2]&15)<15&&(be[1].z=R.dateNF||et[14],R.cellDates&&(be[1].t="d",be[1].v=ow(be[1].v))),R.qpro&&be[3]>Q&&(T["!ref"]=ct(H),Z[L]=T,ie.push(L),T=R.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Q=be[3],L=K||"Sheet"+(Q+1),K="");var P=R.dense?(T[be[0].r]||[])[be[0].c]:T[tt(be[0])];if(P){P.t=be[1].t,P.v=be[1].v,be[1].z!=null&&(P.z=be[1].z),be[1].f!=null&&(P.f=be[1].f);break}R.dense?(T[be[0].r]||(T[be[0].r]=[]),T[be[0].r][be[0].c]=be[1]):T[tt(be[0])]=be[1];break}},R);else if(v[2]==26||v[2]==14)R.Enum=w,v[2]==14&&(R.qpro=!0,v.l=0),t(v,function(be,$e,Le){switch(Le){case 204:L=be;break;case 22:be[1].v=be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(be[3]>Q&&(T["!ref"]=ct(H),Z[L]=T,ie.push(L),T=R.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Q=be[3],L="Sheet"+(Q+1)),Me>0&&be[0].r>=Me)break;R.dense?(T[be[0].r]||(T[be[0].r]=[]),T[be[0].r][be[0].c]=be[1]):T[tt(be[0])]=be[1],H.e.c<be[0].c&&(H.e.c=be[0].c),H.e.r<be[0].r&&(H.e.r=be[0].r);break;case 27:be[14e3]&&(fe[be[14e3][0]]=be[14e3][1]);break;case 1537:fe[be[0]]=be[1],be[0]==Q&&(L=be[1]);break}},R);else throw new Error("Unrecognized LOTUS BOF "+v[2]);if(T["!ref"]=ct(H),Z[K||L]=T,ie.push(K||L),!fe.length)return{SheetNames:ie,Sheets:Z};for(var ae={},ke=[],Ae=0;Ae<fe.length;++Ae)Z[ie[Ae]]?(ke.push(fe[Ae]||ie[Ae]),ae[fe[Ae]]=Z[fe[Ae]]||Z[ie[Ae]]):(ke.push(fe[Ae]),ae[fe[Ae]]={"!ref":"A1"});return{SheetNames:ke,Sheets:ae}}function n(v,x){var R=x||{};if(+R.codepage>=0&&bs(+R.codepage),R.type=="string")throw new Error("Cannot write WK1 to JS string");var T=li(),L=Mt(v["!ref"]),K=Array.isArray(v),Q=[];Fe(T,0,s(1030)),Fe(T,6,l(L));for(var Z=Math.min(L.e.r,8191),ie=L.s.r;ie<=Z;++ie)for(var fe=Hr(ie),H=L.s.c;H<=L.e.c;++H){ie===L.s.r&&(Q[H]=yr(H));var Me=Q[H]+fe,ae=K?(v[ie]||[])[H]:v[Me];if(!(!ae||ae.t=="z"))if(ae.t=="n")(ae.v|0)==ae.v&&ae.v>=-32768&&ae.v<=32767?Fe(T,13,d(ie,H,ae.v)):Fe(T,14,m(ie,H,ae.v));else{var ke=la(ae);Fe(T,15,h(ie,H,ke.slice(0,239)))}}return Fe(T,1),T.end()}function i(v,x){var R=x||{};if(+R.codepage>=0&&bs(+R.codepage),R.type=="string")throw new Error("Cannot write WK3 to JS string");var T=li();Fe(T,0,o(v));for(var L=0,K=0;L<v.SheetNames.length;++L)(v.Sheets[v.SheetNames[L]]||{})["!ref"]&&Fe(T,27,Y(v.SheetNames[L],K++));var Q=0;for(L=0;L<v.SheetNames.length;++L){var Z=v.Sheets[v.SheetNames[L]];if(!(!Z||!Z["!ref"])){for(var ie=Mt(Z["!ref"]),fe=Array.isArray(Z),H=[],Me=Math.min(ie.e.r,8191),ae=ie.s.r;ae<=Me;++ae)for(var ke=Hr(ae),Ae=ie.s.c;Ae<=ie.e.c;++Ae){ae===ie.s.r&&(H[Ae]=yr(Ae));var be=H[Ae]+ke,$e=fe?(Z[ae]||[])[Ae]:Z[be];if(!(!$e||$e.t=="z"))if($e.t=="n")Fe(T,23,k(ae,Ae,Q,$e.v));else{var Le=la($e);Fe(T,22,_(ae,Ae,Q,Le.slice(0,239)))}}++Q}}return Fe(T,1),T.end()}function s(v){var x=ye(2);return x.write_shift(2,v),x}function o(v){var x=ye(26);x.write_shift(2,4096),x.write_shift(2,4),x.write_shift(4,0);for(var R=0,T=0,L=0,K=0;K<v.SheetNames.length;++K){var Q=v.SheetNames[K],Z=v.Sheets[Q];if(!(!Z||!Z["!ref"])){++L;var ie=ci(Z["!ref"]);R<ie.e.r&&(R=ie.e.r),T<ie.e.c&&(T=ie.e.c)}}return R>8191&&(R=8191),x.write_shift(2,R),x.write_shift(1,L),x.write_shift(1,T),x.write_shift(2,0),x.write_shift(2,0),x.write_shift(1,1),x.write_shift(1,2),x.write_shift(4,0),x.write_shift(4,0),x}function a(v,x,R){var T={s:{c:0,r:0},e:{c:0,r:0}};return x==8&&R.qpro?(T.s.c=v.read_shift(1),v.l++,T.s.r=v.read_shift(2),T.e.c=v.read_shift(1),v.l++,T.e.r=v.read_shift(2),T):(T.s.c=v.read_shift(2),T.s.r=v.read_shift(2),x==12&&R.qpro&&(v.l+=2),T.e.c=v.read_shift(2),T.e.r=v.read_shift(2),x==12&&R.qpro&&(v.l+=2),T.s.c==65535&&(T.s.c=T.e.c=T.s.r=T.e.r=0),T)}function l(v){var x=ye(8);return x.write_shift(2,v.s.c),x.write_shift(2,v.s.r),x.write_shift(2,v.e.c),x.write_shift(2,v.e.r),x}function c(v,x,R){var T=[{c:0,r:0},{t:"n",v:0},0,0];return R.qpro&&R.vers!=20768?(T[0].c=v.read_shift(1),T[3]=v.read_shift(1),T[0].r=v.read_shift(2),v.l+=2):(T[2]=v.read_shift(1),T[0].c=v.read_shift(2),T[0].r=v.read_shift(2)),T}function u(v,x,R){var T=v.l+x,L=c(v,x,R);if(L[1].t="s",R.vers==20768){v.l++;var K=v.read_shift(1);return L[1].v=v.read_shift(K,"utf8"),L}return R.qpro&&v.l++,L[1].v=v.read_shift(T-v.l,"cstr"),L}function h(v,x,R){var T=ye(7+R.length);T.write_shift(1,255),T.write_shift(2,x),T.write_shift(2,v),T.write_shift(1,39);for(var L=0;L<T.length;++L){var K=R.charCodeAt(L);T.write_shift(1,K>=128?95:K)}return T.write_shift(1,0),T}function f(v,x,R){var T=c(v,x,R);return T[1].v=v.read_shift(2,"i"),T}function d(v,x,R){var T=ye(7);return T.write_shift(1,255),T.write_shift(2,x),T.write_shift(2,v),T.write_shift(2,R,"i"),T}function g(v,x,R){var T=c(v,x,R);return T[1].v=v.read_shift(8,"f"),T}function m(v,x,R){var T=ye(13);return T.write_shift(1,255),T.write_shift(2,x),T.write_shift(2,v),T.write_shift(8,R,"f"),T}function p(v,x,R){var T=v.l+x,L=c(v,x,R);if(L[1].v=v.read_shift(8,"f"),R.qpro)v.l=T;else{var K=v.read_shift(2);A(v.slice(v.l,v.l+K),L),v.l+=K}return L}function y(v,x,R){var T=x&32768;return x&=-32769,x=(T?v:0)+(x>=8192?x-16384:x),(T?"":"$")+(R?yr(x):Hr(x))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function A(v,x){fn(v,0);for(var R=[],T=0,L="",K="",Q="",Z="";v.l<v.length;){var ie=v[v.l++];switch(ie){case 0:R.push(v.read_shift(8,"f"));break;case 1:K=y(x[0].c,v.read_shift(2),!0),L=y(x[0].r,v.read_shift(2),!1),R.push(K+L);break;case 2:{var fe=y(x[0].c,v.read_shift(2),!0),H=y(x[0].r,v.read_shift(2),!1);K=y(x[0].c,v.read_shift(2),!0),L=y(x[0].r,v.read_shift(2),!1),R.push(fe+H+":"+K+L)}break;case 3:if(v.l<v.length){console.error("WK1 premature formula end");return}break;case 4:R.push("("+R.pop()+")");break;case 5:R.push(v.read_shift(2));break;case 6:{for(var Me="";ie=v[v.l++];)Me+=String.fromCharCode(ie);R.push('"'+Me.replace(/"/g,'""')+'"')}break;case 8:R.push("-"+R.pop());break;case 23:R.push("+"+R.pop());break;case 22:R.push("NOT("+R.pop()+")");break;case 20:case 21:Z=R.pop(),Q=R.pop(),R.push(["AND","OR"][ie-20]+"("+Q+","+Z+")");break;default:if(ie<32&&C[ie])Z=R.pop(),Q=R.pop(),R.push(Q+C[ie]+Z);else if(S[ie]){if(T=S[ie][1],T==69&&(T=v[v.l++]),T>R.length){console.error("WK1 bad formula parse 0x"+ie.toString(16)+":|"+R.join("|")+"|");return}var ae=R.slice(-T);R.length-=T,R.push(S[ie][0]+"("+ae.join(",")+")")}else return ie<=7?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=24?console.error("WK1 unsupported op "+ie.toString(16)):ie<=30?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=115?console.error("WK1 unsupported function opcode "+ie.toString(16)):console.error("WK1 unrecognized opcode "+ie.toString(16))}}R.length==1?x[1].f=""+R[0]:console.error("WK1 bad formula parse |"+R.join("|")+"|")}function I(v){var x=[{c:0,r:0},{t:"n",v:0},0];return x[0].r=v.read_shift(2),x[3]=v[v.l++],x[0].c=v[v.l++],x}function O(v,x){var R=I(v);return R[1].t="s",R[1].v=v.read_shift(x-4,"cstr"),R}function _(v,x,R,T){var L=ye(6+T.length);L.write_shift(2,v),L.write_shift(1,R),L.write_shift(1,x),L.write_shift(1,39);for(var K=0;K<T.length;++K){var Q=T.charCodeAt(K);L.write_shift(1,Q>=128?95:Q)}return L.write_shift(1,0),L}function E(v,x){var R=I(v);R[1].v=v.read_shift(2);var T=R[1].v>>1;if(R[1].v&1)switch(T&7){case 0:T=(T>>3)*5e3;break;case 1:T=(T>>3)*500;break;case 2:T=(T>>3)/20;break;case 3:T=(T>>3)/200;break;case 4:T=(T>>3)/2e3;break;case 5:T=(T>>3)/2e4;break;case 6:T=(T>>3)/16;break;case 7:T=(T>>3)/64;break}return R[1].v=T,R}function b(v,x){var R=I(v),T=v.read_shift(4),L=v.read_shift(4),K=v.read_shift(2);if(K==65535)return T===0&&L===3221225472?(R[1].t="e",R[1].v=15):T===0&&L===3489660928?(R[1].t="e",R[1].v=42):R[1].v=0,R;var Q=K&32768;return K=(K&32767)-16446,R[1].v=(1-Q*2)*(L*Math.pow(2,K+32)+T*Math.pow(2,K)),R}function k(v,x,R,T){var L=ye(14);if(L.write_shift(2,v),L.write_shift(1,R),L.write_shift(1,x),T==0)return L.write_shift(4,0),L.write_shift(4,0),L.write_shift(2,65535),L;var K=0,Q=0,Z=0,ie=0;return T<0&&(K=1,T=-T),Q=Math.log2(T)|0,T/=Math.pow(2,Q-31),ie=T>>>0,ie&2147483648||(T/=2,++Q,ie=T>>>0),T-=ie,ie|=2147483648,ie>>>=0,T*=Math.pow(2,32),Z=T>>>0,L.write_shift(4,Z),L.write_shift(4,ie),Q+=16383+(K?32768:0),L.write_shift(2,Q),L}function B(v,x){var R=b(v);return v.l+=x-14,R}function N(v,x){var R=I(v),T=v.read_shift(4);return R[1].v=T>>6,R}function q(v,x){var R=I(v),T=v.read_shift(8,"f");return R[1].v=T,R}function ue(v,x){var R=q(v);return v.l+=x-10,R}function we(v,x){return v[v.l+x-1]==0?v.read_shift(x,"cstr"):""}function Se(v,x){var R=v[v.l++];R>x-1&&(R=x-1);for(var T="";T.length<R;)T+=String.fromCharCode(v[v.l++]);return T}function ce(v,x,R){if(!(!R.qpro||x<21)){var T=v.read_shift(1);v.l+=17,v.l+=1,v.l+=2;var L=v.read_shift(x-21,"cstr");return[T,L]}}function Re(v,x){for(var R={},T=v.l+x;v.l<T;){var L=v.read_shift(2);if(L==14e3){for(R[L]=[0,""],R[L][0]=v.read_shift(2);v[v.l];)R[L][1]+=String.fromCharCode(v[v.l]),v.l++;v.l++}}return R}function Y(v,x){var R=ye(5+v.length);R.write_shift(2,14e3),R.write_shift(2,x);for(var T=0;T<v.length;++T){var L=v.charCodeAt(T);R[R.l++]=L>127?95:L}return R[R.l++]=0,R}var Pe={0:{n:"BOF",f:Wr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:p},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:we},222:{n:"SHEETNAMELP",f:Se},65535:{n:""}},w={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:b},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:B},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:N},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:ue},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:we},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ce},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function sde(t){var e={},r=t.match(On),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=rt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=bE[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var ode=function(){var t=Ud("t"),e=Ud("rPr");function r(s){var o=s.match(t);if(!o)return{t:"s",v:""};var a={t:"s",v:It(o[1])},l=s.match(e);return l&&(a.s=sde(l[1])),a}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(a){return a.v})}}(),ade=function(){var e=/(\r\n|\n)/g;function r(i,s,o){var a=[];i.u&&a.push("text-decoration: underline;"),i.uval&&a.push("text-underline-style:"+i.uval+";"),i.sz&&a.push("font-size:"+i.sz+"pt;"),i.outline&&a.push("text-effect: outline;"),i.shadow&&a.push("text-shadow: auto;"),s.push('<span style="'+a.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),o.push("</"+l+">")),o.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),lde=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,cde=/<(?:\w+:)?r>/,ude=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function YE(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=It(Kt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Kt(t),r&&(n.h=kE(n.t))):t.match(cde)&&(n.r=Kt(t),n.t=It(Kt((t.replace(ude,"").match(lde)||[]).join("").replace(On,""))),r&&(n.h=ade(ode(n.r)))),n):{t:""}}var hde=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,fde=/<(?:\w+:)?(?:si|sstItem)>/g,dde=/<\/(?:\w+:)?(?:si|sstItem)>/;function gde(t,e){var r=[],n="";if(!t)return r;var i=t.match(hde);if(i){n=i[2].replace(fde,"").split(dde);for(var s=0;s!=n.length;++s){var o=YE(n[s].trim(),e);o!=null&&(r[r.length]=o)}i=rt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var mde=/^\s|\s$|[\t\n\r]/;function wH(t,e){if(!e.bookSST)return"";var r=[Lr];r[r.length]=Ne("sst",null,{xmlns:zc[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(mde)&&(s+=' xml:space="preserve"'),s+=">"+Ut(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function pde(t){return[t.read_shift(4),t.read_shift(4)]}function vde(t,e){var r=[],n=!1;return ga(t,function(s,o,a){switch(a){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}}),r}function wde(t,e){return e||(e=ye(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var Cde=Iue;function yde(t){var e=li();Te(e,159,wde(t));for(var r=0;r<t.length;++r)Te(e,19,Cde(t[r]));return Te(e,160),e.end()}function CH(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function ia(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function xde(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=ia(t,4),e.U=ia(t,4),e.W=ia(t,4),e}function Sde(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function bde(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(Sde(t));return e}function Ede(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function Rde(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=ia(t,4),e.U=ia(t,4),e.W=ia(t,4),e}function Tde(t){var e=Rde(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function yH(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function xH(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function _de(t){var e=ia(t);switch(e.Minor){case 2:return[e.Minor,Ade(t)];case 3:return[e.Minor,Ide()];case 4:return[e.Minor,Mde(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function Ade(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=yH(t,r),i=xH(t,t.length-t.l);return{t:"Std",h:n,v:i}}function Ide(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Mde(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(On,function(s){var o=rt(s);switch(Ro(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(a){n[a]=o[a]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function Ode(t,e){var r={},n=r.EncryptionVersionInfo=ia(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=yH(t,i),e-=i,r.EncryptionVerifier=xH(t,e),r}function Pde(t){var e={},r=e.EncryptionVersionInfo=ia(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function KE(t){var e=0,r,n=CH(t),i=n.length+1,s,o,a,l,c;for(r=sl(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)o=r[s],a=e&16384?1:0,l=e<<1&32767,c=a|l,e=c^o;return e^52811}var SH=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,a){return n(o^a)},s=function(o){for(var a=e[o.length-1],l=104,c=o.length-1;c>=0;--c)for(var u=o[c],h=0;h!=7;++h)u&64&&(a^=r[l]),u*=2,--l;return a};return function(o){for(var a=CH(o),l=s(a),c=a.length,u=sl(16),h=0;h!=16;++h)u[h]=0;var f,d,g;for((c&1)===1&&(f=l>>8,u[c]=i(t[0],f),--c,f=l&255,d=a[a.length-1],u[c]=i(d,f));c>0;)--c,f=l>>8,u[c]=i(a[c],f),--c,f=l&255,u[c]=i(a[c],f);for(c=15,g=15-a.length;g>0;)f=l>>8,u[c]=i(t[g],f),--c,--g,f=l&255,u[c]=i(a[c],f),--c,--g;return u}}(),kde=function(t,e,r,n,i){i||(i=e),n||(n=SH(t));var s,o;for(s=0;s!=e.length;++s)o=e[s],o^=n[r],o=(o>>5|o<<3)&255,i[s]=o,++r;return[i,r,n]},Nde=function(t){var e=0,r=SH(t);return function(n){var i=kde("",n,e,r);return e=i[1],i[0]}};function Fde(t,e,r,n){var i={key:Wr(t),verificationBytes:Wr(t)};return r.password&&(i.verifier=KE(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=Nde(r.password)),i}function Hde(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=Pde(t):n.Data=Ode(t,e),n}function Dde(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?Hde(t,e-2,n):Fde(t,r.biff>=8?e:e-2,r,n),n}var bH=function(){function t(i,s){switch(s.type){case"base64":return e(Ai(i),s);case"binary":return e(i,s);case"buffer":return e(Ct&&Buffer.isBuffer(i)?i.toString("binary"):gl(i),s);case"array":return e(Oc(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var o=s||{},a=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(a)&&(a[h]=[]);for(var f=/\\\w+\b/g,d=0,g,m=-1;g=f.exec(u);){switch(g[0]){case"\\cell":var p=u.slice(d,f.lastIndex-g[0].length);if(p[0]==" "&&(p=p.slice(1)),++m,p.length){var y={v:p,t:"s"};Array.isArray(a)?a[h][m]=y:a[tt({r:h,c:m})]=y}break}d=f.lastIndex}m>c.e.c&&(c.e.c=m)}),a["!ref"]=ct(c),a}function r(i,s){return ml(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],o=Mt(i["!ref"]),a,l=Array.isArray(i),c=o.s.r;c<=o.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var h=tt({r:c,c:u});a=l?(i[c]||[])[u]:i[h],!(!a||a.v==null&&(!a.f||a.F))&&(s.push(" "+(a.w||(la(a),a.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function Lde(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Yd(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function $de(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),o=i-s;if(o===0)return[0,0,e];var a=0,l=0,c=i+s;switch(l=o/(c>1?2-c:c),i){case e:a=((r-n)/o+6)%6;break;case r:a=(n-e)/o+2;break;case n:a=(e-r)/o+4;break}return[a/6,l,c/2]}function Bde(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,o=[s,s,s],a=6*e,l;if(r!==0)switch(a|0){case 0:case 6:l=i*a,o[0]+=i,o[1]+=l;break;case 1:l=i*(2-a),o[0]+=l,o[1]+=i;break;case 2:l=i*(a-2),o[1]+=i,o[2]+=l;break;case 3:l=i*(4-a),o[1]+=l,o[2]+=i;break;case 4:l=i*(a-4),o[2]+=i,o[0]+=l;break;case 5:l=i*(6-a),o[2]+=l,o[0]+=i;break}for(var c=0;c!=3;++c)o[c]=Math.round(o[c]*255);return o}function hv(t,e){if(e===0)return t;var r=$de(Lde(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Yd(Bde(r))}var EH=6,Vde=15,Wde=1,_n=EH;function Kd(t){return Math.floor((t+Math.round(128/_n)/256)*_n)}function Xd(t){return Math.floor((t-5)/_n*100+.5)/100}function fv(t){return Math.round((t*_n+5)/_n*256)/256}function G1(t){return fv(Xd(Kd(t)))}function XE(t){var e=Math.abs(t-G1(t)),r=_n;if(e>.005)for(_n=Wde;_n<Vde;++_n)Math.abs(t-G1(t))<=e&&(e=Math.abs(t-G1(t)),r=_n);_n=r}function ol(t){t.width?(t.wpx=Kd(t.width),t.wch=Xd(t.wpx),t.MDW=_n):t.wpx?(t.wch=Xd(t.wpx),t.width=fv(t.wch),t.MDW=_n):typeof t.wch=="number"&&(t.width=fv(t.wch),t.wpx=Kd(t.width),t.MDW=_n),t.customWidth&&delete t.customWidth}var Ude=96,RH=Ude;function qd(t){return t*96/RH}function vh(t){return t*RH/96}var jde={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function zde(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(On)||[]).forEach(function(o){var a=rt(o);switch(Ro(a[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},a.diagonalUp&&(i.diagonalUp=or(a.diagonalUp)),a.diagonalDown&&(i.diagonalDown=or(a.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in borders")}})}function Gde(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(On)||[]).forEach(function(o){var a=rt(o);switch(Ro(a[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":a.patternType&&(i.patternType=a.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),a.indexed&&(i.bgColor.indexed=parseInt(a.indexed,10)),a.theme&&(i.bgColor.theme=parseInt(a.theme,10)),a.tint&&(i.bgColor.tint=parseFloat(a.tint)),a.rgb&&(i.bgColor.rgb=a.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),a.theme&&(i.fgColor.theme=parseInt(a.theme,10)),a.tint&&(i.fgColor.tint=parseFloat(a.tint)),a.rgb!=null&&(i.fgColor.rgb=a.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in fills")}})}function Yde(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(On)||[]).forEach(function(o){var a=rt(o);switch(Ro(a[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":a.val&&(i.name=Kt(a.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=a.val?or(a.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=a.val?or(a.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(a.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=a.val?or(a.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=a.val?or(a.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=a.val?or(a.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=a.val?or(a.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=a.val?or(a.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":a.val&&(i.sz=+a.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":a.val&&(i.vertAlign=a.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":a.val&&(i.family=parseInt(a.val,10));break;case"<family/>":case"</family>":break;case"<scheme":a.val&&(i.scheme=a.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(a.val=="1")break;a.codepage=bE[parseInt(a.val,10)];break;case"<color":if(i.color||(i.color={}),a.auto&&(i.color.auto=or(a.auto)),a.rgb)i.color.rgb=a.rgb.slice(-6);else if(a.indexed){i.color.index=parseInt(a.indexed,10);var l=vc[i.color.index];i.color.index==81&&(l=vc[1]),l||(l=vc[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else a.theme&&(i.color.theme=parseInt(a.theme,10),a.tint&&(i.color.tint=parseFloat(a.tint)),a.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=hv(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in fonts")}})}function Kde(t,e,r){e.NumberFmt=[];for(var n=Ir(et),i=0;i<n.length;++i)e.NumberFmt[n[i]]=et[n[i]];var s=t[0].match(On);if(s)for(i=0;i<s.length;++i){var o=rt(s[i]);switch(Ro(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var a=It(Kt(o.formatCode)),l=parseInt(o.numFmtId,10);if(e.NumberFmt[l]=a,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=a}na(a,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Xde(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Ne("numFmt",null,{numFmtId:n,formatCode:Ut(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ne("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Mm=["numFmtId","fillId","fontId","borderId","xfId"],Om=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function qde(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(On)||[]).forEach(function(s){var o=rt(s),a=0;switch(Ro(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],a=0;a<Mm.length;++a)n[Mm[a]]&&(n[Mm[a]]=parseInt(n[Mm[a]],10));for(a=0;a<Om.length;++a)n[Om[a]]&&(n[Om[a]]=or(n[Om[a]]));if(e.NumberFmt&&n.numFmtId>392){for(a=392;a>60;--a)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[a]){n.numFmtId=a;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};o.vertical&&(l.vertical=o.vertical),o.horizontal&&(l.horizontal=o.horizontal),o.textRotation!=null&&(l.textRotation=o.textRotation),o.indent&&(l.indent=o.indent),o.wrapText&&(l.wrapText=or(o.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Jde(t){var e=[];return e[e.length]=Ne("cellXfs",null),t.forEach(function(r){e[e.length]=Ne("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ne("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Zde=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(a,l,c){var u={};if(!a)return u;a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=a.match(e))&&Kde(h,u,c),(h=a.match(i))&&Yde(h,u,l,c),(h=a.match(n))&&Gde(h,u,l,c),(h=a.match(s))&&zde(h,u,l,c),(h=a.match(r))&&qde(h,u,c),u}}();function TH(t,e){var r=[Lr,Ne("styleSheet",null,{xmlns:zc[0],"xmlns:vt":qr.vt})],n;return t.SSF&&(n=Xde(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Jde(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Qde(t,e){var r=t.read_shift(2),n=In(t);return[r,n]}function ege(t,e,r){r||(r=ye(6+4*e.length)),r.write_shift(2,t),an(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function tge(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=Hue(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var a=t.read_shift(1);a>0&&(n.family=a);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=Fue(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=In(t),n}function rge(t,e){e||(e=ye(25+4*32)),e.write_shift(2,t.sz*20),Due(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),lv(t.color,e);var n=0;return t.scheme=="major"&&(n=1),t.scheme=="minor"&&(n=2),e.write_shift(1,n),an(t.name,e),e.length>e.l?e.slice(0,e.l):e}var nge=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Y1,ige=Mn;function NM(t,e){e||(e=ye(4*3+8*7+16*1)),Y1||(Y1=iw(nge));var r=Y1[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(lv({auto:1},e),lv({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function sge(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function _H(t,e,r){r||(r=ye(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ff(t,e){return e||(e=ye(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var oge=Mn;function age(t,e){return e||(e=ye(51)),e.write_shift(1,0),Ff(null,e),Ff(null,e),Ff(null,e),Ff(null,e),Ff(null,e),e.length>e.l?e.slice(0,e.l):e}function lge(t,e){return e||(e=ye(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,+t.builtinId),e.write_shift(1,0),av(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function cge(t,e,r){var n=ye(2052);return n.write_shift(4,t),av(e,n),av(r,n),n.length>n.l?n.slice(0,n.l):n}function uge(t,e,r){var n={};n.NumberFmt=[];for(var i in et)n.NumberFmt[i]=et[i];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return ga(t,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],na(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=hv(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(u),o=!0;break;case 38:s.pop(),o=!1;break;default:if(c.T>0)s.push(u);else if(c.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function hge(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(Te(t,615,As(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Te(t,44,ege(i,e[i]))}),Te(t,616))}}function fge(t){var e=1;Te(t,611,As(e)),Te(t,43,rge({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Te(t,612)}function dge(t){var e=2;Te(t,603,As(e)),Te(t,45,NM({patternType:"none"})),Te(t,45,NM({patternType:"gray125"})),Te(t,604)}function gge(t){var e=1;Te(t,613,As(e)),Te(t,46,age()),Te(t,614)}function mge(t){var e=1;Te(t,626,As(e)),Te(t,47,_H({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Te(t,627)}function pge(t,e){Te(t,617,As(e.length)),e.forEach(function(r){Te(t,47,_H(r,0))}),Te(t,618)}function vge(t){var e=1;Te(t,619,As(e)),Te(t,48,lge({xfId:0,builtinId:0,name:"Normal"})),Te(t,620)}function wge(t){var e=0;Te(t,505,As(e)),Te(t,506)}function Cge(t){var e=0;Te(t,508,cge(e,"TableStyleMedium9","PivotStyleMedium4")),Te(t,509)}function yge(t,e){var r=li();return Te(r,278),hge(r,t.SSF),fge(r),dge(r),gge(r),mge(r),pge(r,e.cellXfs),vge(r),wge(r),Cge(r),Te(r,279),r.end()}var xge=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Sge(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(On)||[]).forEach(function(i){var s=rt(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[xge.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function bge(){}function Ege(){}var Rge=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Tge=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,_ge=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Age(t,e,r){e.themeElements={};var n;[["clrScheme",Rge,Sge],["fontScheme",Tge,bge],["fmtScheme",_ge,Ege]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var Ige=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function AH(t,e){(!t||t.length===0)&&(t=qE());var r,n={};if(!(r=t.match(Ige)))throw new Error("themeElements not found in theme");return Age(r[0],n,e),n.raw=t,n}function qE(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Lr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã´ã·ãã¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§ì ê³ ë"/>',r[r.length]='<a:font script="Hans" typeface="å®ä½"/>',r[r.length]='<a:font script="Hant" typeface="æ°ç´°æé«"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã´ã·ãã¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§ì ê³ ë"/>',r[r.length]='<a:font script="Hans" typeface="å®ä½"/>',r[r.length]='<a:font script="Hant" typeface="æ°ç´°æé«"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Mge(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var o;try{o=yF(s,{type:"array"})}catch{return}var a=Ti(o,"theme/theme/theme1.xml",!0);if(a)return AH(a,r)}}function Oge(t){return t.read_shift(4)}function Pge(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=kge(t,4);break;case 2:e.xclrValue=aH(t);break;case 3:e.xclrValue=Oge(t);break;case 4:t.l+=4;break}return t.l+=8,e}function kge(t,e){return Mn(t,e)}function Nge(t,e){return Mn(t,e)}function Fge(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Pge(t);break;case 6:n[1]=Nge(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function Hge(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(Fge(t,r-t.l));return{ixfe:n,ext:s}}function Dge(t,e){e.forEach(function(r){switch(r[0]){}})}function Lge(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:In(t)}}function $ge(t){var e=ye(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),an(t.name,e),e.slice(0,e.l)}function Bge(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function Vge(t){var e=ye(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function Wge(t,e){var r=ye(8+2*e.length);return r.write_shift(4,t),an(e,r),r.slice(0,r.l)}function Uge(t){return t.l+=4,t.read_shift(4)!=0}function jge(t,e){var r=ye(8);return r.write_shift(4,t),r.write_shift(4,1),r}function zge(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],o=!1,a=2;return ga(t,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){a==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):a==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:a=l?1:0;break;case 338:a=2;break;case 35:s.push(u),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!c.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function Gge(){var t=li();return Te(t,332),Te(t,334,As(1)),Te(t,335,$ge({name:"XLDAPR",version:12e4,flags:3496657072})),Te(t,336),Te(t,339,Wge(1,"XLDAPR")),Te(t,52),Te(t,35,As(514)),Te(t,4096,As(0)),Te(t,4097,zi(1)),Te(t,36),Te(t,53),Te(t,340),Te(t,337,jge(1)),Te(t,51,Vge([[1,0]])),Te(t,338),Te(t,333),t.end()}function Yge(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,o;return t.replace(On,function(a){var l=rt(a);switch(Ro(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(o=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return a}),n}function IH(){var t=[Lr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function Kge(t){var e=[];if(!t)return e;var r=1;return(t.match(On)||[]).forEach(function(n){var i=rt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function Xge(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=tt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function qge(t,e,r){var n=[];return ga(t,function(s,o,a){switch(a){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+a.toString(16))}}),n}function Jge(t,e,r,n){if(!t)return t;var i=n||{},s=!1;ga(t,function(a,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function Zge(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var qu=1024;function MH(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Ne("xml",null,{"xmlns:v":bi.v,"xmlns:o":bi.o,"xmlns:x":bi.x,"xmlns:mv":bi.mv}).replace(/\/>/,">"),Ne("o:shapelayout",Ne("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Ne("v:shapetype",[Ne("v:stroke",null,{joinstyle:"miter"}),Ne("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];qu<t*1e3;)qu+=1e3;return e.forEach(function(s){var o=xr(s[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var l=a.type=="gradient"?Ne("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Ne("v:fill",l,a),u={on:"t",obscured:"t"};++qu,i=i.concat(["<v:shape"+jd({id:"_x0000_s"+qu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Ne("v:shadow",null,u),Ne("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",dn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),dn("x:AutoFill","False"),dn("x:Row",String(o.r)),dn("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function FM(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(o){var a=xr(o.ref);if(i?(t[a.r]||(t[a.r]=[]),s=t[a.r][a.c]):s=t[o.ref],!s){s={t:"z"},i?t[a.r][a.c]=s:t[o.ref]=s;var l=Mt(t["!ref"]||"BDWGO1000001:A1");l.s.r>a.r&&(l.s.r=a.r),l.e.r<a.r&&(l.e.r=a.r),l.s.c>a.c&&(l.s.c=a.c),l.e.c<a.c&&(l.e.c=a.c);var c=ct(l);c!==t["!ref"]&&(t["!ref"]=c)}s.c||(s.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}s.c.push(u)})}function Qge(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?author[^>]*>(.*)/);a&&r.push(a[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?comment[^>]*>/);if(a){var l=rt(a[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=xr(l.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var h=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!h&&!!h[1]&&YE(h[1])||{r:"",t:"",h:""};c.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),c.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=f.h),n.push(c)}}}}),n}function OH(t){var e=[Lr,Ne("comments",null,{xmlns:zc[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=Ut(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(Ut(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(dn("t",Ut(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,a=1;a<s.length;++a)o+=`Reply:
    `+s[a]+`
`;e.push(dn("t",Ut(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function e0e(t,e){var r=[],n=!1,i={},s=0;return t.replace(On,function(a,l){var c=rt(a);switch(Ro(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+a.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return a}),r}function t0e(t,e,r){var n=[Lr,Ne("ThreadedComments",null,{xmlns:qr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,a){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};a==0?s=l.id:l.parentId=s,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(Ne("threadedComment",dn("text",o.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function r0e(t,e){var r=[],n=!1;return t.replace(On,function(s){var o=rt(s);switch(Ro(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function n0e(t){var e=[Lr,Ne("personList",null,{xmlns:qr.TCMNT,"xmlns:x":zc[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Ne("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function i0e(t){var e={};e.iauthor=t.read_shift(4);var r=Xc(t);return e.rfx=r.s,e.ref=tt(r.s),t.l+=16,e}function s0e(t,e){return e==null&&(e=ye(36)),e.write_shift(4,t[1].iauthor),Mh(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var o0e=In;function a0e(t){return an(t.slice(0,54))}function l0e(t,e){var r=[],n=[],i={},s=!1;return ga(t,function(a,l,c){switch(c){case 632:n.push(a);break;case 635:i=a;break;case 637:i.t=a.t,i.h=a.h,i.r=a.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function c0e(t){var e=li(),r=[];return Te(e,628),Te(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Te(e,632,a0e(i.a)))})}),Te(e,631),Te(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:xr(n[0]),e:xr(n[0])};Te(e,635,s0e([s,i])),i.t&&i.t.length>0&&Te(e,637,Oue(i)),Te(e,636),delete i.iauthor})}),Te(e,634),Te(e,629),e.end()}var u0e="application/vnd.ms-office.vbaProject";function h0e(t){var e=qe.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");qe.utils.cfb_add(e,i,t.FileIndex[n].content)}}),qe.write(e)}function f0e(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&qe.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var PH=["xlsb","xlsm","xlam","biff8","xla"];function d0e(){return{"!type":"dialog"}}function g0e(){return{"!type":"dialog"}}function m0e(){return{"!type":"macro"}}function p0e(){return{"!type":"macro"}}var ih=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,o){var a=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return a?u+=e.c:--u,l?c+=e.r:--c,i+(a?"":"$")+yr(u)+(l?"":"$")+Hr(c)}return function(i,s){return e=s,i.replace(t,r)}}(),JE=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ZE=function(){return function(e,r){return e.replace(JE,function(n,i,s,o,a,l){var c=LE(o)-(s?0:r.c),u=DE(l)-(a?0:r.r),h=u==0?"":a?u+1:"["+u+"]",f=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+f})}}();function kH(t,e){return t.replace(JE,function(r,n,i,s,o,a){return n+(i=="$"?i+s:yr(LE(s)+e.c))+(o=="$"?o+a:Hr(DE(a)+e.r))})}function v0e(t,e,r){var n=ci(e),i=n.s,s=xr(r),o={r:s.r-i.r,c:s.c-i.c};return kH(t,o)}function w0e(t){return t.length!=1}function HM(t){return t.replace(/_xlfn\./g,"")}function $r(t){t.l+=1}function al(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function NH(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return FH(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),o=al(t),a=al(t);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function FH(t){var e=al(t),r=al(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function C0e(t,e,r){if(r.biff<8)return FH(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=al(t),o=al(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function HH(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return y0e(t);var n=t.read_shift(r&&r.biff==12?4:2),i=al(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function y0e(t){var e=al(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function x0e(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function S0e(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return b0e(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),o=(s&16384)>>14,a=(s&32768)>>15;if(s&=16383,a==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:a}}function b0e(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function E0e(t,e,r){var n=(t[t.l++]&96)>>5,i=NH(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function R0e(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var o=NH(t,s,r);return[n,i,o]}function T0e(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function _0e(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function A0e(t,e,r){var n=(t[t.l++]&96)>>5,i=C0e(t,e-1,r);return[n,i]}function I0e(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function DM(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function M0e(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function O0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function P0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function k0e(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function N0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function DH(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function F0e(t){return t.read_shift(2),DH(t)}function H0e(t){return t.read_shift(2),DH(t)}function D0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=HH(t,0,r);return[n,i]}function L0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=S0e(t,0,r);return[n,i]}function $0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=HH(t,0,r);return[n,i,s]}function B0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[Ume[i],BH[i],n]}function V0e(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:W0e(t);return[i,(s[0]===0?BH:Wme)[s[1]]]}function W0e(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function U0e(t,e,r){t.l+=r&&r.biff==2?3:4}function j0e(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function z0e(t){return t.l++,ma[t.read_shift(1)]}function G0e(t){return t.l++,t.read_shift(2)}function Y0e(t){return t.l++,t.read_shift(1)!==0}function K0e(t){return t.l++,An(t)}function X0e(t,e,r){return t.l++,_g(t,e-1,r)}function q0e(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Pr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=ma[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=An(t);break;case 2:r[1]=qc(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function J0e(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Xc:aw)(t));return i}function Z0e(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=q0e(t,r.biff);return o}function Q0e(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function eme(t,e,r){if(r.biff==5)return tme(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function tme(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function rme(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function nme(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function ime(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function sme(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var ome=Mn,ame=Mn,lme=Mn;function Ig(t,e,r){return t.l+=2,[x0e(t)]}function QE(t){return t.l+=6,[]}var cme=Ig,ume=QE,hme=QE,fme=Ig;function LH(t){return t.l+=2,[Wr(t),t.read_shift(2)&1]}var dme=Ig,gme=LH,mme=QE,pme=Ig,vme=Ig,wme=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Cme(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),o=wme[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:i,C:s}}function yme(t){return t.l+=2,[t.read_shift(4)]}function xme(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function Sme(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function bme(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Eme(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Rme(t){return t.l+=4,[0,0]}var LM={1:{n:"PtgExp",f:j0e},2:{n:"PtgTbl",f:lme},3:{n:"PtgAdd",f:$r},4:{n:"PtgSub",f:$r},5:{n:"PtgMul",f:$r},6:{n:"PtgDiv",f:$r},7:{n:"PtgPower",f:$r},8:{n:"PtgConcat",f:$r},9:{n:"PtgLt",f:$r},10:{n:"PtgLe",f:$r},11:{n:"PtgEq",f:$r},12:{n:"PtgGe",f:$r},13:{n:"PtgGt",f:$r},14:{n:"PtgNe",f:$r},15:{n:"PtgIsect",f:$r},16:{n:"PtgUnion",f:$r},17:{n:"PtgRange",f:$r},18:{n:"PtgUplus",f:$r},19:{n:"PtgUminus",f:$r},20:{n:"PtgPercent",f:$r},21:{n:"PtgParen",f:$r},22:{n:"PtgMissArg",f:$r},23:{n:"PtgStr",f:X0e},26:{n:"PtgSheet",f:xme},27:{n:"PtgEndSheet",f:Sme},28:{n:"PtgErr",f:z0e},29:{n:"PtgBool",f:Y0e},30:{n:"PtgInt",f:G0e},31:{n:"PtgNum",f:K0e},32:{n:"PtgArray",f:I0e},33:{n:"PtgFunc",f:B0e},34:{n:"PtgFuncVar",f:V0e},35:{n:"PtgName",f:Q0e},36:{n:"PtgRef",f:D0e},37:{n:"PtgArea",f:E0e},38:{n:"PtgMemArea",f:rme},39:{n:"PtgMemErr",f:ome},40:{n:"PtgMemNoMem",f:ame},41:{n:"PtgMemFunc",f:nme},42:{n:"PtgRefErr",f:ime},43:{n:"PtgAreaErr",f:T0e},44:{n:"PtgRefN",f:L0e},45:{n:"PtgAreaN",f:A0e},46:{n:"PtgMemAreaN",f:bme},47:{n:"PtgMemNoMemN",f:Eme},57:{n:"PtgNameX",f:eme},58:{n:"PtgRef3d",f:$0e},59:{n:"PtgArea3d",f:R0e},60:{n:"PtgRefErr3d",f:sme},61:{n:"PtgAreaErr3d",f:_0e},255:{}},Tme={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},_me={1:{n:"PtgElfLel",f:LH},2:{n:"PtgElfRw",f:pme},3:{n:"PtgElfCol",f:cme},6:{n:"PtgElfRwV",f:vme},7:{n:"PtgElfColV",f:fme},10:{n:"PtgElfRadical",f:dme},11:{n:"PtgElfRadicalS",f:mme},13:{n:"PtgElfColS",f:ume},15:{n:"PtgElfColSV",f:hme},16:{n:"PtgElfRadicalLel",f:gme},25:{n:"PtgList",f:Cme},29:{n:"PtgSxName",f:yme},255:{}},Ame={0:{n:"PtgAttrNoop",f:Rme},1:{n:"PtgAttrSemi",f:N0e},2:{n:"PtgAttrIf",f:P0e},4:{n:"PtgAttrChoose",f:M0e},8:{n:"PtgAttrGoto",f:O0e},16:{n:"PtgAttrSum",f:U0e},32:{n:"PtgAttrBaxcel",f:DM},33:{n:"PtgAttrBaxcel",f:DM},64:{n:"PtgAttrSpace",f:F0e},65:{n:"PtgAttrSpaceSemi",f:H0e},128:{n:"PtgAttrIfError",f:k0e},255:{}};function Mg(t,e,r,n){if(n.biff<8)return Mn(t,e);for(var i=t.l+e,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=Z0e(t,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=J0e(t,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=i-t.l,e!==0&&s.push(Mn(t,e)),s}function Og(t,e,r){for(var n=t.l+e,i,s,o=[];n!=t.l;)e=n-t.l,s=t[t.l],i=LM[s]||LM[Tme[s]],(s===24||s===25)&&(i=(s===24?_me:Ame)[t[t.l+1]]),!i||!i.f?Mn(t,e):o.push([i.n,i.f(t,e,r)]);return o}function Ime(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var Mme={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Ome(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function $H(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function $M(t,e,r){var n=$H(t,e,r);return n=="#REF"?n:Ome(n,r)}function Rn(t,e,r,n,i){var s=i&&i.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},a=[],l,c,u,h=0,f=0,d,g="";if(!t[0]||!t[0][0])return"";for(var m=-1,p="",y=0,S=t[0].length;y<S;++y){var C=t[0][y];switch(C[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),c=a.pop(),m>=0){switch(t[0][m][1][0]){case 0:p=Tr(" ",t[0][m][1][1]);break;case 1:p=Tr("\r",t[0][m][1][1]);break;default:if(p="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}c=c+p,m=-1}a.push(c+Mme[C[0]]+l);break;case"PtgIsect":l=a.pop(),c=a.pop(),a.push(c+" "+l);break;case"PtgUnion":l=a.pop(),c=a.pop(),a.push(c+","+l);break;case"PtgRange":l=a.pop(),c=a.pop(),a.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=md(C[1][1],o,i),a.push(pd(u,s));break;case"PtgRefN":u=r?md(C[1][1],r,i):C[1][1],a.push(pd(u,s));break;case"PtgRef3d":h=C[1][1],u=md(C[1][2],o,i),g=$M(n,h,i),a.push(g+"!"+pd(u,s));break;case"PtgFunc":case"PtgFuncVar":var A=C[1][0],I=C[1][1];A||(A=0),A&=127;var O=A==0?[]:a.slice(-A);a.length-=A,I==="User"&&(I=O.shift()),a.push(I+"("+O.join(",")+")");break;case"PtgBool":a.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(C[1]);break;case"PtgNum":a.push(String(C[1]));break;case"PtgStr":a.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(C[1]);break;case"PtgAreaN":d=gM(C[1][1],r?{s:r}:o,i),a.push(U1(d,i));break;case"PtgArea":d=gM(C[1][1],o,i),a.push(U1(d,i));break;case"PtgArea3d":h=C[1][1],d=C[1][2],g=$M(n,h,i),a.push(g+"!"+U1(d,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=C[1][2];var _=(n.names||[])[f-1]||(n[0]||[])[f],E=_?_.Name:"SH33TJSNAME"+String(f);E&&E.slice(0,6)=="_xlfn."&&!i.xlfn&&(E=E.slice(6)),a.push(E);break;case"PtgNameX":var b=C[1][1];f=C[1][2];var k;if(i.biff<=5)b<0&&(b=-b),n[b]&&(k=n[b][f]);else{var B="";if(((n[b]||[])[0]||[])[0]==14849||(((n[b]||[])[0]||[])[0]==1025?n[b][f]&&n[b][f].itab>0&&(B=n.SheetNames[n[b][f].itab-1]+"!"):B=n.SheetNames[f-1]+"!"),n[b]&&n[b][f])B+=n[b][f].Name;else if(n[0]&&n[0][f])B+=n[0][f].Name;else{var N=($H(n,b,i)||"").split(";;");N[f-1]?B=N[f-1]:B+="SH33TJSERRX"}a.push(B);break}k||(k={Name:"SH33TJSERRY"}),a.push(k.Name);break;case"PtgParen":var q="(",ue=")";if(m>=0){switch(p="",t[0][m][1][0]){case 2:q=Tr(" ",t[0][m][1][1])+q;break;case 3:q=Tr("\r",t[0][m][1][1])+q;break;case 4:ue=Tr(" ",t[0][m][1][1])+ue;break;case 5:ue=Tr("\r",t[0][m][1][1])+ue;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}m=-1}a.push(q+a.pop()+ue);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":u={c:C[1][1],r:C[1][0]};var we={c:r.c,r:r.r};if(n.sharedf[tt(u)]){var Se=n.sharedf[tt(u)];a.push(Rn(Se,o,we,n,i))}else{var ce=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){a.push(Rn(c[1],o,we,n,i)),ce=!0;break}ce||a.push(C[1])}break;case"PtgArray":a.push("{"+Ime(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var Re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&Re.indexOf(t[0][y][0])==-1){C=t[0][m];var Y=!0;switch(C[1][0]){case 4:Y=!1;case 0:p=Tr(" ",C[1][1]);break;case 5:Y=!1;case 1:p=Tr("\r",C[1][1]);break;default:if(p="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}a.push((Y?p:"")+a.pop()+(Y?"":p)),m=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function Pme(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,o=t.read_shift(i);if(o==65535)return[[],Mn(t,e-2)];var a=Og(t,o,r);return e!==o+i&&(s=Mg(t,e-o-i,a,r)),t.l=n,[a,s]}function kme(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,o=t.read_shift(i);if(o==65535)return[[],Mn(t,e-2)];var a=Og(t,o,r);return e!==o+i&&(s=Mg(t,e-o-i,a,r)),t.l=n,[a,s]}function Nme(t,e,r,n){var i=t.l+e,s=Og(t,n,r),o;return i!==t.l&&(o=Mg(t,i-t.l,s,r)),[s,o]}function Fme(t,e,r){var n=t.l+e,i,s=t.read_shift(2),o=Og(t,s,r);return s==65535?[[],Mn(t,e-2)]:(e!==s+2&&(i=Mg(t,n-s-2,o,r)),[o,i])}function Hme(t){var e;if(ta(t,t.l+6)!==65535)return[An(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Dme(t){if(t==null){var e=ye(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Pc(t);return Pc(0)}function K1(t,e,r){var n=t.l+e,i=To(t);r.biff==2&&++t.l;var s=Hme(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var a=kme(t,n-t.l,r);return{cell:i,val:s[0],formula:a,shared:o>>3&1,tt:s[1]}}function Lme(t,e,r,n,i){var s=Nc(e,r,i),o=Dme(t.v),a=ye(6),l=33;a.write_shift(2,l),a.write_shift(4,0);for(var c=ye(t.bf.length),u=0;u<t.bf.length;++u)c[u]=t.bf[u];var h=on([s,o,a,c]);return h}function lw(t,e,r){var n=t.read_shift(4),i=Og(t,n,r),s=t.read_shift(4),o=s>0?Mg(t,s,i,r):null;return[i,o]}var $me=lw,cw=lw,Bme=lw,Vme=lw,Wme={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},BH={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Ume={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function BM(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function jme(t){var e="of:="+t.replace(JE,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function X1(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function zme(t){return t.replace(/\./,"!")}var wd={},sh={},Cd=typeof Map<"u";function eR(t,e,r){var n=0,i=t.length;if(r){if(Cd?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Cd?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Cd?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function uw(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(_n=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Xd(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=fv(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function yc(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function pl(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){na(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function VH(t,e,r,n,i,s){try{n.cellNF&&(t.z=et[e])}catch(a){if(n.WTF)throw a}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=ar(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(et[e]==null&&na(Wce[e]||"General",e),t.t==="e")t.w=t.w||ma[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Wd(t.v);else if(t.t==="d"){var o=Jr(t.v);(o|0)===o?t.w=o.toString(10):t.w=Wd(o)}else{if(t.v===void 0)return"";t.w=Mc(t.v,sh)}else t.t==="d"?t.w=es(e,Jr(t.v),sh):t.w=es(e,t.v,sh)}catch(a){if(n.WTF)throw a}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=hv(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=hv(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(a){if(n.WTF&&s.Fills)throw a}}}function Gme(t,e,r){if(t&&t["!ref"]){var n=Mt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function Yme(t,e){var r=Mt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=ct(r))}var Kme=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Xme=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,qme=/<(?:\w:)?hyperlink [^>]*>/mg,Jme=/"(\w*:\w*)"/,Zme=/<(?:\w:)?col\b[^>]*[\/]?>/g,Qme=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,epe=/<(?:\w:)?pageMargins[^>]*\/>/g,WH=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,tpe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,rpe=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function npe(t,e,r,n,i,s,o){if(!t)return t;n||(n={"!id":{}});var a=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=t.match(Xme);h?(c=t.slice(0,h.index),u=t.slice(h.index+h[0].length)):c=u=t;var f=c.match(WH);f?tR(f[0],a,i,r):(f=c.match(tpe))&&spe(f[0],f[1]||"",a,i,r);var d=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var g=c.slice(d,d+50).match(Jme);g&&Yme(a,g[1])}var m=c.match(rpe);m&&m[1]&&wpe(m[1],i);var p=[];if(e.cellStyles){var y=c.match(Zme);y&&dpe(p,y)}h&&xpe(h[1],a,e,l,s,o);var S=u.match(Qme);S&&(a["!autofilter"]=mpe(S[0]));var C=[],A=u.match(Kme);if(A)for(d=0;d!=A.length;++d)C[d]=Mt(A[d].slice(A[d].indexOf('"')+1));var I=u.match(qme);I&&upe(a,I,n);var O=u.match(epe);if(O&&(a["!margins"]=hpe(rt(O[0]))),!a["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(a["!ref"]=ct(l)),e.sheetRows>0&&a["!ref"]){var _=Mt(a["!ref"]);e.sheetRows<=+_.e.r&&(_.e.r=e.sheetRows-1,_.e.r>l.e.r&&(_.e.r=l.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>l.e.c&&(_.e.c=l.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),a["!fullref"]=a["!ref"],a["!ref"]=ct(_))}return p.length>0&&(a["!cols"]=p),C.length>0&&(a["!merges"]=C),a}function ipe(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+ct(t[r])+'"/>';return e+"</mergeCells>"}function tR(t,e,r,n){var i=rt(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=It(Kt(i.codeName)))}function spe(t,e,r,n,i){tR(t.slice(0,t.indexOf(">")),r,n,i)}function ope(t,e,r,n,i){var s=!1,o={},a=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,o.codeName=po(Ut(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),a=(a||"")+Ne("outlinePr",null,c)}!s&&!a||(i[i.length]=Ne("sheetPr",a,o))}var ape=["objects","scenarios","selectLockedCells","selectUnlockedCells"],lpe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function cpe(t){var e={sheet:1};return ape.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),lpe.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=KE(t.password).toString(16).toUpperCase()),Ne("sheetProtection",null,e)}function upe(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=rt(Kt(e[i]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+It(s.location))):(s.Target="#"+It(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var a=Mt(s.ref),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var u=tt({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=s):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=s)}}}function hpe(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function fpe(t){return yc(t),Ne("pageMargins",null,t)}function dpe(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=rt(e[n],!0);i.hidden&&(i.hidden=or(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,XE(i.width)),ol(i);s<=o;)t[s++]=lr(i)}}function gpe(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=Ne("col",null,uw(i,n)));return r[r.length]="</cols>",r.join("")}function mpe(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function ppe(t,e,r,n){var i=typeof t.ref=="string"?t.ref:ct(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=ci(i);o.s.r==o.e.r&&(o.e.r=ci(e["!ref"]).e.r,i=ct(o));for(var a=0;a<s.length;++a){var l=s[a];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return a==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ne("autoFilter",null,{ref:i})}var vpe=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function wpe(t,e){e.Views||(e.Views=[{}]),(t.match(vpe)||[]).forEach(function(r,n){var i=rt(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),or(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function Cpe(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ne("sheetViews",Ne("sheetView",null,i),{})}function ype(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=ma[t.v];break;case"d":n&&n.cellDates?i=ar(t.v,-1).toISOString():(t=lr(t),t.t="n",i=""+(t.v=Jr(ar(t.v)))),typeof t.z>"u"&&(t.z=et[14]);break;default:i=t.v;break}var a=dn("v",Ut(i)),l={r:e},c=pl(n.cellXfs,t,n);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){a=dn("v",""+eR(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=o),typeof t.f=="string"&&t.f){var u=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;a=Ne("f",Ut(t.f),u)+(t.v!=null?a:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),Ne("c",a,l)}var xpe=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=Ud("v"),o=Ud("f");return function(l,c,u,h,f,d){for(var g=0,m="",p=[],y=[],S=0,C=0,A=0,I="",O,_,E=0,b=0,k,B,N=0,q=0,ue=Array.isArray(d.CellXf),we,Se=[],ce=[],Re=Array.isArray(c),Y=[],Pe={},w=!1,v=!!u.sheetStubs,x=l.split(e),R=0,T=x.length;R!=T;++R){m=x[R].trim();var L=m.length;if(L!==0){var K=0;e:for(g=0;g<L;++g)switch(m[g]){case">":if(m[g-1]!="/"){++g;break e}if(u&&u.cellStyles){if(_=rt(m.slice(K,g),!0),E=_.r!=null?parseInt(_.r,10):E+1,b=-1,u.sheetRows&&u.sheetRows<E)continue;Pe={},w=!1,_.ht&&(w=!0,Pe.hpt=parseFloat(_.ht),Pe.hpx=vh(Pe.hpt)),_.hidden=="1"&&(w=!0,Pe.hidden=!0),_.outlineLevel!=null&&(w=!0,Pe.level=+_.outlineLevel),w&&(Y[E-1]=Pe)}break;case"<":K=g;break}if(K>=g)break;if(_=rt(m.slice(K,g),!0),E=_.r!=null?parseInt(_.r,10):E+1,b=-1,!(u.sheetRows&&u.sheetRows<E)){h.s.r>E-1&&(h.s.r=E-1),h.e.r<E-1&&(h.e.r=E-1),u&&u.cellStyles&&(Pe={},w=!1,_.ht&&(w=!0,Pe.hpt=parseFloat(_.ht),Pe.hpx=vh(Pe.hpt)),_.hidden=="1"&&(w=!0,Pe.hidden=!0),_.outlineLevel!=null&&(w=!0,Pe.level=+_.outlineLevel),w&&(Y[E-1]=Pe)),p=m.slice(g).split(t);for(var Q=0;Q!=p.length&&p[Q].trim().charAt(0)=="<";++Q);for(p=p.slice(Q),g=0;g!=p.length;++g)if(m=p[g].trim(),m.length!==0){if(y=m.match(r),S=g,C=0,A=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,y!=null&&y.length===2){for(S=0,I=y[1],C=0;C!=I.length&&!((A=I.charCodeAt(C)-64)<1||A>26);++C)S=26*S+A;--S,b=S}else++b;for(C=0;C!=m.length&&m.charCodeAt(C)!==62;++C);if(++C,_=rt(m.slice(0,C),!0),_.r||(_.r=tt({r:E-1,c:b})),I=m.slice(C),O={t:""},(y=I.match(s))!=null&&y[1]!==""&&(O.v=It(y[1])),u.cellFormula){if((y=I.match(o))!=null&&y[1]!==""){if(O.f=It(Kt(y[1])).replace(/\r\n/g,`
`),u.xlfn||(O.f=HM(O.f)),y[0].indexOf('t="array"')>-1)O.F=(I.match(i)||[])[1],O.F.indexOf(":")>-1&&Se.push([Mt(O.F),O.F]);else if(y[0].indexOf('t="shared"')>-1){B=rt(y[0]);var Z=It(Kt(y[1]));u.xlfn||(Z=HM(Z)),ce[parseInt(B.si,10)]=[B,Z,_.r]}}else(y=I.match(/<f[^>]*\/>/))&&(B=rt(y[0]),ce[B.si]&&(O.f=v0e(ce[B.si][1],ce[B.si][2],_.r)));var ie=xr(_.r);for(C=0;C<Se.length;++C)ie.r>=Se[C][0].s.r&&ie.r<=Se[C][0].e.r&&ie.c>=Se[C][0].s.c&&ie.c<=Se[C][0].e.c&&(O.F=Se[C][1])}if(_.t==null&&O.v===void 0)if(O.f||O.F)O.v=0,O.t="n";else if(v)O.t="z";else continue;else O.t=_.t||"n";switch(h.s.c>b&&(h.s.c=b),h.e.c<b&&(h.e.c=b),O.t){case"n":if(O.v==""||O.v==null){if(!v)continue;O.t="z"}else O.v=parseFloat(O.v);break;case"s":if(typeof O.v>"u"){if(!v)continue;O.t="z"}else k=wd[parseInt(O.v,10)],O.v=k.t,O.r=k.r,u.cellHTML&&(O.h=k.h);break;case"str":O.t="s",O.v=O.v!=null?Kt(O.v):"",u.cellHTML&&(O.h=kE(O.v));break;case"inlineStr":y=I.match(n),O.t="s",y!=null&&(k=YE(y[1]))?(O.v=k.t,u.cellHTML&&(O.h=k.h)):O.v="";break;case"b":O.v=or(O.v);break;case"d":u.cellDates?O.v=ar(O.v,1):(O.v=Jr(ar(O.v,1)),O.t="n");break;case"e":(!u||u.cellText!==!1)&&(O.w=O.v),O.v=jF[O.v];break}if(N=q=0,we=null,ue&&_.s!==void 0&&(we=d.CellXf[_.s],we!=null&&(we.numFmtId!=null&&(N=we.numFmtId),u.cellStyles&&we.fillId!=null&&(q=we.fillId))),VH(O,N,q,u,f,d),u.cellDates&&ue&&O.t=="n"&&_h(et[N])&&(O.t="d",O.v=ow(O.v)),_.cm&&u.xlmeta){var fe=(u.xlmeta.Cell||[])[+_.cm-1];fe&&fe.type=="XLDAPR"&&(O.D=!0)}if(Re){var H=xr(_.r);c[H.r]||(c[H.r]=[]),c[H.r][H.c]=O}else c[_.r]=O}}}}Y.length>0&&(c["!rows"]=Y)}}();function Spe(t,e,r,n){var i=[],s=[],o=Mt(t["!ref"]),a="",l,c="",u=[],h=0,f=0,d=t["!rows"],g=Array.isArray(t),m={r:c},p,y=-1;for(f=o.s.c;f<=o.e.c;++f)u[f]=yr(f);for(h=o.s.r;h<=o.e.r;++h){for(s=[],c=Hr(h),f=o.s.c;f<=o.e.c;++f){l=u[f]+c;var S=g?(t[h]||[])[f]:t[l];S!==void 0&&(a=ype(S,l,t,e))!=null&&s.push(a)}(s.length>0||d&&d[h])&&(m={r:c},d&&d[h]&&(p=d[h],p.hidden&&(m.hidden=1),y=-1,p.hpx?y=qd(p.hpx):p.hpt&&(y=p.hpt),y>-1&&(m.ht=y,m.customHeight=1),p.level&&(m.outlineLevel=p.level)),i[i.length]=Ne("row",s.join(""),m))}if(d)for(;h<d.length;++h)d&&d[h]&&(m={r:h+1},p=d[h],p.hidden&&(m.hidden=1),y=-1,p.hpx?y=qd(p.hpx):p.hpt&&(y=p.hpt),y>-1&&(m.ht=y,m.customHeight=1),p.level&&(m.outlineLevel=p.level),i[i.length]=Ne("row","",m));return i.join("")}function UH(t,e,r,n){var i=[Lr,Ne("worksheet",null,{xmlns:zc[0],"xmlns:r":qr.r})],s=r.SheetNames[t],o=0,a="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",u=Mt(c);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=ct(u)}n||(n={}),l["!comments"]=[];var h=[];ope(l,r,t,e,i),i[i.length]=Ne("dimension",null,{ref:c}),i[i.length]=Cpe(l,e,t,r),e.sheetFormat&&(i[i.length]=Ne("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=gpe(l,l["!cols"])),i[o=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(a=Spe(l,e),a.length>0&&(i[i.length]=a)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),l["!protect"]&&(i[i.length]=cpe(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=ppe(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=ipe(l["!merges"]));var f=-1,d,g=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(d={ref:m[0]},m[1].Target.charAt(0)!="#"&&(g=Wt(n,-1,Ut(m[1].Target).replace(/#.*$/,""),St.HLINK),d["r:id"]="rId"+g),(f=m[1].Target.indexOf("#"))>-1&&(d.location=Ut(m[1].Target.slice(f+1))),m[1].Tooltip&&(d.tooltip=Ut(m[1].Tooltip)),i[i.length]=Ne("hyperlink",null,d))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=fpe(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=dn("ignoredErrors",Ne("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(g=Wt(n,-1,"../drawings/drawing"+(t+1)+".xml",St.DRAW),i[i.length]=Ne("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=h),l["!comments"].length>0&&(g=Wt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",St.VML),i[i.length]=Ne("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function bpe(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function Epe(t,e,r){var n=ye(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=qd(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var a=0,l=n.l;n.l+=4;for(var c={r:t,c:0},u=0;u<16;++u)if(!(e.s.c>u+1<<10||e.e.c<u<<10)){for(var h=-1,f=-1,d=u<<10;d<u+1<<10;++d){c.c=d;var g=Array.isArray(r)?(r[c.r]||[])[c.c]:r[tt(c)];g&&(h<0&&(h=d),f=d)}h<0||(++a,n.write_shift(4,h),n.write_shift(4,f))}var m=n.l;return n.l=l,n.write_shift(4,a),n.l=m,n.length>n.l?n.slice(0,n.l):n}function Rpe(t,e,r,n){var i=Epe(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&Te(t,0,i)}var Tpe=Xc,_pe=Mh;function Ape(){}function Ipe(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=Pue(t),r}function Mpe(t,e,r){r==null&&(r=ye(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return lv({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),$F(t,r),r.slice(0,r.l)}function Ope(t){var e=ts(t);return[e]}function Ppe(t,e,r){return r==null&&(r=ye(8)),Gc(e,r)}function kpe(t){var e=Yc(t);return[e]}function Npe(t,e,r){return r==null&&(r=ye(4)),Kc(e,r)}function Fpe(t){var e=ts(t),r=t.read_shift(1);return[e,r,"b"]}function Hpe(t,e,r){return r==null&&(r=ye(9)),Gc(e,r),r.write_shift(1,t.v?1:0),r}function Dpe(t){var e=Yc(t),r=t.read_shift(1);return[e,r,"b"]}function Lpe(t,e,r){return r==null&&(r=ye(5)),Kc(e,r),r.write_shift(1,t.v?1:0),r}function $pe(t){var e=ts(t),r=t.read_shift(1);return[e,r,"e"]}function Bpe(t,e,r){return r==null&&(r=ye(9)),Gc(e,r),r.write_shift(1,t.v),r}function Vpe(t){var e=Yc(t),r=t.read_shift(1);return[e,r,"e"]}function Wpe(t,e,r){return r==null&&(r=ye(8)),Kc(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function Upe(t){var e=ts(t),r=t.read_shift(4);return[e,r,"s"]}function jpe(t,e,r){return r==null&&(r=ye(12)),Gc(e,r),r.write_shift(4,e.v),r}function zpe(t){var e=Yc(t),r=t.read_shift(4);return[e,r,"s"]}function Gpe(t,e,r){return r==null&&(r=ye(8)),Kc(e,r),r.write_shift(4,e.v),r}function Ype(t){var e=ts(t),r=An(t);return[e,r,"n"]}function Kpe(t,e,r){return r==null&&(r=ye(16)),Gc(e,r),Pc(t.v,r),r}function jH(t){var e=Yc(t),r=An(t);return[e,r,"n"]}function Xpe(t,e,r){return r==null&&(r=ye(12)),Kc(e,r),Pc(t.v,r),r}function qpe(t){var e=ts(t),r=WE(t);return[e,r,"n"]}function Jpe(t,e,r){return r==null&&(r=ye(12)),Gc(e,r),BF(t.v,r),r}function Zpe(t){var e=Yc(t),r=WE(t);return[e,r,"n"]}function Qpe(t,e,r){return r==null&&(r=ye(8)),Kc(e,r),BF(t.v,r),r}function eve(t){var e=ts(t),r=$E(t);return[e,r,"is"]}function tve(t){var e=ts(t),r=In(t);return[e,r,"str"]}function rve(t,e,r){return r==null&&(r=ye(12+4*t.v.length)),Gc(e,r),an(t.v,r),r.length>r.l?r.slice(0,r.l):r}function nve(t){var e=Yc(t),r=In(t);return[e,r,"str"]}function ive(t,e,r){return r==null&&(r=ye(8+4*t.v.length)),Kc(e,r),an(t.v,r),r.length>r.l?r.slice(0,r.l):r}function sve(t,e,r){var n=t.l+e,i=ts(t);i.r=r["!row"];var s=t.read_shift(1),o=[i,s,"b"];if(r.cellFormula){t.l+=2;var a=cw(t,n-t.l,r);o[3]=Rn(a,null,i,r.supbooks,r)}else t.l=n;return o}function ove(t,e,r){var n=t.l+e,i=ts(t);i.r=r["!row"];var s=t.read_shift(1),o=[i,s,"e"];if(r.cellFormula){t.l+=2;var a=cw(t,n-t.l,r);o[3]=Rn(a,null,i,r.supbooks,r)}else t.l=n;return o}function ave(t,e,r){var n=t.l+e,i=ts(t);i.r=r["!row"];var s=An(t),o=[i,s,"n"];if(r.cellFormula){t.l+=2;var a=cw(t,n-t.l,r);o[3]=Rn(a,null,i,r.supbooks,r)}else t.l=n;return o}function lve(t,e,r){var n=t.l+e,i=ts(t);i.r=r["!row"];var s=In(t),o=[i,s,"str"];if(r.cellFormula){t.l+=2;var a=cw(t,n-t.l,r);o[3]=Rn(a,null,i,r.supbooks,r)}else t.l=n;return o}var cve=Xc,uve=Mh;function hve(t,e){return e==null&&(e=ye(4)),e.write_shift(4,t),e}function fve(t,e){var r=t.l+e,n=Xc(t),i=BE(t),s=In(t),o=In(t),a=In(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:a};return o&&(l.Tooltip=o),l}function dve(t,e){var r=ye(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Mh({s:xr(t[0]),e:xr(t[0])},r),VE("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return an(i||"",r),an(t[1].Tooltip||"",r),an("",r),r.slice(0,r.l)}function gve(){}function mve(t,e,r){var n=t.l+e,i=VF(t),s=t.read_shift(1),o=[i];if(o[2]=s,r.cellFormula){var a=$me(t,n-t.l,r);o[1]=a}else t.l=n;return o}function pve(t,e,r){var n=t.l+e,i=Xc(t),s=[i];if(r.cellFormula){var o=Vme(t,n-t.l,r);s[1]=o,t.l=n}else t.l=n;return s}function vve(t,e,r){r==null&&(r=ye(18));var n=uw(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var zH=["left","right","top","bottom","header","footer"];function wve(t){var e={};return zH.forEach(function(r){e[r]=An(t)}),e}function Cve(t,e){return e==null&&(e=ye(6*8)),yc(t),zH.forEach(function(r){Pc(t[r],e)}),e}function yve(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function xve(t,e,r){r==null&&(r=ye(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Sve(t){var e=ye(24);return e.write_shift(4,4),e.write_shift(4,1),Mh(t,e),e}function bve(t,e){return e==null&&(e=ye(16*4+2)),e.write_shift(2,t.password?KE(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function Eve(){}function Rve(){}function Tve(t,e,r,n,i,s,o){if(!t)return t;var a=e||{};n||(n={"!id":{}});var l=a.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,f=!1,d,g,m,p,y,S,C,A,I,O=[];a.biff=12,a["!row"]=0;var _=0,E=!1,b=[],k={},B=a.supbooks||i.supbooks||[[]];if(B.sharedf=k,B.arrayf=b,B.SheetNames=i.SheetNames||i.Sheets.map(function(Re){return Re.name}),!a.supbooks&&(a.supbooks=B,i.Names))for(var N=0;N<i.Names.length;++N)B[0][N+1]=i.Names[N];var q=[],ue=[],we=!1;Jd[16]={n:"BrtShortReal",f:jH};var Se;if(ga(t,function(Y,Pe,w){if(!f)switch(w){case 148:c=Y;break;case 0:d=Y,a.sheetRows&&a.sheetRows<=d.r&&(f=!0),A=Hr(p=d.r),a["!row"]=d.r,(Y.hidden||Y.hpt||Y.level!=null)&&(Y.hpt&&(Y.hpx=vh(Y.hpt)),ue[Y.r]=Y);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:Y[2]},Y[2]){case"n":g.v=Y[1];break;case"s":C=wd[Y[1]],g.v=C.t,g.r=C.r;break;case"b":g.v=!!Y[1];break;case"e":g.v=Y[1],a.cellText!==!1&&(g.w=ma[g.v]);break;case"str":g.t="s",g.v=Y[1];break;case"is":g.t="s",g.v=Y[1].t;break}if((m=o.CellXf[Y[0].iStyleRef])&&VH(g,m.numFmtId,null,a,s,o),y=Y[0].c==-1?y+1:Y[0].c,a.dense?(l[p]||(l[p]=[]),l[p][y]=g):l[yr(y)+A]=g,a.cellFormula){for(E=!1,_=0;_<b.length;++_){var v=b[_];d.r>=v[0].s.r&&d.r<=v[0].e.r&&y>=v[0].s.c&&y<=v[0].e.c&&(g.F=ct(v[0]),E=!0)}!E&&Y.length>3&&(g.f=Y[3])}if(u.s.r>d.r&&(u.s.r=d.r),u.s.c>y&&(u.s.c=y),u.e.r<d.r&&(u.e.r=d.r),u.e.c<y&&(u.e.c=y),a.cellDates&&m&&g.t=="n"&&_h(et[m.numFmtId])){var x=mc(g.v);x&&(g.t="d",g.v=new Date(x.y,x.m-1,x.d,x.H,x.M,x.S,x.u))}Se&&(Se.type=="XLDAPR"&&(g.D=!0),Se=void 0);break;case 1:case 12:if(!a.sheetStubs||h)break;g={t:"z",v:void 0},y=Y[0].c==-1?y+1:Y[0].c,a.dense?(l[p]||(l[p]=[]),l[p][y]=g):l[yr(y)+A]=g,u.s.r>d.r&&(u.s.r=d.r),u.s.c>y&&(u.s.c=y),u.e.r<d.r&&(u.e.r=d.r),u.e.c<y&&(u.e.c=y),Se&&(Se.type=="XLDAPR"&&(g.D=!0),Se=void 0);break;case 176:O.push(Y);break;case 49:Se=((a.xlmeta||{}).Cell||[])[Y-1];break;case 494:var R=n["!id"][Y.relId];for(R?(Y.Target=R.Target,Y.loc&&(Y.Target+="#"+Y.loc),Y.Rel=R):Y.relId==""&&(Y.Target="#"+Y.loc),p=Y.rfx.s.r;p<=Y.rfx.e.r;++p)for(y=Y.rfx.s.c;y<=Y.rfx.e.c;++y)a.dense?(l[p]||(l[p]=[]),l[p][y]||(l[p][y]={t:"z",v:void 0}),l[p][y].l=Y):(S=tt({c:y,r:p}),l[S]||(l[S]={t:"z",v:void 0}),l[S].l=Y);break;case 426:if(!a.cellFormula)break;b.push(Y),I=a.dense?l[p][y]:l[yr(y)+A],I.f=Rn(Y[1],u,{r:d.r,c:y},B,a),I.F=ct(Y[0]);break;case 427:if(!a.cellFormula)break;k[tt(Y[0].s)]=Y[1],I=a.dense?l[p][y]:l[yr(y)+A],I.f=Rn(Y[1],u,{r:d.r,c:y},B,a);break;case 60:if(!a.cellStyles)break;for(;Y.e>=Y.s;)q[Y.e--]={width:Y.w/256,hidden:!!(Y.flags&1),level:Y.level},we||(we=!0,XE(Y.w/256)),ol(q[Y.e+1]);break;case 161:l["!autofilter"]={ref:ct(Y)};break;case 476:l["!margins"]=Y;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),Y.name&&(i.Sheets[r].CodeName=Y.name),(Y.above||Y.left)&&(l["!outline"]={above:Y.above,left:Y.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),Y.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!Pe.T){if(!h||a.WTF)throw new Error("Unexpected record 0x"+w.toString(16))}}},a),delete a.supbooks,delete a["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=ct(c||u)),a.sheetRows&&l["!ref"]){var ce=Mt(l["!ref"]);a.sheetRows<=+ce.e.r&&(ce.e.r=a.sheetRows-1,ce.e.r>u.e.r&&(ce.e.r=u.e.r),ce.e.r<ce.s.r&&(ce.s.r=ce.e.r),ce.e.c>u.e.c&&(ce.e.c=u.e.c),ce.e.c<ce.s.c&&(ce.s.c=ce.e.c),l["!fullref"]=l["!ref"],l["!ref"]=ct(ce))}return O.length>0&&(l["!merges"]=O),q.length>0&&(l["!cols"]=q),ue.length>0&&(l["!rows"]=ue),l}function _ve(t,e,r,n,i,s,o){if(e.v===void 0)return!1;var a="";switch(e.t){case"b":a=e.v?"1":"0";break;case"d":e=lr(e),e.z=e.z||et[14],e.v=Jr(ar(e.v)),e.t="n";break;case"n":case"e":a=""+e.v;break;default:a=e.v;break}var l={r,c:n};switch(l.s=pl(i.cellXfs,e,i),e.l&&s["!links"].push([tt(l),e.l]),e.c&&s["!comments"].push([tt(l),e.c]),e.t){case"s":case"str":return i.bookSST?(a=eR(i.Strings,e.v,i.revStrings),l.t="s",l.v=a,o?Te(t,18,Gpe(e,l)):Te(t,7,jpe(e,l))):(l.t="str",o?Te(t,17,ive(e,l)):Te(t,6,rve(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?Te(t,13,Qpe(e,l)):Te(t,2,Jpe(e,l)):o?Te(t,16,Xpe(e,l)):Te(t,5,Kpe(e,l)),!0;case"b":return l.t="b",o?Te(t,15,Lpe(e,l)):Te(t,4,Hpe(e,l)),!0;case"e":return l.t="e",o?Te(t,14,Wpe(e,l)):Te(t,3,Bpe(e,l)),!0}return o?Te(t,12,Npe(e,l)):Te(t,1,Ppe(e,l)),!0}function Ave(t,e,r,n){var i=Mt(e["!ref"]||"A1"),s,o="",a=[];Te(t,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var u=i.s.r;u<=c;++u){o=Hr(u),Rpe(t,e,i,u);var h=!1;if(u<=i.e.r)for(var f=i.s.c;f<=i.e.c;++f){u===i.s.r&&(a[f]=yr(f)),s=a[f]+o;var d=l?(e[u]||[])[f]:e[s];if(!d){h=!1;continue}h=_ve(t,d,u,f,n,e,h)}}Te(t,146)}function Ive(t,e){!e||!e["!merges"]||(Te(t,177,hve(e["!merges"].length)),e["!merges"].forEach(function(r){Te(t,176,uve(r))}),Te(t,178))}function Mve(t,e){!e||!e["!cols"]||(Te(t,390),e["!cols"].forEach(function(r,n){r&&Te(t,60,vve(n,r))}),Te(t,391))}function Ove(t,e){!e||!e["!ref"]||(Te(t,648),Te(t,649,Sve(Mt(e["!ref"]))),Te(t,650))}function Pve(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=Wt(r,-1,n[1].Target.replace(/#.*$/,""),St.HLINK);Te(t,494,dve(n,i))}}),delete e["!links"]}function kve(t,e,r,n){if(e["!comments"].length>0){var i=Wt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",St.VML);Te(t,551,VE("rId"+i)),e["!legacy"]=i}}function Nve(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:ct(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,a=ci(s);a.s.r==a.e.r&&(a.e.r=ci(e["!ref"]).e.r,s=ct(a));for(var l=0;l<o.length;++l){var c=o[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Te(t,161,Mh(Mt(s))),Te(t,162)}}function Fve(t,e,r){Te(t,133),Te(t,137,xve(e,r)),Te(t,138),Te(t,134)}function Hve(t,e){e["!protect"]&&Te(t,535,bve(e["!protect"]))}function Dve(t,e,r,n){var i=li(),s=r.SheetNames[t],o=r.Sheets[s]||{},a=s;try{r&&r.Workbook&&(a=r.Workbook.Sheets[t].CodeName||a)}catch{}var l=Mt(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Te(i,129),(r.vbaraw||o["!outline"])&&Te(i,147,Mpe(a,o["!outline"])),Te(i,148,_pe(l)),Fve(i,o,r.Workbook),Mve(i,o),Ave(i,o,t,e),Hve(i,o),Nve(i,o,r,t),Ive(i,o),Pve(i,o,n),o["!margins"]&&Te(i,476,Cve(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&Ove(i,o),kve(i,o,t,n),Te(i,130),i.end()}function Lve(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var i=It((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function $ve(t,e,r,n,i,s){var o=s||{"!type":"chart"};if(!t)return s;var a=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var f=Lve(h);u.s.r=u.s.c=0,u.e.c=a,c=yr(a),f[0].forEach(function(d,g){o[c+Hr(g)]={t:"n",v:d,z:f[1]},l=g}),u.e.r<l&&(u.e.r=l),++a}),a>0&&(o["!ref"]=ct(u)),o}function Bve(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,a=t.match(WH);return a&&tR(a[0],s,i,r),(o=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Vve(t,e){t.l+=10;var r=In(t);return{name:r}}function Wve(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return ga(t,function(l,c,u){switch(u){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var rR=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Uve=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],jve=[],zve=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function VM(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=or(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function WM(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=or(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function GH(t){WM(t.WBProps,rR),WM(t.CalcPr,zve),VM(t.WBView,Uve),VM(t.Sheets,jve),sh.date1904=or(t.WBProps.date1904)}function Gve(t){return!t.Workbook||!t.Workbook.WBProps?"false":or(t.Workbook.WBProps.date1904)?"true":"false"}var Yve="][*?/\\".split("");function YH(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Yve.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Kve(t,e,r){t.forEach(function(n,i){YH(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[i]&&e[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Xve(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];Kve(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)Gme(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var qve=/<\w+:workbook/;function Jve(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},o=0;if(t.replace(On,function(l,c){var u=rt(l);switch(Ro(u[0])){case"<?xml":break;case"<workbook":l.match(qve)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":rR.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=or(u[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:r.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(r.WBProps.CodeName=Kt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=It(Kt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Kt(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),or(u.hidden||"0")&&(s.Hidden=!0),o=c+l.length;break;case"</definedName>":s.Ref=It(Kt(t.slice(o,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),zc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return GH(r),r}function KH(t){var e=[Lr];e[e.length]=Ne("workbook",null,{xmlns:zc[0],"xmlns:r":qr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(rR.forEach(function(a){t.Workbook.WBProps[a[0]]!=null&&t.Workbook.WBProps[a[0]]!=a[1]&&(n[a[0]]=t.Workbook.WBProps[a[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Ne("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var o={name:Ut(t.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Ne("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),a.Sheet!=null&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(e[e.length]=Ne("definedName",Ut(a.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function Zve(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=lx(t),r.name=In(t),r}function Qve(t,e){return e||(e=ye(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),VE(t.strRelID,e),an(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function ewe(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?In(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function twe(t,e){e||(e=ye(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),$F(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function rwe(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function nwe(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=kue(t),o=Bme(t,0,r),a=BE(t);t.l=n;var l={Name:s,Ptg:o};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}function iwe(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],Jd[16]={n:"BrtFRTArchID$",f:rwe},ga(t,function(l,c,u){switch(u){case 156:o.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Rn(l.Ptg,null,null,o,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,l]):o[0]=[u,l],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(l),o.XTI=o.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(u),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),GH(r),r.Names=s,r.supbooks=o,r}function swe(t,e){Te(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Te(t,156,Qve(i))}Te(t,144)}function owe(t,e){e||(e=ye(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return an("SheetJS",e),an(tv.version,e),an(tv.version,e),an("7262",e),e.length>e.l?e.slice(0,e.l):e}function awe(t,e){e||(e=ye(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function lwe(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(Te(t,135),Te(t,158,awe(i)),Te(t,136))}}function cwe(t,e){var r=li();return Te(r,131),Te(r,128,owe()),Te(r,153,twe(t.Workbook&&t.Workbook.WBProps||null)),lwe(r,t),swe(r,t),Te(r,132),r.end()}function uwe(t,e,r){return e.slice(-4)===".bin"?iwe(t,r):Jve(t,r)}function hwe(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?Tve(t,n,r,i,s,o,a):npe(t,n,r,i,s,o,a)}function fwe(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?Wve(t,n,r,i,s):Bve(t,n,r,i,s)}function dwe(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?m0e():p0e()}function gwe(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?d0e():g0e()}function mwe(t,e,r,n){return e.slice(-4)===".bin"?uge(t,r,n):Zde(t,r,n)}function pwe(t,e,r){return AH(t,r)}function vwe(t,e,r){return e.slice(-4)===".bin"?vde(t,r):gde(t,r)}function wwe(t,e,r){return e.slice(-4)===".bin"?l0e(t,r):Qge(t,r)}function Cwe(t,e,r){return e.slice(-4)===".bin"?qge(t):Kge(t)}function ywe(t,e,r,n){return r.slice(-4)===".bin"?Jge(t,e,r,n):void 0}function xwe(t,e,r){return e.slice(-4)===".bin"?zge(t,e,r):Yge(t,e,r)}function Swe(t,e,r){return(e.slice(-4)===".bin"?cwe:KH)(t)}function bwe(t,e,r,n,i){return(e.slice(-4)===".bin"?Dve:UH)(t,r,n,i)}function Ewe(t,e,r){return(e.slice(-4)===".bin"?yge:TH)(t,r)}function Rwe(t,e,r){return(e.slice(-4)===".bin"?yde:wH)(t,r)}function Twe(t,e,r){return(e.slice(-4)===".bin"?c0e:OH)(t)}function _we(t){return(t.slice(-4)===".bin"?Gge:IH)()}var XH=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,qH=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function fs(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(XH),s,o,a,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(qH),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(o+1),n[a]=s[2].slice(1,s[2].length-1));return n}function Awe(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(XH),i,s,o,a;if(n)for(a=0;a!=n.length;++a)i=n[a].match(qH),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),r[o]=i[2].slice(1,i[2].length-1));return r}var yd;function Iwe(t,e){var r=yd[t]||It(t);return r==="General"?Mc(e):es(r,e)}function Mwe(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=or(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=ar(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[It(e)]=i}function Owe(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||ma[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Wd(t.v):t.w=Mc(t.v):t.w=Iwe(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=yd[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&_h(n)){var i=mc(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function Pwe(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=jde[n.Pattern]||n.Pattern)}t[e.ID]=e}function kwe(t,e,r,n,i,s,o,a,l,c){var u="General",h=n.StyleID,f={};c=c||{};var d=[],g=0;for(h===void 0&&a&&(h=a.StyleID),h===void 0&&o&&(h=o.StyleID);s[h]!==void 0&&(s[h].nf&&(u=s[h].nf),s[h].Interior&&d.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=or(t);break;case"String":n.t="s",n.r=sM(It(t)),n.v=t.indexOf("<")>-1?It(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(ar(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=It(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=jF[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=sM(e||t));break}if(Owe(n,u,c),c.cellFormula!==!1)if(n.Formula){var m=It(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=ih(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=ih("RC:RC",i):n.ArrayRange&&(n.F=ih(n.ArrayRange,i),l.push([Mt(n.F),n.F]))}else for(g=0;g<l.length;++g)i.r>=l[g][0].s.r&&i.r<=l[g][0].e.r&&i.c>=l[g][0].s.c&&i.c<=l[g][0].e.c&&(n.F=l[g][1]);c.cellStyles&&(d.forEach(function(p){!f.patternType&&p.patternType&&(f.patternType=p.patternType)}),n.s=f),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Nwe(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function q1(t,e){var r=e||{};Ah();var n=Wf(NE(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Kt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=lr(r);return o.type="string",ph.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function($e){i.indexOf("<"+$e)>=0&&(s=!0)}),s)return CCe(n,r);yd={"General Number":"General","General Date":et[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":et[15],"Short Date":et[14],"Long Time":et[19],"Medium Time":et[18],"Short Time":et[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:et[2],Standard:et[4],Percent:et[10],Scientific:et[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var a,l=[],c,u={},h=[],f=r.dense?[]:{},d="",g={},m={},p=fs('<Data ss:Type="String">'),y=0,S=0,C=0,A={s:{r:2e6,c:2e6},e:{r:0,c:0}},I={},O={},_="",E=0,b=[],k={},B={},N=0,q=[],ue=[],we={},Se=[],ce,Re=!1,Y=[],Pe=[],w={},v=0,x=0,R={Sheets:[],WBProps:{date1904:!1}},T={};zd.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var L="";a=zd.exec(n);)switch(a[3]=(L=a[3]).toLowerCase()){case"data":if(L=="data"){if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break}if(l[l.length-1][1])break;a[1]==="/"?kwe(n.slice(y,a.index),_,p,l[l.length-1][0]=="comment"?we:g,{c:S,r:C},I,Se[S],m,Y,r):(_="",p=fs(a[0]),y=a.index+a[0].length);break;case"cell":if(a[1]==="/")if(ue.length>0&&(g.c=ue),(!r.sheetRows||r.sheetRows>C)&&g.v!==void 0&&(r.dense?(f[C]||(f[C]=[]),f[C][S]=g):f[yr(S)+Hr(C)]=g),g.HRef&&(g.l={Target:It(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(v=S+(parseInt(g.MergeAcross,10)|0),x=C+(parseInt(g.MergeDown,10)|0),b.push({s:{c:S,r:C},e:{c:v,r:x}})),!r.sheetStubs)g.MergeAcross?S=v+1:++S;else if(g.MergeAcross||g.MergeDown){for(var K=S;K<=v;++K)for(var Q=C;Q<=x;++Q)(K>S||Q>C)&&(r.dense?(f[Q]||(f[Q]=[]),f[Q][K]={t:"z"}):f[yr(K)+Hr(Q)]={t:"z"});S=v+1}else++S;else g=Awe(a[0]),g.Index&&(S=+g.Index-1),S<A.s.c&&(A.s.c=S),S>A.e.c&&(A.e.c=S),a[0].slice(-2)==="/>"&&++S,ue=[];break;case"row":a[1]==="/"||a[0].slice(-2)==="/>"?(C<A.s.r&&(A.s.r=C),C>A.e.r&&(A.e.r=C),a[0].slice(-2)==="/>"&&(m=fs(a[0]),m.Index&&(C=+m.Index-1)),S=0,++C):(m=fs(a[0]),m.Index&&(C=+m.Index-1),w={},(m.AutoFitHeight=="0"||m.Height)&&(w.hpx=parseInt(m.Height,10),w.hpt=qd(w.hpx),Pe[C]=w),m.Hidden=="1"&&(w.hidden=!0,Pe[C]=w));break;case"worksheet":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));h.push(d),A.s.r<=A.e.r&&A.s.c<=A.e.c&&(f["!ref"]=ct(A),r.sheetRows&&r.sheetRows<=A.e.r&&(f["!fullref"]=f["!ref"],A.e.r=r.sheetRows-1,f["!ref"]=ct(A))),b.length&&(f["!merges"]=b),Se.length>0&&(f["!cols"]=Se),Pe.length>0&&(f["!rows"]=Pe),u[d]=f}else A={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=S=0,l.push([a[3],!1]),c=fs(a[0]),d=It(c.Name),f=r.dense?[]:{},b=[],Y=[],Pe=[],T={name:d,Hidden:0},R.Sheets.push(T);break;case"table":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else{if(a[0].slice(-2)=="/>")break;l.push([a[3],!1]),Se=[],Re=!1}break;case"style":a[1]==="/"?Pwe(I,O,r):O=fs(a[0]);break;case"numberformat":O.nf=It(fs(a[0]).Format||"General"),yd[O.nf]&&(O.nf=yd[O.nf]);for(var Z=0;Z!=392&&et[Z]!=O.nf;++Z);if(Z==392){for(Z=57;Z!=392;++Z)if(et[Z]==null){na(O.nf,Z);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ce=fs(a[0]),ce.Hidden&&(ce.hidden=!0,delete ce.Hidden),ce.Width&&(ce.wpx=parseInt(ce.Width,10)),!Re&&ce.wpx>10){Re=!0,_n=EH;for(var ie=0;ie<Se.length;++ie)Se[ie]&&ol(Se[ie])}Re&&ol(ce),Se[ce.Index-1||Se.length]=ce;for(var fe=0;fe<+ce.Span;++fe)Se[Se.length]=lr(ce);break;case"namedrange":if(a[1]==="/")break;R.Names||(R.Names=[]);var H=rt(a[0]),Me={Name:H.Name,Ref:ih(H.RefersTo.slice(1),{r:0,c:0})};R.Sheets.length>0&&(Me.Sheet=R.Sheets.length-1),R.Names.push(Me);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(a[0].slice(-2)==="/>")break;a[1]==="/"?_+=n.slice(E,a.index):E=a.index+a[0].length;break;case"interior":if(!r.cellStyles)break;O.Interior=fs(a[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(a[0].slice(-2)==="/>")break;a[1]==="/"?ihe(k,L,n.slice(N,a.index)):N=a.index+a[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else l.push([a[3],!1]);break;case"comment":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));Nwe(we),ue.push(we)}else l.push([a[3],!1]),c=fs(a[0]),we={a:c.Author};break;case"autofilter":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else if(a[0].charAt(a[0].length-2)!=="/"){var ae=fs(a[0]);f["!autofilter"]={ref:ih(ae.Range).replace(/\$/g,"")},l.push([a[3],!0])}break;case"name":break;case"datavalidation":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"null":break;default:if(l.length==0&&a[3]=="document"||l.length==0&&a[3]=="uof")return YM(n,r);var ke=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ke=!1}break;case"componentoptions":switch(a[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ke=!1}break;case"excelworkbook":switch(a[3]){case"date1904":R.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ke=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":break;case"height":break;case"width":break;default:ke=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if(a[0].slice(-2)!=="/>")if(a[1]==="/")switch(n.slice(N,a.index)){case"SheetHidden":T.Hidden=1;break;case"SheetVeryHidden":T.Hidden=2;break}else N=a.index+a[0].length;break;case"header":f["!margins"]||yc(f["!margins"]={},"xlml"),isNaN(+rt(a[0]).Margin)||(f["!margins"].header=+rt(a[0]).Margin);break;case"footer":f["!margins"]||yc(f["!margins"]={},"xlml"),isNaN(+rt(a[0]).Margin)||(f["!margins"].footer=+rt(a[0]).Margin);break;case"pagemargins":var Ae=rt(a[0]);f["!margins"]||yc(f["!margins"]={},"xlml"),isNaN(+Ae.Top)||(f["!margins"].top=+Ae.Top),isNaN(+Ae.Left)||(f["!margins"].left=+Ae.Left),isNaN(+Ae.Right)||(f["!margins"].right=+Ae.Right),isNaN(+Ae.Bottom)||(f["!margins"].bottom=+Ae.Bottom);break;case"displayrighttoleft":R.Views||(R.Views=[]),R.Views[0]||(R.Views[0]={}),R.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ke=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ke=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ke=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ke=!1}break;case"querytable":switch(a[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ke=!1}break;case"datavalidation":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ke=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ke=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ke=!1}break;case"smarttags":break;default:ke=!1;break}if(ke||a[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(a[0].slice(-2)==="/>")break;a[1]==="/"?Mwe(B,L,q,n.slice(N,a.index)):(q=a,N=a.index+a[0].length);break}if(r.WTF)throw"Unrecognized tag: "+a[3]+"|"+l.join("|")}var be={};return!r.bookSheets&&!r.bookProps&&(be.Sheets=u),be.SheetNames=h,be.Workbook=R,be.SSF=lr(et),be.Props=k,be.Custprops=B,be}function mx(t,e){switch(iR(e=e||{}),e.type||"base64"){case"base64":return q1(Ai(t),e);case"binary":case"buffer":case"file":return q1(t,e);case"array":return q1(gl(t),e)}}function Fwe(t,e){var r=[];return t.Props&&r.push(she(t.Props,e)),t.Custprops&&r.push(ohe(t.Props,t.Custprops)),r.join("")}function Hwe(){return""}function Dwe(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(Ne("NumberFormat",null,{"ss:Format":Ut(et[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(Ne("Style",s.join(""),o))}),Ne("Styles",r.join(""))}function JH(t){return Ne("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+ZE(t.Ref,{r:0,c:0})})}function Lwe(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(JH(i)))}return Ne("Names",r.join(""))}function $we(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],o=0;o<i.length;++o){var a=i[o];a.Sheet==r&&(a.Name.match(/^_xlfn\./)||s.push(JH(a)))}return s.join("")}function Bwe(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(Ne("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(Ne("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(Ne("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Ne("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(dn("ProtectContents","True")),t["!protect"].objects&&i.push(dn("ProtectObjects","True")),t["!protect"].scenarios&&i.push(dn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(dn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(dn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":Ne("WorksheetOptions",i.join(""),{xmlns:bi.x})}function Vwe(t){return t.map(function(e){var r=lue(e.t||""),n=Ne("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ne("Comment",n,{"ss:Author":e.a})}).join("")}function Wwe(t,e,r,n,i,s,o){if(!t||t.v==null&&t.f==null)return"";var a={};if(t.f&&(a["ss:Formula"]="="+Ut(ZE(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var l=xr(t.F.slice(e.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(t.l&&t.l.Target&&(a["ss:HRef"]=Ut(t.l.Target),t.l.Tooltip&&(a["x:HRefScreenTip"]=Ut(t.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=o.c||c[u].s.r!=o.r||(c[u].e.c>c[u].s.c&&(a["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(a["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",f="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",f=String(t.v);break;case"b":h="Boolean",f=t.v?"1":"0";break;case"e":h="Error",f=ma[t.v];break;case"d":h="DateTime",f=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||et[14]);break;case"s":h="String",f=aue(t.v||"");break}var d=pl(n.cellXfs,t,n);a["ss:StyleID"]="s"+(21+d),a["ss:Index"]=o.c+1;var g=t.v!=null?f:"",m=t.t=="z"?"":'<Data ss:Type="'+h+'">'+g+"</Data>";return(t.c||[]).length>0&&(m+=Vwe(t.c)),Ne("Cell",m,a)}function Uwe(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=vh(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function jwe(t,e,r,n){if(!t["!ref"])return"";var i=Mt(t["!ref"]),s=t["!merges"]||[],o=0,a=[];t["!cols"]&&t["!cols"].forEach(function(p,y){ol(p);var S=!!p.width,C=uw(y,p),A={"ss:Index":y+1};S&&(A["ss:Width"]=Kd(C.width)),p.hidden&&(A["ss:Hidden"]="1"),a.push(Ne("Column",null,A))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var u=[Uwe(c,(t["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var f=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>h)&&!(s[o].s.r>c)&&!(s[o].e.c<h)&&!(s[o].e.r<c)){(s[o].s.c!=h||s[o].s.r!=c)&&(f=!0);break}if(!f){var d={r:c,c:h},g=tt(d),m=l?(t[c]||[])[h]:t[g];u.push(Wwe(m,g,t,e,r,n,d))}}u.push("</Row>"),u.length>2&&a.push(u.join(""))}return a.join("")}function zwe(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],o=s?$we(s,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?jwe(s,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(Bwe(s,e,t,r)),n.join("")}function Gwe(t,e){e||(e={}),t.SSF||(t.SSF=lr(et)),t.SSF&&(Ah(),nw(t.SSF),e.revssf=sw(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],pl(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Fwe(t,e)),r.push(Hwe()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Ne("Worksheet",zwe(n,e,t),{"ss:Name":Ut(t.SheetNames[n])}));return r[2]=Dwe(t,e),r[3]=Lwe(t),Lr+Ne("Workbook",r.join(""),{xmlns:bi.ss,"xmlns:o":bi.o,"xmlns:x":bi.x,"xmlns:ss":bi.ss,"xmlns:dt":bi.dt,"xmlns:html":bi.html})}function Ywe(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=Lue(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=$ue(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var Kwe=[60,1084,2066,2165,2175];function Xwe(t,e,r,n,i){var s=n,o=[],a=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&a.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(a)}o.push(a),r.l+=s;for(var l=ta(r,r.l),c=px[l],u=0;c!=null&&Kwe.indexOf(l)>-1;)s=ta(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),a=r.slice(u,r.l+4+s),o.push(a),r.l+=4+s,c=px[l=ta(r,r.l)];var h=on(o);fn(h,0);var f=0;h.lens=[];for(var d=0;d<o.length;++d)h.lens.push(f),f+=o[d].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function Qs(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=et[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||ma[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Wd(t.v):t.w=Mc(t.v):t.w=es(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&_h(et[n]||String(n))){var i=mc(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Pm(t,e,r){return{v:t,ixfe:e,t:r}}function qwe(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},o={},a=null,l=[],c="",u={},h,f="",d,g,m,p,y={},S=[],C,A,I=[],O=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},b=function(se){return se<8?vc[se]:se<64&&O[se-8]||vc[se]},k=function(se,Ee,Oe){var De=Ee.XF.data;if(!(!De||!De.patternType||!Oe||!Oe.cellStyles)){Ee.s={},Ee.s.patternType=De.patternType;var ze;(ze=Yd(b(De.icvFore)))&&(Ee.s.fgColor={rgb:ze}),(ze=Yd(b(De.icvBack)))&&(Ee.s.bgColor={rgb:ze})}},B=function(se,Ee,Oe){if(!(w>1)&&!(Oe.sheetRows&&se.r>=Oe.sheetRows)){if(Oe.cellStyles&&Ee.XF&&Ee.XF.data&&k(se,Ee,Oe),delete Ee.ixfe,delete Ee.XF,h=se,f=tt(se),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),se.r<o.s.r&&(o.s.r=se.r),se.c<o.s.c&&(o.s.c=se.c),se.r+1>o.e.r&&(o.e.r=se.r+1),se.c+1>o.e.c&&(o.e.c=se.c+1),Oe.cellFormula&&Ee.f){for(var De=0;De<S.length;++De)if(!(S[De][0].s.c>se.c||S[De][0].s.r>se.r)&&!(S[De][0].e.c<se.c||S[De][0].e.r<se.r)){Ee.F=ct(S[De][0]),(S[De][0].s.c!=se.c||S[De][0].s.r!=se.r)&&delete Ee.f,Ee.f&&(Ee.f=""+Rn(S[De][1],o,se,Y,N));break}}Oe.dense?(i[se.r]||(i[se.r]=[]),i[se.r][se.c]=Ee):i[f]=Ee}},N={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:S,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(N.password=e.password);var q,ue=[],we=[],Se=[],ce=[],Re=!1,Y=[];Y.SheetNames=N.snames,Y.sharedf=N.sharedf,Y.arrayf=N.arrayf,Y.names=[],Y.XTI=[];var Pe=0,w=0,v=0,x=[],R=[],T;N.codepage=1200,bs(1200);for(var L=!1;t.l<t.length-1;){var K=t.l,Q=t.read_shift(2);if(Q===0&&Pe===10)break;var Z=t.l===t.length?0:t.read_shift(2),ie=px[Q];if(ie&&ie.f){if(e.bookSheets&&Pe===133&&Q!==133)break;if(Pe=Q,ie.r===2||ie.r==12){var fe=t.read_shift(2);if(Z-=2,!N.enc&&fe!==Q&&((fe&255)<<8|fe>>8)!==Q)throw new Error("rt mismatch: "+fe+"!="+Q);ie.r==12&&(t.l+=10,Z-=10)}var H={};if(Q===10?H=ie.f(t,Z,N):H=Xwe(Q,ie,t,Z,N),w==0&&[9,521,1033,2057].indexOf(Pe)===-1)continue;switch(Q){case 34:r.opts.Date1904=_.WBProps.date1904=H;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(N.enc||(t.l=0),N.enc=H,!e.password)throw new Error("File is password-protected");if(H.valid==null)throw new Error("Encryption scheme unsupported");if(!H.valid)throw new Error("Password is incorrect");break;case 92:N.lastuser=H;break;case 66:var Me=Number(H);switch(Me){case 21010:Me=1200;break;case 32768:Me=1e4;break;case 32769:Me=1252;break}bs(N.codepage=Me),L=!0;break;case 317:N.rrtabid=H;break;case 25:N.winlocked=H;break;case 439:r.opts.RefreshAll=H;break;case 12:r.opts.CalcCount=H;break;case 16:r.opts.CalcDelta=H;break;case 17:r.opts.CalcIter=H;break;case 13:r.opts.CalcMode=H;break;case 14:r.opts.CalcPrecision=H;break;case 95:r.opts.CalcSaveRecalc=H;break;case 15:N.CalcRefMode=H;break;case 2211:r.opts.FullCalc=H;break;case 129:H.fDialog&&(i["!type"]="dialog"),H.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),H.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:I.push(H);break;case 430:Y.push([H]),Y[Y.length-1].XTI=[];break;case 35:case 547:Y[Y.length-1].push(H);break;case 24:case 536:T={Name:H.Name,Ref:Rn(H.rgce,o,null,Y,N)},H.itab>0&&(T.Sheet=H.itab-1),Y.names.push(T),Y[0]||(Y[0]=[],Y[0].XTI=[]),Y[Y.length-1].push(H),H.Name=="_xlnm._FilterDatabase"&&H.itab>0&&H.rgce&&H.rgce[0]&&H.rgce[0][0]&&H.rgce[0][0][0]=="PtgArea3d"&&(R[H.itab-1]={ref:ct(H.rgce[0][0][1][2])});break;case 22:N.ExternCount=H;break;case 23:Y.length==0&&(Y[0]=[],Y[0].XTI=[]),Y[Y.length-1].XTI=Y[Y.length-1].XTI.concat(H),Y.XTI=Y.XTI.concat(H);break;case 2196:if(N.biff<8)break;T!=null&&(T.Comment=H[1]);break;case 18:i["!protect"]=H;break;case 19:H!==0&&N.WTF&&console.error("Password verifier: "+H);break;case 133:s[H.pos]=H,N.snames.push(H.name);break;case 10:{if(--w)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=ct(o),e.sheetRows&&e.sheetRows<=o.e.r){var ae=o.e.r;o.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=ct(o),o.e.r=ae}o.e.r++,o.e.c++}ue.length>0&&(i["!merges"]=ue),we.length>0&&(i["!objects"]=we),Se.length>0&&(i["!cols"]=Se),ce.length>0&&(i["!rows"]=ce),_.Sheets.push(E)}c===""?u=i:n[c]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(N.biff===8&&(N.biff={9:2,521:3,1033:4}[Q]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[H.BIFFVer]||8),N.biffguess=H.BIFFVer==0,H.BIFFVer==0&&H.dt==4096&&(N.biff=5,L=!0,bs(N.codepage=28591)),N.biff==8&&H.BIFFVer==0&&H.dt==16&&(N.biff=2),w++)break;if(i=e.dense?[]:{},N.biff<8&&!L&&(L=!0,bs(N.codepage=e.codepage||1252)),N.biff<5||H.BIFFVer==0&&H.dt==4096){c===""&&(c="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var ke={pos:t.l-Z,name:c};s[ke.pos]=ke,N.snames.push(c)}else c=(s[K]||{name:""}).name;H.dt==32&&(i["!type"]="chart"),H.dt==64&&(i["!type"]="macro"),ue=[],we=[],N.arrayf=S=[],Se=[],ce=[],Re=!1,E={Hidden:(s[K]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[H.r]||[])[H.c]:i[tt({c:H.c,r:H.r})])&&++H.c,C={ixfe:H.ixfe,XF:I[H.ixfe]||{},v:H.val,t:"n"},v>0&&(C.z=x[C.ixfe>>8&63]),Qs(C,e,r.opts.Date1904),B({c:H.c,r:H.r},C,e);break;case 5:case 517:C={ixfe:H.ixfe,XF:I[H.ixfe],v:H.val,t:H.t},v>0&&(C.z=x[C.ixfe>>8&63]),Qs(C,e,r.opts.Date1904),B({c:H.c,r:H.r},C,e);break;case 638:C={ixfe:H.ixfe,XF:I[H.ixfe],v:H.rknum,t:"n"},v>0&&(C.z=x[C.ixfe>>8&63]),Qs(C,e,r.opts.Date1904),B({c:H.c,r:H.r},C,e);break;case 189:for(var Ae=H.c;Ae<=H.C;++Ae){var be=H.rkrec[Ae-H.c][0];C={ixfe:be,XF:I[be],v:H.rkrec[Ae-H.c][1],t:"n"},v>0&&(C.z=x[C.ixfe>>8&63]),Qs(C,e,r.opts.Date1904),B({c:Ae,r:H.r},C,e)}break;case 6:case 518:case 1030:{if(H.val=="String"){a=H;break}if(C=Pm(H.val,H.cell.ixfe,H.tt),C.XF=I[C.ixfe],e.cellFormula){var $e=H.formula;if($e&&$e[0]&&$e[0][0]&&$e[0][0][0]=="PtgExp"){var Le=$e[0][0][1][0],P=$e[0][0][1][1],F=tt({r:Le,c:P});y[F]?C.f=""+Rn(H.formula,o,H.cell,Y,N):C.F=((e.dense?(i[Le]||[])[P]:i[F])||{}).F}else C.f=""+Rn(H.formula,o,H.cell,Y,N)}v>0&&(C.z=x[C.ixfe>>8&63]),Qs(C,e,r.opts.Date1904),B(H.cell,C,e),a=H}break;case 7:case 519:if(a)a.val=H,C=Pm(H,a.cell.ixfe,"s"),C.XF=I[C.ixfe],e.cellFormula&&(C.f=""+Rn(a.formula,o,a.cell,Y,N)),v>0&&(C.z=x[C.ixfe>>8&63]),Qs(C,e,r.opts.Date1904),B(a.cell,C,e),a=null;else throw new Error("String record expects Formula");break;case 33:case 545:{S.push(H);var G=tt(H[0].s);if(d=e.dense?(i[H[0].s.r]||[])[H[0].s.c]:i[G],e.cellFormula&&d){if(!a||!G||!d)break;d.f=""+Rn(H[1],o,H[0],Y,N),d.F=ct(H[0])}}break;case 1212:{if(!e.cellFormula)break;if(f){if(!a)break;y[tt(a.cell)]=H[0],d=e.dense?(i[a.cell.r]||[])[a.cell.c]:i[tt(a.cell)],(d||{}).f=""+Rn(H[0],o,h,Y,N)}}break;case 253:C=Pm(l[H.isst].t,H.ixfe,"s"),l[H.isst].h&&(C.h=l[H.isst].h),C.XF=I[C.ixfe],v>0&&(C.z=x[C.ixfe>>8&63]),Qs(C,e,r.opts.Date1904),B({c:H.c,r:H.r},C,e);break;case 513:e.sheetStubs&&(C={ixfe:H.ixfe,XF:I[H.ixfe],t:"z"},v>0&&(C.z=x[C.ixfe>>8&63]),Qs(C,e,r.opts.Date1904),B({c:H.c,r:H.r},C,e));break;case 190:if(e.sheetStubs)for(var ne=H.c;ne<=H.C;++ne){var X=H.ixfe[ne-H.c];C={ixfe:X,XF:I[X],t:"z"},v>0&&(C.z=x[C.ixfe>>8&63]),Qs(C,e,r.opts.Date1904),B({c:ne,r:H.r},C,e)}break;case 214:case 516:case 4:C=Pm(H.val,H.ixfe,"s"),C.XF=I[C.ixfe],v>0&&(C.z=x[C.ixfe>>8&63]),Qs(C,e,r.opts.Date1904),B({c:H.c,r:H.r},C,e);break;case 0:case 512:w===1&&(o=H);break;case 252:l=H;break;case 1054:if(N.biff==4){x[v++]=H[1];for(var re=0;re<v+163&&et[re]!=H[1];++re);re>=163&&na(H[1],v+163)}else na(H[1],H[0]);break;case 30:{x[v++]=H;for(var te=0;te<v+163&&et[te]!=H;++te);te>=163&&na(H,v+163)}break;case 229:ue=ue.concat(H);break;case 93:we[H.cmo[0]]=N.lastobj=H;break;case 438:N.lastobj.TxO=H;break;case 127:N.lastobj.ImData=H;break;case 440:for(p=H[0].s.r;p<=H[0].e.r;++p)for(m=H[0].s.c;m<=H[0].e.c;++m)d=e.dense?(i[p]||[])[m]:i[tt({c:m,r:p})],d&&(d.l=H[1]);break;case 2048:for(p=H[0].s.r;p<=H[0].e.r;++p)for(m=H[0].s.c;m<=H[0].e.c;++m)d=e.dense?(i[p]||[])[m]:i[tt({c:m,r:p})],d&&d.l&&(d.l.Tooltip=H[1]);break;case 28:{if(N.biff<=5&&N.biff>=2)break;d=e.dense?(i[H[0].r]||[])[H[0].c]:i[tt(H[0])];var ee=we[H[2]];d||(e.dense?(i[H[0].r]||(i[H[0].r]=[]),d=i[H[0].r][H[0].c]={t:"z"}):d=i[tt(H[0])]={t:"z"},o.e.r=Math.max(o.e.r,H[0].r),o.s.r=Math.min(o.s.r,H[0].r),o.e.c=Math.max(o.e.c,H[0].c),o.s.c=Math.min(o.s.c,H[0].c)),d.c||(d.c=[]),g={a:H[1],t:ee.TxO.t},d.c.push(g)}break;case 2173:Dge(I[H.ixfe],H.ext);break;case 125:{if(!N.cellStyles)break;for(;H.e>=H.s;)Se[H.e--]={width:H.w/256,level:H.level||0,hidden:!!(H.flags&1)},Re||(Re=!0,XE(H.w/256)),ol(Se[H.e+1])}break;case 520:{var oe={};H.level!=null&&(ce[H.r]=oe,oe.level=H.level),H.hidden&&(ce[H.r]=oe,oe.hidden=!0),H.hpt&&(ce[H.r]=oe,oe.hpt=H.hpt,oe.hpx=vh(H.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||yc(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Q]]=H;break;case 161:i["!margins"]||yc(i["!margins"]={}),i["!margins"].header=H.header,i["!margins"].footer=H.footer;break;case 574:H.RTL&&(_.Views[0].RTL=!0);break;case 146:O=H;break;case 2198:q=H;break;case 140:A=H;break;case 442:c?E.CodeName=H||E.name:_.WBProps.CodeName=H||"ThisWorkbook";break}}else ie||console.error("Missing Info for XLS Record 0x"+Q.toString(16)),t.l+=Z}return r.SheetNames=Ir(s).sort(function(le,se){return Number(le)-Number(se)}).map(function(le){return s[le].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&R.forEach(function(le,se){r.Sheets[r.SheetNames[se]]["!autofilter"]=le}),r.Strings=l,r.SSF=lr(et),N.enc&&(r.Encryption=N.enc),q&&(r.Themes=q),r.Metadata={},A!==void 0&&(r.Metadata.Country=A),Y.names.length>0&&(_.Names=Y.names),r.Workbook=_,r}var xd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Jwe(t,e,r){var n=qe.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=bM(n,cx,xd.DSI);for(var s in i)e[s]=i[s]}catch(c){if(r.WTF)throw c}var o=qe.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var a=bM(o,ux,xd.SI);for(var l in a)e[l]==null&&(e[l]=a[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(qF(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function Zwe(t,e){var r=[],n=[],i=[],s=0,o,a=QI(cx,"n"),l=QI(ux,"n");if(t.Props)for(o=Ir(t.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(a,o[s])?r:Object.prototype.hasOwnProperty.call(l,o[s])?n:i).push([o[s],t.Props[o[s]]]);if(t.Custprops)for(o=Ir(t.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(a,o[s])?r:Object.prototype.hasOwnProperty.call(l,o[s])?n:i).push([o[s],t.Custprops[o[s]]]);var c=[];for(s=0;s<i.length;++s)nH.indexOf(i[s][0])>-1||XF.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&qe.utils.cfb_add(e,"/SummaryInformation",EM(n,xd.SI,l,ux)),(r.length||c.length)&&qe.utils.cfb_add(e,"/DocumentSummaryInformation",EM(r,xd.DSI,a,cx,c.length?c:null,xd.UDI))}function ZH(t,e){e||(e={}),iR(e),RE(),e.codepage&&EE(e.codepage);var r,n;if(t.FullPaths){if(qe.find(t,"/encryption"))throw new Error("File is password-protected");r=qe.find(t,"!CompObj"),n=qe.find(t,"/Workbook")||qe.find(t,"/Book")}else{switch(e.type){case"base64":t=Ri(Ai(t));break;case"binary":t=Ri(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}fn(t,0),n={content:t}}var i,s;if(r&&Ywe(r),e.bookProps&&!e.bookSheets)i={};else{var o=Ct?"buffer":"array";if(n&&n.content)i=qwe(n.content,e);else if((s=qe.find(t,"PerfectOffice_MAIN"))&&s.content)i=Cc.to_workbook(s.content,(e.type=o,e));else if((s=qe.find(t,"NativeContent_MAIN"))&&s.content)i=Cc.to_workbook(s.content,(e.type=o,e));else throw(s=qe.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&qe.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=h0e(t))}var a={};return t.FullPaths&&Jwe(t,a,e),i.Props=i.Custprops=a,e.bookFiles&&(i.cfb=t),i}function Qwe(t,e){var r=e||{},n=qe.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return qe.utils.cfb_add(n,i,QH(t,r)),r.biff==8&&(t.Props||t.Custprops)&&Zwe(t,n),r.biff==8&&t.vbaraw&&f0e(n,qe.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Jd={0:{f:bpe},1:{f:Ope},2:{f:qpe},3:{f:$pe},4:{f:Fpe},5:{f:Ype},6:{f:tve},7:{f:Upe},8:{f:lve},9:{f:ave},10:{f:sve},11:{f:ove},12:{f:kpe},13:{f:Zpe},14:{f:Vpe},15:{f:Dpe},16:{f:jH},17:{f:nve},18:{f:zpe},19:{f:$E},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:nwe},40:{},42:{},43:{f:tge},44:{f:Qde},45:{f:ige},46:{f:oge},47:{f:sge},48:{},49:{f:Tue},50:{},51:{f:Bge},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:gH},62:{f:eve},63:{f:Xge},64:{f:Eve},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Mn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:yve},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Ipe},148:{f:Tpe,p:16},151:{f:gve},152:{},153:{f:ewe},154:{},155:{},156:{f:Zve},157:{},158:{},159:{T:1,f:pde},160:{T:-1},161:{T:1,f:Xc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:cve},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Lge},336:{T:-1},337:{f:Uge,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:lx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:dH},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:mve},427:{f:pve},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:wve},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Ape},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:fve},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:lx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:o0e},633:{T:1},634:{T:-1},635:{T:1,f:i0e},636:{T:-1},637:{f:Mue},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Vve},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Rve},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},px={6:{f:K1},10:{f:ka},12:{f:Wr},13:{f:Wr},14:{f:Pr},15:{f:Pr},16:{f:An},17:{f:Pr},18:{f:Pr},19:{f:Wr},20:{f:MM},21:{f:MM},23:{f:dH},24:{f:PM},25:{f:Pr},26:{},27:{},28:{f:Rfe},29:{},34:{f:Pr},35:{f:OM},38:{f:An},39:{f:An},40:{f:An},41:{f:An},42:{f:Pr},43:{f:Pr},47:{f:Dde},49:{f:Zhe},51:{f:Wr},60:{},61:{f:Yhe},64:{f:Pr},65:{f:Jhe},66:{f:Wr},77:{},80:{},81:{},82:{},85:{f:Wr},89:{},90:{},91:{},92:{f:Hhe},93:{f:Afe},94:{},95:{f:Pr},96:{},97:{},99:{f:Pr},125:{f:gH},128:{f:dfe},129:{f:Lhe},130:{f:Wr},131:{f:Pr},132:{f:Pr},133:{f:$he},134:{},140:{f:Hfe},141:{f:Wr},144:{},146:{f:$fe},151:{},152:{},153:{},154:{},155:{},156:{f:Wr},157:{},158:{},160:{f:Gfe},161:{f:Wfe},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:cfe},190:{f:ufe},193:{f:ka},197:{},198:{},199:{},200:{},201:{},202:{f:Pr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Wr},220:{},221:{f:Pr},222:{},224:{f:ffe},225:{f:Fhe},226:{f:ka},227:{},229:{f:Tfe},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Vhe},253:{f:efe},255:{f:Uhe},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:iH},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Pr},353:{f:ka},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:wfe},431:{f:Pr},432:{},433:{},434:{},437:{},438:{f:Ofe},439:{f:Pr},440:{f:Pfe},441:{},442:{f:Ag},443:{},444:{f:Wr},445:{},446:{},448:{f:ka},449:{f:Ghe,r:2},450:{f:ka},512:{f:_M},513:{f:zfe},515:{f:pfe},516:{f:rfe},517:{f:IM},519:{f:Yfe},520:{f:jhe},523:{},545:{f:kM},549:{f:TM},566:{},574:{f:Xhe},638:{f:lfe},659:{},1048:{},1054:{f:ife},1084:{},1212:{f:Sfe},2048:{f:Nfe},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Im},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ka},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Bfe,r:12},2173:{f:Hge,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Pr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:xfe,r:12},2197:{},2198:{f:Mge,r:12},2199:{},2200:{},2201:{},2202:{f:bfe,r:12},2203:{f:ka},2204:{},2205:{},2206:{},2207:{},2211:{f:zhe},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Wr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Ufe},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Lfe},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:_M},1:{},2:{f:Zfe},3:{f:qfe},4:{f:Xfe},5:{f:IM},7:{f:ede},8:{},9:{f:Im},11:{},22:{f:Wr},30:{f:ofe},31:{},32:{},33:{f:kM},36:{},37:{f:TM},50:{f:tde},62:{},52:{},67:{},68:{f:Wr},69:{},86:{},126:{},127:{f:Kfe},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:rde},223:{},234:{},354:{},421:{},518:{f:K1},521:{f:Im},536:{f:PM},547:{f:OM},561:{},579:{},1030:{f:K1},1033:{f:Im},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Fe(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&HE(r)&&t.push(r)}}function eCe(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return Fe(t,e,r,i);var s=e;if(!isNaN(s)){for(var o=r.parts||[],a=0,l=0,c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;var u=t.next(4);for(u.write_shift(2,s),u.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c;l<i;){for(u=t.next(4),u.write_shift(2,60),c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;u.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c}}}function Pg(t,e,r){return t||(t=ye(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function tCe(t,e,r,n){var i=ye(9);return Pg(i,t,e),sH(r,n||"b",i),i}function rCe(t,e,r){var n=ye(8+2*r.length);return Pg(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function nCe(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Jr(ar(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?Fe(t,2,Qfe(r,n,i)):Fe(t,3,Jfe(r,n,i));return;case"b":case"e":Fe(t,5,tCe(r,n,e.v,e.t));return;case"s":case"str":Fe(t,4,rCe(r,n,(e.v||"").slice(0,255)));return}Fe(t,1,Pg(null,r,n))}function iCe(t,e,r,n){var i=Array.isArray(e),s=Mt(e["!ref"]||"A1"),o,a="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=ct(s)}for(var c=s.s.r;c<=s.e.r;++c){a=Hr(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=yr(u)),o=l[u]+a;var h=i?(e[c]||[])[u]:e[o];h&&nCe(t,h,c,u)}}}function sCe(t,e){for(var r=e||{},n=li(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Fe(n,r.biff==4?1033:r.biff==3?521:9,GE(t,16,r)),iCe(n,t.Sheets[t.SheetNames[i]],i,r),Fe(n,10),n.end()}function oCe(t,e,r){Fe(t,49,Qhe({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function aCe(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Fe(t,1054,sfe(i,e[i],r))})}function lCe(t,e){var r=ye(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Fe(t,2151,r),r=ye(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),uH(Mt(e["!ref"]||"A1"),r),r.write_shift(4,4),Fe(t,2152,r)}function cCe(t,e){for(var r=0;r<16;++r)Fe(t,224,AM({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Fe(t,224,AM(n,0,e))})}function uCe(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Fe(t,440,kfe(n)),n[1].Tooltip&&Fe(t,2048,Ffe(n))}delete e["!links"]}function hCe(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&Fe(t,125,Vfe(uw(i,n),i))})}}function fCe(t,e,r,n,i){var s=16+pl(i.cellXfs,e,i);if(e.v==null&&!e.bf){Fe(t,513,Nc(r,n,s));return}if(e.bf)Fe(t,6,Lme(e,r,n,i,s));else switch(e.t){case"d":case"n":var o=e.t=="d"?Jr(ar(e.v)):e.v;Fe(t,515,vfe(r,n,o,s));break;case"b":case"e":Fe(t,517,mfe(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var a=eR(i.Strings,e.v,i.revStrings);Fe(t,253,tfe(r,n,a,s))}else Fe(t,516,nfe(r,n,(e.v||"").slice(0,255),s,i));break;default:Fe(t,513,Nc(r,n,s))}}function dCe(t,e,r){var n=li(),i=r.SheetNames[t],s=r.Sheets[i]||{},o=(r||{}).Workbook||{},a=(o.Sheets||[])[t]||{},l=Array.isArray(s),c=e.biff==8,u,h="",f=[],d=Mt(s["!ref"]||"A1"),g=c?65536:16384;if(d.e.c>255||d.e.r>=g){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,g-1)}Fe(n,2057,GE(r,16,e)),Fe(n,13,zi(1)),Fe(n,12,zi(100)),Fe(n,15,$n(!0)),Fe(n,17,$n(!1)),Fe(n,16,Pc(.001)),Fe(n,95,$n(!0)),Fe(n,42,$n(!1)),Fe(n,43,$n(!1)),Fe(n,130,zi(1)),Fe(n,128,gfe()),Fe(n,131,$n(!1)),Fe(n,132,$n(!1)),c&&hCe(n,s["!cols"]),Fe(n,512,afe(d,e)),c&&(s["!links"]=[]);for(var m=d.s.r;m<=d.e.r;++m){h=Hr(m);for(var p=d.s.c;p<=d.e.c;++p){m===d.s.r&&(f[p]=yr(p)),u=f[p]+h;var y=l?(s[m]||[])[p]:s[u];y&&(fCe(n,y,m,p,e),c&&y.l&&s["!links"].push([u,y.l]))}}var S=a.CodeName||a.name||i;return c&&Fe(n,574,qhe((o.Views||[])[0])),c&&(s["!merges"]||[]).length&&Fe(n,229,_fe(s["!merges"])),c&&uCe(n,s),Fe(n,442,oH(S)),c&&lCe(n,s),Fe(n,10),n.end()}function gCe(t,e,r){var n=li(),i=(t||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},a=r.biff==8,l=r.biff==5;if(Fe(n,2057,GE(t,5,r)),r.bookType=="xla"&&Fe(n,135),Fe(n,225,a?zi(1200):null),Fe(n,193,mhe(2)),l&&Fe(n,191),l&&Fe(n,192),Fe(n,226),Fe(n,92,Dhe("SheetJS",r)),Fe(n,66,zi(a?1200:1252)),a&&Fe(n,353,zi(0)),a&&Fe(n,448),Fe(n,317,jfe(t.SheetNames.length)),a&&t.vbaraw&&Fe(n,211),a&&t.vbaraw){var c=o.CodeName||"ThisWorkbook";Fe(n,442,oH(c))}Fe(n,156,zi(17)),Fe(n,25,$n(!1)),Fe(n,18,$n(!1)),Fe(n,19,zi(0)),a&&Fe(n,431,$n(!1)),a&&Fe(n,444,zi(0)),Fe(n,61,Khe()),Fe(n,64,$n(!1)),Fe(n,141,zi(0)),Fe(n,34,$n(Gve(t)=="true")),Fe(n,14,$n(!0)),a&&Fe(n,439,$n(!1)),Fe(n,218,zi(0)),oCe(n,t,r),aCe(n,t.SSF,r),cCe(n,r),a&&Fe(n,352,$n(!1));var u=n.end(),h=li();a&&Fe(h,140,Dfe()),a&&r.Strings&&eCe(h,252,Whe(r.Strings)),Fe(h,10);var f=h.end(),d=li(),g=0,m=0;for(m=0;m<t.SheetNames.length;++m)g+=(a?12:11)+(a?2:1)*t.SheetNames[m].length;var p=u.length+g+f.length;for(m=0;m<t.SheetNames.length;++m){var y=s[m]||{};Fe(d,133,Bhe({pos:p,hs:y.Hidden||0,dt:0,name:t.SheetNames[m]},r)),p+=e[m].length}var S=d.end();if(g!=S.length)throw new Error("BS8 "+g+" != "+S.length);var C=[];return u.length&&C.push(u),S.length&&C.push(S),f.length&&C.push(f),on(C)}function mCe(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=lr(et)),t&&t.SSF&&(Ah(),nw(t.SSF),r.revssf=sw(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,sR(r),r.cellXfs=[],pl(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=dCe(i,r,t);return n.unshift(gCe(t,n,r)),on(n)}function QH(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=ci(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return mCe(t,e);case 4:case 3:case 2:return sCe(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function UM(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),o=i.index,a=s&&s.index||t.length,l=Qce(t.slice(o,a),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,f=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(o=0;o<l.length;++o){var m=l[o].trim(),p=m.slice(0,3).toLowerCase();if(p=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(p!="<td"&&p!="<th")){var y=m.split(/<\/t[dh]>/i);for(a=0;a<y.length;++a){var S=y[a].trim();if(S.match(/<t[dh]/i)){for(var C=S,A=0;C.charAt(0)=="<"&&(A=C.indexOf(">"))>-1;)C=C.slice(A+1);for(var I=0;I<g.length;++I){var O=g[I];O.s.c==u&&O.s.r<c&&c<=O.e.r&&(u=O.e.c+1,I=-1)}var _=rt(S.slice(0,S.indexOf(">")));f=_.colspan?+_.colspan:1,((h=+_.rowspan)>1||f>1)&&g.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+f-1}});var E=_.t||_["data-t"]||"";if(!C.length){u+=f;continue}if(C=bF(C),d.s.r>c&&(d.s.r=c),d.e.r<c&&(d.e.r=c),d.s.c>u&&(d.s.c=u),d.e.c<u&&(d.e.c=u),!C.length){u+=f;continue}var b={t:"s",v:C};r.raw||!C.trim().length||E=="s"||(C==="TRUE"?b={t:"b",v:!0}:C==="FALSE"?b={t:"b",v:!1}:isNaN(_s(C))?isNaN(mh(C).getDate())||(b={t:"d",v:ar(C)},r.cellDates||(b={t:"n",v:Jr(b.v)}),b.z=r.dateNF||et[14]):b={t:"n",v:_s(C)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=b):n[tt({r:c,c:u})]=b,u+=f}}}}return n["!ref"]=ct(d),g.length&&(n["!merges"]=g),n}function pCe(t,e,r,n){for(var i=t["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var a=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>o)&&!(i[c].e.r<r||i[c].e.c<o)){if(i[c].s.r<r||i[c].s.c<o){a=-1;break}a=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(a<0)){var u=tt({r,c:o}),h=n.dense?(t[r]||[])[o]:t[u],f=h&&h.v!=null&&(h.h||kE(h.w||(la(h),h.w)||""))||"",d={};a>1&&(d.rowspan=a),l>1&&(d.colspan=l),n.editable?f='<span contenteditable="true">'+f+"</span>":h&&(d["data-t"]=h&&h.t||"z",h.v!=null&&(d["data-v"]=h.v),h.z!=null&&(d["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),d.id=(n.id||"sjs")+"-"+u,s.push(Ne("td",f,d))}}var g="<tr>";return g+s.join("")+"</tr>"}var vCe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',wCe="</body></html>";function CCe(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ml(UM(r[0],e),e);var n=lR();return r.forEach(function(i,s){cR(n,UM(i,e),"Sheet"+(s+1))}),n}function yCe(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function eD(t,e){var r=e||{},n=r.header!=null?r.header:vCe,i=r.footer!=null?r.footer:wCe,s=[n],o=ci(t["!ref"]);r.dense=Array.isArray(t),s.push(yCe(t,o,r));for(var a=o.s.r;a<=o.e.r;++a)s.push(pCe(t,o,a,r));return s.push("</table>"+i),s.join("")}function tD(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?xr(n.origin):n.origin;i=o.r,s=o.c}var a=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,a.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var u=ci(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var h=[],f=0,d=t["!rows"]||(t["!rows"]=[]),g=0,m=0,p=0,y=0,S=0,C=0;for(t["!cols"]||(t["!cols"]=[]);g<a.length&&m<l;++g){var A=a[g];if(jM(A)){if(n.display)continue;d[m]={hidden:!0}}var I=A.children;for(p=y=0;p<I.length;++p){var O=I[p];if(!(n.display&&jM(O))){var _=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):bF(O.innerHTML),E=O.getAttribute("data-z")||O.getAttribute("z");for(f=0;f<h.length;++f){var b=h[f];b.s.c==y+s&&b.s.r<m+i&&m+i<=b.e.r&&(y=b.e.c+1-s,f=-1)}C=+O.getAttribute("colspan")||1,((S=+O.getAttribute("rowspan")||1)>1||C>1)&&h.push({s:{r:m+i,c:y+s},e:{r:m+i+(S||1)-1,c:y+s+(C||1)-1}});var k={t:"s",v:_},B=O.getAttribute("data-t")||O.getAttribute("t")||"";_!=null&&(_.length==0?k.t=B||"z":n.raw||_.trim().length==0||B=="s"||(_==="TRUE"?k={t:"b",v:!0}:_==="FALSE"?k={t:"b",v:!1}:isNaN(_s(_))?isNaN(mh(_).getDate())||(k={t:"d",v:ar(_)},n.cellDates||(k={t:"n",v:Jr(k.v)}),k.z=n.dateNF||et[14]):k={t:"n",v:_s(_)})),k.z===void 0&&E!=null&&(k.z=E);var N="",q=O.getElementsByTagName("A");if(q&&q.length)for(var ue=0;ue<q.length&&!(q[ue].hasAttribute("href")&&(N=q[ue].getAttribute("href"),N.charAt(0)!="#"));++ue);N&&N.charAt(0)!="#"&&(k.l={Target:N}),n.dense?(t[m+i]||(t[m+i]=[]),t[m+i][y+s]=k):t[tt({c:y+s,r:m+i})]=k,c.e.c<y+s&&(c.e.c=y+s),y+=C}}++m}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,m-1+i),t["!ref"]=ct(c),m>=l&&(t["!fullref"]=ct((c.e.r=a.length-g+m-1+i,c))),t}function rD(t,e){var r=e||{},n=r.dense?[]:{};return tD(n,t,e)}function xCe(t,e){return ml(rD(t,e),e)}function jM(t){var e="",r=SCe(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function SCe(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function bCe(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=It(e.replace(/<[^>]*>/g,""));return[r]}var zM={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function nD(t,e){var r=e||{},n=NE(t),i=[],s,o,a={name:""},l="",c=0,u,h,f={},d=[],g=r.dense?[]:{},m,p,y={value:""},S="",C=0,A=[],I=-1,O=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,b={},k=[],B={},N=0,q=0,ue=[],we=1,Se=1,ce=[],Re={Names:[]},Y={},Pe=["",""],w=[],v={},x="",R=0,T=!1,L=!1,K=0;for(zd.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=zd.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"å·¥ä½è¡¨":m[1]==="/"?(_.e.c>=_.s.c&&_.e.r>=_.s.r?g["!ref"]=ct(_):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=_.e.r&&(g["!fullref"]=g["!ref"],_.e.r=r.sheetRows-1,g["!ref"]=ct(_)),k.length&&(g["!merges"]=k),ue.length&&(g["!rows"]=ue),u.name=u.åç§°||u.name,typeof JSON<"u"&&JSON.stringify(u),d.push(u.name),f[u.name]=g,L=!1):m[0].charAt(m[0].length-2)!=="/"&&(u=rt(m[0],!1),I=O=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,g=r.dense?[]:{},k=[],ue=[],L=!0);break;case"table-row-group":m[1]==="/"?--E:++E;break;case"table-row":case"è¡":if(m[1]==="/"){I+=we,we=1;break}if(h=rt(m[0],!1),h.è¡å·?I=h.è¡å·-1:I==-1&&(I=0),we=+h["number-rows-repeated"]||1,we<10)for(K=0;K<we;++K)E>0&&(ue[I+K]={level:E});O=-1;break;case"covered-table-cell":m[1]!=="/"&&++O,r.sheetStubs&&(r.dense?(g[I]||(g[I]=[]),g[I][O]={t:"z"}):g[tt({r:I,c:O})]={t:"z"}),S="",A=[];break;case"table-cell":case"æ°æ®":if(m[0].charAt(m[0].length-2)==="/")++O,y=rt(m[0],!1),Se=parseInt(y["number-columns-repeated"]||"1",10),p={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(p.f=BM(It(y.formula))),(y.æ°æ®ç±»å||y["value-type"])=="string"&&(p.t="s",p.v=It(y["string-value"]||""),r.dense?(g[I]||(g[I]=[]),g[I][O]=p):g[tt({r:I,c:O})]=p),O+=Se-1;else if(m[1]!=="/"){++O,S="",C=0,A=[],Se=1;var Q=we?I+we-1:I;if(O>_.e.c&&(_.e.c=O),O<_.s.c&&(_.s.c=O),I<_.s.r&&(_.s.r=I),Q>_.e.r&&(_.e.r=Q),y=rt(m[0],!1),w=[],v={},p={t:y.æ°æ®ç±»å||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=It(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(N=parseInt(y["number-matrix-rows-spanned"],10)||0,q=parseInt(y["number-matrix-columns-spanned"],10)||0,B={s:{r:I,c:O},e:{r:I+N-1,c:O+q-1}},p.F=ct(B),ce.push([B,p.F])),y.formula)p.f=BM(y.formula);else for(K=0;K<ce.length;++K)I>=ce[K][0].s.r&&I<=ce[K][0].e.r&&O>=ce[K][0].s.c&&O<=ce[K][0].e.c&&(p.F=ce[K][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(N=parseInt(y["number-rows-spanned"],10)||0,q=parseInt(y["number-columns-spanned"],10)||0,B={s:{r:I,c:O},e:{r:I+N-1,c:O+q-1}},k.push(B)),y["number-columns-repeated"]&&(Se=parseInt(y["number-columns-repeated"],10)),p.t){case"boolean":p.t="b",p.v=or(y["boolean-value"]);break;case"float":p.t="n",p.v=parseFloat(y.value);break;case"percentage":p.t="n",p.v=parseFloat(y.value);break;case"currency":p.t="n",p.v=parseFloat(y.value);break;case"date":p.t="d",p.v=ar(y["date-value"]),r.cellDates||(p.t="n",p.v=Jr(p.v)),p.z="m/d/yy";break;case"time":p.t="n",p.v=qce(y["time-value"])/86400,r.cellDates&&(p.t="d",p.v=ow(p.v)),p.z="HH:MM:SS";break;case"number":p.t="n",p.v=parseFloat(y.æ°æ®æ°å¼);break;default:if(p.t==="string"||p.t==="text"||!p.t)p.t="s",y["string-value"]!=null&&(S=It(y["string-value"]),A=[]);else throw new Error("Unsupported value type "+p.t)}}else{if(T=!1,p.t==="s"&&(p.v=S||"",A.length&&(p.R=A),T=C==0),Y.Target&&(p.l=Y),w.length>0&&(p.c=w,w=[]),S&&r.cellText!==!1&&(p.w=S),T&&(p.t="z",delete p.v),(!T||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=I))for(var Z=0;Z<we;++Z){if(Se=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(g[I+Z]||(g[I+Z]=[]),g[I+Z][O]=Z==0?p:lr(p);--Se>0;)g[I+Z][O+Se]=lr(p);else for(g[tt({r:I+Z,c:O})]=p;--Se>0;)g[tt({r:I+Z,c:O+Se})]=lr(p);_.e.c<=O&&(_.e.c=O)}Se=parseInt(y["number-columns-repeated"]||"1",10),O+=Se-1,Se=0,p={},S="",A=[]}Y={};break;case"document":case"document-content":case"çµå­è¡¨æ ¼ææ¡£":case"spreadsheet":case"ä¸»ä½":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s;v.t=S,A.length&&(v.R=A),v.a=x,w.push(v)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);x="",R=0,S="",C=0,A=[];break;case"creator":m[1]==="/"?x=n.slice(R,m.index):R=m.index+m[0].length;break;case"meta":case"åæ°æ®":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);S="",C=0,A=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(b[a.name]=l,(s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",a=rt(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=rt(m[0],!1),l+=zM[m[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=rt(m[0],!1),l+=zM[m[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":o=rt(m[0],!1),Pe=X1(o["cell-range-address"]);var ie={Name:o.name,Ref:Pe[0]+"!"+Pe[1]};L&&(ie.Sheet=d.length),Re.Names.push(ie);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"çµå­è¡¨æ ¼":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"ææ¬ä¸²":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!y||!y["string-value"])){var fe=bCe(n.slice(C,m.index));S=(S.length>0?S+`
`:"")+fe[0]}else rt(m[0],!1),C=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{Pe=X1(rt(m[0])["target-range-address"]),f[Pe[0]]["!autofilter"]={ref:Pe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"æ é¢":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(Y=rt(m[0],!1),!Y.href)break;Y.Target=It(Y.href),delete Y.href,Y.Target.charAt(0)=="#"&&Y.Target.indexOf(".")>-1?(Pe=X1(Y.Target.slice(1)),Y.Target="#"+Pe[0]+"!"+Pe[1]):Y.Target.match(/^\.\.[\\\/]/)&&(Y.Target=Y.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"è¡¨:":case"å­:":break;default:if(r.WTF)throw new Error(m)}}var H={Sheets:f,SheetNames:d,Workbook:Re};return r.bookSheets&&delete H.Sheets,H}function GM(t,e){e=e||{},Vi(t,"META-INF/manifest.xml")&&que(Vr(t,"META-INF/manifest.xml"),e);var r=Ti(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=nD(Kt(r),e);return Vi(t,"meta.xml")&&(n.Props=YF(Vr(t,"meta.xml"))),n}function YM(t,e){return nD(t,e)}var ECe=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+jd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Lr+e}}(),KM=function(){var t=function(s){return Ut(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,a){var l=[];l.push('      <table:table table:name="'+Ut(o.SheetNames[a])+`" table:style-name="ta1">
`);var c=0,u=0,h=ci(s["!ref"]||"A1"),f=s["!merges"]||[],d=0,g=Array.isArray(s);if(s["!cols"])for(u=0;u<=h.e.c;++u)l.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var m="",p=s["!rows"]||[];for(c=0;c<h.s.r;++c)m=p[c]?' table:style-name="ro'+p[c].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=h.e.r;++c){for(m=p[c]?' table:style-name="ro'+p[c].ods+'"':"",l.push("        <table:table-row"+m+`>
`),u=0;u<h.s.c;++u)l.push(e);for(;u<=h.e.c;++u){var y=!1,S={},C="";for(d=0;d!=f.length;++d)if(!(f[d].s.c>u)&&!(f[d].s.r>c)&&!(f[d].e.c<u)&&!(f[d].e.r<c)){(f[d].s.c!=u||f[d].s.r!=c)&&(y=!0),S["table:number-columns-spanned"]=f[d].e.c-f[d].s.c+1,S["table:number-rows-spanned"]=f[d].e.r-f[d].s.r+1;break}if(y){l.push(r);continue}var A=tt({r:c,c:u}),I=g?(s[c]||[])[u]:s[A];if(I&&I.f&&(S["table:formula"]=Ut(jme(I.f)),I.F&&I.F.slice(0,A.length)==A)){var O=ci(I.F);S["table:number-matrix-columns-spanned"]=O.e.c-O.s.c+1,S["table:number-matrix-rows-spanned"]=O.e.r-O.s.r+1}if(!I){l.push(e);continue}switch(I.t){case"b":C=I.v?"TRUE":"FALSE",S["office:value-type"]="boolean",S["office:boolean-value"]=I.v?"true":"false";break;case"n":C=I.w||String(I.v||0),S["office:value-type"]="float",S["office:value"]=I.v||0;break;case"s":case"str":C=I.v==null?"":I.v,S["office:value-type"]="string";break;case"d":C=I.w||ar(I.v).toISOString(),S["office:value-type"]="date",S["office:date-value"]=ar(I.v).toISOString(),S["table:style-name"]="ce1";break;default:l.push(e);continue}var _=t(C);if(I.l&&I.l.Target){var E=I.l.Target;E=E.charAt(0)=="#"?"#"+zme(E.slice(1)):E,E.charAt(0)!="#"&&!E.match(/^\w+:/)&&(E="../"+E),_=Ne("text:a",_,{"xlink:href":E.replace(/&/g,"&amp;")})}l.push("          "+Ne("table:table-cell",Ne("text:p",_,{}),S)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var a=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var h=c["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;ol(h),h.ods=a;var f=c["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),s.push(`  </style:style>
`),++a}}});var l=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var h=c["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,a){var l=[Lr],c=jd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=jd({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(GF().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)l.push(n(o.Sheets[o.SheetNames[h]],o,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function iD(t,e){if(e.bookType=="fods")return KM(t,e);var r=ME(),n="",i=[],s=[];return n="mimetype",ht(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ht(r,n,KM(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",ht(r,n,ECe(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",ht(r,n,Lr+GF()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",ht(r,n,Que(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ht(r,n,Jue(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Fc(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function vx(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Kt(gl(t))}function RCe(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Ri(po(t))}function TCe(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function ll(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function XM(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function _Ce(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function ACe(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function Zd(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Bt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Ar(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Ot(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=Zd(t,r),s=i&7;i=Math.floor(i/8);var o=0,a;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);a=t.slice(l,r[0])}break;case 5:o=4,a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Zd(t,r),a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:a,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function hn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(Bt(n*8+i.type)),i.type==2&&e.push(Bt(i.data.length)),e.push(i.data))})}),ll(e)}function nR(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function Li(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=Zd(t,n),s=Ot(t.slice(n[0],n[0]+i));n[0]+=i;var o={id:Ar(s[1][0].data),messages:[]};s[2].forEach(function(a){var l=Ot(a.data),c=Ar(l[3][0].data);o.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=s[3])!=null&&e[0]&&(o.merge=Ar(s[3][0].data)>>>0>0),r.push(o)}return r}function Hu(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Bt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Bt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:Bt(o.data.length)}],n[2].push({data:hn(o.meta),type:2})});var s=hn(n);e.push(Bt(s.length)),e.push(s),i.forEach(function(o){return e.push(o)})}),ll(e)}function ICe(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Zd(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var a=o-59;o=e[r[0]],a>1&&(o|=e[r[0]+1]<<8),a>2&&(o|=e[r[0]+2]<<16),a>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=a}i.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var l=0,c=0;if(s==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[ll(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=ll(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function $i(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(ICe(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return ll(e)}function Du(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=Bt(n),o=s.length;e.push(s),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=n}return ll(e)}function MCe(t,e,r,n){var i=Fc(t),s=i.getUint32(4,!0),o=(n>1?12:8)+XM(s&(n>1?3470:398))*4,a=-1,l=-1,c=NaN,u=new Date(2001,0,1);s&512&&(a=i.getUint32(o,!0),o+=4),o+=XM(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(o,!0),o+=4),s&32&&(c=i.getFloat64(o,!0),o+=8),s&64&&(u.setTime(u.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function OCe(t,e,r){var n=Fc(t),i=n.getUint32(8,!0),s=12,o=-1,a=-1,l=NaN,c=NaN,u=new Date(2001,0,1);i&1&&(l=_Ce(t,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(a=n.getUint32(s,!0),s+=4),i&16&&(o=n.getUint32(s,!0),s+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[a]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return h}function J1(t,e){var r=new Uint8Array(32),n=Fc(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,ACe(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Z1(t,e){var r=new Uint8Array(32),n=Fc(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function PCe(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return MCe(t,e,r,t[0]);case 5:return OCe(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function En(t){var e=Ot(t);return Zd(e[1][0].data)}function qM(t,e){var r=Ot(e.data),n=Ar(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(o){var a=Ot(o.data),l=Ar(a[1][0].data)>>>0;switch(n){case 1:s[l]=vx(a[3][0].data);break;case 8:{var c=t[En(a[9][0].data)][0],u=Ot(c.data),h=t[En(u[1][0].data)][0],f=Ar(h.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var d=Ot(h.data);s[l]=d[3].map(function(g){return vx(g.data)}).join("")}break}}),s}function kCe(t,e){var r,n,i,s,o,a,l,c,u,h,f,d,g,m,p=Ot(t),y=Ar(p[1][0].data)>>>0,S=Ar(p[2][0].data)>>>0,C=((n=(r=p[8])==null?void 0:r[0])==null?void 0:n.data)&&Ar(p[8][0].data)>0||!1,A,I;if((s=(i=p[7])==null?void 0:i[0])!=null&&s.data&&e!=0)A=(a=(o=p[7])==null?void 0:o[0])==null?void 0:a.data,I=(c=(l=p[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(u=p[4])==null?void 0:u[0])!=null&&h.data&&e!=1)A=(d=(f=p[4])==null?void 0:f[0])==null?void 0:d.data,I=(m=(g=p[3])==null?void 0:g[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var O=C?4:1,_=Fc(A),E=[],b=0;b<A.length/2;++b){var k=_.getUint16(b*2,!0);k<65535&&E.push([b,k])}if(E.length!=S)throw"Expected ".concat(S," cells, found ").concat(E.length);var B=[];for(b=0;b<E.length-1;++b)B[E[b][0]]=I.subarray(E[b][1]*O,E[b+1][1]*O);return E.length>=1&&(B[E[E.length-1][0]]=I.subarray(E[E.length-1][1]*O)),{R:y,cells:B}}function NCe(t,e){var r,n=Ot(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Ar(n[7][0].data)>>>0>0?1:0:-1,s=nR(n[5],function(o){return kCe(o,i)});return{nrows:Ar(n[4][0].data)>>>0,data:s.reduce(function(o,a){return o[a.R]||(o[a.R]=[]),a.cells.forEach(function(l,c){if(o[a.R][c])throw new Error("Duplicate cell r=".concat(a.R," c=").concat(c));o[a.R][c]=l}),o},[])}}function FCe(t,e,r){var n,i=Ot(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ar(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Ar(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=ct(s);var o=Ot(i[4][0].data),a=qM(t,t[En(o[4][0].data)][0]),l=(n=o[17])!=null&&n[0]?qM(t,t[En(o[17][0].data)][0]):[],c=Ot(o[3][0].data),u=0;c[1].forEach(function(h){var f=Ot(h.data),d=t[En(f[2][0].data)][0],g=Ar(d.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var m=NCe(t,d);m.data.forEach(function(p,y){p.forEach(function(S,C){var A=tt({r:u+y,c:C}),I=PCe(S,a,l);I&&(r[A]=I)})}),u+=m.nrows})}function HCe(t,e){var r=Ot(e.data),n={"!ref":"A1"},i=t[En(r[2][0].data)],s=Ar(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return FCe(t,i[0],n),n}function DCe(t,e){var r,n=Ot(e.data),i={name:(r=n[1])!=null&&r[0]?vx(n[1][0].data):"",sheets:[]},s=nR(n[2],En);return s.forEach(function(o){t[o].forEach(function(a){var l=Ar(a.meta[1][0].data);l==6e3&&i.sheets.push(HCe(t,a))})}),i}function LCe(t,e){var r=lR(),n=Ot(e.data),i=nR(n[1],En);if(i.forEach(function(s){t[s].forEach(function(o){var a=Ar(o.meta[1][0].data);if(a==2){var l=DCe(t,o);l.sheets.forEach(function(c,u){cR(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Q1(t){var e,r,n,i,s={},o=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=$i(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var u;try{u=Li(c)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){s[h.id]=h.messages,o.push(h.id)})}}),!o.length)throw new Error("File has no messages");var a=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Ar(s[1][0].meta[1][0].data)==1&&s[1][0];if(a||o.forEach(function(l){s[l].forEach(function(c){var u=Ar(c.meta[1][0].data)>>>0;if(u==1)if(!a)a=c;else throw new Error("Document has multiple roots")})}),!a)throw new Error("Cannot find Document root");return LCe(s,a)}function $Ce(t,e,r){var n,i,s,o;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var a=((o=(s=t[8])==null?void 0:s[0])==null?void 0:o.data)&&Ar(t[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var l=0,c=Fc(t[7][0].data),u=0,h=[],f=Fc(t[4][0].data),d=0,g=[],m=0;m<e.length;++m){if(e[m]==null){c.setUint16(m*2,65535,!0),f.setUint16(m*2,65535);continue}c.setUint16(m*2,u,!0),f.setUint16(m*2,d,!0);var p,y;switch(typeof e[m]){case"string":p=J1({t:"s",v:e[m]},r),y=Z1({t:"s",v:e[m]},r);break;case"number":p=J1({t:"n",v:e[m]},r),y=Z1({t:"n",v:e[m]},r);break;case"boolean":p=J1({t:"b",v:e[m]},r),y=Z1({t:"b",v:e[m]},r);break;default:throw new Error("Unsupported value "+e[m])}h.push(p),u+=p.length,g.push(y),d+=y.length,++l}for(t[2][0].data=Bt(l);m<t[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),f.setUint16(m*2,65535,!0);return t[6][0].data=ll(h),t[3][0].data=ll(g),l}function BCe(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ci(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(ct(n)));var s=dv(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(x){return x.forEach(function(R){typeof R=="string"&&o.push(R)})});var a={},l=[],c=qe.read(e.numbers,{type:"base64"});c.FileIndex.map(function(x,R){return[x,c.FullPaths[R]]}).forEach(function(x){var R=x[0],T=x[1];if(R.type==2&&R.name.match(/\.iwa/)){var L=R.content,K=$i(L),Q=Li(K);Q.forEach(function(Z){l.push(Z.id),a[Z.id]={deps:[],location:T,type:Ar(Z.messages[0].meta[1][0].data)}})}}),l.sort(function(x,R){return x-R});var u=l.filter(function(x){return x>1}).map(function(x){return[x,Bt(x)]});c.FileIndex.map(function(x,R){return[x,c.FullPaths[R]]}).forEach(function(x){var R=x[0];if(x[1],!!R.name.match(/\.iwa/)){var T=Li($i(R.content));T.forEach(function(L){L.messages.forEach(function(K){u.forEach(function(Q){L.messages.some(function(Z){return Ar(Z.meta[1][0].data)!=11006&&TCe(Z.data,Q[1])})&&a[Q[0]].deps.push(L.id)})})})}});for(var h=qe.find(c,a[1].location),f=Li($i(h.content)),d,g=0;g<f.length;++g){var m=f[g];m.id==1&&(d=m)}var p=En(Ot(d.messages[0].data)[1][0].data);for(h=qe.find(c,a[p].location),f=Li($i(h.content)),g=0;g<f.length;++g)m=f[g],m.id==p&&(d=m);for(p=En(Ot(d.messages[0].data)[2][0].data),h=qe.find(c,a[p].location),f=Li($i(h.content)),g=0;g<f.length;++g)m=f[g],m.id==p&&(d=m);for(p=En(Ot(d.messages[0].data)[2][0].data),h=qe.find(c,a[p].location),f=Li($i(h.content)),g=0;g<f.length;++g)m=f[g],m.id==p&&(d=m);var y=Ot(d.messages[0].data);{y[6][0].data=Bt(n.e.r+1),y[7][0].data=Bt(n.e.c+1);var S=En(y[46][0].data),C=qe.find(c,a[S].location),A=Li($i(C.content));{for(var I=0;I<A.length&&A[I].id!=S;++I);if(A[I].id!=S)throw"Bad ColumnRowUIDMapArchive";var O=Ot(A[I].messages[0].data);O[1]=[],O[2]=[],O[3]=[];for(var _=0;_<=n.e.c;++_){var E=[];E[1]=E[2]=[{type:0,data:Bt(_+420690)}],O[1].push({type:2,data:hn(E)}),O[2].push({type:0,data:Bt(_)}),O[3].push({type:0,data:Bt(_)})}O[4]=[],O[5]=[],O[6]=[];for(var b=0;b<=n.e.r;++b)E=[],E[1]=E[2]=[{type:0,data:Bt(b+726270)}],O[4].push({type:2,data:hn(E)}),O[5].push({type:0,data:Bt(b)}),O[6].push({type:0,data:Bt(b)});A[I].messages[0].data=hn(O)}C.content=Du(Hu(A)),C.size=C.content.length,delete y[46];var k=Ot(y[4][0].data);{k[7][0].data=Bt(n.e.r+1);var B=Ot(k[1][0].data),N=En(B[2][0].data);C=qe.find(c,a[N].location),A=Li($i(C.content));{if(A[0].id!=N)throw"Bad HeaderStorageBucket";var q=Ot(A[0].messages[0].data);for(b=0;b<s.length;++b){var ue=Ot(q[2][0].data);ue[1][0].data=Bt(b),ue[4][0].data=Bt(s[b].length),q[2][b]={type:q[2][0].type,data:hn(ue)}}A[0].messages[0].data=hn(q)}C.content=Du(Hu(A)),C.size=C.content.length;var we=En(k[2][0].data);C=qe.find(c,a[we].location),A=Li($i(C.content));{if(A[0].id!=we)throw"Bad HeaderStorageBucket";for(q=Ot(A[0].messages[0].data),_=0;_<=n.e.c;++_)ue=Ot(q[2][0].data),ue[1][0].data=Bt(_),ue[4][0].data=Bt(n.e.r+1),q[2][_]={type:q[2][0].type,data:hn(ue)};A[0].messages[0].data=hn(q)}C.content=Du(Hu(A)),C.size=C.content.length;var Se=En(k[4][0].data);(function(){for(var x=qe.find(c,a[Se].location),R=Li($i(x.content)),T,L=0;L<R.length;++L){var K=R[L];K.id==Se&&(T=K)}var Q=Ot(T.messages[0].data);{Q[3]=[];var Z=[];o.forEach(function(H,Me){Z[1]=[{type:0,data:Bt(Me)}],Z[2]=[{type:0,data:Bt(1)}],Z[3]=[{type:2,data:RCe(H)}],Q[3].push({type:2,data:hn(Z)})})}T.messages[0].data=hn(Q);var ie=Hu(R),fe=Du(ie);x.content=fe,x.size=x.content.length})();var ce=Ot(k[3][0].data);{var Re=ce[1][0];delete ce[2];var Y=Ot(Re.data);{var Pe=En(Y[2][0].data);(function(){for(var x=qe.find(c,a[Pe].location),R=Li($i(x.content)),T,L=0;L<R.length;++L){var K=R[L];K.id==Pe&&(T=K)}var Q=Ot(T.messages[0].data);{delete Q[6],delete ce[7];var Z=new Uint8Array(Q[5][0].data);Q[5]=[];for(var ie=0,fe=0;fe<=n.e.r;++fe){var H=Ot(Z);ie+=$Ce(H,s[fe],o),H[1][0].data=Bt(fe),Q[5].push({data:hn(H),type:2})}Q[1]=[{type:0,data:Bt(n.e.c+1)}],Q[2]=[{type:0,data:Bt(n.e.r+1)}],Q[3]=[{type:0,data:Bt(ie)}],Q[4]=[{type:0,data:Bt(n.e.r+1)}]}T.messages[0].data=hn(Q);var Me=Hu(R),ae=Du(Me);x.content=ae,x.size=x.content.length})()}Re.data=hn(Y)}k[3][0].data=hn(ce)}y[4][0].data=hn(k)}d.messages[0].data=hn(y);var w=Hu(f),v=Du(w);return h.content=v,h.size=h.content.length,c}function sD(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function iR(t){sD([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function sR(t){sD([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function VCe(t){return St.WS.indexOf(t)>-1?"sheet":t==St.CS?"chart":t==St.DS?"dialog":t==St.MS?"macro":t&&t.length?t:"sheet"}function WCe(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,VCe(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function UCe(t,e,r,n,i,s,o,a,l,c,u,h){try{s[n]=vd(Ti(t,r,!0),e);var f=Vr(t,e),d;switch(a){case"sheet":d=hwe(f,e,i,l,s[n],c,u,h);break;case"chart":if(d=fwe(f,e,i,l,s[n],c,u,h),!d||!d["!drawel"])break;var g=jf(d["!drawel"].Target,e),m=Gd(g),p=Zge(Ti(t,g,!0),vd(Ti(t,m,!0),g)),y=jf(p,g),S=Gd(y);d=$ve(Ti(t,y,!0),y,l,vd(Ti(t,S,!0),y),c,d);break;case"macro":d=dwe(f,e,i,l,s[n],c,u,h);break;case"dialog":d=gwe(f,e,i,l,s[n],c,u,h);break;default:throw new Error("Unrecognized sheet type "+a)}o[n]=d;var C=[];s&&s[n]&&Ir(s[n]).forEach(function(A){var I="";if(s[n][A].Type==St.CMNT){I=jf(s[n][A].Target,e);var O=wwe(Vr(t,I,!0),I,l);if(!O||!O.length)return;FM(d,O,!1)}s[n][A].Type==St.TCMNT&&(I=jf(s[n][A].Target,e),C=C.concat(e0e(Vr(t,I,!0),l)))}),C&&C.length&&FM(d,C,!0,l.people||[])}catch(A){if(l.WTF)throw A}}function Fi(t){return t.charAt(0)=="/"?t.slice(1):t}function jCe(t,e){if(Ah(),e=e||{},iR(e),Vi(t,"META-INF/manifest.xml")||Vi(t,"objectdata.xml"))return GM(t,e);if(Vi(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Q1<"u"){if(t.FileIndex)return Q1(t);var r=qe.utils.cfb_new();return rM(t).forEach(function(ue){ht(r,ue,tue(t,ue))}),Q1(r)}throw new Error("Unsupported NUMBERS file")}if(!Vi(t,"[Content_Types].xml"))throw Vi(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Vi(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=rM(t),i=Kue(Ti(t,"[Content_Types].xml")),s=!1,o,a;if(i.workbooks.length===0&&(a="xl/workbook.xml",Vr(t,a,!0)&&i.workbooks.push(a)),i.workbooks.length===0){if(a="xl/workbook.bin",!Vr(t,a,!0))throw new Error("Could not find workbook");i.workbooks.push(a),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(wd=[],i.sst)try{wd=vwe(Vr(t,Fi(i.sst)),i.sst,e)}catch(ue){if(e.WTF)throw ue}e.cellStyles&&i.themes.length&&(l=pwe(Ti(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(c=mwe(Vr(t,Fi(i.style)),i.style,l,e))}i.links.map(function(ue){try{var we=vd(Ti(t,Gd(Fi(ue))),ue);return ywe(Vr(t,Fi(ue)),we,ue,e)}catch{}});var u=uwe(Vr(t,Fi(i.workbooks[0])),i.workbooks[0],e),h={},f="";i.coreprops.length&&(f=Vr(t,Fi(i.coreprops[0]),!0),f&&(h=YF(f)),i.extprops.length!==0&&(f=Vr(t,Fi(i.extprops[0]),!0),f&&the(f,h,e)));var d={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(f=Ti(t,Fi(i.custprops[0]),!0),f&&(d=nhe(f,e)));var g={};if((e.bookSheets||e.bookProps)&&(u.Sheets?o=u.Sheets.map(function(we){return we.name}):h.Worksheets&&h.SheetNames.length>0&&(o=h.SheetNames),e.bookProps&&(g.Props=h,g.Custprops=d),e.bookSheets&&typeof o<"u"&&(g.SheetNames=o),e.bookSheets?g.SheetNames:e.bookProps))return g;o={};var m={};e.bookDeps&&i.calcchain&&(m=Cwe(Vr(t,Fi(i.calcchain)),i.calcchain));var p=0,y={},S,C;{var A=u.Sheets;h.Worksheets=A.length,h.SheetNames=[];for(var I=0;I!=A.length;++I)h.SheetNames[I]=A[I].name}var O=s?"bin":"xml",_=i.workbooks[0].lastIndexOf("/"),E=(i.workbooks[0].slice(0,_+1)+"_rels/"+i.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");Vi(t,E)||(E="xl/_rels/workbook."+O+".rels");var b=vd(Ti(t,E,!0),E.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=xwe(Vr(t,Fi(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=r0e(Vr(t,Fi(i.people[0])),e)),b&&(b=WCe(b,u.Sheets));var k=Vr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(p=0;p!=h.Worksheets;++p){var B="sheet";if(b&&b[p]?(S="xl/"+b[p][1].replace(/[\/]?xl\//,""),Vi(t,S)||(S=b[p][1]),Vi(t,S)||(S=E.replace(/_rels\/.*$/,"")+b[p][1]),B=b[p][2]):(S="xl/worksheets/sheet"+(p+1-k)+"."+O,S=S.replace(/sheet0\./,"sheet.")),C=S.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(p!=e.sheets)continue e;break;case"string":if(h.SheetNames[p].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var N=!1,q=0;q!=e.sheets.length;++q)typeof e.sheets[q]=="number"&&e.sheets[q]==p&&(N=1),typeof e.sheets[q]=="string"&&e.sheets[q].toLowerCase()==h.SheetNames[p].toLowerCase()&&(N=1);if(!N)continue e}}UCe(t,S,C,h.SheetNames[p],p,y,o,B,e,u,l,c)}return g={Directory:i,Workbook:u,Props:h,Custprops:d,Deps:m,Sheets:o,SheetNames:h.SheetNames,Strings:wd,Styles:c,Themes:l,SSF:lr(et)},e&&e.bookFiles&&(t.files?(g.keys=n,g.files=t.files):(g.keys=[],g.files={},t.FullPaths.forEach(function(ue,we){ue=ue.replace(/^Root Entry[\/]/,""),g.keys.push(ue),g.files[ue]=t.FileIndex[we]}))),e&&e.bookVBA&&(i.vba.length>0?g.vbaraw=Vr(t,Fi(i.vba[0]),!0):i.defaults&&i.defaults.bin===u0e&&(g.vbaraw=Vr(t,"xl/vbaProject.bin",!0))),g}function zCe(t,e){var r=e||{},n="Workbook",i=qe.find(t,n);try{if(n="/!DataSpaces/Version",i=qe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(xde(i.content),n="/!DataSpaces/DataSpaceMap",i=qe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=bde(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=qe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Ede(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=qe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);Tde(i.content)}catch{}if(n="/EncryptionInfo",i=qe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=_de(i.content);if(n="/EncryptedPackage",i=qe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(a[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(a[1],i.content,r.password||"",r);if(a[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(a[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function GCe(t,e){return e.bookType=="ods"?iD(t,e):e.bookType=="numbers"?BCe(t,e):e.bookType=="xlsb"?YCe(t,e):KCe(t,e)}function YCe(t,e){qu=1024,t&&!t.SSF&&(t.SSF=lr(et)),t&&t.SSF&&(Ah(),nw(t.SSF),e.revssf=sw(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Cd?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=PH.indexOf(e.bookType)>-1,i=jE();sR(e=e||{});var s=ME(),o="",a=0;if(e.cellXfs=[],pl(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",ht(s,o,KF(t.Props,e)),i.coreprops.push(o),Wt(e.rels,2,o,St.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,ht(s,o,JF(t.Props)),i.extprops.push(o),Wt(e.rels,3,o,St.EXT_PROPS),t.Custprops!==t.Props&&Ir(t.Custprops||{}).length>0&&(o="docProps/custom.xml",ht(s,o,ZF(t.Custprops)),i.custprops.push(o),Wt(e.rels,4,o,St.CUST_PROPS)),a=1;a<=t.SheetNames.length;++a){var u={"!id":{}},h=t.Sheets[t.SheetNames[a-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+a+"."+r,ht(s,o,bwe(a-1,o,e,t,u)),i.sheets.push(o),Wt(e.wbrels,-1,"worksheets/sheet"+a+"."+r,St.WS[0])}if(h){var d=h["!comments"],g=!1,m="";d&&d.length>0&&(m="xl/comments"+a+"."+r,ht(s,m,Twe(d,m)),i.comments.push(m),Wt(u,-1,"../comments"+a+"."+r,St.CMNT),g=!0),h["!legacy"]&&g&&ht(s,"xl/drawings/vmlDrawing"+a+".vml",MH(a,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&ht(s,Gd(o),nh(u))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,ht(s,o,Rwe(e.Strings,o,e)),i.strs.push(o),Wt(e.wbrels,-1,"sharedStrings."+r,St.SST)),o="xl/workbook."+r,ht(s,o,Swe(t,o)),i.workbooks.push(o),Wt(e.rels,1,o,St.WB),o="xl/theme/theme1.xml",ht(s,o,qE(t.Themes,e)),i.themes.push(o),Wt(e.wbrels,-1,"theme/theme1.xml",St.THEME),o="xl/styles."+r,ht(s,o,Ewe(t,o,e)),i.styles.push(o),Wt(e.wbrels,-1,"styles."+r,St.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",ht(s,o,t.vbaraw),i.vba.push(o),Wt(e.wbrels,-1,"vbaProject.bin",St.VBA)),o="xl/metadata."+r,ht(s,o,_we(o)),i.metadata.push(o),Wt(e.wbrels,-1,"metadata."+r,St.XLMETA),ht(s,"[Content_Types].xml",zF(i,e)),ht(s,"_rels/.rels",nh(e.rels)),ht(s,"xl/_rels/workbook."+r+".rels",nh(e.wbrels)),delete e.revssf,delete e.ssf,s}function KCe(t,e){qu=1024,t&&!t.SSF&&(t.SSF=lr(et)),t&&t.SSF&&(Ah(),nw(t.SSF),e.revssf=sw(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Cd?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=PH.indexOf(e.bookType)>-1,i=jE();sR(e=e||{});var s=ME(),o="",a=0;if(e.cellXfs=[],pl(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",ht(s,o,KF(t.Props,e)),i.coreprops.push(o),Wt(e.rels,2,o,St.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,ht(s,o,JF(t.Props)),i.extprops.push(o),Wt(e.rels,3,o,St.EXT_PROPS),t.Custprops!==t.Props&&Ir(t.Custprops||{}).length>0&&(o="docProps/custom.xml",ht(s,o,ZF(t.Custprops)),i.custprops.push(o),Wt(e.rels,4,o,St.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,a=1;a<=t.SheetNames.length;++a){var h={"!id":{}},f=t.Sheets[t.SheetNames[a-1]],d=(f||{})["!type"]||"sheet";switch(d){case"chart":default:o="xl/worksheets/sheet"+a+"."+r,ht(s,o,UH(a-1,e,t,h)),i.sheets.push(o),Wt(e.wbrels,-1,"worksheets/sheet"+a+"."+r,St.WS[0])}if(f){var g=f["!comments"],m=!1,p="";if(g&&g.length>0){var y=!1;g.forEach(function(S){S[1].forEach(function(C){C.T==!0&&(y=!0)})}),y&&(p="xl/threadedComments/threadedComment"+a+"."+r,ht(s,p,t0e(g,u,e)),i.threadedcomments.push(p),Wt(h,-1,"../threadedComments/threadedComment"+a+"."+r,St.TCMNT)),p="xl/comments"+a+"."+r,ht(s,p,OH(g)),i.comments.push(p),Wt(h,-1,"../comments"+a+"."+r,St.CMNT),m=!0}f["!legacy"]&&m&&ht(s,"xl/drawings/vmlDrawing"+a+".vml",MH(a,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&ht(s,Gd(o),nh(h))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,ht(s,o,wH(e.Strings,e)),i.strs.push(o),Wt(e.wbrels,-1,"sharedStrings."+r,St.SST)),o="xl/workbook."+r,ht(s,o,KH(t)),i.workbooks.push(o),Wt(e.rels,1,o,St.WB),o="xl/theme/theme1.xml",ht(s,o,qE(t.Themes,e)),i.themes.push(o),Wt(e.wbrels,-1,"theme/theme1.xml",St.THEME),o="xl/styles."+r,ht(s,o,TH(t,e)),i.styles.push(o),Wt(e.wbrels,-1,"styles."+r,St.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",ht(s,o,t.vbaraw),i.vba.push(o),Wt(e.wbrels,-1,"vbaProject.bin",St.VBA)),o="xl/metadata."+r,ht(s,o,IH()),i.metadata.push(o),Wt(e.wbrels,-1,"metadata."+r,St.XLMETA),u.length>1&&(o="xl/persons/person.xml",ht(s,o,n0e(u)),i.people.push(o),Wt(e.wbrels,-1,"persons/person.xml",St.PEOPLE)),ht(s,"[Content_Types].xml",zF(i,e)),ht(s,"_rels/.rels",nh(e.rels)),ht(s,"xl/_rels/workbook."+r+".rels",nh(e.wbrels)),delete e.revssf,delete e.ssf,s}function oR(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Ai(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function XCe(t,e){return qe.find(t,"EncryptedPackage")?zCe(t,e):ZH(t,e)}function qCe(t,e){var r,n=t,i=e||{};return i.type||(i.type=Ct&&Buffer.isBuffer(t)?"buffer":"base64"),r=yF(n,i),jCe(r,i)}function oD(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return mx(t.slice(r),e);default:break e}return ph.to_workbook(t,e)}function JCe(t,e){var r="",n=oR(t,e);switch(e.type){case"base64":r=Ai(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Oc(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Kt(r)),e.type="binary",oD(r,e)}function ZCe(t,e){var r=t;return e.type=="base64"&&(r=Ai(r)),r=ja.utils.decode(1200,r.slice(2),"str"),e.type="binary",oD(r,e)}function QCe(t){return t.match(/[^\x00-\x7F]/)?po(t):t}function ey(t,e,r,n){return n?(r.type="string",ph.to_workbook(t,r)):ph.to_workbook(e,r)}function wx(t,e){RE();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return wx(new Uint8Array(t),(r=lr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),sh={},r.dateNF&&(sh.dateNF=r.dateNF),r.type||(r.type=Ct&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Ct?"buffer":"binary",n=Yce(t),typeof Uint8Array<"u"&&!Ct&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=QCe(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),a=new Uint8Array(o);if(a.foo="bar",!a.foo)return r=lr(r),r.type="array",wx(TE(n),r)}switch((i=oR(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return XCe(qe.read(n,r),r);break;case 9:if(i[1]<=8)return ZH(n,r);break;case 60:return mx(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return ide(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return pH.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?qCe(n,r):ey(t,n,r,s);case 239:return i[3]===60?mx(n,r):ey(t,n,r,s);case 255:if(i[1]===254)return ZCe(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Cc.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Cc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return gx.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return bH.to_workbook(n,r);break;case 10:case 13:case 32:return JCe(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return nde.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?gx.to_workbook(n,r):ey(t,n,r,s)}function aD(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Rg(e.file,qe.write(t,{type:Ct?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return qe.write(t,e)}function e1e(t,e){var r=lr(e||{}),n=GCe(t,r);return t1e(n,r)}function t1e(t,e){var r={},n=Ct?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?qe.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(rw(i))}return e.password&&typeof encrypt_agile<"u"?aD(encrypt_agile(i,e.password),e):e.type==="file"?Rg(e.file,i):e.type=="string"?Kt(i):i}function r1e(t,e){var r=e||{},n=Qwe(t,r);return aD(n,r)}function no(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Vd(po(n));case"binary":return po(n);case"string":return t;case"file":return Rg(e.file,n,"utf8");case"buffer":return Ct?da(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):no(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function n1e(t,e){switch(e.type){case"base64":return Vd(t);case"binary":return t;case"string":return t;case"file":return Rg(e.file,t,"binary");case"buffer":return Ct?da(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function km(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Vd(r):e.type=="string"?Kt(r):r;case"file":return Rg(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function lD(t,e){RE(),Xve(t);var r=lr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=lD(t,r);return r.type="array",rw(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return no(Gwe(t,r),r);case"slk":case"sylk":return no(mH.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return no(eD(t.Sheets[t.SheetNames[i]],r),r);case"txt":return n1e(cD(t.Sheets[t.SheetNames[i]],r),r);case"csv":return no(aR(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return no(pH.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return km(gx.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return no(ph.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return no(bH.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return no(vH.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return no(iD(t,r),r);case"wk1":return km(Cc.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return km(Cc.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),km(QH(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),r1e(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return e1e(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function i1e(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function s1e(t,e,r){var n={};return n.type="file",n.file=e,i1e(n),lD(t,n)}function o1e(t,e,r,n,i,s,o,a){var l=Hr(r),c=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),h=!0,f=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!o||t[r])for(var d=e.s.c;d<=e.e.c;++d){var g=o?t[r][d]:t[n[d]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;s[d]!=null&&(f[s[d]]=c);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[d]!=null){if(m==null)if(g.t=="e"&&m===null)f[s[d]]=null;else if(c!==void 0)f[s[d]]=c;else if(u&&m===null)f[s[d]]=null;else continue;else f[s[d]]=u&&(g.t!=="n"||g.t==="n"&&a.rawNumbers!==!1)?m:la(g,m,a);m!=null&&(h=!1)}}return{row:f,isempty:h}}function dv(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Mt(u);break;case"number":l=Mt(t["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var h=Hr(l.s.r),f=[],d=[],g=0,m=0,p=Array.isArray(t),y=l.s.r,S=0,C={};p&&!t[y]&&(t[y]=[]);var A=c.skipHidden&&t["!cols"]||[],I=c.skipHidden&&t["!rows"]||[];for(S=l.s.c;S<=l.e.c;++S)if(!(A[S]||{}).hidden)switch(f[S]=yr(S),r=p?t[y][S]:t[f[S]+h],n){case 1:s[S]=S-l.s.c;break;case 2:s[S]=f[S];break;case 3:s[S]=c.header[S-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),a=o=la(r,null,c),m=C[o]||0,!m)C[o]=1;else{do a=o+"_"+m++;while(C[a]);C[o]=m,C[a]=1}s[S]=a}for(y=l.s.r+i;y<=l.e.r;++y)if(!(I[y]||{}).hidden){var O=o1e(t,l,y,f,n,s,p,c);(O.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(d[g++]=O.row)}return d.length=g,d}var JM=/"/g;function a1e(t,e,r,n,i,s,o,a){for(var l=!0,c=[],u="",h=Hr(r),f=e.s.c;f<=e.e.c;++f)if(n[f]){var d=a.dense?(t[r]||[])[f]:t[n[f]+h];if(d==null)u="";else if(d.v!=null){l=!1,u=""+(a.rawNumbers&&d.t=="n"?d.v:la(d,null,a));for(var g=0,m=0;g!==u.length;++g)if((m=u.charCodeAt(g))===i||m===s||m===34||a.forceQuotes){u='"'+u.replace(JM,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(l=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(JM,'""')+'"')):u="";c.push(u)}return a.blankrows===!1&&l?null:c.join(o)}function aR(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Mt(t["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),a=n.RS!==void 0?n.RS:`
`,l=a.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",h=[];n.dense=Array.isArray(t);for(var f=n.skipHidden&&t["!cols"]||[],d=n.skipHidden&&t["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(f[g]||{}).hidden||(h[g]=yr(g));for(var m=0,p=i.s.r;p<=i.e.r;++p)(d[p]||{}).hidden||(u=a1e(t,i,p,h,o,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((m++?a:"")+u)));return delete n.dense,r.join("")}function cD(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=aR(t,e);return r}function l1e(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Mt(t["!ref"]),s="",o=[],a,l=[],c=Array.isArray(t);for(a=i.s.c;a<=i.e.c;++a)o[a]=yr(a);for(var u=i.s.r;u<=i.e.r;++u)for(s=Hr(u),a=i.s.c;a<=i.e.c;++a)if(e=o[a]+s,r=c?(t[u]||[])[a]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function uD(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},o=0,a=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?xr(n.origin):n.origin;o=l.r,a=l.c}var c,u={s:{c:0,r:0},e:{c:a,r:o+e.length-1+i}};if(s["!ref"]){var h=Mt(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),o==-1&&(o=h.e.r+1,u.e.r=o+e.length-1+i)}else o==-1&&(o=0,u.e.r=e.length-1+i);var f=n.header||[],d=0;e.forEach(function(m,p){Ir(m).forEach(function(y){(d=f.indexOf(y))==-1&&(f[d=f.length]=y);var S=m[y],C="z",A="",I=tt({c:a+d,r:o+p+i});c=Qd(s,I),S&&typeof S=="object"&&!(S instanceof Date)?s[I]=S:(typeof S=="number"?C="n":typeof S=="boolean"?C="b":typeof S=="string"?C="s":S instanceof Date?(C="d",n.cellDates||(C="n",S=Jr(S)),A=n.dateNF||et[14]):S===null&&n.nullError&&(C="e",S=0),c?(c.t=C,c.v=S,delete c.w,delete c.R,A&&(c.z=A)):s[I]=c={t:C,v:S},A&&(c.z=A))})}),u.e.c=Math.max(u.e.c,a+f.length-1);var g=Hr(o);if(i)for(d=0;d<f.length;++d)s[yr(d+a)+g]={t:"s",v:f[d]};return s["!ref"]=ct(u),s}function c1e(t,e){return uD(null,t,e)}function Qd(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=xr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Qd(t,tt(e)):Qd(t,tt({r:e,c:r||0}))}function u1e(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function lR(){return{SheetNames:[],Sheets:{}}}function cR(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=o+i)!=-1;++i);}if(YH(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function h1e(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=u1e(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function f1e(t,e){return t.z=e,t}function hD(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function d1e(t,e,r){return hD(t,"#"+e,r)}function g1e(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function m1e(t,e,r,n){for(var i=typeof e!="string"?e:Mt(e),s=typeof e=="string"?e:ct(e),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var l=Qd(t,o,a);l.t="n",l.F=s,delete l.v,o==i.s.r&&a==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Nm={encode_col:yr,encode_row:Hr,encode_cell:tt,encode_range:ct,decode_col:LE,decode_row:DE,split_cell:Rue,decode_cell:xr,decode_range:ci,format_cell:la,sheet_add_aoa:LF,sheet_add_json:uD,sheet_add_dom:tD,aoa_to_sheet:Ih,json_to_sheet:c1e,table_to_sheet:rD,table_to_book:xCe,sheet_to_csv:aR,sheet_to_txt:cD,sheet_to_json:dv,sheet_to_html:eD,sheet_to_formulae:l1e,sheet_to_row_object_array:dv,sheet_get_cell:Qd,book_new:lR,book_append_sheet:cR,book_set_sheet_visibility:h1e,cell_set_number_format:f1e,cell_set_hyperlink:hD,cell_set_internal_link:d1e,cell_add_comment:g1e,sheet_set_array_formula:m1e,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},fD={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){(function(r,n){t.exports=n()})(Hf,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},i=!n.document&&!!n.postMessage,s=n.IS_PAPA_WORKER||!1,o={},a=0,l={parse:function(E,b){var k=(b=b||{}).dynamicTyping||!1;if(_(k)&&(b.dynamicTypingFunction=k,k={}),b.dynamicTyping=k,b.transform=!!_(b.transform)&&b.transform,b.worker&&l.WORKERS_SUPPORTED){var B=function(){if(!l.WORKERS_SUPPORTED)return!1;var q=(we=n.URL||n.webkitURL||null,Se=r.toString(),l.BLOB_URL||(l.BLOB_URL=we.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",Se,")();"],{type:"text/javascript"})))),ue=new n.Worker(q),we,Se;return ue.onmessage=S,ue.id=a++,o[ue.id]=ue}();return B.userStep=b.step,B.userChunk=b.chunk,B.userComplete=b.complete,B.userError=b.error,b.step=_(b.step),b.chunk=_(b.chunk),b.complete=_(b.complete),b.error=_(b.error),delete b.worker,void B.postMessage({input:E,config:b,workerId:B.id})}var N=null;return l.NODE_STREAM_INPUT,typeof E=="string"?(E=function(q){return q.charCodeAt(0)===65279?q.slice(1):q}(E),N=b.download?new h(b):new d(b)):E.readable===!0&&_(E.read)&&_(E.on)?N=new g(b):(n.File&&E instanceof File||E instanceof Object)&&(N=new f(b)),N.stream(E)},unparse:function(E,b){var k=!1,B=!0,N=",",q=`\r
`,ue='"',we=ue+ue,Se=!1,ce=null,Re=!1;(function(){if(typeof b=="object"){if(typeof b.delimiter!="string"||l.BAD_DELIMITERS.filter(function(v){return b.delimiter.indexOf(v)!==-1}).length||(N=b.delimiter),(typeof b.quotes=="boolean"||typeof b.quotes=="function"||Array.isArray(b.quotes))&&(k=b.quotes),typeof b.skipEmptyLines!="boolean"&&typeof b.skipEmptyLines!="string"||(Se=b.skipEmptyLines),typeof b.newline=="string"&&(q=b.newline),typeof b.quoteChar=="string"&&(ue=b.quoteChar),typeof b.header=="boolean"&&(B=b.header),Array.isArray(b.columns)){if(b.columns.length===0)throw new Error("Option columns is empty");ce=b.columns}b.escapeChar!==void 0&&(we=b.escapeChar+ue),(typeof b.escapeFormulae=="boolean"||b.escapeFormulae instanceof RegExp)&&(Re=b.escapeFormulae instanceof RegExp?b.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var Y=new RegExp(p(ue),"g");if(typeof E=="string"&&(E=JSON.parse(E)),Array.isArray(E)){if(!E.length||Array.isArray(E[0]))return Pe(null,E,Se);if(typeof E[0]=="object")return Pe(ce||Object.keys(E[0]),E,Se)}else if(typeof E=="object")return typeof E.data=="string"&&(E.data=JSON.parse(E.data)),Array.isArray(E.data)&&(E.fields||(E.fields=E.meta&&E.meta.fields||ce),E.fields||(E.fields=Array.isArray(E.data[0])?E.fields:typeof E.data[0]=="object"?Object.keys(E.data[0]):[]),Array.isArray(E.data[0])||typeof E.data[0]=="object"||(E.data=[E.data])),Pe(E.fields||[],E.data||[],Se);throw new Error("Unable to serialize unrecognized input");function Pe(v,x,R){var T="";typeof v=="string"&&(v=JSON.parse(v)),typeof x=="string"&&(x=JSON.parse(x));var L=Array.isArray(v)&&0<v.length,K=!Array.isArray(x[0]);if(L&&B){for(var Q=0;Q<v.length;Q++)0<Q&&(T+=N),T+=w(v[Q],Q);0<x.length&&(T+=q)}for(var Z=0;Z<x.length;Z++){var ie=L?v.length:x[Z].length,fe=!1,H=L?Object.keys(x[Z]).length===0:x[Z].length===0;if(R&&!L&&(fe=R==="greedy"?x[Z].join("").trim()==="":x[Z].length===1&&x[Z][0].length===0),R==="greedy"&&L){for(var Me=[],ae=0;ae<ie;ae++){var ke=K?v[ae]:ae;Me.push(x[Z][ke])}fe=Me.join("").trim()===""}if(!fe){for(var Ae=0;Ae<ie;Ae++){0<Ae&&!H&&(T+=N);var be=L&&K?v[Ae]:Ae;T+=w(x[Z][be],Ae)}Z<x.length-1&&(!R||0<ie&&!H)&&(T+=q)}}return T}function w(v,x){if(v==null)return"";if(v.constructor===Date)return JSON.stringify(v).slice(1,25);var R=!1;Re&&typeof v=="string"&&Re.test(v)&&(v="'"+v,R=!0);var T=v.toString().replace(Y,we);return(R=R||k===!0||typeof k=="function"&&k(v,x)||Array.isArray(k)&&k[x]||function(L,K){for(var Q=0;Q<K.length;Q++)if(-1<L.indexOf(K[Q]))return!0;return!1}(T,l.BAD_DELIMITERS)||-1<T.indexOf(N)||T.charAt(0)===" "||T.charAt(T.length-1)===" ")?ue+T+ue:T}}};if(l.RECORD_SEP="",l.UNIT_SEP="",l.BYTE_ORDER_MARK="\uFEFF",l.BAD_DELIMITERS=["\r",`
`,'"',l.BYTE_ORDER_MARK],l.WORKERS_SUPPORTED=!i&&!!n.Worker,l.NODE_STREAM_INPUT=1,l.LocalChunkSize=10485760,l.RemoteChunkSize=5242880,l.DefaultDelimiter=",",l.Parser=y,l.ParserHandle=m,l.NetworkStreamer=h,l.FileStreamer=f,l.StringStreamer=d,l.ReadableStreamStreamer=g,n.jQuery){var c=n.jQuery;c.fn.parse=function(E){var b=E.config||{},k=[];return this.each(function(q){if(!(c(this).prop("tagName").toUpperCase()==="INPUT"&&c(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var ue=0;ue<this.files.length;ue++)k.push({file:this.files[ue],inputElem:this,instanceConfig:c.extend({},b)})}),B(),this;function B(){if(k.length!==0){var q,ue,we,Se,ce=k[0];if(_(E.before)){var Re=E.before(ce.file,ce.inputElem);if(typeof Re=="object"){if(Re.action==="abort")return q="AbortError",ue=ce.file,we=ce.inputElem,Se=Re.reason,void(_(E.error)&&E.error({name:q},ue,we,Se));if(Re.action==="skip")return void N();typeof Re.config=="object"&&(ce.instanceConfig=c.extend(ce.instanceConfig,Re.config))}else if(Re==="skip")return void N()}var Y=ce.instanceConfig.complete;ce.instanceConfig.complete=function(Pe){_(Y)&&Y(Pe,ce.file,ce.inputElem),N()},l.parse(ce.file,ce.instanceConfig)}else _(E.complete)&&E.complete()}function N(){k.splice(0,1),B()}}}function u(E){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(b){var k=I(b);k.chunkSize=parseInt(k.chunkSize),b.step||b.chunk||(k.chunkSize=null),this._handle=new m(k),(this._handle.streamer=this)._config=k}).call(this,E),this.parseChunk=function(b,k){if(this.isFirstChunk&&_(this._config.beforeFirstChunk)){var B=this._config.beforeFirstChunk(b);B!==void 0&&(b=B)}this.isFirstChunk=!1,this._halted=!1;var N=this._partialLine+b;this._partialLine="";var q=this._handle.parse(N,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var ue=q.meta.cursor;this._finished||(this._partialLine=N.substring(ue-this._baseIndex),this._baseIndex=ue),q&&q.data&&(this._rowCount+=q.data.length);var we=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s)n.postMessage({results:q,workerId:l.WORKER_ID,finished:we});else if(_(this._config.chunk)&&!k){if(this._config.chunk(q,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);q=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(q.data),this._completeResults.errors=this._completeResults.errors.concat(q.errors),this._completeResults.meta=q.meta),this._completed||!we||!_(this._config.complete)||q&&q.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),we||q&&q.meta.paused||this._nextChunk(),q}this._halted=!0},this._sendError=function(b){_(this._config.error)?this._config.error(b):s&&this._config.error&&n.postMessage({workerId:l.WORKER_ID,error:b,finished:!1})}}function h(E){var b;(E=E||{}).chunkSize||(E.chunkSize=l.RemoteChunkSize),u.call(this,E),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(k){this._input=k,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(b=new XMLHttpRequest,this._config.withCredentials&&(b.withCredentials=this._config.withCredentials),i||(b.onload=O(this._chunkLoaded,this),b.onerror=O(this._chunkError,this)),b.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var k=this._config.downloadRequestHeaders;for(var B in k)b.setRequestHeader(B,k[B])}if(this._config.chunkSize){var N=this._start+this._config.chunkSize-1;b.setRequestHeader("Range","bytes="+this._start+"-"+N)}try{b.send(this._config.downloadRequestBody)}catch(q){this._chunkError(q.message)}i&&b.status===0&&this._chunkError()}},this._chunkLoaded=function(){b.readyState===4&&(b.status<200||400<=b.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:b.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(k){var B=k.getResponseHeader("Content-Range");return B===null?-1:parseInt(B.substring(B.lastIndexOf("/")+1))}(b),this.parseChunk(b.responseText)))},this._chunkError=function(k){var B=b.statusText||k;this._sendError(new Error(B))}}function f(E){var b,k;(E=E||{}).chunkSize||(E.chunkSize=l.LocalChunkSize),u.call(this,E);var B=typeof FileReader<"u";this.stream=function(N){this._input=N,k=N.slice||N.webkitSlice||N.mozSlice,B?((b=new FileReader).onload=O(this._chunkLoaded,this),b.onerror=O(this._chunkError,this)):b=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var N=this._input;if(this._config.chunkSize){var q=Math.min(this._start+this._config.chunkSize,this._input.size);N=k.call(N,this._start,q)}var ue=b.readAsText(N,this._config.encoding);B||this._chunkLoaded({target:{result:ue}})},this._chunkLoaded=function(N){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(N.target.result)},this._chunkError=function(){this._sendError(b.error)}}function d(E){var b;u.call(this,E=E||{}),this.stream=function(k){return b=k,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var k,B=this._config.chunkSize;return B?(k=b.substring(0,B),b=b.substring(B)):(k=b,b=""),this._finished=!b,this.parseChunk(k)}}}function g(E){u.call(this,E=E||{});var b=[],k=!0,B=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(N){this._input=N,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){B&&b.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),b.length?this.parseChunk(b.shift()):k=!0},this._streamData=O(function(N){try{b.push(typeof N=="string"?N:N.toString(this._config.encoding)),k&&(k=!1,this._checkIsFinished(),this.parseChunk(b.shift()))}catch(q){this._streamError(q)}},this),this._streamError=O(function(N){this._streamCleanUp(),this._sendError(N)},this),this._streamEnd=O(function(){this._streamCleanUp(),B=!0,this._streamData("")},this),this._streamCleanUp=O(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function m(E){var b,k,B,N=Math.pow(2,53),q=-N,ue=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,we=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,Se=this,ce=0,Re=0,Y=!1,Pe=!1,w=[],v={data:[],errors:[],meta:{}};if(_(E.step)){var x=E.step;E.step=function(Z){if(v=Z,L())T();else{if(T(),v.data.length===0)return;ce+=Z.data.length,E.preview&&ce>E.preview?k.abort():(v.data=v.data[0],x(v,Se))}}}function R(Z){return E.skipEmptyLines==="greedy"?Z.join("").trim()==="":Z.length===1&&Z[0].length===0}function T(){return v&&B&&(Q("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+l.DefaultDelimiter+"'"),B=!1),E.skipEmptyLines&&(v.data=v.data.filter(function(Z){return!R(Z)})),L()&&function(){if(!v)return;function Z(fe,H){_(E.transformHeader)&&(fe=E.transformHeader(fe,H)),w.push(fe)}if(Array.isArray(v.data[0])){for(var ie=0;L()&&ie<v.data.length;ie++)v.data[ie].forEach(Z);v.data.splice(0,1)}else v.data.forEach(Z)}(),function(){if(!v||!E.header&&!E.dynamicTyping&&!E.transform)return v;function Z(fe,H){var Me,ae=E.header?{}:[];for(Me=0;Me<fe.length;Me++){var ke=Me,Ae=fe[Me];E.header&&(ke=Me>=w.length?"__parsed_extra":w[Me]),E.transform&&(Ae=E.transform(Ae,ke)),Ae=K(ke,Ae),ke==="__parsed_extra"?(ae[ke]=ae[ke]||[],ae[ke].push(Ae)):ae[ke]=Ae}return E.header&&(Me>w.length?Q("FieldMismatch","TooManyFields","Too many fields: expected "+w.length+" fields but parsed "+Me,Re+H):Me<w.length&&Q("FieldMismatch","TooFewFields","Too few fields: expected "+w.length+" fields but parsed "+Me,Re+H)),ae}var ie=1;return!v.data.length||Array.isArray(v.data[0])?(v.data=v.data.map(Z),ie=v.data.length):v.data=Z(v.data,0),E.header&&v.meta&&(v.meta.fields=w),Re+=ie,v}()}function L(){return E.header&&w.length===0}function K(Z,ie){return fe=Z,E.dynamicTypingFunction&&E.dynamicTyping[fe]===void 0&&(E.dynamicTyping[fe]=E.dynamicTypingFunction(fe)),(E.dynamicTyping[fe]||E.dynamicTyping)===!0?ie==="true"||ie==="TRUE"||ie!=="false"&&ie!=="FALSE"&&(function(H){if(ue.test(H)){var Me=parseFloat(H);if(q<Me&&Me<N)return!0}return!1}(ie)?parseFloat(ie):we.test(ie)?new Date(ie):ie===""?null:ie):ie;var fe}function Q(Z,ie,fe,H){var Me={type:Z,code:ie,message:fe};H!==void 0&&(Me.row=H),v.errors.push(Me)}this.parse=function(Z,ie,fe){var H=E.quoteChar||'"';if(E.newline||(E.newline=function(ke,Ae){ke=ke.substring(0,1048576);var be=new RegExp(p(Ae)+"([^]*?)"+p(Ae),"gm"),$e=(ke=ke.replace(be,"")).split("\r"),Le=ke.split(`
`),P=1<Le.length&&Le[0].length<$e[0].length;if($e.length===1||P)return`
`;for(var F=0,G=0;G<$e.length;G++)$e[G][0]===`
`&&F++;return F>=$e.length/2?`\r
`:"\r"}(Z,H)),B=!1,E.delimiter)_(E.delimiter)&&(E.delimiter=E.delimiter(Z),v.meta.delimiter=E.delimiter);else{var Me=function(ke,Ae,be,$e,Le){var P,F,G,ne;Le=Le||[",","	","|",";",l.RECORD_SEP,l.UNIT_SEP];for(var X=0;X<Le.length;X++){var re=Le[X],te=0,ee=0,oe=0;G=void 0;for(var le=new y({comments:$e,delimiter:re,newline:Ae,preview:10}).parse(ke),se=0;se<le.data.length;se++)if(be&&R(le.data[se]))oe++;else{var Ee=le.data[se].length;ee+=Ee,G!==void 0?0<Ee&&(te+=Math.abs(Ee-G),G=Ee):G=Ee}0<le.data.length&&(ee/=le.data.length-oe),(F===void 0||te<=F)&&(ne===void 0||ne<ee)&&1.99<ee&&(F=te,P=re,ne=ee)}return{successful:!!(E.delimiter=P),bestDelimiter:P}}(Z,E.newline,E.skipEmptyLines,E.comments,E.delimitersToGuess);Me.successful?E.delimiter=Me.bestDelimiter:(B=!0,E.delimiter=l.DefaultDelimiter),v.meta.delimiter=E.delimiter}var ae=I(E);return E.preview&&E.header&&ae.preview++,b=Z,k=new y(ae),v=k.parse(b,ie,fe),T(),Y?{meta:{paused:!0}}:v||{meta:{paused:!1}}},this.paused=function(){return Y},this.pause=function(){Y=!0,k.abort(),b=_(E.chunk)?"":b.substring(k.getCharIndex())},this.resume=function(){Se.streamer._halted?(Y=!1,Se.streamer.parseChunk(b,!0)):setTimeout(Se.resume,3)},this.aborted=function(){return Pe},this.abort=function(){Pe=!0,k.abort(),v.meta.aborted=!0,_(E.complete)&&E.complete(v),b=""}}function p(E){return E.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function y(E){var b,k=(E=E||{}).delimiter,B=E.newline,N=E.comments,q=E.step,ue=E.preview,we=E.fastMode,Se=b=E.quoteChar===void 0||E.quoteChar===null?'"':E.quoteChar;if(E.escapeChar!==void 0&&(Se=E.escapeChar),(typeof k!="string"||-1<l.BAD_DELIMITERS.indexOf(k))&&(k=","),N===k)throw new Error("Comment character same as delimiter");N===!0?N="#":(typeof N!="string"||-1<l.BAD_DELIMITERS.indexOf(N))&&(N=!1),B!==`
`&&B!=="\r"&&B!==`\r
`&&(B=`
`);var ce=0,Re=!1;this.parse=function(Y,Pe,w){if(typeof Y!="string")throw new Error("Input must be a string");var v=Y.length,x=k.length,R=B.length,T=N.length,L=_(q),K=[],Q=[],Z=[],ie=ce=0;if(!Y)return Oe();if(E.header&&!Pe){var fe=Y.split(B)[0].split(k),H=[],Me={},ae=!1;for(var ke in fe){var Ae=fe[ke];_(E.transformHeader)&&(Ae=E.transformHeader(Ae,ke));var be=Ae,$e=Me[Ae]||0;for(0<$e&&(ae=!0,be=Ae+"_"+$e),Me[Ae]=$e+1;H.includes(be);)be=be+"_"+$e;H.push(be)}if(ae){var Le=Y.split(B);Le[0]=H.join(k),Y=Le.join(B)}}if(we||we!==!1&&Y.indexOf(b)===-1){for(var P=Y.split(B),F=0;F<P.length;F++){if(Z=P[F],ce+=Z.length,F!==P.length-1)ce+=B.length;else if(w)return Oe();if(!N||Z.substring(0,T)!==N){if(L){if(K=[],oe(Z.split(k)),De(),Re)return Oe()}else oe(Z.split(k));if(ue&&ue<=F)return K=K.slice(0,ue),Oe(!0)}}return Oe()}for(var G=Y.indexOf(k,ce),ne=Y.indexOf(B,ce),X=new RegExp(p(Se)+p(b),"g"),re=Y.indexOf(b,ce);;)if(Y[ce]!==b)if(N&&Z.length===0&&Y.substring(ce,ce+T)===N){if(ne===-1)return Oe();ce=ne+R,ne=Y.indexOf(B,ce),G=Y.indexOf(k,ce)}else if(G!==-1&&(G<ne||ne===-1))Z.push(Y.substring(ce,G)),ce=G+x,G=Y.indexOf(k,ce);else{if(ne===-1)break;if(Z.push(Y.substring(ce,ne)),Ee(ne+R),L&&(De(),Re))return Oe();if(ue&&K.length>=ue)return Oe(!0)}else for(re=ce,ce++;;){if((re=Y.indexOf(b,re+1))===-1)return w||Q.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:K.length,index:ce}),se();if(re===v-1)return se(Y.substring(ce,re).replace(X,b));if(b!==Se||Y[re+1]!==Se){if(b===Se||re===0||Y[re-1]!==Se){G!==-1&&G<re+1&&(G=Y.indexOf(k,re+1)),ne!==-1&&ne<re+1&&(ne=Y.indexOf(B,re+1));var te=le(ne===-1?G:Math.min(G,ne));if(Y.substr(re+1+te,x)===k){Z.push(Y.substring(ce,re).replace(X,b)),Y[ce=re+1+te+x]!==b&&(re=Y.indexOf(b,ce)),G=Y.indexOf(k,ce),ne=Y.indexOf(B,ce);break}var ee=le(ne);if(Y.substring(re+1+ee,re+1+ee+R)===B){if(Z.push(Y.substring(ce,re).replace(X,b)),Ee(re+1+ee+R),G=Y.indexOf(k,ce),re=Y.indexOf(b,ce),L&&(De(),Re))return Oe();if(ue&&K.length>=ue)return Oe(!0);break}Q.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:K.length,index:ce}),re++}}else re++}return se();function oe(ze){K.push(ze),ie=ce}function le(ze){var lt=0;if(ze!==-1){var nt=Y.substring(re+1,ze);nt&&nt.trim()===""&&(lt=nt.length)}return lt}function se(ze){return w||(ze===void 0&&(ze=Y.substring(ce)),Z.push(ze),ce=v,oe(Z),L&&De()),Oe()}function Ee(ze){ce=ze,oe(Z),Z=[],ne=Y.indexOf(B,ce)}function Oe(ze){return{data:K,errors:Q,meta:{delimiter:k,linebreak:B,aborted:Re,truncated:!!ze,cursor:ie+(Pe||0)}}}function De(){q(Oe()),K=[],Q=[]}},this.abort=function(){Re=!0},this.getCharIndex=function(){return ce}}function S(E){var b=E.data,k=o[b.workerId],B=!1;if(b.error)k.userError(b.error,b.file);else if(b.results&&b.results.data){var N={abort:function(){B=!0,C(b.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:A,resume:A};if(_(k.userStep)){for(var q=0;q<b.results.data.length&&(k.userStep({data:b.results.data[q],errors:b.results.errors,meta:b.results.meta},N),!B);q++);delete b.results}else _(k.userChunk)&&(k.userChunk(b.results,N,b.file),delete b.results)}b.finished&&!B&&C(b.workerId,b.results)}function C(E,b){var k=o[E];_(k.userComplete)&&k.userComplete(b),k.terminate(),delete o[E]}function A(){throw new Error("Not implemented.")}function I(E){if(typeof E!="object"||E===null)return E;var b=Array.isArray(E)?[]:{};for(var k in E)b[k]=I(E[k]);return b}function O(E,b){return function(){E.apply(b,arguments)}}function _(E){return typeof E=="function"}return s&&(n.onmessage=function(E){var b=E.data;if(l.WORKER_ID===void 0&&b&&(l.WORKER_ID=b.workerId),typeof b.input=="string")n.postMessage({workerId:l.WORKER_ID,results:l.parse(b.input,b.config),finished:!0});else if(n.File&&b.input instanceof File||b.input instanceof Object){var k=l.parse(b.input,b.config);k&&n.postMessage({workerId:l.WORKER_ID,results:k,finished:!0})}}),(h.prototype=Object.create(u.prototype)).constructor=h,(f.prototype=Object.create(u.prototype)).constructor=f,(d.prototype=Object.create(d.prototype)).constructor=d,(g.prototype=Object.create(u.prototype)).constructor=g,l})})(fD);var p1e=fD.exports;const ZM=eO(p1e),v1e=async t=>{try{const e=await pD.post(`${vD}/unpacking/unpacking-import`,{data:t},{headers:{"Content-Type":"application/json"}});return(e.status===200||e.status===201)&&e.data.status===!0?{success:!0}:{success:!1,message:e.data.message||sc.ERROR_DATA}}catch(e){return{success:!1,message:e.response?e.response.data.message:sc.ERROR}}};gce();function D1e(){const e=dD(),[r,n]=Fg.useState([]),[i,s]=Fg.useState([]),[o,a]=Fg.useState(!1),[l,c]=Fg.useState(1),u=y=>{const S=y.target.files[0];if(!S)return;a(!0);const C=S.name.split(".").pop().toLowerCase(),I={csv:f,xlsx:h,xls:h}[C];I?I(S):(Mo.error(sc.ERROR_CSV_EXCEL),a(!1))},h=y=>{const S=new FileReader;S.onload=C=>{const A=wx(C.target.result,{type:"array"}),I=A.Sheets[A.SheetNames[0]],O=Nm.sheet_to_json(I,{header:1,raw:!0});s(O),n(O.slice(0,200)),a(!1)},S.onerror=()=>{Mo.error(sc.ERROR_XLSX),a(!1)},S.readAsArrayBuffer(y)},f=y=>{ZM.parse(y,{complete:({data:S})=>{s(S),n(S.slice(0,200)),a(!1)},error:()=>{Mo.error(sc.ERROR_CSV),a(!1)},header:!1,skipEmptyLines:!0})},d=()=>{const y=l+1,S=i.slice(0,y*200);n(S),c(y)},g=y=>{let S,C;switch(y){case"csv":S=new Blob([ZM.unparse(i)],{type:"text/csv;charset=utf-8;"}),C=document.createElement("a"),C.download="data.csv";break;case"json":S=new Blob([JSON.stringify(i)],{type:"application/json"}),C=document.createElement("a"),C.download="data.json";break;case"xlsx":const A=Nm.aoa_to_sheet(i),I=Nm.book_new();return Nm.book_append_sheet(I,A,"Sheet1"),s1e(I,"data.xlsx"),Mo.success(gw.XLSX_DATA)}S&&C&&(C.href=URL.createObjectURL(S),C.click())},m=async()=>{if(i.length===0){Mo.warning(wD.DATA_WARNING);return}const y=Mo.loading(gw.DATA_LOAD,0);try{const S=await v1e(i);y(),S.success?(Mo.success(gw.RECORD_CREATED),s([]),n([]),p()):Mo.error(sc.INVALID_DATA)}catch{y(),Mo.error(sc.INVALID_DATA)}},p=()=>{e("/u/action=data-1-2/db=ETC_PCB_UNPACKING_WEB"),s([])};return hr.jsxs("div",{className:"w-full h-screen overflow-auto bg-slate-50 p-3",children:[hr.jsxs(Jc,{type:"text",onClick:p,className:"mb-4",children:[hr.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:hr.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),"ETC PCB UNPACKING WEB"]}),hr.jsxs("div",{className:"flex justify-between mb-2",children:[hr.jsx("input",{type:"file",accept:".xlsx, .xls, .csv",onChange:u,className:"border rounded-lg p-2 cursor-pointer"}),hr.jsxs("div",{className:"flex items-center gap-3",children:[hr.jsx(Jc,{onClick:m,size:"large",children:"Import Data"}),hr.jsx(Jc,{onClick:()=>g("csv"),size:"large",children:"Export to CSV"}),hr.jsx(Jc,{onClick:()=>g("json"),size:"large",children:"Export to JSON"}),hr.jsx(Jc,{onClick:()=>g("xlsx"),size:"large",children:"Export to Excel"})]})]}),o?hr.jsx(gD,{}):hr.jsx(hr.Fragment,{children:r.length===0?hr.jsx(hr.Fragment,{children:hr.jsx("div",{className:"grid h-screen place-content-center items-center  justify-center bg-white",children:hr.jsx("img",{src:mD,className:"  w-96  opacity-60 h-auto "})})}):hr.jsxs(hr.Fragment,{children:["  ",hr.jsx(qk,{data:r,rowHeaders:!0,colHeaders:!0,height:"auto",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,licenseKey:"non-commercial-and-evaluation",contextMenu:!0,manualColumnResize:!0,autoColumnSize:!0,manualRowResize:!0,autoRowSize:!0,outsideClickDeselects:!0}),l*200<i.length&&hr.jsx("div",{className:"flex justify-center mt-4",children:hr.jsx(Jc,{onClick:d,className:"p-2 bg-blue-500 text-white rounded",children:"Táº£i thÃªm dá»¯ liá»u"})})]})})]})}export{D1e as default};
